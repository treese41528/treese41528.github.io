.. _3-5-choosing-the-right-measure-resistance-to-extreme-values:



.. raw:: html

   <div class="video-placeholder">
     <iframe
       src="https://www.youtube.com/embed/if-8h2DECQg?list=PLHKEwTHXfbagA3ybKLAcEJriGT-6k89c6"
       allowfullscreen>
     </iframe>
   </div>

.. admonition:: Slides
   :class: tip

   `Download Chapter 3 slides (PPTX) <https://yjjpfnblgtrogqvcjaon.supabase.co/storage/v1/object/public/stat-350-assets/slides/Chapter%203%20Numerical%20Summary%20Measures/Numerical%20Summaries%20%28Chapter%203%29_AC.pptx>`_


Choosing the Right Measure & Comparing Measures Across Data Sets
==========================================================================================

Now that we've explored different measures of central tendency and spread, we need to **determine
which measures are most appropriate for different types of data**. The effectiveness of each 
measure depends on the distribution shape and the presence of outliers. 

.. admonition:: Road Map üß≠
   :class: important

   ‚Ä¢ Understand what it means for a measure to be **resistant**.
   ‚Ä¢ Examine how skewness affects different measures of center and spread.
   ‚Ä¢ Learn which measures to choose when dealing with outliers.
   ‚Ä¢ Explore **standardization** for comparing observations across different datasets.
   ‚Ä¢ See how side-by-side boxplots can compare distributions across groups.

Resistant and Non-Resistant Measures
----------------------------------------

One of the most important considerations when choosing summary statistics is whether 
they are resistant to outliers and extreme values. This is because under the presence of
extreme values, certain measures lose their representative power for the data set.

* A **resistant measure** is one that isn't strongly affected by extreme values in the dataset. 
* A **non-resistant measure** can be heavily influenced by them.

Skewed distributions provide an excellent way to understand the concept of resistance. 
Let's examine what happens to our measures of center and spread when data is skewed.

Effect of skewness on numerical summary measures
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. _skewed-dists:
.. figure:: https://yjjpfnblgtrogqvcjaon.supabase.co/storage/v1/object/public/stat-350-assets/images/chapter3/box_plot_vs_histogram.png
   :alt: Comparison of negatively and positively skewed distributions
   :align: center
   :figwidth: 90%

   Skewed distributions

**Observation 1: Sample mean is pulled towards the tail**

In :numref:`skewed-dists`, notice how the mean (solid dot) is pulled in the direction of the tail, while the median remains 
firmly in the middle of the ordered data.

**Observation 2: Many points in the tail are marked as explicit points**

When data is skewed, box plots often flag many points as "explicit"
in the direction of the tail.

However, these flagged points don't necessarily represent true outliers. 
They may simply be part of the natural tail behavior of the distribution. 

Recall that real outliers typically show a clear gap between them and the rest of the data.
These points should be investigated more thoroughly to determine if they are real outliers, 
but it is evident that many explicit points on :numref:`skewed-dists` are not.


Choosing the Right Pair of measures
------------------------------------------

Sample Mean vs. Sample Median
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

As we can see from the skewed distributions,

* The sample mean (:math:`\bar{x}`) is **non-resistant** because it gives equal weight to each observation, 
  including outliers.

* The sample median (:math:`\tilde{x}`) is **resistant** because it depends only on the order (ranks) 
  of most of the data, not the exact values.

Sample Variance (Standard Deviation) vs. IQR
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Similarly, the measures of spread also differ in their resistance to outliers.

* The sample variance (:math:`s^2`) and sample standard deviation (:math:`s`) are **non-resistant** because

  - Their computation depends on the sample mean, which is already non-resistant.
  - Their computation involves squaring the distances of data points from the sample mean, 
    which amplifies the effect of extreme values.

* The interquartile range (IQR) is **resistant**. Because it only considers the middle 50% of the data, it is 
  not affected by extreme values in either tail.

Why Use Non-Resistant Measures At All?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

:math:`\bar{x}` and :math:`s` (or :math:`s^2`) are still favored over :math:`\tilde{x}` and IQR
when skewness and outliers are not a concern, because they carry important theoretical properties related
to normality. These properties will form the foundation of many inference methods we develope later in
the semester.

Summary
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. flat-table::
   :width: 90%
   :widths: 2 1 2 2
   :header-rows: 1
   :align: center

   * - Property of data distribution
     - Resistance required?
     - Measure of center
     - Measure of variability

   * - Skewed or has outliers
     - Yes
     - Sample median
     - IQR
   
   * - Reasonably symmetric and has no outliers
     - No
     - Sample mean
     - Sample variance (sd)

Comparing Measures Among Data Sets
-----------------------------------------

A. Side-by-Side Box Plots for Group Comparisons
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

When comparing a quantitative variable across categories, side-by-side box plots provide an excellent visualization tool.

.. figure:: https://yjjpfnblgtrogqvcjaon.supabase.co/storage/v1/object/public/stat-350-assets/images/chapter3/singer-heights.png
   :alt: Side-by-side box plots of heights by voice type
   :align: center
   :width: 70%

   Heights of singers in the New York Choral Society (1979) by voice type

This example shows the heights of singers in the New York Choral Society, 
categorized by voice type (soprano, alto, tenor, and bass). Some key observations are:

* Singers with lower voice ranges tend to be taller.
* However, there is a significant overlap in heights between tenors and basses, and between
  sopranos and altos.
* Each voice type shows a different distribution of heights. For example, the distribution is
  negatively skewed for the sopranos, while it is fairly symmetric for the altos except for a single outlier.

B. Standardization: Comparing Apples to Oranges
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Often, we need to compare observations from different variables that 
use different scales or units. **Standardization allows us to convert values 
to a common scale**, making direct comparisons possible.

Suppose we have a data set :math:`x_1, x_2, \cdots, x_n`, with the sample mean
:math:`\bar{x}` and sample standard deviation :math:`s`. Then for
each :math:`x_i`, its **standardized value** :math:`z_i` is calculated as:

.. math::

   z_i = \frac{x_i - \bar{x}}{s}

The standardized values tell us **how many standard deviations** :math:`x_i` **is from the mean**:

* Positive z-scores indicate values above the mean.
* Negative z-scores indicate values below the mean.
* A z-score of 0 indicates a value equal to the mean.

.. admonition:: Example üí°: Interpreting a Standardized Data Point
   :class: note

   Suppose for some data point :math:`x_i`, its standardized value is 
   :math:`z_i = -2.25`. This means the observation :math:`x_i` is 2.25 standard deviations below the mean.

Properties and Uses of Standardized Data
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

After standardization, the new data set :math:`z_1, z_2, \cdots, z_n` always
has a sample mean of 0 and a sample standard deviation of 1 (this can be verified
through a few algebraic steps). In other words, standardization adjusts
any data set so that each value is measured relative to a common center and scale.
This leads to several important properties:

1. Since they are unitless (the original units cancel out in the calculation),
   they provide an immediate sense of distance. For example, a data point with
   :math:`z=-3` is most likely very far from the central mass of the data.
2. They allow for direct comparison of observations from different distributions.

Bringing It All Together
------------------------

.. admonition:: Key Takeaways üìù
   :class: important

   1. **Resistant measures** (median, IQR) are not strongly affected by outliers and skewness and should be used when data is skewed 
      or contains outliers.
   
   2. **Non-resistant measures** (mean, standard deviation) are influenced by extreme values but have better statistical properties 
      for symmetric distributions without outliers.
   
   3. The **sample mean** is always pulled in the direction of the tail in skewed distributions, while the **sample median** remains 
      representative of the center.
   
   4. **Side-by-side box plots** allow us to compare distributions of a quantitative variable across categories of a categorical variable.
   
   5. **Standardized observations** enable comparisons across different distributions.

Exercises
~~~~~~~~~~~~~~

1. **Resistant vs. Non-Resistant Measures**: For each of the following datasets, state whether you would use the mean and standard 
   deviation or the median and IQR as summary measures, and explain why:
   
   a) Annual salaries of employees at a small company with one extremely high-paid CEO
   b) Heights of randomly selected adult males from a normally distributed population
   c) Times to completion of a task with a few extremely slow performances

2. **Standardization**: A student took tests in both math and English. She scored 85 on the math test (mean = 75, sd = 5) 
   and 88 on the English test (mean = 80, sd = 10).
   
   a) Calculate the z-score for each test result.
   b) On which test did she perform better relative to her peers?
   c) Explain why we can't compare the raw scores directly.

3. **Skewed Distributions**: Using the dataset {3, 4, 5, 5, 6, 7, 8, 15, 22}:
   
   a) Create a dot plot or histogram and describe the shape of the distribution.
   b) Calculate the mean, median, standard deviation, and IQR.
   c) Explain how the relationship between the mean and median confirms your assessment of the distribution shape.
   d) Which measures would you recommend for summarizing this dataset?

4. **Side-by-Side Box Plot Interpretation**: A researcher collects data on the recovery time (in days) for patients 
   using three different treatments:
   
   * Treatment A: {5, 7, 8, 9, 10, 12, 14}
   * Treatment B: {3, 4, 5, 6, 7, 8, 20}
   * Treatment C: {8, 9, 10, 11, 12, 13, 14}
   
   a) Create side-by-side box plots for the three treatments
   b) Which treatment appears to have the shortest typical recovery time?
   c) Which treatment has the most consistent results?
   d) Are there any potential outliers? If so, how might they affect your assessment?

..
   Appendix: Code for Creating a Side-by-Side Box Plot
   --------------------------------------------------------

   Let's first walk through how to create side-by-side box plots in R using the New York Choral 
   Society height data. First, we'll need to structure our data properly. Here's the dataset:

   .. code-block:: r

      # Singer heights data (in inches)
      singer_data <- data.frame(
      Voice = c(rep("Soprano", 36), rep("Alto", 35), rep("Tenor", 21), rep("Bass", 39)),
      Height = c(
         # Soprano heights
         64, 62, 66, 65, 60, 61, 65, 66, 65, 63, 67, 65, 62, 65, 68, 65, 63, 65, 62, 65, 66, 62, 65, 63, 65, 66, 65, 62, 65, 66, 65, 61, 65, 66, 65, 62,
         # Alto heights
         65, 62, 68, 67, 67, 63, 67, 66, 63, 72, 62, 61, 66, 64, 60, 61, 66, 66, 66, 62, 70, 65, 64, 63, 65, 69, 61, 66, 65, 61, 63, 64, 67, 66, 68,
         # Tenor heights
         69, 72, 71, 66, 76, 74, 71, 66, 68, 67, 70, 65, 72, 70, 68, 73, 66, 68, 67, 64, 0,
         # Bass heights
         72, 70, 72, 69, 73, 71, 72, 68, 68, 71, 66, 68, 71, 73, 73, 70, 68, 70, 75, 68, 71, 70, 74, 70, 75, 75, 69, 72, 71, 70, 71, 68, 70, 75, 72, 66, 72, 70, 69
      )
      )

      # Remove any zero values (missing data)
      singer_data <- subset(singer_data, Height > 0)
      
   Now we can create the box plots using ggplot2:

   .. code-block:: r

      library(ggplot2)
      
      # Create a function to convert heights in inches to feet and inches format for labels
      convert_in_to_ft <- function(values) {
      feet <- floor(values / 12)
      inches <- floor(values %% 12)
      value <- sprintf("%sft %sin", feet, inches)
      return(value)
      }
      
      # Create the side-by-side box plots
      ggplot(singer_data, aes(x = Voice, y = Height)) +
      stat_boxplot(geom = "errorbar") +     # Add whisker ends
      geom_boxplot(fill = "purple") +       # Create box plots with purple fill
      theme(text = element_text(size = 24, face = "bold"),
            axis.text = element_text(size = 20, face = "bold")) +
      stat_summary(fun = mean, col = "black", geom = "point", size = 3) +  # Add mean points
      scale_y_continuous(label = convert_in_to_ft,                          # Custom y-axis labels
                        breaks = c(60, 65, 70, 75)) +
      xlab("") +                            # No x-axis label needed
      ylab("Height")                        # y-axis label   
