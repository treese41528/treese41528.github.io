.. _11-1-ci-ht-two-samples:


.. raw:: html

   <div class="video-placeholder" role="group" aria-labelledby="video-ch11-1">
      <iframe
         id="video-ch11-1"
         title="STAT 350 – Chapter 11.1 Confidence Interval and Hypothesis Testing for Two Samples or Treatments Video"
         src="https://www.youtube.com/embed/bztTXSBCIVo?list=PLHKEwTHXfbagA3ybKLAcEJriGT-6k89c6"
         allowfullscreen>
      </iframe> 
   </div>

.. admonition:: Slides 📊
   :class: tip

   `Download Chapter 11 slides (PPTX) <https://yjjpfnblgtrogqvcjaon.supabase.co/storage/v1/object/public/stat-350-assets/
   slides/Chapter%2011%20Two%20Sample%20Procedures/CI%20and%20HT%20for%20Two%20Samples%20or%20Treatments_AC.pptx>`_


Statistical Inference for Two Samples
=======================================================================================

Up to this point, our statistical inference toolkit has focused on single populations—estimating means, 
testing hypotheses, and quantifying uncertainty for one group at a time. However, many of the most 
important questions in research and decision-making involve **comparisons**, which
require us to extend our methods to two-sample procedures.


.. admonition:: Road Map 🧭
   :class: important

   * Apply the general logic of statistical inference learned in Chapters 9 and 10 to research
     questions about **comparing two populations**.
   * Recognize the characteristics of a research context that leads to an
     **independent or paired** two-sample analysis.

The Comparative Mindset: From Description to Comparison
-----------------------------------------------------------

To answer comparative questions such as:

- Does the new medical treatment produce better outcomes than the 
  standard treatment?
- Which of two manufacturing processes produces more consistent results?
- Did a training program improve employee performance?
- Do men and women differ in their response to a particular intervention?

we must focus on characterizing **differences** between two populations
rather than describing the properties of each population in isolation.
Before we dive into the relevant inference methods, let us first establish the
notation.

Notation for Two-Sample Procedures
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

When working with two populations :math:`A` and :math:`B`, we distinguish their 
components using subscripts. Numbers or letters other than :math:`A`
and :math:`B` may be used, as long as their connection to the context is clearly defined.

.. flat-table::
   :header-rows: 1
   :width: 60%
   :align: center
   :widths: 15 10 10

   * - Population
     - A
     - B 
   
   * - Population Mean
     - :math:`\mu_A`
     - :math:`\mu_B`
   
   * - Population Standard Deviation
     - :math:`\sigma_A`
     - :math:`\sigma_B`
   
   * - Sample Size
     - :math:`n_A`
     - :math:`n_B`
   
   * - Sample Mean
     - :math:`\bar{X}_A`
     - :math:`\bar{X}_B`

   * - Sample Standard Deviation
     - :math:`S_A`
     - :math:`S_B`
     
Two Fundamental Scenarios: Independent vs. Paired Samples
------------------------------------------------------------------

The inference method for a two-sample comparison depends on how the samples
are associated. In this chapter, we focus on two specific types of association: 
**independent and paired** samples.

Independent Samples: Difference of Means
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Indpendent samples require that their populations are independent
and their sampling procedures do not influence each other.
Therefore, their sample sizes :math:`n_A` and :math:`n_B` need not be equal.

**Typical scenarios:**

- Comparing test scores between students taught with Method A vs. Method B
- Measuring blood pressure in two groups of patients, each group receiving Drug A vs. Drug B
- Analyzing repair costs for two different car models

**Analysis Strategy:**

Since there are no guarantees of shared structure between the two populations, we must
first summarize each population individually, then compare the summary. Specifically,
we will make inference on the **difference of their means**, :math:`\mu_A-\mu_B`.

Paired Samples: Mean of Differences
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Two samples are considered paired if there is a natural system linking subjects
one-to-one across the samples. Consequently, the sample sizes are 
always equal :math:`(n=n_A=n_B).`


**Typical scenarios:**

- Before and after measurements on the same patients
- Twins receiving different treatments
- Left vs. right measurements on the same subjects

Each pair consists of closely related individuals matched on similar background
characteristics. 

**Analysis Strategy:**

It is usually expected that there **exists considerable variation outside pairs** 
due to extraneous characteristics. An important aspect of a paired two-sample analysis is therefore
to minimize their influence on the result. This is achieved by viewing the two groups as working
together to generate a **single population of differences**. Instead of analyzing the data points of
Group A and Group B separately, we first compute the pair-wise differences :math:`D_1, D_2, \cdots, D_n`
and then analyze the **mean of the differences**, :math:`\mu_D`.

.. admonition:: Example 💡: Independent or Not?
   :class: note 

   For each case, state whether the samples should be considered paired or independent. Exaplain your
   reasoning.

   **Case 1**

   - Sample 1: corns from Farm A in Indiana
   - Sample 2: corns from Farm B in Ohio
   
   This is better suited for an **independent** two-sample analysis. In the given context, the number of corns
   from Farm A and Farm B need not be the same, which already violates a key condition
   for paired analysis. Moreover, there is no straightforward way to pair an individual 
   corn from Farm A with one from Farm B.

   **Case 2**

   - Sample 1: Weight of newborn babies in Jan 2023
   - Sample 2: Weight of the same group of newborn babies in Feb 2023

   It is natural to pair each data point from Sample 1 to the data point generated by the same individual
   in Sample 2. A **paired** analysis should be used. 

   **Case 3**

   - Sample 1: Output from running Algorithm 1 using 10 different datasets
   - Sample 2: Output from running Algorithm 2 using the same 10 datasets

   Each output in Sample 1 should be compared directly to the output from Sample 2 that used the same dataset,
   as performance can vary significantly by the data quality. **Paired** two-sample analysis should be used.

   **Case 4**

   - Sample 1: Registered cars in Northwest Lafayette BMV
   - Sample 2: Registered cars in Southeast Lafayette BMV

   The number of registered cars in Northwest Lafayette BMV is not constrained to be equal to
   the number in Southeast Lafayette BMV. No clear pairing system exists. **Independent** two-sample analysis
   should be used.

Formulating Hypotheses for Independent Two-Sample Comparisons
-------------------------------------------------------------------

In independent two-sample hypothesis testing, 
the parameter of interest is the **difference between the two true means**.
With this in mind, hypothesis formulation follows a similar set of rules as the one-sample case.

.. _HT_template:
.. figure:: https://yjjpfnblgtrogqvcjaon.supabase.co/storage/v1/object/public/stat-350-assets/images/chapter11/2sample-indep-HT-template.png 
   :figwidth: 70%
   :align: center 
   :alt: Template for independent two-sample hypotheses

   Template for independent two-sample hypotheses

We deonte the **null value** for a difference with :math:`\Delta_0`, using the Greek letter "Delta".

Listing all possible combinations of null and alternative hypotheses from the template
yields three distinct tests types:

**Upper-Tailed Hypothesis Test**

.. math::

   &H_0: \mu_A - \mu_B \leq \Delta_0\\
   &H_a: \mu_A - \mu_B > \Delta_0

**Lower-Tailed Hypothesis Test**

.. math::

   &H_0: \mu_A - \mu_B \geq \Delta_0\\
   &H_a: \mu_A - \mu_B < \Delta_0

**Two-Tailed Hypothesis Test**

.. math::

   &H_0: \mu_A - \mu_B = \Delta_0\\
   &H_a: \mu_A - \mu_B \neq \Delta_0

Special Case When the Null Value is Zero
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

In many cases, the test is on whether there is any difference between the two means,
or whether one is larger or smaller than the other. These cases correspond to the special cases 
with :math:`\Delta_0 = 0`.

**Upper-Tailed Test**: "Is :math:`\mu_A` **greater** than :math:`\mu_B`?"

.. math::

   &H_0: \mu_A - \mu_B \leq 0\\
   &H_a: \mu_A - \mu_B > 0

**Lower-Tailed Test**: "Is :math:`\mu_A` **less** than :math:`\mu_B`?"

.. math::

   &H_0: \mu_A - \mu_B \geq 0\\
   &H_a: \mu_A - \mu_B < 0

**Two-Tailed Test**: "Is :math:`\mu_A` **different** than :math:`\mu_B`?"

.. math::

   &H_0: \mu_A - \mu_B = 0\\
   &H_a: \mu_A - \mu_B \neq 0
   
.. admonition:: Order Matters
   :class: important

   The way we define the difference (:math:`\mu_A - \mu_B` vs. :math:`\mu_B - \mu_A`) determines the test type. 
   To avoid confusion, clearly link the notation to the context and specify the
   order of subtraction.

Formulating Hypotheses for Paired Two-Sample Comparisons
----------------------------------------------------------

Denote the samples from Populations A and B as:

.. math::
   X_{A1}, X_{A2}, \cdots, X_{An} \quad \text{ and } \quad X_{B1}, X_{B2}, \cdots, X_{Bn}, 

respectively. Assume that each pair was assigned the same index.
By taking the difference :math:`D_i = X_{A_i}-X_{Bi}` for all :math:`i=1,2, \cdots, n,` 
we obtain a **single sample** of :math:`n` pair-wise differences. Hypothesis tests 
are then performed on the **true mean of the differences**, :math:`\mu_D,` using one of the
three possible formulations:

**Upper-Tailed Hypothesis Test**

.. math::

   &H_0: \mu_D \leq \Delta_0\\
   &H_a: \mu_D > \Delta_0

**Lower-Tailed Hypothesis Test**

.. math::

   &H_0: \mu_D \geq \Delta_0\\
   &H_a: \mu_D < \Delta_0

**Two-Tailed Hypothesis Test**

.. math::

   &H_0: \mu_D = \Delta_0\\
   &H_a: \mu_D \neq \Delta_0

As in the independent analysis, the special cases with :math:`\Delta_0=0` correspond to
research questions about the direction of the difference (positive or negative) or about 
the existence of any difference at all.

.. admonition:: Specifying the Order of Subtraction is Crucial for Paired Analysis ‼️
   :class: danger

   In paired two-sample analyses, clarifying the order of subtraction is especially important because the information 
   is not apparent in the hypotheses. The related statement should be included in the **first of the four
   steps** of hypothesis testing, as part of parameter definition.

Bringing It All Together
-----------------------------

.. admonition:: Key Takeaways 📝
   :class: important

   1. **Two-sample procedures** answer questions about differences between populations or treatments.
   
   2. When the samples are **independent**, the two true means :math:`\mu_A` and :math:`\mu_B` are compared directly.
   
   3. In **paired samples**, sampling on one side significantly influences sampling probabilities in the other.
      For their comparative analysis, the two-sample data is transformed to a single sample of differences 
      :math:`D_i = X_{Ai} - X_{Bi}.` The central parameter is the mean of the differences, :math:`\mu_D`.

Exercises
~~~~~~~~~~~~~~

1. **Identifying Procedures**: For each scenario below, determine whether an independent or 
   paired two-sample procedure is appropriate. Explain your reasoning.

   a) Comparing the effectiveness of two different headache medications by giving drug A to one 
      group of patients and drug B to another group
   b) Measuring reaction times before and after participants consume caffeine
   c) Comparing test scores between students in two different schools
   d) Evaluating a new teaching method by comparing pre-test and post-test scores for the same students
   e) Comparing blood pressure medications by giving twins different drugs