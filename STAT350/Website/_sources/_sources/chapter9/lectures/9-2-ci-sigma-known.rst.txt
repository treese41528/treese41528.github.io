.. _9-2-ci-sigma-known:


.. raw:: html

   <div class="video-placeholder" role="group" aria-labelledby="video-ch7-1">
      <iframe
         id="video-ch7-1"
         title="STAT 350 – Chapter 7.1 Statistics and Sampling Distributions Video"
         src="https://www.youtube.com/embed/eK7cWzaG0-0?list=PLHKEwTHXfbagA3ybKLAcEJriGT-6k89c6"
         allowfullscreen>
      </iframe>
   </div>

.. admonition:: Slides 📊
   :class: tip

   `Download Chapter 9 slides (PPTX) <https://yjjpfnblgtrogqvcjaon.supabase.co/storage/v1/object/public/stat-350-assets/slides/
   Chapter%209%20Confidence%20Intervals/L19-21%20Confidence%20Intervals%20for%20Single%20Sample_AC.pptx>`_
   
Confidence Intervals for the Population Mean, When σ is Known
==================================================================

**Confidence intervals** are one of the most fundamental tools for expressing uncertainty 
around a point estimate. In this section, we focus on
constructing the confidence interval for a population mean
:math:`\mu` when **the population standard deviation** :math:`\sigma` **is known**. 
While this scenario is somewhat rare in practice 
(as :math:`\sigma` is typically unknown), it provides a clear foundation for understanding the 
core logic of interval estimation.

.. admonition:: Road Map 🧭
   :class: important
   
   * Understand the **complementary roles** of a point estimator and an interval estimator.
   * Derive the **confidence interval for a population mean** :math:`\mu`, given that the population standard deviation
     :math:`\sigma` is known. Apply the derived formula to problems.
   * Understand the difference between a **confidence interval as an estimator** and and a realized **estimate**,
     and correctly interpret each.

Why Point Estimates Aren't Enough
------------------------------------

In practice, we usually have access to only one sample from the population.
When we use a point estimator :math:`\hat{\theta}` to estimate a parameter :math:`\theta`,
we obtain only one realization out of many potential estiamtes 
that could have been observed. From this alone, we do not know how precise our current estimate is. 

To address this limitation, we turn to an **interval estimator**, which relies on the
sampling distribution of :math:`\hat{\theta}` to **measure and express uncertainty**.

Interval Estimators
~~~~~~~~~~~~~~~~~~~~~~

An **interval estimator** of a parameter :math:`\theta` aims to provide a **range of possible values** for 
its true location. It is typically constructed by expanding left and right
from a point estimator. For a point estimator :math:`\hat{\theta}` whose sampling distirbution
is symmetric, the expansion is also symmetric. That is, it takes the following general
form:

.. math::
   (\hat{\theta} - ME, \hat{\theta} + ME),

where ME stands for the **margin of error**. The margin of error expresses the magnitude of expansion
from the reference point, and therefore is **always non-negative**. Its value is determined by a combination
of several components, such as

* The population distribution,
* The definition of the point estimator :math:`\hat{\theta}`, and
* The sample size :math:`n`.


Confidence Interval for :math:`\mu`, When :math:`\sigma` is Known
-------------------------------------------------------------------

We now construct a specific class of interval estimators for the population mean :math:`\mu`,
based on its most widely used point estimator :math:`\bar{X}`. This class 
is called **Confidence Intervals (CIs)**.

The Goal
~~~~~~~~~~

For a pre-specified value :math:`C` between 0 and 1,
a confidence interval for :math:`\mu` **aims to capture** :math:`\mu` **with probability** :math:`C`.
Mathematically, this is equivalent to finding the ME (margin of error)
which satisfies:

.. math::
   P\left(\bar{X}-ME < \mu < \bar{X} + ME \right) = C.

Preliminaries
~~~~~~~~~~~~~~~~~~~

Before diving into the main derivation, let us first touch on its key 
ingredients.

* The probability :math:`C` is called the **confidence coefficient** of a confidence interval.
* When expressed in the percentage scale, :math:`C \cdot 100\%` is called the **confidence level**
  of a confidence interval.
* We denote the **complement of** :math:`C` as :math:`\alpha`. That is,
  
  .. math:: 
     \alpha = 1 - C. 

* Another important ingredient is the :math:`z`-**critical value**. A :math:`z`-critical
  value :math:`z_{\alpha/2}` is the value on a standard normal
  pdf which marks an **upper area** of :math:`\alpha/2`.
  
   .. figure:: https://yjjpfnblgtrogqvcjaon.supabase.co/storage/v1/object/public/stat-350-assets/images/chapter9/z-critical-value.png 
      :figwidth: 100%
      :align: center 
      :alt: Location of a z-critical value on a standard normal pdf

  By the symmetry of the standard normal distribution around 0, the region below :math:`-z_{\alpha/2}` also
  has the area :math:`\alpha/2`. Note that this leaves the central region bewteen :math:`-z_{\alpha/2}` and
  :math:`z_{\alpha/2}` exactly the area of :math:`C`.



Deriving the Confidence Interval: The Pivotal Method
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

This derivation is valid under the following assumptions:

1. :math:`X_1, X_2, \ldots, X_n` form an *iid* sample from the population, :math:`X`.
   The expected value and variance of :math:`X` is denoted :math:`\mu` and :math:`\sigma^2`,
   respectively.
2. Either the population is normally distributed, or we have sufficiently large :math:`n`
   for the CLT to hold.
3. The population variance :math:`\sigma^2` is known.

From the first and second assumptions, we have:

.. math::
   \bar{X} \sim N\left(\mu, \frac{\sigma^2}{n}\right),

which is equivalent to stating that its standardization has a standard normal distribution:

.. math::
   \frac{\bar{X} - \mu}{\sigma/\sqrt{n}} \sim N(0, 1).

The standardization of :math:`\bar{X}` is also called the **pivotal quanity**.
We are now ready to take the final steps.



**Step 1: Find the Interval Under the Standard Normal Distribution**

From the preliminaries, we already know that 

.. math::
   P\left(-z_{\alpha/2} < Z < z_{\alpha/2}\right) = C.


**Step 2: Replace** :math:`Z` **with the Pivotal Quantity**

.. math::
   P\left(-z_{\alpha/2} < \frac{\bar{X} - \mu}{\sigma/\sqrt{n}} < z_{\alpha/2}\right) = C.

This is possible because the pivotal quantity has the same distribution as :math:`Z`.

**Step 3: Rearrange the Inequalities**

1. Multiply all terms by :math:`\frac{\sigma}{\sqrt{n}}`:

   .. math::
      P\left(-z_{\alpha/2} \frac{\sigma}{\sqrt{n}} < \bar{X} - \mu < z_{\alpha/2} \frac{\sigma}{\sqrt{n}}\right) = C

2. Multiply by -1 and reverse the inequalities:

   .. math::
      P\left(z_{\alpha/2} \frac{\sigma}{\sqrt{n}} > \mu - \bar{X} > -z_{\alpha/2} \frac{\sigma}{\sqrt{n}}\right) = C

3. Rearrange to isolate :math:`\mu`:

   .. math::
      P\left(\bar{X} - z_{\alpha/2} \frac{\sigma}{\sqrt{n}} < \mu < \bar{X} + z_{\alpha/2} \frac{\sigma}{\sqrt{n}}\right) = C

At this point, the probability statement looks exactly like our goal,
with a computable representation of the ME.

Summary
~~~~~~~~~~

From the result above, we discover that the **margin of error** for the :math:`C\cdot 100 \%` confidence interval
of :math:`\mu` is

.. math::
   ME = z_{\alpha/2}\frac{\sigma}{\sqrt{n}}.

Plugging this into the general form, we finally obtain the complete expression for the 
confidence interval:

.. math::
   \left(\bar{X} - z_{\alpha/2} \frac{\sigma}{\sqrt{n}}, 
   \bar{X} + z_{\alpha/2} \frac{\sigma}{\sqrt{n}}\right).

Alternatively, the CI is also written as:

.. math::
   \bar{X} \pm z_{\alpha/2} \frac{\sigma}{\sqrt{n}}.

.. admonition:: Confidence Interval Is Also a Random Variable‼️
   :class: important

   Note that a confidence interval will also vary from sample to sample, since its 
   center, :math:`\bar{X}`, does. This means that we can view a CI
   as a (bivariate) random variable. 

   In practice, we have one realization of a CI based on a single sample:

   .. math::
      \left(\bar{x} - z_{\alpha/2} \frac{\sigma}{\sqrt{n}}, 
      \bar{x} + z_{\alpha/2} \frac{\sigma}{\sqrt{n}}\right).

   Note that the center is now represented with the lower case :math:`\bar{x}`. 
   Unlike a point estimate, however, a realized CI still gives us a 
   measure of precision through its **width**. A narrow interval suggests high precision, 
   while a wide interval reflects greater uncertainty.

.. admonition:: New Terminology: Standard Error
   :class: important 

   To distinguish from the population standard deviation :math:`\sigma`, we 
   often call the true standard deviation of an estimator the **standard error**.

   In our current setting, the standard error is :math:`\sigma_{\bar{X}} = \sigma/\sqrt{n}`.
   However, the mathematical definition of a standard error changes by the inference problem and
   its appropriate point estimator. We will encounter a few different standard errors in the upcoming chapters.

.. admonition:: Example 💡: American Adult Male Weights
   :class: note

   Historical data from 1960 indicated that the weight of American adult males was normally distributed 
   with a mean of :math:`\mu = 166.3` lbs and a standard deviation of :math:`\sigma = 49.26` lbs.

   In 2000, researchers collected a new sample of :math:`n = 3,791` adult males and found a sample mean of 
   :math:`\bar{x} = 191` lbs. Assuming the standard deviation hasn't changed, compute a 99% 
   confidence interval for the mean weight of American adult males in 2000.

   **The building blocks**

   * Sample mean: :math:`\bar{x} = 191` lbs
   * Population standard deviation: :math:`\sigma = 49.26` lbs
   * Sample size: :math:`n = 3,791`
   * Confidence level: :math:`99\% \, (C = 0.99, \alpha = 0.01)`

   **Find the critical value**

   The critical value: :math:`z_{\alpha/2} = z_{0.005}` is equal to the 99.5th percentile
   of a standard normal distribution. You can use the R command:

   .. code-block:: r

      qnorm(0.005, lower.tail=FALSE)   

   We find that :math:`z_{0.005} = 2.5758`.

   **Find the margin of error**
      
   .. math::
      \text{ME} = z_{0.005} \frac{\sigma}{\sqrt{n}} = 2.5758 \frac{49.26}{\sqrt{3791}} \approx 2.06 \text{ lbs}

   **Construct the confidence interval**

   .. math::
      \bar{x} \pm \text{ME} = 191 \pm 2.06 = [188.94 \text{ lbs}, 193.06 \text{ lbs}]

Interpreting Confidence Intervals Correctly
------------------------------------------------

Suppose a 95% confidence interval of :math:`(121.4, 126.2)` is computed for the true mean crop yield of corn
in a certain state, in bushels per acre. Then, it is **incorrect** to interpret the numbers as the following:

   ❌ "With 0.95 probability, the true mean yield of corn is between 121.4 and 126.2 bushels per acre." ❌

The statement is incorrect for two main reasons, which we now analyze one by one.

Common Pitfall 1: Probabilities of a Confidence Interval
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The confidence interval was constructed so that its probability of including the true mean is 0.95.
However, this property is true for the **CI as an estimator**, which is a random variable, NOT for a set of realized
values. Once the upper and lower values are determined as :math:`(121.4, 126.2)`, they do not have any probabilistic
relationship with another fixed quantity, :math:`\mu`. Therefore, the expression "With 0.95 probability..." is inaccurate.

Common Pitfall 2: Interval Is Random, :math:`\mu` Is Not
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Since a realized confidence interval is observed while the population mean :math:`\mu` is not, 
it is easy to mistakenly imply that :math:`\mu` varies from sample to sample, 
rather than the interval itself. The incorrect statement above implies that the true mean yield of corn
either succeeds or fails to be between the two fixed numbers, which is not accurate.

We should always remember that :math:`\mu` is an unknown yet unchanging property of the population distribution,
whereas the confidence interval changes from sample to sample. 
Our interpretations should reflect this distinction as accurately as possible.

.. _CI:
.. figure:: https://yjjpfnblgtrogqvcjaon.supabase.co/storage/v1/object/public/stat-350-assets/images/chapter9/many-CIs.png
   :figwidth: 65%
   :align: center
   :alt: Multiple confidence intervals showing which ones capture the true mean
   
   :math:`\mu` stays fixed while the confidence interval changes over different samples.

How To Say It Better
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

To include the confidence level as part of the interpretation, we use the term "confidence." We say 

   ✅ With 95% **confidence**, the interval :math:`(121.4, 126.2)` captures the true mean yield of corn. ✅

**Confidence** here is not used in its everyday sense, but as a **technical term**. It means that
:math:`(121.4, 126.2)` is one realization of a random variable which, across many samples, successfully 
captures the true mean with probability 0.95.

It is also possible to interpret :math:`C` as a probability, provided that the discussion is focused
on **the confidence interval as a random variable**. It is correct to say

   ✅ Over many computations of the CI using different samples,
   the **probability** that it captures :math:`\mu` is approximately 0.95. ✅

Here, 0.95 indicates the **proportion** of "successful" CIs out of the complete collection of 
a very large number of computed CIs. 

.. admonition:: Confidence Intervals Simulation 🎮
   :class: interactive
  
   Explore how confidence intervals behave by generating images like :numref:`CI`
   under different population distributions, sample sizes, and confidence level.
  
   `🔗 Launch Interactive Demo <https://treese41528.github.io/STAT350/ShinyApps/CI_Simulator.html>`_ |
   `📄 View R Code <https://treese41528.github.io/STAT350/ShinyApps/CI_Simulator_Shiny.R>`_

   .. figure:: https://yjjpfnblgtrogqvcjaon.supabase.co/storage/v1/object/public/stat-350-assets/images/chapter9/CI-simulator-preview.png 
      :figwidth: 70%
      :align: center 
      :alt: CI simulator preview

      CI simulator preview

Templates for Valid Interpretations
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

You are encouraged to use the templates below for interpretations of confidence intervals.
Simply replace the parentheses with specific values/contexts from your experiment.

.. flat-table::
   :align: center
   :width: 100%
   :header-rows: 2

   * - :cspan:`2` Templates for Interpreting a CI
   
   * - Case
     - Template

   * - When interpreting a concrete outcome of an experiment (an interval **estimate**)
     - With (:math:`C \cdot 100`)% confidence, the interval (lower value, upper value) captures the
       true/population mean of (context).
   
   * - When interpreting a CI as an interval **estimator**
     - Over many repeated trials of (experiment context), the proportion of realized confidence intervals which
       capture the true mean of (context) will be about (:math:`C`).

.. admonition:: Example 💡: American Adult Male Weights, Continued
   :class: note

   In the previous example, we computed a 99% confidence interval for the true mean weight 
   of American adult males as :math:`[188.94, 193.06]`. Give a valid interpretation of this outcome.

   **Interpretation:** We are 99% confident that the interval between 188.94 and 193.06 pounds
   includes the true mean weight of American adult males in 2000.

Bringing It All Together
----------------------------

.. admonition:: Key Takeaways 📝
   :class: important

   * An **interval estimator** provides a **range of plausible values for a population parameter**.
   * For a population mean with known standard deviation, its **confidence interval** is defined as
     :math:`\bar{X} \pm z_{\alpha/2} \frac{\sigma}{\sqrt{n}}`.
   * A confidence interval from a single experiment should be interpreted with care. Once a set of
     realized values, its interpretation should not directly involve any probabilities. Use the term
     **confidence** to imply its generation procedure.

Exercises
~~~~~~~~~~~~~~~

1. **Compute and Interpret**: A researcher measures the heights of 36 adult men and finds a sample mean 
   of 175.4 cm. Assuming the population standard deviation is known to be 7.2 cm, construct a 95% confidence 
   interval for the mean height. Interpret the interval.