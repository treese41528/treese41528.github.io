.. _7-3-clt:



.. raw:: html

   <div class="video-placeholder" role="group" aria-labelledby="video-ch7-3">
      <iframe
         id="video-ch7-3"
         title="STAT 350 ‚Äì Chapter 7.3 Central Limit Theorem Video"
         src="https://www.youtube.com/embed/l1vhy86sIVU?list=PLHKEwTHXfbagA3ybKLAcEJriGT-6k89c6"
         allowfullscreen>
      </iframe>
   </div>

.. admonition:: Slides üìä
   :class: tip

   `Download Chapter 7 slides (PPTX) <https://yjjpfnblgtrogqvcjaon.supabase.co/storage/v1/object/public/stat-350-assets/slides/
   Chapter%207%20Sampling%20Distributions/Sampling%20Distributions%20%28Chapter7%29_AC.pptx>`_
   
The Central Limit Theorem (CLT)
====================================================

We've established that the sampling distribution of :math:`\bar{X}` is normal when the population is normal. 
Then what about cases where the **population is not normally distributed**? 
The Central Limit Theorem (CLT) is a pivotal concept in statistics that addresses this question.

.. admonition:: Road Map üß≠
   :class: important

   * Learn the formal statement of the Central Limit Theorem (CLT). 
   * Recognize the experimental settings where the CLT applies. 
   * Apply the CLT to compute approximate probabilities of the sample mean.

The Formal Statement of the CLT
-----------------------------------

For an *independent and identically distributed (iid)* random sample :math:`X_1, X_2, ..., X_n` 
from a population with a finite mean :math:`Œº` and finite standard deviation :math:`œÉ`,

.. math::

   \frac{\bar{X} - \mu}{\sigma/\sqrt{n}} \xrightarrow{d} N(0,1) \text{ as } n \rightarrow \infty

.. admonition:: What does this all mean? üîé
   :class: important

   * :math:`\frac{\bar{X} - \mu}{\sigma/\sqrt{n}}` is the *standardized sample mean*. 
     :math:`\bar{X}` is subtracted by its own mean :math:`\mu_{\bar{X}} = \mu`, 
     then divided by its own standard deviation :math:`\sigma_{\bar{X}} = \frac{\sigma}{\sqrt{n}}` (the standard error).

   * :math:`\xrightarrow{d}` indicates *convergence in distribution*.

   * Putting together, the mathematical statement reads: "The distribution of the standardized sample mean
     approaches standard normal as the sample size :math:`n` goes to infinity."

Practical Implications of the CLT
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

When 

1. the population has a **finite mean** :math:`\mu` and a **finite standard deviation** :math:`\sigma`,
2. the observations are **independent and identically distributed (iid)**, and
3. the sample size :math:`n` is **sufficiently large**,

we have
 

.. math::
   \frac{\bar{X} - \mu}{\sigma/\sqrt{n}} \stackrel{d}{\approx} Z, 

where :math:`\stackrel{d}{\approx}` indicates that the two random variables have **similar** distributions.
By applying the same linear operations on both sides, we can
equivalently write:

.. math::
   \bar{X} \stackrel{d}{\approx} \frac{\sigma}{\sqrt{n}} Z + \mu.

The right-hand side is a linear transformation of a standard normal random variable
with the distribution :math:`N(\mu, \sigma/\sqrt{n})`. It follows that:

.. math::
   \bar{X} \stackrel{\text{approx}}{\sim} N\left(\mu, \frac{\sigma}{\sqrt{n}}\right).

Visual Demonstrations
--------------------------------------

The Central Limit Theorem (CLT) states that the sampling distribution of the sample mean approaches a 
normal distribution as the sample size increases, **regardless of the shape of the population distribution**, 
as long as certain conditions are met. Let us use a visual tool to build intuition for this somewhat surprising result.

How to Use the Simulation Tool
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The simulation tool requires a few inputs.

.. flat-table::
   :width: 100%
   :header-rows: 1

   * - Argument
     - Description
     - How to use

   * - **Population Distribution**
     - Normal, uniform, exponential, etc.
     - Select the family of distributions from which samples will be generated

   * - **Population Parameters**
     - Different for each population family (e.g., :math:`\mu` and :math:`\sigma` for normal, :math:`\lambda` for exponential)
     - Select the specific distribution belonging to the chosen family

   * - **Sample Size** :math:`n`
     - The number of data points used to compute one sample mean
     - Increase from small to large. Observe the change in the sampling distribution
   
   * - **Number of Samples**
     - The number of different sample means used to construct a histogram of the sampling distribution
     - Fix at a large number (10000, for example) so the sampling distribution of of sample means is 
       sufficiently described.

Once all values are set as desired, click **simulate**. Two plots will display:

* A pdf/pmf plot of the population distribution
* A histogram of sample means drawn from the population

.. admonition:: Interactive Visualization üéÆ
   :class: interactive
 
   **Central Limit Theorem Simulation**
  
   Visualize how sample means converge to a normal distribution as sample size
   increases, regardless of the underlying population distribution.
  
   `üîó Launch Interactive Demo <https://treese41528.github.io/STAT350/ShinyApps/CLT.html>`_ |
   `üìÑ View R Code <https://treese41528.github.io/STAT350/ShinyApps/CLT_Shiny.R>`_


A Checklist
~~~~~~~~~~~~~

By experimenting with different settings, confirm the following:

.. flat-table::
   :header-rows: 1
   :width: 100%

   * - ‚úî‚ùì
     - To confirm

   * -
     - The CLT indeed holds. That is, the histogram of sample means approaches a normal shape
       as :math:`n` grows.
   
   * -
     - A *large enough* :math:`n`, which makes the histogram look sufficiently normal, is different
       for each population distribution. In general, a population requires a larger :math:`n` if 
       it has strong non-normal characteristics (asymetry, multimodality, etc.).

   * - 
     - the center of the histogram remains around :math:`\mu` while the spread (:math:`\sigma/\sqrt{n}`) narrows around
       :math:`\mu` as :math:`n` increases.

How Large is "Sufficiently Large"?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The common rule of thumb that n > 30 is sufficient should not be blindly applied. 
As we saw through simulations, the appropriate sample size depends entirely on the underlying population distribution. 
The farther the population distribution is from normal, the larger the sample size needed for the CLT to apply effectively.

In practice, **we only observe a single sample from a population**. Our understanding of the 
population depends on the sample we observe and our background knowledge. We must explore our sample carefully
to determine if the sample size is likely sufficient for the CLT to apply.

Step-by-Step Problem Solving with the CLT
-----------------------------------------------

Problems using the CLT follow the general steps below:

1. Verify that the prerequisites for the CLT are met.
2. Identify the population mean :math:`\mu_X` and standard deviation :math:`\sigma_X`, and
   use them to calculate the mean :math:`\mu_{\bar{X}} = \mu_X` and 
   the standard error :math:`\sigma_{\bar{X}} = \sigma_X/\sqrt{n}` of the sampling distribution.
3. Establish the approximate sampling distribution of the sample mean: :math:`\bar{X} \stackrel{\text{approx}}{\sim} N(\mu_{\bar{X}}, \sigma_{\bar{X}})`.
4. Use a standard normal table or software to find the required probability.


.. admonition:: Exampleüí°: Another Maze Navigation Example
   :class: note 

   The same subspecies of rat from the previous experiment will be forced to navigate a more complex maze in which 
   a wrong turn early on can drastically increase the time to completion. The true mean completion time for
   the whole population of the subspecies is known to be 10 minutes. The true standard deviation is 3 minutes. 
   It is also known that the distribution is slightly right skewed. 

   Suppose that 60 rats are randomly selected from the population to navigate the maze.

   a) What is the mean of the **average time** it takes 60 rats to navigate the maze?
   b) What is the standard deviation of the **average time**?
   c) What is the probability that the **average maze navigation time** for the 60 rats is greater than 11 minutes?
   
   **Organize the Given Information**

   We know that the distribution of the population :math:`X` is slightly right skewed. Further, :math:`\mu_X=10` and :math:`\sigma_X=3`.
   
   **Solve the Problems**

   a) :math:`\mu_{\bar{X}} = \mu_{X} = 10`

   b) :math:`\sigma_{\bar{X}} = \frac{\sigma_X}{\sqrt{n}} = \frac{3}{\sqrt{60}}=0.3878`

   c) We do not know the population distribution, so we hope to use the CLT to compute the probability. We must first confirm that
      all the conditions are met for the CLT to hold:

      1. The population mean and standard deviation are finite. ‚úî
      2. The sample was formed by taking random samples from the same population. The randmonness ensures that
         the selection of one rat does not influence others (independence). Since they come from the same population,
         their distributions are identical. ‚úî
      3. For a *slightly* skewed distribution, :math:`n=60` is large enough. (To confirm, try plotting a left-skewed beta case with
         :math:`\alpha=3, \beta=2` using the simulation tool above). ‚úî

      Therefore, :math:`\bar{X} \stackrel{\text{approx}}{\sim} N(\mu_{X}=10, \sigma_{\bar{X}}=0.3878)` by the CLT. Then

      .. math::
         P(\bar{X} > 11) &= 1 - P(\bar{X} \leq 11) \\
         &= 1 - P\left(Z \leq \frac{11-10}{3/\sqrt{60}}\right) \\
         &= 1-\Phi(2.58) = 0.0049



Bringing It All Together
---------------------------------------------

.. admonition:: Key Takeaways üìù
   :class: important

   1. **The Central Limit Theorem states** that for an iid sample from a population with finite mean and variance, 
      the distribution of the standardized sample mean approaches standard normal as the sample size increases.
   
   2. **The CLT can be used to approximate the sampling distribution of** :math:`\bar{X}`, 
      but the sample size needed depends on how far the population distribution deviates from normality.
   
The Central Limit Theorem represents one of the most powerful and remarkable results in statistics. 
It allows us to use the normal distribution as a foundation for statistical inference across a wide 
range of real-world situations, even when the underlying population distributions are unknown or non-normal. 

Exercises
---------

These exercises develop your skills in applying the Central Limit Theorem to approximate the sampling distribution of the sample mean when the population is not normally distributed.

.. admonition:: Key Concepts
   :class: tip

   **Central Limit Theorem (CLT)**: For an iid random sample from a population with finite mean :math:`\mu` and finite standard deviation :math:`\sigma`, as :math:`n \to \infty`:

   .. math::
      \frac{\bar{X} - \mu}{\sigma/\sqrt{n}} \xrightarrow{d} N(0,1)

   **Practical implication**: When :math:`n` is sufficiently large,

   .. math::
      \bar{X} \stackrel{\text{approx}}{\sim} N\left(\mu, \sigma_{\bar{X}}^2\right) \quad \text{where } \sigma_{\bar{X}} = \frac{\sigma}{\sqrt{n}}

   Throughout these exercises, :math:`N(\mu, \sigma^2)` denotes a normal distribution with mean :math:`\mu` and **variance** :math:`\sigma^2`.

.. admonition:: CLT Conditions Checklist
   :class: info

   Before applying the CLT, verify:

   1. ‚úì Population has **finite mean** :math:`\mu` and **finite standard deviation** :math:`\sigma`
   2. ‚úì Observations are **independent and identically distributed (iid)**
   3. ‚úì Sample size :math:`n` is **sufficiently large** (depends on population shape)

   **Important**: The required sample size depends heavily on how far the population deviates from normality. Symmetric populations may need only :math:`n \geq 15`, while heavily skewed or heavy-tailed distributions may require :math:`n \geq 50` or more. The common ":math:`n \geq 30`" rule is a rough guideline, not a guarantee.

.. admonition:: R Functions for CLT Calculations
   :class: tip

   Once the CLT applies, use normal distribution functions with :math:`\mu_{\bar{X}} = \mu` and :math:`\sigma_{\bar{X}} = \sigma/\sqrt{n}`:

   .. code-block:: r

      # Define parameters
      mu <- ...           # Population mean
      sigma <- ...        # Population SD
      n <- ...            # Sample size
      se <- sigma / sqrt(n)  # Standard error

      # Probability calculations for XÃÑ
      pnorm(x, mean = mu, sd = se)                     # P(XÃÑ ‚â§ x)
      pnorm(x, mean = mu, sd = se, lower.tail = FALSE) # P(XÃÑ > x)

      # Quantiles of XÃÑ
      qnorm(p, mean = mu, sd = se)                     # Find x such that P(XÃÑ ‚â§ x) = p

.. admonition:: Exercise 1: CLT with Uniform Population
   :class: note

   The time (in seconds) for a random number generator to complete a cryptographic operation follows a uniform distribution on the interval :math:`[2, 6]`.

   a. Find the population mean :math:`\mu` and population standard deviation :math:`\sigma`.

   b. For a sample of :math:`n = 49` operations, find the mean and standard error of :math:`\bar{X}`.

   c. Verify that the CLT conditions are satisfied.

   d. Use the CLT to approximate :math:`P(\bar{X} > 4.2)`.

   e. Find :math:`P(3.7 < \bar{X} < 4.3)`.

   .. dropdown:: Solution
      :class-container: sd-border-success

      Let :math:`X` = time for one operation (seconds), where :math:`X \sim \text{Uniform}(2, 6)`.

      **Part (a): Population parameters**

      For a uniform distribution on :math:`[a, b]`:

      .. math::
         \mu = \frac{a + b}{2} = \frac{2 + 6}{2} = 4 \text{ seconds}

      .. math::
         \sigma = \frac{b - a}{\sqrt{12}} = \frac{6 - 2}{\sqrt{12}} = \frac{4}{3.464} = 1.155 \text{ seconds}

      **Part (b): Sampling distribution parameters**

      .. math::
         \mu_{\bar{X}} = \mu = 4 \text{ seconds}

      .. math::
         \sigma_{\bar{X}} = \frac{\sigma}{\sqrt{n}} = \frac{1.155}{\sqrt{49}} = \frac{1.155}{7} = 0.165 \text{ seconds}

      **Part (c): CLT conditions**

      1. ‚úì Finite mean and SD: :math:`\mu = 4` and :math:`\sigma = 1.155` are both finite.
      2. ‚úì iid: Operations are randomly selected and independent of each other under stable conditions.
      3. ‚úì Sample size: The uniform distribution is symmetric and bounded, so the CLT converges quickly. With :math:`n = 49`, the normal approximation is excellent.

      **Part (d): P(XÃÑ > 4.2) using CLT**

      By CLT: :math:`\bar{X} \stackrel{\text{approx}}{\sim} N(4, 0.165^2)`.

      .. math::
         P(\bar{X} > 4.2) = P\left(Z > \frac{4.2 - 4}{0.165}\right) = P(Z > 1.21)

      .. math::
         = 1 - \Phi(1.21) = 1 - 0.8869 = 0.1131

      **Part (e): P(3.7 < XÃÑ < 4.3)**

      .. math::
         P(3.7 < \bar{X} < 4.3) = P\left(\frac{3.7 - 4}{0.165} < Z < \frac{4.3 - 4}{0.165}\right)

      .. math::
         = P(-1.82 < Z < 1.82) = \Phi(1.82) - \Phi(-1.82)

      .. math::
         = 0.9656 - 0.0344 = 0.9312

      **R verification:**

      .. code-block:: r

         mu <- 4
         sigma <- 4/sqrt(12)  # 1.1547
         n <- 49
         se <- sigma / sqrt(n)  # 0.1650

         # Part (d): P(XÃÑ > 4.2)
         pnorm(4.2, mean = mu, sd = se, lower.tail = FALSE)
         # [1] 0.1127

         # Part (e): P(3.7 < XÃÑ < 4.3)
         pnorm(4.3, mean = mu, sd = se) - pnorm(3.7, mean = mu, sd = se)
         # [1] 0.9310

----

.. admonition:: Exercise 2: CLT with Exponential Population
   :class: note

   The time between customer arrivals at a help desk follows an exponential distribution with mean :math:`\mu = 5` minutes.

   a. What is the population standard deviation :math:`\sigma`?

   b. A manager records :math:`n = 40` inter-arrival times and computes the sample mean. What is the approximate distribution of :math:`\bar{X}`?

   c. Find the probability that the sample mean inter-arrival time is less than 4 minutes.

   d. Find the probability that the sample mean is within 1 minute of the population mean.

   e. The exponential distribution is right-skewed. Why is :math:`n = 40` likely sufficient for the CLT approximation?

   .. dropdown:: Solution
      :class-container: sd-border-success

      Let :math:`X` = inter-arrival time (minutes), where :math:`X \sim \text{Exp}(\mu = 5)`.

      **Part (a): Population standard deviation**

      For an exponential distribution, :math:`\sigma = \mu` (a unique property of this distribution).

      .. math::
         \sigma = 5 \text{ minutes}

      **Part (b): Approximate distribution of XÃÑ**

      First, calculate the standard error:

      .. math::
         \sigma_{\bar{X}} = \frac{\sigma}{\sqrt{n}} = \frac{5}{\sqrt{40}} = \frac{5}{6.325} = 0.791 \text{ minutes}

      **CLT conditions check:**

      1. ‚úì Finite mean (:math:`\mu = 5`) and SD (:math:`\sigma = 5`)
      2. ‚úì iid: Inter-arrival times are independent and from the same process
      3. ‚úì :math:`n = 40` is reasonably large for moderately skewed exponential

      By CLT:

      .. math::
         \bar{X} \stackrel{\text{approx}}{\sim} N(5, 0.791^2)

      **Part (c): P(XÃÑ < 4)**

      .. math::
         P(\bar{X} < 4) = P\left(Z < \frac{4 - 5}{0.791}\right) = P(Z < -1.26)

      .. math::
         = \Phi(-1.26) = 0.1038

      **Part (d): P(|XÃÑ ‚àí Œº| < 1) = P(4 < XÃÑ < 6)**

      .. math::
         P(4 < \bar{X} < 6) = P\left(\frac{4 - 5}{0.791} < Z < \frac{6 - 5}{0.791}\right)

      .. math::
         = P(-1.26 < Z < 1.26) = \Phi(1.26) - \Phi(-1.26)

      .. math::
         = 0.8962 - 0.1038 = 0.7924

      **R verification:**

      .. code-block:: r

         mu <- 5
         sigma <- 5  # For exponential, œÉ = Œº
         n <- 40
         se <- sigma / sqrt(n)  # 0.7906

         # Part (c): P(XÃÑ < 4)
         pnorm(4, mean = mu, sd = se)
         # [1] 0.1034

         # Part (d): P(4 < XÃÑ < 6)
         pnorm(6, mean = mu, sd = se) - pnorm(4, mean = mu, sd = se)
         # [1] 0.7932

      **Part (e): Why n = 40 is likely sufficient**

      Although the exponential distribution is right-skewed, it has moderate skewness (skewness coefficient = 2 for all exponential distributions). The CLT converges reasonably quickly for such distributions. With :math:`n = 40`, the averaging process is often adequate for many practical probability calculations involving the exponential distribution. However, for populations with more extreme skewness or heavier tails, larger samples may be needed.

----

.. admonition:: Exercise 3: Effect of Sample Size on CLT Approximation
   :class: note

   A manufacturing process produces components with weights that follow a right-skewed distribution with :math:`\mu = 50` grams and :math:`\sigma = 8` grams.

   a. For :math:`n = 16`, find :math:`\sigma_{\bar{X}}` and use the CLT to approximate :math:`P(\bar{X} > 52)`.

   b. For :math:`n = 64`, find :math:`\sigma_{\bar{X}}` and approximate :math:`P(\bar{X} > 52)`.

   c. For :math:`n = 256`, find :math:`\sigma_{\bar{X}}` and approximate :math:`P(\bar{X} > 52)`.

   d. Explain the pattern in your answers. Why does :math:`P(\bar{X} > 52)` decrease as :math:`n` increases?

   e. A quality engineer questions whether the CLT approximation is valid for :math:`n = 16` given the skewed population. Is this concern reasonable?

   .. dropdown:: Solution
      :class-container: sd-border-success

      Given: :math:`\mu = 50` g, :math:`\sigma = 8` g, population is right-skewed.

      **Part (a): n = 16**

      .. math::
         \sigma_{\bar{X}} = \frac{8}{\sqrt{16}} = 2 \text{ g}

      By CLT: :math:`\bar{X} \stackrel{\text{approx}}{\sim} N(50, 2^2)`.

      .. math::
         P(\bar{X} > 52) \approx P\left(Z > \frac{52 - 50}{2}\right) = P(Z > 1.00) = 1 - 0.8413 = 0.1587

      **Part (b): n = 64**

      .. math::
         \sigma_{\bar{X}} = \frac{8}{\sqrt{64}} = 1 \text{ g}

      .. math::
         P(\bar{X} > 52) \approx P\left(Z > \frac{52 - 50}{1}\right) = P(Z > 2.00) = 1 - 0.9772 = 0.0228

      **Part (c): n = 256**

      .. math::
         \sigma_{\bar{X}} = \frac{8}{\sqrt{256}} = 0.5 \text{ g}

      .. math::
         P(\bar{X} > 52) \approx P\left(Z > \frac{52 - 50}{0.5}\right) = P(Z > 4.00) \approx 0.00003

      **R verification:**

      .. code-block:: r

         mu <- 50
         sigma <- 8

         # Part (a): n = 16
         pnorm(52, mean = mu, sd = sigma/sqrt(16), lower.tail = FALSE)
         # [1] 0.1587

         # Part (b): n = 64
         pnorm(52, mean = mu, sd = sigma/sqrt(64), lower.tail = FALSE)
         # [1] 0.02275

         # Part (c): n = 256
         pnorm(52, mean = mu, sd = sigma/sqrt(256), lower.tail = FALSE)
         # [1] 3.167e-05

      **Part (d): Pattern explanation**

      .. list-table::
         :header-rows: 1
         :widths: 20 30 30

         * - :math:`n`
           - :math:`\sigma_{\bar{X}}`
           - :math:`P(\bar{X} > 52)`
         * - 16
           - 2.0 g
           - 0.1587
         * - 64
           - 1.0 g
           - 0.0228
         * - 256
           - 0.5 g
           - 0.00003

      As :math:`n` increases, the standard error decreases, making the sampling distribution more concentrated around :math:`\mu = 50`. A value of 52 (which is 2 grams above the mean) becomes increasingly "extreme" in terms of standard errors: 1.0 SE for :math:`n = 16`, 2.0 SE for :math:`n = 64`, and 4.0 SE for :math:`n = 256`.

      .. figure:: https://yjjpfnblgtrogqvcjaon.supabase.co/storage/v1/object/public/stat-350-assets/Exercises/ch7-3/fig3_sample_size_effect.png
         :alt: Sampling distributions for different sample sizes
         :align: center
         :width: 80%

         Larger samples produce more concentrated sampling distributions, making P(XÃÑ > 52) decrease dramatically.

      **Part (e): Validity concern for n = 16**

      **Yes, this concern is reasonable.** For skewed populations, :math:`n = 16` may not be large enough for the CLT approximation to be accurate. The approximation for :math:`n = 16` should be treated as rough‚Äîdirectionally correct but potentially inaccurate depending on the degree of skewness and presence of outliers.

      The results for :math:`n = 64` and :math:`n = 256` are more reliable. If high precision is needed with small samples from skewed populations, alternative methods (like bootstrapping) or larger sample sizes should be considered.

----

.. admonition:: Exercise 4: Verifying CLT Conditions
   :class: note

   For each scenario, determine whether the CLT can be appropriately applied. If not, explain which condition is violated.

   a. Sample of 50 household incomes from a city, used to estimate mean income. Income distributions are typically right-skewed.

   b. Sample of 25 measurements from a symmetric, bell-shaped population.

   c. Sample of 100 observations from a manufacturing process, where each observation is the maximum of 10 temperature readings from the same set of correlated sensors taken in overlapping time windows.

   d. Sample of 40 waiting times from a process that occasionally produces extreme outliers (heavy-tailed distribution with infinite variance).

   e. Sample of 35 reaction times from a mildly skewed distribution with :math:`\mu = 250` ms and :math:`\sigma = 40` ms.

   .. dropdown:: Solution
      :class-container: sd-border-success

      **Part (a): Household incomes, n = 50, right-skewed**

      ‚úì **CLT can be applied.** Income distributions have finite mean and variance. With :math:`n = 50`, the sample size is large enough to handle right-skewness. The CLT approximation should be reasonably accurate.

      **Part (b): Bell-shaped population, n = 25**

      ‚úì **CLT is valid, but not necessary.** Since the population is symmetric and bell-shaped (approximately normal), the sampling distribution of :math:`\bar{X}` is already approximately normal even for small :math:`n`. The exact normal result from Section 7.2 applies if the population is truly normal; otherwise, the CLT provides additional justification.

      **Part (c): Maximum of correlated sensors with overlapping windows, n = 100**

      ‚úó **CLT cannot be applied.** The observations are not independent‚Äîeach observation is derived from the same set of correlated sensors, and overlapping time windows introduce temporal dependence between consecutive observations. The **independence** condition is violated. Even with :math:`n = 100`, the CLT does not apply because the variance formula :math:`\text{Var}(\bar{X}) = \sigma^2/n` assumes independence; with dependent observations, the true variance of :math:`\bar{X}` may be much larger.

      **Part (d): Heavy-tailed distribution with infinite variance, n = 40**

      ‚úó **CLT cannot be applied.** The CLT requires **finite variance**. If the population variance is infinite (as with some heavy-tailed distributions like the Cauchy distribution), the CLT does not hold regardless of sample size. The sampling distribution of :math:`\bar{X}` will not approach normality.

      **Part (e): Mildly skewed reaction times, n = 35**

      ‚úì **CLT can be applied.** The population has finite :math:`\mu` and :math:`\sigma`, observations can be assumed iid if properly sampled, and :math:`n = 35` is reasonable for a mildly skewed distribution. With :math:`\sigma_{\bar{X}} = 40/\sqrt{35} = 6.76` ms, the approximation :math:`\bar{X} \stackrel{\text{approx}}{\sim} N(250, 6.76^2)` is reasonable.

----

.. admonition:: Exercise 5: Comparing CLT to Normal Population Result
   :class: note

   Consider two populations, both with :math:`\mu = 100` and :math:`\sigma = 20`:

   - **Population A**: Normally distributed
   - **Population B**: Uniformly distributed on :math:`[100 - 20\sqrt{3}, 100 + 20\sqrt{3}]`

   For samples of size :math:`n = 36` from each population:

   a. What is the sampling distribution of :math:`\bar{X}` for Population A? (Use exact result.)

   b. What is the approximate sampling distribution of :math:`\bar{X}` for Population B? (Use CLT.)

   c. Calculate :math:`P(\bar{X} < 95)` for each population.

   d. Why are the answers to part (c) similar?

   .. dropdown:: Solution
      :class-container: sd-border-success

      Both populations have :math:`\mu = 100`, :math:`\sigma = 20`, and :math:`n = 36`.

      Standard error: :math:`\sigma_{\bar{X}} = \frac{20}{\sqrt{36}} = \frac{20}{6} = 3.333`.

      **Part (a): Population A (Normal) ‚Äî Exact result**

      Since Population A is normal, by the exact result from Section 7.2:

      .. math::
         \bar{X} \sim N(100, 3.333^2) \quad \text{(exactly)}

      **Part (b): Population B (Uniform) ‚Äî CLT approximation**

      The uniform distribution is symmetric with finite mean and variance, and :math:`n = 36` is large. By CLT:

      .. math::
         \bar{X} \stackrel{\text{approx}}{\sim} N(100, 3.333^2)

      **Part (c): P(XÃÑ < 95) for each population**

      *Population A (exact):*

      .. math::
         P(\bar{X} < 95) = P\left(Z < \frac{95 - 100}{3.333}\right) = P(Z < -1.50) = 0.0668

      *Population B (CLT approximation):*

      .. math::
         P(\bar{X} < 95) \approx P\left(Z < \frac{95 - 100}{3.333}\right) = P(Z < -1.50) \approx 0.0668

      **R verification:**

      .. code-block:: r

         mu <- 100
         se <- 20 / sqrt(36)  # 3.333

         # Both populations give the same result
         pnorm(95, mean = mu, sd = se)
         # [1] 0.0668

      **Part (d): Why are the answers similar?**

      The answers are nearly identical because:

      1. Both sampling distributions have the same mean (:math:`\mu_{\bar{X}} = 100`) and standard error (:math:`\sigma_{\bar{X}} = 3.333`)

      2. For Population A, normality is exact; for Population B, the CLT approximation is very accurate because the uniform distribution is symmetric and bounded, causing rapid convergence to normality

      3. The CLT tells us that the shape of the population matters less and less as :math:`n` increases‚Äîall sampling distributions converge to normal

      This illustrates the power of the CLT: regardless of the original population shape, sample means behave similarly for large :math:`n`.

----

.. admonition:: Exercise 6: Sample Size Determination
   :class: note

   A quality control engineer needs to estimate the mean fill volume of bottles. The filling process has :math:`\sigma = 2.4` mL, and the distribution is slightly right-skewed.

   a. The engineer wants :math:`P(|\bar{X} - \mu| < 0.5) \geq 0.95`. Using the CLT approximation, find the minimum sample size needed.

   b. Given that the population is skewed, should the engineer use a sample size larger than the minimum calculated in part (a)? Explain.

   c. If the engineer uses :math:`n = 100`, find :math:`P(|\bar{X} - \mu| < 0.5)`.

   .. dropdown:: Solution
      :class-container: sd-border-success

      Given: :math:`\sigma = 2.4` mL, population slightly right-skewed.

      **Part (a): Minimum sample size for P(|XÃÑ ‚àí Œº| < 0.5) ‚â• 0.95**

      We need:

      .. math::
         P\left(-0.5 < \bar{X} - \mu < 0.5\right) \geq 0.95

      Standardizing:

      .. math::
         P\left(-\frac{0.5}{\sigma_{\bar{X}}} < Z < \frac{0.5}{\sigma_{\bar{X}}}\right) \geq 0.95

      For a symmetric interval, we need :math:`\frac{0.5}{\sigma_{\bar{X}}} \geq z_{0.975} = 1.96`.

      .. math::
         \sigma_{\bar{X}} \leq \frac{0.5}{1.96} = 0.2551

      .. math::
         \frac{2.4}{\sqrt{n}} \leq 0.2551 \implies \sqrt{n} \geq \frac{2.4}{0.2551} = 9.408 \implies n \geq 88.5

      Minimum sample size: **n = 89**.

      **Part (b): Should a larger sample be used?**

      **Yes, a larger sample is advisable** for two reasons:

      1. **CLT accuracy**: The calculation assumes the CLT approximation is accurate. For a skewed population, using a sample size larger than the theoretical minimum (e.g., :math:`n = 100` or more) helps ensure the normal approximation is valid.

      2. **Safety margin**: The minimum of 89 achieves *exactly* 95% probability under ideal conditions. Real-world variability and the approximation nature of the CLT suggest building in a buffer.

      **Part (c): P(|XÃÑ ‚àí Œº| < 0.5) with n = 100**

      .. math::
         \sigma_{\bar{X}} = \frac{2.4}{\sqrt{100}} = 0.24 \text{ mL}

      .. math::
         P(|\bar{X} - \mu| < 0.5) = P\left(-\frac{0.5}{0.24} < Z < \frac{0.5}{0.24}\right)

      .. math::
         = P(-2.08 < Z < 2.08) = \Phi(2.08) - \Phi(-2.08)

      .. math::
         = 0.9812 - 0.0188 = 0.9624

      With :math:`n = 100`, there is about a **96.2%** probability that the sample mean is within 0.5 mL of the true mean‚Äîexceeding the 95% target.

      **R verification:**

      .. code-block:: r

         sigma <- 2.4

         # Part (a): Find minimum n for P(|XÃÑ - Œº| < 0.5) ‚â• 0.95
         # Need SE ‚â§ 0.5/1.96
         (2.4 / (0.5/qnorm(0.975)))^2
         # [1] 88.5 ‚Üí round up to 89

         # Part (c): P(|XÃÑ - Œº| < 0.5) with n = 100
         se <- sigma / sqrt(100)  # 0.24
         pnorm(0.5/se) - pnorm(-0.5/se)
         # [1] 0.9625

----

.. admonition:: Exercise 7: Process Monitoring Application
   :class: note

   A chemical reactor operates with a temperature that fluctuates according to a distribution with :math:`\mu = 350¬∞C` and :math:`\sigma = 12¬∞C`. The distribution is symmetric but has heavier tails than normal. Every hour, an automated system records :math:`n = 36` temperature readings and computes the average.

   a. Using the CLT, what is the approximate distribution of the hourly average temperature :math:`\bar{X}`?

   b. The system triggers an alert if :math:`\bar{X}` falls outside the interval :math:`[346, 354]`. What is the probability of a false alarm (alert when the process is operating normally)?

   c. Suppose the reactor drifts so that :math:`\mu = 355¬∞C`. What is the probability that the monitoring system detects this drift (i.e., :math:`\bar{X}` falls outside :math:`[346, 354]`)?

   d. How would increasing :math:`n` to 64 affect the false alarm rate and detection probability?

   .. dropdown:: Solution
      :class-container: sd-border-success

      Given: :math:`\mu = 350¬∞C`, :math:`\sigma = 12¬∞C`, :math:`n = 36`, symmetric heavy-tailed distribution.

      **Part (a): Approximate distribution of XÃÑ**

      Standard error: :math:`\sigma_{\bar{X}} = \frac{12}{\sqrt{36}} = 2¬∞C`.

      CLT conditions: ‚úì Finite :math:`\mu` and :math:`\sigma`, ‚úì iid readings, ‚úì :math:`n = 36` is sufficient for a symmetric distribution (even with heavy tails, symmetry helps).

      .. math::
         \bar{X} \stackrel{\text{approx}}{\sim} N(350, 2^2)

      **Part (b): False alarm probability when Œº = 350**

      .. math::
         P(\text{false alarm}) = P(\bar{X} < 346 \text{ or } \bar{X} > 354)

      .. math::
         = P\left(Z < \frac{346 - 350}{2}\right) + P\left(Z > \frac{354 - 350}{2}\right)

      .. math::
         = P(Z < -2) + P(Z > 2) = 0.0228 + 0.0228 = 0.0456

      About **4.56%** false alarm rate.

      **Part (c): Detection probability when Œº = 355**

      Now :math:`\bar{X} \stackrel{\text{approx}}{\sim} N(355, 2^2)`.

      .. math::
         P(\text{detection}) = P(\bar{X} < 346 \text{ or } \bar{X} > 354)

      .. math::
         = P\left(Z < \frac{346 - 355}{2}\right) + P\left(Z > \frac{354 - 355}{2}\right)

      .. math::
         = P(Z < -4.5) + P(Z > -0.5)

      .. math::
         \approx 0 + (1 - 0.3085) = 0.6915

      About **69%** detection rate‚Äîthe system will catch the drift about 69% of the time.

      **Part (d): Effect of increasing n to 64**

      New standard error: :math:`\sigma_{\bar{X}} = \frac{12}{\sqrt{64}} = 1.5¬∞C`.

      *False alarm rate (Œº = 350):*

      .. math::
         P(Z < -2.67 \text{ or } Z > 2.67) = 2 \times 0.0038 = 0.0076 \approx 0.76\%

      *Detection rate (Œº = 355):*

      .. math::
         P\left(Z < \frac{346-355}{1.5}\right) + P\left(Z > \frac{354-355}{1.5}\right) = P(Z < -6) + P(Z > -0.67)

      .. math::
         \approx 0 + 0.7486 = 0.749 \approx 75\%

      **Summary**: Increasing :math:`n` from 36 to 64 decreases the false alarm rate (4.56% ‚Üí 0.76%) while increasing the detection rate (69% ‚Üí 75%). Larger samples make the monitoring system both more reliable and more sensitive.

      **R verification:**

      .. code-block:: r

         sigma <- 12

         # With n = 36
         se36 <- sigma / sqrt(36)  # 2
         # Part (b): False alarm rate when Œº = 350
         pnorm(346, mean = 350, sd = se36) + pnorm(354, mean = 350, sd = se36, lower.tail = FALSE)
         # [1] 0.0455

         # Part (c): Detection rate when Œº = 355
         pnorm(346, mean = 355, sd = se36) + pnorm(354, mean = 355, sd = se36, lower.tail = FALSE)
         # [1] 0.6915

         # Part (d): With n = 64
         se64 <- sigma / sqrt(64)  # 1.5
         # False alarm rate
         pnorm(346, mean = 350, sd = se64) + pnorm(354, mean = 350, sd = se64, lower.tail = FALSE)
         # [1] 0.0076
         # Detection rate
         pnorm(346, mean = 355, sd = se64) + pnorm(354, mean = 355, sd = se64, lower.tail = FALSE)
         # [1] 0.7475

----

.. admonition:: Exercise 8: Exploring the CLT with Simulation üéÆ
   :class: note

   Use the interactive CLT simulation to explore how the sampling distribution of :math:`\bar{X}` changes with different populations and sample sizes.

   **Access the simulation**: `CLT Interactive Demo <https://treese41528.github.io/STAT350/ShinyApps/CLT.html>`_

   **Setup**: Set "Number of Samples (SRS)" to 10000 for all explorations (this ensures smooth histograms).

   **Part A: Effect of Sample Size on Convergence**

   1. Select **Exponential** distribution. Set :math:`n = 5`. Click Simulate.
      
      - Describe the shape of the sampling distribution histogram. Is it symmetric or skewed?
      - Compare the experimental mean and SD to the theoretical values.

   2. Increase to :math:`n = 15`, then :math:`n = 30`, then :math:`n = 60`. For each:
      
      - How does the histogram shape change?
      - How does the QQ plot change? (Points closer to the line indicate better normality.)

   3. At what sample size does the sampling distribution appear approximately normal for the exponential population?

   **Part B: Comparing Population Shapes**

   Using :math:`n = 30` for each, compare the sampling distributions for:

   1. **Uniform** ‚Äî symmetric, bounded
   2. **Exponential** ‚Äî right-skewed, unbounded
   3. **Beta** (try different Œ±, Œ≤ values) ‚Äî can be skewed or symmetric
   4. **Bimodal** ‚Äî two peaks

   For which population(s) does :math:`n = 30` seem sufficient for normality? For which might you want a larger sample?

   **Part C: When CLT Fails**

   1. Select **Cauchy (CLT Failure!)** distribution with :math:`n = 30`. Simulate.
      
      - Does the sampling distribution look normal?
      - What happens to the experimental mean and SD across different simulations? (Click Simulate several times.)

   2. Increase to :math:`n = 100`, then :math:`n = 500`. Does the sampling distribution become more normal?

   3. Explain why the CLT fails for the Cauchy distribution.

   .. dropdown:: Solution
      :class-container: sd-border-success

      **Part A: Effect of Sample Size**

      1. *n = 5 (Exponential)*: The histogram is noticeably right-skewed, similar to the population. The QQ plot shows curvature, indicating departure from normality. Experimental mean and SD should be close to theoretical values.

      2. *As n increases*:
         
         - :math:`n = 15`: Still somewhat skewed but less pronounced
         - :math:`n = 30`: Approximately symmetric, QQ plot mostly linear
         - :math:`n = 60`: Very close to normal, QQ plot nearly perfect line

      3. For the exponential distribution, :math:`n \approx 30\text{--}40` typically produces an approximately normal sampling distribution. This aligns with the common rule of thumb.

      **Part B: Comparing Population Shapes**

      With :math:`n = 30`:

      - **Uniform**: Sampling distribution is very close to normal. The uniform distribution is symmetric and bounded, so convergence is rapid. Even :math:`n = 10\text{--}15` often suffices.
      
      - **Exponential**: Approximately normal at :math:`n = 30` for many practical calculations, though slight right skewness may still be visible in the QQ plot.
      
      - **Beta**: Depends on parameters. Symmetric beta (:math:`\alpha = \beta`) converges quickly; highly skewed beta (e.g., :math:`\alpha = 1, \beta = 5`) may benefit from :math:`n > 30\text{--}40`.
      
      - **Bimodal**: Often converges reasonably well by :math:`n = 30` because averaging smooths out the two modes.

      **Key insight**: The more the population deviates from normality (especially skewness and heavy tails), the larger the sample size needed for an accurate approximation.

      **Part C: When CLT Fails (Cauchy)**

      1. *n = 30*: The sampling distribution does NOT look normal. It has heavy tails and extreme outliers. The histogram may look erratic.

      2. *n = 100, 500*: The distribution still does not become normal. You may see extreme sample means far from 0.

      3. *Experimental mean/SD instability*: Each time you simulate, the experimental mean and SD change dramatically‚Äîthey don't stabilize.

      **Why CLT fails for Cauchy**: The Cauchy distribution has **no finite mean or variance** (both are undefined/infinite). The CLT requires finite mean and variance. Without these, the sample mean does not converge to any distribution‚Äîit remains unstable and heavy-tailed regardless of sample size.

      This demonstrates that the CLT conditions are not just technicalities‚Äîthey are essential requirements.

----

.. admonition:: Exercise 9: Conceptual Understanding
   :class: note

   Answer the following conceptual questions about the Central Limit Theorem.

   a. The CLT says the sampling distribution of :math:`\bar{X}` approaches normal as :math:`n \to \infty`. Does this mean that individual observations :math:`X_i` become more normal as we collect more data? Explain.

   b. Two populations have the same mean and variance, but Population A is symmetric while Population B is heavily right-skewed. For which population would you need a larger sample size for the CLT approximation to be accurate? Why?

   c. If a population is already normally distributed, is the CLT still useful? Explain.

   d. A student claims: "The CLT guarantees that :math:`\bar{X}` is normally distributed for any sample size as long as :math:`n \geq 30`." Is this statement accurate? Critique it.

   e. Based on the simulation in Exercise 8, explain why the Cauchy distribution is a counterexample to the CLT.

   .. dropdown:: Solution
      :class-container: sd-border-success

      **Part (a): Do individual observations become more normal?**

      **No.** The CLT describes the behavior of the *sample mean* :math:`\bar{X}`, not individual observations. The population distribution (and hence each :math:`X_i`) remains unchanged regardless of sample size. The "magic" of the CLT is that *averaging* many observations produces a quantity that is approximately normal, even though the individual observations may be far from normal.

      **Part (b): Which population needs larger n?**

      **Population B (heavily right-skewed)** requires a larger sample size. The CLT converges faster for distributions that are closer to normal. Symmetric distributions converge quickly (often :math:`n \geq 15\text{--}20` suffices), while heavily skewed distributions may need :math:`n \geq 50` or more. The greater the departure from normality, the larger the :math:`n` needed.

      **Part (c): Is the CLT useful for normal populations?**

      When the population is normal, we have the **exact result** from Section 7.2: :math:`\bar{X} \sim N(\mu, \sigma^2/n)` for any sample size. The CLT is not needed in this case because we already know the exact distribution.

      However, the CLT provides reassurance that our inference methods remain valid even if our normality assumption is slightly wrong‚Äîthe procedures are robust to mild departures from normality.

      **Part (d): Critique of the "n ‚â• 30" claim**

      This statement is **not accurate**. Issues include:

      1. **"Guarantees"** is too strong‚Äîthe CLT provides an *approximation*, not an exact result. The quality of the approximation depends on the population shape.

      2. **"n ‚â• 30"** is an oversimplified rule of thumb, not a universal threshold. Symmetric, bounded populations may need much less (even :math:`n = 10\text{--}15`); heavily skewed or heavy-tailed populations may need :math:`n \geq 50` or more.

      3. The CLT describes what happens as :math:`n \to \infty`. For finite :math:`n`, we only have an approximation, and we should assess whether that approximation is adequate for our purposes.

      A more accurate statement: "The required sample size for an adequate CLT approximation depends on the population's departure from normality. Symmetric populations converge quickly; skewed or heavy-tailed populations require larger samples."

      **Part (e): Cauchy as CLT counterexample**

      The Cauchy distribution has **undefined (infinite) mean and variance**. In Exercise 8's simulation, we observed that:

      - The sampling distribution of :math:`\bar{X}` does not become more normal as :math:`n` increases
      - The experimental mean and SD are unstable across simulations
      - Extreme outliers persist even with large samples

      This occurs because the CLT requires finite mean and variance. The Cauchy distribution violates both conditions, so the theorem simply does not apply. This is not a matter of needing a "larger n"‚Äîthe CLT will never work for Cauchy regardless of sample size.

----

Additional Practice Problems
----------------------------

**True/False Questions** (1 point each)

1. The Central Limit Theorem requires the population to be normally distributed.

   ‚ìâ or ‚íª

2. As sample size increases, the sampling distribution of :math:`\bar{X}` becomes more concentrated around :math:`\mu`.

   ‚ìâ or ‚íª

3. The CLT can be applied when the population has infinite variance.

   ‚ìâ or ‚íª

4. For a symmetric population, a smaller sample size is typically needed for the CLT approximation to be accurate compared to a skewed population.

   ‚ìâ or ‚íª

5. The CLT tells us that individual observations become approximately normal when the sample size is large.

   ‚ìâ or ‚íª

6. If observations are not independent, the CLT does not apply.

   ‚ìâ or ‚íª

**Multiple Choice Questions** (2 points each)

7. The CLT states that as :math:`n \to \infty`, which quantity approaches a standard normal distribution?

   ‚í∂ :math:`\bar{X}`
   
   ‚í∑ :math:`\frac{\bar{X} - \mu}{\sigma}`
   
   ‚í∏ :math:`\frac{\bar{X} - \mu}{\sigma/\sqrt{n}}`
   
   ‚íπ :math:`\frac{X_i - \mu}{\sigma}`

8. A population has :math:`\mu = 80` and :math:`\sigma = 15`. For :math:`n = 25`, the CLT approximation gives :math:`\bar{X} \stackrel{\text{approx}}{\sim}`:

   ‚í∂ :math:`N(80, 15^2)`
   
   ‚í∑ :math:`N(80, 3^2)`
   
   ‚í∏ :math:`N(80, 0.6^2)`
   
   ‚íπ :math:`N(3.2, 80)`

9. Which condition is NOT required for the CLT to apply?

   ‚í∂ Population has finite mean
   
   ‚í∑ Population has finite variance
   
   ‚í∏ Population is normally distributed
   
   ‚íπ Observations are independent

10. For a heavily right-skewed population, which sample size is most likely to give an accurate CLT approximation?

    ‚í∂ :math:`n = 10`
    
    ‚í∑ :math:`n = 25`
    
    ‚í∏ :math:`n = 50`
    
    ‚íπ :math:`n = 100`

11. If :math:`X \sim \text{Uniform}(0, 12)`, then :math:`\sigma =`:

    ‚í∂ 6
    
    ‚í∑ :math:`12/\sqrt{12} \approx 3.46`
    
    ‚í∏ 12
    
    ‚íπ 4

12. Using the CLT with :math:`\mu = 50`, :math:`\sigma = 10`, and :math:`n = 100`, find :math:`P(\bar{X} > 52)`:

    ‚í∂ :math:`P(Z > 0.2)`
    
    ‚í∑ :math:`P(Z > 2)`
    
    ‚í∏ :math:`P(Z > 20)`
    
    ‚íπ :math:`P(Z > 0.02)`

.. dropdown:: Answers to Practice Problems
   :class-container: sd-border-success

   **True/False Answers:**

   1. **False** ‚Äî The CLT applies to any population with finite mean and variance, regardless of its distribution shape.

   2. **True** ‚Äî The standard error :math:`\sigma/\sqrt{n}` decreases as :math:`n` increases, concentrating the distribution around :math:`\mu`.

   3. **False** ‚Äî The CLT requires **finite variance**. For populations with infinite variance (like Cauchy), the CLT does not apply.

   4. **True** ‚Äî Symmetric distributions are "closer" to normal, so the CLT approximation converges faster.

   5. **False** ‚Äî The CLT applies to the **sample mean** :math:`\bar{X}`, not to individual observations. Individual observations retain their original (non-normal) distribution.

   6. **True** ‚Äî Independence is a key requirement. Without it, the variance formula :math:`\sigma^2/n` and the CLT both fail.

   **Multiple Choice Answers:**

   7. **‚í∏** ‚Äî The CLT states that the **standardized sample mean** :math:`\frac{\bar{X} - \mu}{\sigma/\sqrt{n}} \xrightarrow{d} N(0,1)`.

   8. **‚í∑** ‚Äî :math:`\sigma_{\bar{X}} = 15/\sqrt{25} = 3`, so :math:`\bar{X} \stackrel{\text{approx}}{\sim} N(80, 3^2)`. Remember: :math:`N(\mu, \sigma^2)` uses variance as the second parameter.

   9. **‚í∏** ‚Äî Normality of the population is NOT required. The CLT works for any population shape (given finite mean and variance).

   10. **‚íπ** ‚Äî Heavily skewed populations require larger samples. :math:`n = 100` is most likely to give an accurate approximation.

   11. **‚í∑** ‚Äî For Uniform(a, b): :math:`\sigma = \frac{b-a}{\sqrt{12}} = \frac{12}{\sqrt{12}} = \sqrt{12} \approx 3.46`.

   12. **‚í∑** ‚Äî :math:`z = \frac{52 - 50}{10/\sqrt{100}} = \frac{2}{1} = 2`, so the answer is :math:`P(Z > 2)`.