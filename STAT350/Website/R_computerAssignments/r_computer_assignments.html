

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>R / RStudio Guide and Function Reference &mdash; STAT 350</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=581abb6a" />

  
    <link rel="canonical" href="https://treese41528.github.io/STAT350/course_site/R_computerAssignments/r_computer_assignments.html" />
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/custom.js?v=de5959cf"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="1. Introduction to Statistics" href="../chapter1/index.html" />
    <link rel="prev" title="&lt;no title&gt;" href="../worksheets/worksheet_materials/worksheet22.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            STAT 350: Introduction to Statistics
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Orientation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../course-intro.html">Course Introduction &amp; Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../course-intro.html#why-statistics-why-now">Why Statistics? Why Now?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../course-intro.html#course-roadmap">Course Roadmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../course-intro.html#a-clear-note-on-using-ai">A Clear Note on Using AI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../course-intro.html#getting-started-a-checklist">Getting Started: A Checklist</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../course-intro.html#homework-assignments-on-edfinity">Homework Assignments on Edfinity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../course-intro.html#miscellaneous-tips">Miscellaneous Tips</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Exam Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../exams/exams_index.html">Course Examinations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../exams/exams_index.html#general-exam-policies">General Exam Policies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../exams/exam_materials/exam1.html">Exam 1</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../exams/exam_materials/exam1.html#exam-locations-by-section">Exam Locations by Section</a></li>
<li class="toctree-l4"><a class="reference internal" href="../exams/exam_materials/exam1.html#exam-coverage">Exam Coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../exams/exam_materials/exam1.html#preparation-materials">Preparation Materials</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../exams/exam_materials/exam2.html">Exam 2</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../exams/exam_materials/exam2.html#exam-locations-by-section">Exam Locations by Section</a></li>
<li class="toctree-l4"><a class="reference internal" href="../exams/exam_materials/exam2.html#exam-coverage">Exam Coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../exams/exam_materials/exam2.html#additional-resources">Additional Resources</a></li>
<li class="toctree-l4"><a class="reference internal" href="../exams/exam_materials/exam2.html#preparation-materials">Preparation Materials</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../exams/exam_materials/final_exam.html">Final Exam</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../exams/exam_materials/final_exam.html#about-the-final-exam">About the Final Exam</a></li>
<li class="toctree-l4"><a class="reference internal" href="../exams/exam_materials/final_exam.html#required-review-materials">Required Review Materials</a></li>
<li class="toctree-l4"><a class="reference internal" href="../exams/exam_materials/final_exam.html#post-exam-2-preparation-materials">Post Exam 2 Preparation Materials</a></li>
<li class="toctree-l4"><a class="reference internal" href="../exams/exam_materials/final_exam.html#study-guide-resource">Study Guide Resource</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Worksheets</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../worksheets/worksheets_index.html">Course Worksheets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../worksheets/worksheets_index.html#pedagogical-philosophy">Pedagogical Philosophy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../worksheets/worksheets_index.html#implementation-guidelines">Implementation Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../worksheets/worksheets_index.html#why-these-worksheets-matter">Why These Worksheets Matter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../worksheets/worksheets_index.html#the-critical-role-of-simulation">The Critical Role of Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../worksheets/worksheets_index.html#worksheets">Worksheets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet1.html">Worksheet 1: Exploring Data with R</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet1.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet1.html#part-1-loading-and-understanding-the-dataset">Part 1: Loading and Understanding the Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet1.html#part-2-initial-data-exploration">Part 2: Initial Data Exploration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet1.html#part-3-frequency-tables">Part 3: Frequency Tables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet1.html#part-4-univariate-analysis-of-uptake">Part 4: Univariate Analysis of Uptake</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet1.html#part-5-grouped-statistics-with-tapply">Part 5: Grouped Statistics with tapply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet1.html#part-6-comparative-visualization-by-type">Part 6: Comparative Visualization by Type</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet1.html#part-7-exploring-the-concentration-effect">Part 7: Exploring the Concentration Effect</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet1.html#part-8-advanced-visualization-with-multiple-categories">Part 8: Advanced Visualization with Multiple Categories</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet1.html#reference-key-functions">Reference: Key Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet1.html#submission-guidelines">Submission Guidelines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet2.html">Worksheet 2: Set Theory and Probability Fundamentals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet2.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet2.html#part-1-set-theory-foundations">Part 1: Set Theory Foundations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet2.html#part-2-probability-axioms">Part 2: Probability Axioms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet2.html#part-3-applying-probability-rules">Part 3: Applying Probability Rules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet2.html#part-4-the-inclusion-exclusion-principle">Part 4: The Inclusion-Exclusion Principle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet2.html#simulation-exercise">Simulation Exercise</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet2.html#key-takeaways">Key Takeaways</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet2.html#submission-guidelines">Submission Guidelines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet3.html">Worksheet 3: Conditional Probability and Bayes’ Theorem</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet3.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet3.html#part-1-understanding-conditional-probability">Part 1: Understanding Conditional Probability</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet3.html#part-2-tree-diagrams-and-sequential-sampling">Part 2: Tree Diagrams and Sequential Sampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet3.html#part-3-bayes-theorem-and-sequential-updating">Part 3: Bayes’ Theorem and Sequential Updating</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet3.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet4.html">Worksheet 4: Independence and Random Variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet4.html#part-1-independence-property">Part 1: Independence Property</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet4.html#part-2-independent-vs-mutually-exclusive-events">Part 2: Independent vs. Mutually Exclusive Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet4.html#part-3-introduction-to-random-variables">Part 3: Introduction to Random Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet4.html#part-4-probability-mass-functions">Part 4: Probability Mass Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet4.html#part-5-joint-probability-mass-functions">Part 5: Joint Probability Mass Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet4.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet5.html">Worksheet 5: Expected Value and Variance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet5.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet5.html#part-1-expected-value-and-lotus">Part 1: Expected Value and LOTUS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet5.html#part-2-variance-and-its-properties">Part 2: Variance and Its Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet5.html#part-3-sums-of-random-variables">Part 3: Sums of Random Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet5.html#part-4-joint-probability-mass-functions">Part 4: Joint Probability Mass Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet5.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet6.html">Worksheet 6: Named Discrete Distributions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet6.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet6.html#part-1-the-bernoulli-distribution">Part 1: The Bernoulli Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet6.html#part-2-the-binomial-distribution">Part 2: The Binomial Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet6.html#part-3-the-poisson-distribution">Part 3: The Poisson Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet6.html#part-4-other-named-discrete-distributions">Part 4: Other Named Discrete Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet6.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet7.html">Worksheet 7: Continuous Random Variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet7.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet7.html#part-1-probability-density-functions">Part 1: Probability Density Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet7.html#part-2-finding-constants-for-valid-pdfs">Part 2: Finding Constants for Valid PDFs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet7.html#part-3-expected-value-and-variance">Part 3: Expected Value and Variance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet7.html#part-4-cumulative-distribution-functions">Part 4: Cumulative Distribution Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet7.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet8.html">Worksheet 8: Uniform and Exponential Distributions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet8.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet8.html#part-1-the-uniform-distribution">Part 1: The Uniform Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet8.html#part-2-the-exponential-distribution">Part 2: The Exponential Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet8.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet9.html">Worksheet 9: The Normal Distribution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet9.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet9.html#part-1-the-normal-distribution">Part 1: The Normal Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet9.html#part-2-the-empirical-rule">Part 2: The Empirical Rule</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet9.html#part-3-the-standard-normal-table">Part 3: The Standard Normal Table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet9.html#part-4-z-score-transformation">Part 4: Z-Score Transformation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet9.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet10.html">Worksheet 10: Checking Normality and Introduction to Sampling Distributions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet10.html#part-1-checking-normality">Part 1: Checking Normality</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet10.html#part-2-introduction-to-sampling-distributions">Part 2: Introduction to Sampling Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../worksheets/worksheet_materials/worksheet10.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Computer Assignments</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">R / RStudio Guide and Function Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#quick-reference-table">Quick Reference Table</a></li>
<li class="toctree-l2"><a class="reference internal" href="#quick-start-r-rstudio-setup">Quick Start: R / RStudio Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#recommended-workflow">Recommended workflow</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#course-pipeline-at-a-glance">Course Pipeline (At a Glance)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#packages-libraries-course-set">Packages / Libraries (Course Set)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rstudio-orientation">RStudio Orientation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#getting-started-with-swirl">Getting Started with swirl</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#setup-and-use-swirl">Setup and Use swirl</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#alternative-r-learning-resources">Alternative R Learning Resources</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#base-r">Base R</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tidyverse">tidyverse</a></li>
<li class="toctree-l3"><a class="reference internal" href="#r-markdown">R Markdown</a></li>
<li class="toctree-l3"><a class="reference internal" href="#statistical-computing">Statistical Computing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#video-resources">Video Resources</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#assignment-tutorials-links">Assignment Tutorials (Links)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#function-reference-alphabetized-within-category">Function Reference (Alphabetized within Category)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#data-i-o-housekeeping">Data I/O &amp; Housekeeping</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-structures-creation">Data Structures &amp; Creation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-wrangling-utilities">Data Wrangling &amp; Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="#descriptive-statistics-correlation">Descriptive Statistics &amp; Correlation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#probability-distributions">Probability &amp; Distributions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#simulation-functions">Simulation Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inference-functions">Inference Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#graphics-ggplot2">Graphics (ggplot2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#core-components">Core Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="#geoms-geometric-objects">Geoms (Geometric Objects)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plot-customization">Plot Customization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tables-reporting">Tables &amp; Reporting</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#best-practices-common-pitfalls">Best Practices &amp; Common Pitfalls</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#appendix-quick-links">Appendix: Quick Links</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#setup">Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#assignments">Assignments</a></li>
<li class="toctree-l3"><a class="reference internal" href="#getting-help">Getting Help</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Chapters</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../chapter1/index.html">1. Introduction to Statistics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter1/lectures/1-1-intro.html">1.1. What Is Statistics?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter1/lectures/1-2-probability-inference.html">1.2. Probability &amp; Statistical Inference: How Are They Associated?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../chapter2/index.html">2. Graphical Summaries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter2/lectures/2-1-understanding-the-structure-of-data-set.html">2.1. Data Set Structure and Variable Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter2/lectures/2-2-tools-for-categorical-qualitative-data.html">2.2. Tools for Categorical (Qualitative) Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter2/lectures/2-3-tools-for-numerical-quantitative-data.html">2.3. Tools for Numerical (Quantitative) Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter2/lectures/2-4-exploring-quantitative-distributions-modality-shape-and-outliers.html">2.4. Exploring Quantitative Distributions: Modality, Skewness &amp; Outliers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../chapter3/index.html">3. Numerical Summaries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter3/lectures/3-1-intro-numerical-summaries.html">3.1. Introduction to Numerical Summaries: Notation and Terminology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter3/lectures/3-2-measures-of-central-tendency.html">3.2. Measures of Central Tendency</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter3/lectures/3-3-measures-of-variability-range-variance-and-SD.html">3.3. Measures of Variability - Range, Variance, and Standard Deviation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter3/lectures/3-4-measures-of-variability-IQR-and-5-number-summary.html">3.4. Measures of Variability - Interquartile Range and Five-Number Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter3/lectures/3-5-choosing-the-right-measure-resistance-to-extreme-values.html">3.5. Choosing the Right Measure &amp; Comparing Measures Across Data Sets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../chapter4/index.html">4. Probability</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter4/lectures/4-1-basic-set-theory.html">4.1. Basic Set Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter4/lectures/4-2-probability.html">4.2. Probability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter4/lectures/4-3-conditional-probability.html">4.3. Conditional Probability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter4/lectures/4-4-law-of-total-probability-and-bayes-rule.html">4.4. Law of Total Probability and Bayes’ Rule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter4/lectures/4-5-bayes-update-rule-example.html">4.5. Bayesian Updating: Sequential Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter4/lectures/4-6-independence-of-events.html">4.6. Independence of Events</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../chapter5/index.html">5. Discrete Distributions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter5/lectures/5-1-discrete-rvs-and-pmfs.html">5.1. Discrete Random Variables and Probability Mass Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter5/lectures/5-2-joint-pmfs.html">5.2. Joint Probability Mass Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter5/lectures/5-3-expected-value-of-discrete-rv.html">5.3. Expected Value of a Discrete Random Variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter5/lectures/5-4-variance-of-discrete-rv.html">5.4. Varianace of a Discrete Random Variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter5/lectures/5-5-covariance-of-dependent-rvs.html">5.5. Covariance of Dependent Random Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter5/lectures/5-6-binomial-distribution.html">5.6. The Binomial Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter5/lectures/5-7-poisson-distribution.html">5.7. Poisson Distribution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../chapter6/index.html">6. Continuous Distributions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter6/lectures/6-1-continuous-rvs-and-pdfs.html">6.1. Continuous Random Variables and Probability Density Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter6/lectures/6-2-expected-value-and-variance-of-cts-rvs.html">6.2. Expected Value and Variance of Continuous Random Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter6/lectures/6-3-cdfs.html">6.3. Cumulative Distribution Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter6/lectures/6-4-normal-distribution.html">6.4. Normal Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter6/lectures/6-5-uniform-distribution.html">6.5. Uniform Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter6/lectures/6-6-exponential-distribution.html">6.6. Exponential Distribution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../chapter7/index.html">7. Sampling Distributions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter7/lectures/7-1-statistics-and-sampling-distributions.html">7.1. Statistics and Sampling Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter7/lectures/7-2-sampling-distribution-for-the-sample-mean.html">7.2. Sampling Distribution for the Sample Mean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter7/lectures/7-3-clt.html">7.3. The Central Limit Theorem (CLT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter7/lectures/7-4-discret-rvs-and-clt.html">7.4. Understanding Binomial and Poisson Distributions through CLT</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../chapter8/index.html">8. Experimental Design</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter8/lectures/8-1-experimental-and-sampling-designs.html">8.1. Experimental and Sampling Designs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter8/lectures/8-2-experimental-design-principles.html">8.2. Experimental Design Principles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter8/lectures/8-3-basic-types-of-experimental-design.html">8.3. Basic Types of Experimental Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter8/lectures/8-4-addressing-potential-flaws-in-experimental-design.html">8.4. Addressing Potential Flaws in Experimental Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter8/lectures/8-5-examples-of-experimental-design.html">8.5. Examples of Experimental Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter8/lectures/8-6-sampling-design.html">8.6. Sampling Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter8/lectures/8-7-sampling-bias.html">8.7. Sampling Bias</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../chapter9/index.html">9. Confidence Intervals and Bounds</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter9/lectures/9-1-intro-statistical-inference.html">9.1. Introduction to Statistical Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter9/lectures/9-2-ci-sigma-known.html">9.2. Confidence Intervals for the Population Mean, When σ is Known</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter9/lectures/9-3-precision-of-ci-and-sample-size-calculation.html">9.3. Precision of a Confidence Interval and Sample Size Calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter9/lectures/9-4-cb-sigma-known.html">9.4. Confidence Bounds for the Poulation Mean When σ is Known</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter9/lectures/9-5-ci-cb-sigma-unknown.html">9.5. Confidence Intervals and Bounds When σ is Unknown</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../chapter10/index.html">10. Hypothesis Testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter10/lectures/10-1-ht-errors-and-power.html">10.1. Type I Error, Type II Error, and Power</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter10/lectures/10-2-ht-for-mean-sigma-known.html">10.2. Hypothesis Test for the Population Mean When σ is Known</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter10/lectures/10-3-ht-for-mean-sigma-unknown.html">10.3. Hypothesis Test for the Population Mean When σ Is Unknown</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter10/lectures/10-4-pvalue-significance-conclusion.html">10.4. P-values, Statistical Significance, and Formal Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../chapter11/index.html">11. Two Sample Procedures</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter11/lectures/11-1-ci-ht-two-samples.html">11.1. Confidence Interval/Bound and Hypothesis Test for Two Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter11/lectures/11-2-comparing-two-means-independent-sigmas-known.html">11.2. Comparing the Means of Two Independent Populations - Population Variances Are Known</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter11/lectures/11-3-comparing-two-means-independent-pooled.html">11.3. Comparing the Means of Two Independent Populations - Pooled Variance Estimator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter11/lectures/11-4-comparing-two-means-independent-unpooled.html">11.4. Comparing the Means of Two Independent Populations - No Equal Variance Assumption</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter11/lectures/11-5-mean-of-paired-differences-two-dependent-populations.html">11.5. Analyzing the Mean of Paired Differences Between two Dependent Populations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../chapter12/index.html">12. ANOVA</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter12/lectures/12-1-intro-one-way-anova.html">12.1. Introduction to One-Way ANOVA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter12/lectures/12-2-sources-of-variability.html">12.2. Different Sources of Variability in an ANOVA Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter12/lectures/12-3-f-test-and-relationship-to-t-test.html">12.3. One-Way ANOVA F-Test and Its Relationship to Two-Sample t-Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter12/lectures/12-4-multiple-comparison-procedures-family-wise-error-rates.html">12.4. Multiple Comparison Procedures and Family-Wise Error Rates</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../chapter13/index.html">13. Simple Linear Regression</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../chapter13/lectures/13-1-intro-to-lr-correlation-scatter-plots.html">13.1. Introduction to Linear Regression: Correlation and Scatter Plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter13/lectures/13-2-simple-linear-regression.html">13.2. Simple Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter13/lectures/13-3-diagnostics-inference.html">13.3. Model Diagnostics and Statistical Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chapter13/lectures/13-4-prediction-robustness.html">13.4. Prediction, Robustness, and Applied Examples</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">STAT 350: Introduction to Statistics</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">R / RStudio Guide and Function Reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/R_computerAssignments/r_computer_assignments.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="r-rstudio-guide-and-function-reference">
<span id="r-computer-assignments"></span><h1>R / RStudio Guide and Function Reference<a class="headerlink" href="#r-rstudio-guide-and-function-reference" title="Link to this heading"></a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#overview" id="id10">Overview</a></p></li>
<li><p><a class="reference internal" href="#quick-reference-table" id="id11">Quick Reference Table</a></p></li>
<li><p><a class="reference internal" href="#quick-start-r-rstudio-setup" id="id12">Quick Start: R / RStudio Setup</a></p>
<ul>
<li><p><a class="reference internal" href="#recommended-workflow" id="id13">Recommended workflow</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#course-pipeline-at-a-glance" id="id14">Course Pipeline (At a Glance)</a></p></li>
<li><p><a class="reference internal" href="#packages-libraries-course-set" id="id15">Packages / Libraries (Course Set)</a></p></li>
<li><p><a class="reference internal" href="#rstudio-orientation" id="id16">RStudio Orientation</a></p></li>
<li><p><a class="reference internal" href="#getting-started-with-swirl" id="id17">Getting Started with swirl</a></p>
<ul>
<li><p><a class="reference internal" href="#setup-and-use-swirl" id="id18">Setup and Use swirl</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#alternative-r-learning-resources" id="id19">Alternative R Learning Resources</a></p>
<ul>
<li><p><a class="reference internal" href="#base-r" id="id20">Base R</a></p></li>
<li><p><a class="reference internal" href="#tidyverse" id="id21">tidyverse</a></p></li>
<li><p><a class="reference internal" href="#r-markdown" id="id22">R Markdown</a></p></li>
<li><p><a class="reference internal" href="#statistical-computing" id="id23">Statistical Computing</a></p></li>
<li><p><a class="reference internal" href="#video-resources" id="id24">Video Resources</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#assignment-tutorials-links" id="id25">Assignment Tutorials (Links)</a></p></li>
<li><p><a class="reference internal" href="#function-reference-alphabetized-within-category" id="id26">Function Reference (Alphabetized within Category)</a></p>
<ul>
<li><p><a class="reference internal" href="#data-i-o-housekeeping" id="id27">Data I/O &amp; Housekeeping</a></p></li>
<li><p><a class="reference internal" href="#data-structures-creation" id="id28">Data Structures &amp; Creation</a></p></li>
<li><p><a class="reference internal" href="#data-wrangling-utilities" id="id29">Data Wrangling &amp; Utilities</a></p></li>
<li><p><a class="reference internal" href="#descriptive-statistics-correlation" id="id30">Descriptive Statistics &amp; Correlation</a></p></li>
<li><p><a class="reference internal" href="#probability-distributions" id="id31">Probability &amp; Distributions</a></p></li>
<li><p><a class="reference internal" href="#simulation-functions" id="id32">Simulation Functions</a></p></li>
<li><p><a class="reference internal" href="#inference-functions" id="id33">Inference Functions</a></p></li>
<li><p><a class="reference internal" href="#graphics-ggplot2" id="id34">Graphics (ggplot2)</a></p></li>
<li><p><a class="reference internal" href="#core-components" id="id35">Core Components</a></p></li>
<li><p><a class="reference internal" href="#geoms-geometric-objects" id="id36">Geoms (Geometric Objects)</a></p></li>
<li><p><a class="reference internal" href="#plot-customization" id="id37">Plot Customization</a></p></li>
<li><p><a class="reference internal" href="#tables-reporting" id="id38">Tables &amp; Reporting</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="overview">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Overview</a><a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>This document is a comprehensive reference for the <strong>primary R tools</strong> used in STAT 350. It introduces R and RStudio, outlines the workflow we use in class, and provides an <strong>enhanced reference</strong> to the functions, libraries, and plotting layers that appear across the computer assignments and worksheets. The emphasis is on: loading data; validating and cleaning; visualizing; computing summaries; fitting models; <strong>checking assumptions</strong>; and performing inference with well-annotated code.</p>
<p>Use this as a companion to the assignment tutorials (linked below).</p>
</section>
<section id="quick-reference-table">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Quick Reference Table</a><a class="headerlink" href="#quick-reference-table" title="Link to this heading"></a></h2>
<table class="docutils align-left" id="id9">
<caption><span class="caption-number">Table 10 </span><span class="caption-text">Common Tasks Quick Reference</span><a class="headerlink" href="#id9" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 25.0%" />
<col style="width: 25.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Task</p></th>
<th class="head"><p>Function(s)</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Import CSV</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">read.csv()</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">d</span> <span class="pre">&lt;-</span> <span class="pre">read.csv('data/AppRating.csv')</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Check structure</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str()</span></code>, <code class="docutils literal notranslate"><span class="pre">head()</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str(d);</span> <span class="pre">head(d,</span> <span class="pre">10)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Remove NAs</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">complete.cases()</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">d_clean</span> <span class="pre">&lt;-</span> <span class="pre">d[complete.cases(d),</span> <span class="pre">]</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Basic summary</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">summary()</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">summary(d$score)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Create histogram</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ggplot()</span> <span class="pre">+</span> <span class="pre">geom_histogram()</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ggplot(d,</span> <span class="pre">aes(x=score))</span> <span class="pre">+</span> <span class="pre">geom_histogram()</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>One-sample t-test</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">t.test()</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">t.test(d$score,</span> <span class="pre">mu</span> <span class="pre">=</span> <span class="pre">3)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Two-sample t-test</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">t.test()</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">t.test(score</span> <span class="pre">~</span> <span class="pre">platform,</span> <span class="pre">data</span> <span class="pre">=</span> <span class="pre">d)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>One-way ANOVA</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">aov()</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">fit</span> <span class="pre">&lt;-</span> <span class="pre">aov(score</span> <span class="pre">~</span> <span class="pre">group,</span> <span class="pre">data</span> <span class="pre">=</span> <span class="pre">d)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Linear regression</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">lm()</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">mod</span> <span class="pre">&lt;-</span> <span class="pre">lm(rating</span> <span class="pre">~</span> <span class="pre">price,</span> <span class="pre">data</span> <span class="pre">=</span> <span class="pre">d)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Check residuals</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">plot()</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">plot(mod,</span> <span class="pre">which</span> <span class="pre">=</span> <span class="pre">1:2)</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="quick-start-r-rstudio-setup">
<h2><a class="toc-backref" href="#id12" role="doc-backlink">Quick Start: R / RStudio Setup</a><a class="headerlink" href="#quick-start-r-rstudio-setup" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Local Install (R/RStudio): <a class="reference external" href="https://treese41528.github.io/STAT350/Computer_Assignment_Tutorials/Local_Install.html">Local Install</a></p></li>
<li><p>Scholar Access (cluster): <a class="reference external" href="https://treese41528.github.io/STAT350/Computer_Assignment_Tutorials/Scholar-Access.html">Scholar Access</a></p></li>
</ul>
<section id="recommended-workflow">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">Recommended workflow</a><a class="headerlink" href="#recommended-workflow" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p><strong>Create an RStudio Project</strong> for the course.</p></li>
<li><p>Keep a top-level folder for data (e.g., <code class="docutils literal notranslate"><span class="pre">data/</span></code>). Store the course CSV (e.g., <code class="docutils literal notranslate"><span class="pre">AppRatingFall2025.csv</span></code>) there.</p></li>
<li><p>Write analyses in <strong>scripts</strong> (<code class="docutils literal notranslate"><span class="pre">.R</span></code>) or <strong>R Markdown</strong> (if you want knit-able reports).</p></li>
<li><p>Use <strong>relative paths</strong> (avoid changing working directory mid-script).</p></li>
<li><p>Save figures/tables explicitly if you will reuse them in the report or Brightspace.</p></li>
</ol>
</section>
</section>
<section id="course-pipeline-at-a-glance">
<h2><a class="toc-backref" href="#id14" role="doc-backlink">Course Pipeline (At a Glance)</a><a class="headerlink" href="#course-pipeline-at-a-glance" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p><strong>Import</strong>: <code class="docutils literal notranslate"><span class="pre">read.csv</span></code> → <strong>inspect</strong> with <code class="docutils literal notranslate"><span class="pre">head</span></code>, <code class="docutils literal notranslate"><span class="pre">str</span></code>, <code class="docutils literal notranslate"><span class="pre">summary</span></code>.</p></li>
<li><p><strong>Validate &amp; clean</strong>: missing data (<code class="docutils literal notranslate"><span class="pre">is.na</span></code>, <code class="docutils literal notranslate"><span class="pre">complete.cases</span></code>), types (<code class="docutils literal notranslate"><span class="pre">as.numeric</span></code>, <code class="docutils literal notranslate"><span class="pre">factor</span></code>), quick checks (<code class="docutils literal notranslate"><span class="pre">length</span></code>, <code class="docutils literal notranslate"><span class="pre">nrow</span></code>, <code class="docutils literal notranslate"><span class="pre">unique</span></code>).</p></li>
<li><p><strong>Explore</strong>: core summaries (<code class="docutils literal notranslate"><span class="pre">mean</span></code>, <code class="docutils literal notranslate"><span class="pre">median</span></code>, <code class="docutils literal notranslate"><span class="pre">sd</span></code>, <code class="docutils literal notranslate"><span class="pre">quantile</span></code>, <code class="docutils literal notranslate"><span class="pre">IQR</span></code>), plots (<code class="docutils literal notranslate"><span class="pre">ggplot2</span></code> histograms/boxplots).</p></li>
<li><p><strong>Model</strong>: one/two-sample t; ANOVA; SLR via <code class="docutils literal notranslate"><span class="pre">lm</span></code>; compute p-values/intervals; <strong>diagnostics</strong> (residual plots, QQ).</p></li>
<li><p><strong>Report</strong>: figures/tables (<code class="docutils literal notranslate"><span class="pre">ggplot2</span></code>, <code class="docutils literal notranslate"><span class="pre">knitr::kable</span></code> + <code class="docutils literal notranslate"><span class="pre">kableExtra</span></code>), short text with context.</p></li>
</ol>
</section>
<section id="packages-libraries-course-set">
<h2><a class="toc-backref" href="#id15" role="doc-backlink">Packages / Libraries (Course Set)</a><a class="headerlink" href="#packages-libraries-course-set" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>ggplot2</strong> — Grammar of Graphics. Histograms, boxplots, QQ, scatter + fit lines, ribbons for intervals.</p></li>
<li><p><strong>grid</strong>, <strong>gridExtra</strong> — Plot/table layout (e.g., arrange multiple graphics on a page).</p></li>
<li><p><strong>kableExtra</strong> — Styling for <code class="docutils literal notranslate"><span class="pre">knitr::kable</span></code> tables (borders, alignment).</p></li>
<li><p><strong>knitr</strong> — Report tooling; <code class="docutils literal notranslate"><span class="pre">kable</span></code> produces clean tables.</p></li>
<li><p><strong>latex2exp</strong> — <code class="docutils literal notranslate"><span class="pre">TeX()</span></code> for LaTeX-style math in plot labels.</p></li>
<li><p><strong>magrittr</strong> — Pipe operator <code class="docutils literal notranslate"><span class="pre">%&gt;%</span></code> to chain steps.</p></li>
<li><p><strong>stats</strong> — Inference &amp; models: <code class="docutils literal notranslate"><span class="pre">aov</span></code>, <code class="docutils literal notranslate"><span class="pre">anova</span></code>, <code class="docutils literal notranslate"><span class="pre">lm</span></code>, <code class="docutils literal notranslate"><span class="pre">t.test</span></code>, <code class="docutils literal notranslate"><span class="pre">TukeyHSD</span></code>, distributions (<code class="docutils literal notranslate"><span class="pre">dnorm</span></code>, <code class="docutils literal notranslate"><span class="pre">qnorm</span></code>, <code class="docutils literal notranslate"><span class="pre">pt</span></code>, <code class="docutils literal notranslate"><span class="pre">qt</span></code>), etc.</p></li>
<li><p><strong>utils</strong> — I/O like <code class="docutils literal notranslate"><span class="pre">read.csv</span></code>, <code class="docutils literal notranslate"><span class="pre">write.csv</span></code>.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Install from CRAN if needed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">install</span><span class="o">.</span><span class="n">packages</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="s2">&quot;ggplot2&quot;</span><span class="p">,</span><span class="s2">&quot;knitr&quot;</span><span class="p">,</span><span class="s2">&quot;kableExtra&quot;</span><span class="p">,</span><span class="s2">&quot;latex2exp&quot;</span><span class="p">,</span><span class="s2">&quot;gridExtra&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</section>
<section id="rstudio-orientation">
<h2><a class="toc-backref" href="#id16" role="doc-backlink">RStudio Orientation</a><a class="headerlink" href="#rstudio-orientation" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>Console</strong> (executes statements), <strong>Source/Editor</strong> (scripts, Rmd), <strong>Environment</strong> (objects), <strong>Plots/Help</strong> (graphics, docs).</p></li>
<li><p>Use <strong>Projects</strong> to lock working directory. Prefer relative paths and <strong>never</strong> hardcode machine-specific directories mid-script.</p></li>
<li><p>Keep code modular. Consider separate chunks for import, cleaning, EDA, modeling, diagnostics, and reporting.</p></li>
</ul>
</section>
<section id="getting-started-with-swirl">
<h2><a class="toc-backref" href="#id17" role="doc-backlink">Getting Started with swirl</a><a class="headerlink" href="#getting-started-with-swirl" title="Link to this heading"></a></h2>
<p>If you have never coded before, the computer assignments may immediately feel overwhelming. However, R is a language that is as rewarding as it is approachable, especially for statistical work. If you’re new to coding, you’ll find R’s logical syntax is perfect for beginners.</p>
<p>Our tutorials are tailored to gradually build your understanding, making R less daunting. The tutorials are focused on the tools needed for the Computer Assignments. However, you may feel you need to get a little more comfortable in R before you attempt the tutorials and the Computer Assignments. An R package called <strong>swirl</strong> may be just what you need to get started.</p>
<section id="setup-and-use-swirl">
<h3><a class="toc-backref" href="#id18" role="doc-backlink">Setup and Use swirl</a><a class="headerlink" href="#setup-and-use-swirl" title="Link to this heading"></a></h3>
<ol class="arabic">
<li><p>Setup R and RStudio (see links above)</p></li>
<li><p>Install swirl from the command line in R:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">install.packages</span><span class="p">(</span><span class="s">&#39;swirl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Load swirl:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="s">&#39;swirl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Run swirl:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">swirl</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ol>
<p>This will start the command line interactive tutorials of swirl. You will be instructed on exercises on the command line.</p>
<p><strong>swirl Commands (available anytime during lessons):</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">skip()</span></code> — Skip the current question</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">play()</span></code> — Experiment with R on your own (swirl ignores your actions)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nxt()</span></code> — Return swirl’s attention after using play()</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bye()</span></code> — Exit swirl (progress is saved)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">main()</span></code> — Return to swirl’s main menu</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">info()</span></code> — Display these options again</p></li>
</ul>
<p>I recommend working through at least a few lessons to get familiarity with coding in R.</p>
</section>
</section>
<section id="alternative-r-learning-resources">
<h2><a class="toc-backref" href="#id19" role="doc-backlink">Alternative R Learning Resources</a><a class="headerlink" href="#alternative-r-learning-resources" title="Link to this heading"></a></h2>
<p>For curious students who want to explore R beyond the course requirements:</p>
<section id="base-r">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">Base R</a><a class="headerlink" href="#base-r" title="Link to this heading"></a></h3>
<ul>
<li><p><strong>CRAN “An Introduction to R”</strong> (official manual): Canonical, up-to-date coverage of types, subsetting, vectorization, base graphics, and the modeling API. The authoritative source.</p>
<p><a class="reference external" href="https://cran.r-project.org/doc/manuals/r-release/R-intro.html">https://cran.r-project.org/doc/manuals/r-release/R-intro.html</a></p>
</li>
<li><p><strong>Deep R Programming</strong> (free textbook): Modern, rigorous coverage of R semantics, performance, and numerical computing. Ideal after you’re comfortable with basics.</p>
<p><a class="reference external" href="https://deepr.gagolewski.com/">https://deepr.gagolewski.com/</a></p>
</li>
</ul>
</section>
<section id="tidyverse">
<h3><a class="toc-backref" href="#id21" role="doc-backlink">tidyverse</a><a class="headerlink" href="#tidyverse" title="Link to this heading"></a></h3>
<ul>
<li><p><strong>R for Data Science</strong> (2e, free online): The authoritative entry point to tidy data workflows (readr, dplyr, tidyr, ggplot2, purrr).</p>
<p><a class="reference external" href="https://r4ds.hadley.nz">https://r4ds.hadley.nz</a></p>
</li>
<li><p><strong>tidyverse.org</strong>: Core package documentation and philosophy.</p>
<p><a class="reference external" href="https://www.tidyverse.org">https://www.tidyverse.org</a></p>
</li>
</ul>
</section>
<section id="r-markdown">
<h3><a class="toc-backref" href="#id22" role="doc-backlink">R Markdown</a><a class="headerlink" href="#r-markdown" title="Link to this heading"></a></h3>
<ul>
<li><p><strong>R Markdown: The Definitive Guide</strong>: Complete reference for authoring and multi-format output.</p>
<p><a class="reference external" href="https://bookdown.org/yihui/rmarkdown/">https://bookdown.org/yihui/rmarkdown/</a></p>
</li>
<li><p><strong>R Markdown Cookbook</strong>: Task-oriented tips that save hours in practice.</p>
<p><a class="reference external" href="https://bookdown.org/yihui/rmarkdown-cookbook/">https://bookdown.org/yihui/rmarkdown-cookbook/</a></p>
</li>
</ul>
</section>
<section id="statistical-computing">
<h3><a class="toc-backref" href="#id23" role="doc-backlink">Statistical Computing</a><a class="headerlink" href="#statistical-computing" title="Link to this heading"></a></h3>
<ul>
<li><p><strong>STAT 545</strong> (UBC): Practice-first course on modern workflows with excellent materials.</p>
<p><a class="reference external" href="https://stat545.com">https://stat545.com</a></p>
</li>
<li><p><strong>Modern Statistics for Modern Biology</strong>: R-based computational statistics for life sciences.</p>
<p><a class="reference external" href="https://www.huber.embl.de/msmb/">https://www.huber.embl.de/msmb/</a></p>
</li>
</ul>
</section>
<section id="video-resources">
<h3><a class="toc-backref" href="#id24" role="doc-backlink">Video Resources</a><a class="headerlink" href="#video-resources" title="Link to this heading"></a></h3>
<ul>
<li><p><strong>R Programming Full Course for Beginners</strong> (freeCodeCamp): Comprehensive 2-hour introduction covering basics through data analysis.</p>
<p><a class="reference external" href="https://www.youtube.com/watch?v=fDRa82lxzaU">https://www.youtube.com/watch?v=fDRa82lxzaU</a></p>
</li>
<li><p><strong>R Programming Tutorial - Learn the Basics</strong> (freeCodeCamp): Shorter focused tutorial on R fundamentals.</p>
<p><a class="reference external" href="https://www.youtube.com/watch?v=Q5g6lYUn6Q4">https://www.youtube.com/watch?v=Q5g6lYUn6Q4</a></p>
</li>
</ul>
</section>
</section>
<section id="assignment-tutorials-links">
<h2><a class="toc-backref" href="#id25" role="doc-backlink">Assignment Tutorials (Links)</a><a class="headerlink" href="#assignment-tutorials-links" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>Computer Assignment 1 Tutorial</strong> — Intro &amp; basics:
<a class="reference external" href="https://treese41528.github.io/STAT350/Computer_Assignment_Tutorials/Computer_Assignment_1_Tutorial.html">CA1 Tutorial</a></p></li>
<li><p><strong>Computer Assignment 2 Tutorial</strong> — Graphical &amp; numerical summaries:
<a class="reference external" href="https://treese41528.github.io/STAT350/Computer_Assignment_Tutorials/Computer_Assignment_2_Graphical_and_Numerical_Summaries_Tutorial.html">CA2 Tutorial</a></p></li>
<li><p><strong>Computer Assignment 3 Tutorial</strong> — Subsetting &amp; basic hypothesis testing:
<a class="reference external" href="https://treese41528.github.io/STAT350/Computer_Assignment_Tutorials/Computer_Assignment_3_BasicHypothesisTesting_and_subsetting_Tutorial.html">CA3 Tutorial</a></p></li>
<li><p><strong>Computer Assignment 4 Tutorial</strong> — Two-sample procedures:
<a class="reference external" href="https://treese41528.github.io/STAT350/Computer_Assignment_Tutorials/Computer_Assignment_4_TwoSampleProcedures_Tutorial.html">CA4 Tutorial</a></p></li>
<li><p><strong>Computer Assignment 5 Tutorial</strong> — One-way ANOVA:
<a class="reference external" href="https://treese41528.github.io/STAT350/Computer_Assignment_Tutorials/Computer_Assignment_5_ANOVA_Tutorial.html">CA5 Tutorial</a></p></li>
<li><p><strong>Computer Assignment 6 Tutorial</strong> — Simple linear regression:
<a class="reference external" href="https://treese41528.github.io/STAT350/Computer_Assignment_Tutorials/Computer_Assignment_6_SimpleLinearRegression_Tutorial.html">CA6 Tutorial</a></p></li>
</ul>
</section>
<section id="function-reference-alphabetized-within-category">
<h2><a class="toc-backref" href="#id26" role="doc-backlink">Function Reference (Alphabetized within Category)</a><a class="headerlink" href="#function-reference-alphabetized-within-category" title="Link to this heading"></a></h2>
<section id="data-i-o-housekeeping">
<h3><a class="toc-backref" href="#id27" role="doc-backlink">Data I/O &amp; Housekeeping</a><a class="headerlink" href="#data-i-o-housekeeping" title="Link to this heading"></a></h3>
<p><strong>getwd()</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Show current working directory
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?getwd</span></code> in R console
<em>Syntax</em>: <code class="docutils literal notranslate"><span class="pre">getwd()</span></code></p>
<p>Example showing the working directory:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">getwd</span><span class="p">()</span>
<span class="go">[1] &quot;/Users/username/STAT350&quot;</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>head(x, n = 6)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Display first n rows of a data frame or elements of a vector
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?head</span></code> in R console
<em>Syntax</em>: <code class="docutils literal notranslate"><span class="pre">head(x,</span> <span class="pre">n</span> <span class="pre">=</span> <span class="pre">6)</span></code>
<em>Common use</em>: Quickly inspect data after importing</p>
<p>Using built-in iris dataset:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">data</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="nf">head</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">)</span>
<span class="go">  Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span>
<span class="go">1          5.1         3.5          1.4         0.2  setosa</span>
<span class="go">2          4.9         3.0          1.4         0.2  setosa</span>
<span class="go">3          4.7         3.2          1.3         0.2  setosa</span>
</pre></div>
</div>
<p><em>See also</em>: <code class="docutils literal notranslate"><span class="pre">tail()</span></code>, <code class="docutils literal notranslate"><span class="pre">str()</span></code>, <code class="docutils literal notranslate"><span class="pre">summary()</span></code></p>
</div></blockquote>
<p><strong>read.csv(file, header = TRUE, stringsAsFactors = FALSE, …)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Import CSV file into a data frame
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?read.csv</span></code> in R console
<em>Key arguments</em>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">header</span></code>: First row contains column names (default TRUE)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stringsAsFactors</span></code>: Keep strings as characters (recommended FALSE)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">na.strings</span></code>: Values to treat as NA (default “NA”)</p></li>
</ul>
<p><em>Common pitfalls</em>:</p>
<ul class="simple">
<li><p>Using absolute paths (breaks on other computers)</p></li>
<li><p>Forgetting to check for proper import with <code class="docutils literal notranslate"><span class="pre">str()</span></code></p></li>
<li><p>Not handling special characters in column names</p></li>
</ul>
<p>Basic import:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">mydata</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;data/experiment.csv&quot;</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="nf">str</span><span class="p">(</span><span class="n">mydata</span><span class="p">)</span>
<span class="go">&#39;data.frame&#39;:     150 obs. of  5 variables:</span>
<span class="go"> $ id      : int  1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="go"> $ group   : chr  &quot;A&quot; &quot;B&quot; &quot;A&quot; &quot;C&quot; ...</span>
<span class="go"> $ measure1: num  23.5 19.2 25.1 22.8 20.3 ...</span>
<span class="go"> $ measure2: num  45.2 41.8 46.7 44.3 42.1 ...</span>
<span class="go"> $ outcome : chr  &quot;success&quot; &quot;failure&quot; &quot;success&quot; ...</span>
</pre></div>
</div>
<p>With options for handling missing data:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mydata</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;data/experiment.csv&quot;</span><span class="p">,</span>
<span class="w">                  </span><span class="n">stringsAsFactors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span>
<span class="w">                  </span><span class="n">na.strings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;NA&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;N/A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>Always validate after import:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">sum</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">mydata</span><span class="p">))</span>
<span class="go">[1] 12</span>
</pre></div>
</div>
<p><em>See also</em>: <code class="docutils literal notranslate"><span class="pre">read.table()</span></code>, <code class="docutils literal notranslate"><span class="pre">write.csv()</span></code>, <code class="docutils literal notranslate"><span class="pre">str()</span></code></p>
</div></blockquote>
<p><strong>setwd(path)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Change working directory
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?setwd</span></code> in R console
<em>Warning</em>: Avoid using in scripts; use RStudio Projects instead</p>
<p>Not recommended in scripts:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Bad practice - machine specific!</span>
<span class="c1"># setwd(&quot;/Users/username/STAT350&quot;)</span>

<span class="c1"># Better: Use RStudio Projects or relative paths</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>write.csv(x, file, row.names = FALSE)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Export data frame to CSV file
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?write.csv</span></code> in R console
<em>Key arguments</em>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">row.names</span></code>: Include row numbers (usually FALSE)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">na</span></code>: String for missing values (default “NA”)</p></li>
</ul>
<p>Save cleaned data:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">write.csv</span><span class="p">(</span><span class="n">d_clean</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;output/cleaned_data.csv&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="data-structures-creation">
<h3><a class="toc-backref" href="#id28" role="doc-backlink">Data Structures &amp; Creation</a><a class="headerlink" href="#data-structures-creation" title="Link to this heading"></a></h3>
<p><strong>c(…)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Combine values into a vector
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?c</span></code> in R console</p>
<p>Creating different types of vectors:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">v1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="n">v2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;iOS&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Android&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Windows&quot;</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="n">v3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;two&quot;</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="nf">class</span><span class="p">(</span><span class="n">v3</span><span class="p">)</span>
<span class="go">[1] &quot;character&quot;</span>
</pre></div>
</div>
<p>Note that mixed types get coerced to the most general type (character in this case).</p>
</div></blockquote>
<p><strong>colnames(x), rownames(x)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Get or set column/row names
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?colnames</span></code> or <code class="docutils literal notranslate"><span class="pre">?rownames</span></code> in R console</p>
<p>Getting column names from built-in dataset:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">colnames</span><span class="p">(</span><span class="n">mtcars</span><span class="p">)</span>
<span class="go"> [1] &quot;mpg&quot;  &quot;cyl&quot;  &quot;disp&quot; &quot;hp&quot;   &quot;drat&quot; &quot;wt&quot;   &quot;qsec&quot; &quot;vs&quot;   &quot;am&quot;   &quot;gear&quot; &quot;carb&quot;</span>
</pre></div>
</div>
<p>Renaming columns:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a copy to modify</span>
<span class="n">mydata</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mtcars</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">]</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">mydata</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;MPG&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Cylinders&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Displacement&quot;</span><span class="p">)</span>

<span class="c1"># Or rename specific columns</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">mydata</span><span class="p">)[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;MilesPerGallon&quot;</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>data.frame(…)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Create a data frame from vectors
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?data.frame</span></code> in R console
<em>Key arguments</em>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">stringsAsFactors</span></code>: Auto-convert strings to factors (set FALSE)</p></li>
</ul>
<p>Creating a data frame from scratch:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="gp">+ </span><span class="w">  </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">,</span>
<span class="gp">+ </span><span class="w">  </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;B&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;B&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;B&quot;</span><span class="p">),</span>
<span class="gp">+ </span><span class="w">  </span><span class="n">score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">85</span><span class="p">,</span><span class="w"> </span><span class="m">90</span><span class="p">,</span><span class="w"> </span><span class="m">78</span><span class="p">,</span><span class="w"> </span><span class="m">82</span><span class="p">,</span><span class="w"> </span><span class="m">88</span><span class="p">),</span>
<span class="gp">+ </span><span class="w">  </span><span class="n">stringsAsFactors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span>
<span class="gp">+ </span><span class="p">)</span>
<span class="gp">&gt; </span><span class="nf">str</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">&#39;data.frame&#39;:     5 obs. of  3 variables:</span>
<span class="go"> $ id   : int  1 2 3 4 5</span>
<span class="go"> $ group: chr  &quot;A&quot; &quot;A&quot; &quot;B&quot; &quot;B&quot; &quot;B&quot;</span>
<span class="go"> $ score: num  85 90 78 82 88</span>
</pre></div>
</div>
<p><em>See also</em>: <code class="docutils literal notranslate"><span class="pre">tibble::tibble()</span></code> for modern alternative</p>
</div></blockquote>
<p><strong>factor(x, levels = …, ordered = FALSE)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Create categorical variables with defined levels
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?factor</span></code> in R console
<em>When to use</em>: For categorical data in ANOVA, controlling plot order</p>
<p>Basic factor creation with automatic level detection:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">platform</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;iOS&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Android&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;iOS&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Windows&quot;</span><span class="p">))</span>
<span class="gp">&gt; </span><span class="nf">levels</span><span class="p">(</span><span class="n">platform</span><span class="p">)</span>
<span class="go">[1] &quot;Android&quot; &quot;iOS&quot;     &quot;Windows&quot;</span>
</pre></div>
</div>
<p>Controlling level order for plots and analyses:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">platform</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">platform</span><span class="p">,</span>
<span class="w">                  </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;iOS&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Android&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Windows&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>Creating ordered factors for ordinal data:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">satisfaction</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Low&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;High&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Medium&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;High&quot;</span><span class="p">),</span>
<span class="w">                      </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Low&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Medium&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;High&quot;</span><span class="p">),</span>
<span class="w">                      </span><span class="n">ordered</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
<p><em>Common pitfall</em>: Converting numeric factors back to numbers</p>
<p>Wrong way (returns level indices):</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">f</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;4&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;6&quot;</span><span class="p">))</span>
<span class="gp">&gt; </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">[1] 1 2 3</span>
</pre></div>
</div>
<p>Correct way:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
<span class="go">[1] 2 4 6</span>
</pre></div>
</div>
<p><em>See also</em>: <code class="docutils literal notranslate"><span class="pre">levels()</span></code>, <code class="docutils literal notranslate"><span class="pre">relevel()</span></code>, <code class="docutils literal notranslate"><span class="pre">droplevels()</span></code></p>
</div></blockquote>
</section>
<section id="data-wrangling-utilities">
<h3><a class="toc-backref" href="#id29" role="doc-backlink">Data Wrangling &amp; Utilities</a><a class="headerlink" href="#data-wrangling-utilities" title="Link to this heading"></a></h3>
<p><strong>apply(X, MARGIN, FUN)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Apply function over matrix/array margins
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?apply</span></code> in R console
<em>Key arguments</em>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">MARGIN</span></code>: 1 for rows, 2 for columns</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FUN</span></code>: Function to apply</p></li>
</ul>
<p>Create a sample matrix:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">M</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">matrix</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">12</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="n">M</span>
<span class="go">     [,1] [,2] [,3] [,4]</span>
<span class="go">[1,]    1    4    7   10</span>
<span class="go">[2,]    2    5    8   11</span>
<span class="go">[3,]    3    6    9   12</span>
</pre></div>
</div>
<p>Row means (MARGIN = 1):</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">apply</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span>
<span class="go">[1] 5.5 6.5 7.5</span>
</pre></div>
</div>
<p>Column sums (MARGIN = 2):</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">apply</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">sum</span><span class="p">)</span>
<span class="go">[1]  6 15 24 33</span>
</pre></div>
</div>
<p>Custom function to calculate range:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">apply</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">[1] 2 2 2 2</span>
</pre></div>
</div>
<p><em>See also</em>: <code class="docutils literal notranslate"><span class="pre">lapply()</span></code>, <code class="docutils literal notranslate"><span class="pre">sapply()</span></code>, <code class="docutils literal notranslate"><span class="pre">tapply()</span></code></p>
</div></blockquote>
<p><strong>as.numeric(x)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Convert to numeric type
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?as.numeric</span></code> in R console
<em>Common uses</em>: Fix data imported as characters, convert factors</p>
<p>Character to numeric conversion:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;1.5&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;2.3&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;3.1&quot;</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[1] 1.5 2.3 3.1</span>
</pre></div>
</div>
<p>Non-numeric values produce NAs with a warning:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;three&quot;</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">[1]  1  2 NA</span>
<span class="go">Warning message:</span>
<span class="go">NAs introduced by coercion</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>complete.cases(x)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Identify rows with no missing values
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?complete.cases</span></code> in R console
<em>Returns</em>: Logical vector (TRUE for complete rows)</p>
<p>Create data with missing values:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="gp">+ </span><span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">),</span>
<span class="gp">+ </span><span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="m">8</span><span class="p">)</span>
<span class="gp">+ </span><span class="p">)</span>
<span class="gp">&gt; </span><span class="nf">complete.cases</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">[1]  TRUE FALSE FALSE  TRUE</span>
</pre></div>
</div>
<p>Filter to complete cases only:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">df_clean</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="nf">complete.cases</span><span class="p">(</span><span class="n">df</span><span class="p">),</span><span class="w"> </span><span class="p">]</span>
<span class="gp">&gt; </span><span class="nf">nrow</span><span class="p">(</span><span class="n">df_clean</span><span class="p">)</span>
<span class="go">[1] 2</span>
</pre></div>
</div>
<p>Count incomplete cases:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">sum</span><span class="p">(</span><span class="o">!</span><span class="nf">complete.cases</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="go">[1] 2</span>
</pre></div>
</div>
<p><em>See also</em>: <code class="docutils literal notranslate"><span class="pre">is.na()</span></code>, <code class="docutils literal notranslate"><span class="pre">na.omit()</span></code></p>
</div></blockquote>
<p><strong>ifelse(test, yes, no)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Vectorized conditional operation
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?ifelse</span></code> in R console</p>
<p>Basic pass/fail grading:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">score</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">85</span><span class="p">,</span><span class="w"> </span><span class="m">72</span><span class="p">,</span><span class="w"> </span><span class="m">90</span><span class="p">,</span><span class="w"> </span><span class="m">68</span><span class="p">,</span><span class="w"> </span><span class="m">88</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="n">grade</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">score</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">80</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Pass&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Fail&quot;</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="n">grade</span>
<span class="go">[1] &quot;Pass&quot; &quot;Fail&quot; &quot;Pass&quot; &quot;Fail&quot; &quot;Pass&quot;</span>
</pre></div>
</div>
<p>Nested ifelse for letter grades:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">grade</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">score</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">90</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;A&quot;</span><span class="p">,</span>
<span class="w">               </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">score</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">80</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;B&quot;</span><span class="p">,</span>
<span class="w">                     </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">score</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">70</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;F&quot;</span><span class="p">)))</span>
</pre></div>
</div>
<p>Conditional calculations:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">$</span><span class="n">adjusted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">group</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;control&quot;</span><span class="p">,</span>
<span class="w">                     </span><span class="n">df</span><span class="o">$</span><span class="n">score</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">1.1</span><span class="p">,</span>
<span class="w">                     </span><span class="n">df</span><span class="o">$</span><span class="n">score</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>IQR(x, na.rm = FALSE)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Calculate interquartile range (Q3 - Q1)
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?IQR</span></code> in R console</p>
<p>With missing values:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="kc">NA</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="nf">IQR</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[1] NA</span>
<span class="gp">&gt; </span><span class="nf">IQR</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="go">[1] 4</span>
</pre></div>
</div>
<p>Compare with manual calculation from quantiles:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">quantile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.25</span><span class="p">,</span><span class="w"> </span><span class="m">0.75</span><span class="p">),</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="go">25% 75%</span>
<span class="go">  3   7</span>
</pre></div>
</div>
<p><em>See also</em>: <code class="docutils literal notranslate"><span class="pre">quantile()</span></code>, <code class="docutils literal notranslate"><span class="pre">fivenum()</span></code>, <code class="docutils literal notranslate"><span class="pre">boxplot.stats()</span></code></p>
</div></blockquote>
<p><strong>is.na(x)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Test for missing values
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?is.na</span></code> in R console</p>
<p>Identifying NAs:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="nf">is.na</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[1] FALSE  TRUE FALSE  TRUE FALSE</span>
</pre></div>
</div>
<p>Counting NAs:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">sum</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">[1] 2</span>
</pre></div>
</div>
<p>Finding positions of NAs:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">which</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">[1] 2 4</span>
</pre></div>
</div>
<p>Replacing NAs:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="nf">is.na</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span>
</pre></div>
</div>
<p><em>See also</em>: <code class="docutils literal notranslate"><span class="pre">complete.cases()</span></code>, <code class="docutils literal notranslate"><span class="pre">na.omit()</span></code>, <code class="docutils literal notranslate"><span class="pre">anyNA()</span></code></p>
</div></blockquote>
<p><strong>paste(…, sep = “ “, collapse = NULL)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Concatenate strings
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?paste</span></code> in R console
<em>Key arguments</em>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sep</span></code>: Separator between elements</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">collapse</span></code>: Collapse vector to single string</p></li>
</ul>
<p>Basic concatenation:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;Mean:&quot;</span><span class="p">,</span><span class="w"> </span><span class="m">5.2</span><span class="p">)</span>
<span class="go">[1] &quot;Mean: 5.2&quot;</span>
</pre></div>
</div>
<p>Custom separator for dates:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;2024&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;01&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;15&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="p">)</span>
<span class="go">[1] &quot;2024-01-15&quot;</span>
</pre></div>
</div>
<p>Vectorized operation:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;Group&quot;</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">)</span>
<span class="go">[1] &quot;Group 1&quot; &quot;Group 2&quot; &quot;Group 3&quot;</span>
</pre></div>
</div>
<p>Collapse to single string:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">paste</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;B&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;C&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">collapse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;, &quot;</span><span class="p">)</span>
<span class="go">[1] &quot;A, B, C&quot;</span>
</pre></div>
</div>
<p>No-space version with paste0:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">paste0</span><span class="p">(</span><span class="s">&quot;var&quot;</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">)</span>
<span class="go">[1] &quot;var1&quot; &quot;var2&quot; &quot;var3&quot;</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>quantile(x, probs = seq(0, 1, 0.25), na.rm = FALSE)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Calculate sample quantiles
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?quantile</span></code> in R console</p>
<p>Default quartiles:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="kc">NA</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="nf">quantile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="go">  0%  25%  50%  75% 100%</span>
<span class="go"> 1.0  3.0  5.5  8.0 10.0</span>
</pre></div>
</div>
<p>Custom percentiles:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">quantile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">probs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.1</span><span class="p">,</span><span class="w"> </span><span class="m">0.9</span><span class="p">),</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="go">10% 90%</span>
<span class="go">1.9 9.1</span>
</pre></div>
</div>
<p><em>See also</em>: <code class="docutils literal notranslate"><span class="pre">median()</span></code>, <code class="docutils literal notranslate"><span class="pre">IQR()</span></code>, <code class="docutils literal notranslate"><span class="pre">fivenum()</span></code></p>
</div></blockquote>
<p><strong>sapply(X, FUN), lapply(X, FUN)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Apply function over list/vector elements
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?sapply</span></code> or <code class="docutils literal notranslate"><span class="pre">?lapply</span></code> in R console
<em>Differences</em>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lapply</span></code>: Always returns a list</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sapply</span></code>: Simplifies to vector/matrix if possible</p></li>
</ul>
<p>Create a list of vectors:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">lst</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="o">:</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">11</span><span class="o">:</span><span class="m">15</span><span class="p">)</span>
</pre></div>
</div>
<p>sapply simplifies to vector:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">sapply</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span>
<span class="go"> a  b  c</span>
<span class="go"> 3  8 13</span>
</pre></div>
</div>
<p>lapply returns list:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">lapply</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span>
<span class="go">$a</span>
<span class="go">[1] 3</span>

<span class="go">$b</span>
<span class="go">[1] 8</span>

<span class="go">$c</span>
<span class="go">[1] 13</span>
</pre></div>
</div>
<p>Check multiple columns for NAs:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">sapply</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>tapply(X, INDEX, FUN)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Apply function by group
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?tapply</span></code> in R console</p>
<p>Group means using built-in dataset:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">tapply</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span>
<span class="go">    setosa versicolor  virginica</span>
<span class="go">     5.006      5.936      6.588</span>
</pre></div>
</div>
<p>Multiple statistics per group:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">tapply</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">iris</span><span class="o">$</span><span class="n">Species</span><span class="p">,</span>
<span class="w">       </span><span class="kr">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
</pre></div>
</div>
<p><em>See also</em>: <code class="docutils literal notranslate"><span class="pre">aggregate()</span></code>, <code class="docutils literal notranslate"><span class="pre">by()</span></code></p>
</div></blockquote>
</section>
<section id="descriptive-statistics-correlation">
<h3><a class="toc-backref" href="#id30" role="doc-backlink">Descriptive Statistics &amp; Correlation</a><a class="headerlink" href="#descriptive-statistics-correlation" title="Link to this heading"></a></h3>
<p><strong>cor(x, y = NULL, use = “everything”, method = “pearson”)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Calculate correlation coefficient
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?cor</span></code> in R console
<em>Key arguments</em>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">use</span></code>: How to handle NAs (“complete.obs” drops them)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">method</span></code>: “pearson” (default), “spearman”, “kendall”</p></li>
</ul>
<p>Perfect positive correlation:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="nf">cor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span>
<span class="go">[1] 1</span>
</pre></div>
</div>
<p>Using built-in dataset:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">cor</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">,</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">wt</span><span class="p">)</span>
<span class="go">[1] -0.8676594</span>
</pre></div>
</div>
<p>Correlation matrix:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">cor</span><span class="p">(</span><span class="n">mtcars</span><span class="p">[,</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;mpg&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;wt&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hp&quot;</span><span class="p">)])</span>
<span class="go">           mpg         wt         hp</span>
<span class="go">mpg  1.0000000 -0.8676594 -0.7761684</span>
<span class="go">wt  -0.8676594  1.0000000  0.6587479</span>
<span class="go">hp  -0.7761684  0.6587479  1.0000000</span>
</pre></div>
</div>
<p><em>Interpretation guide</em>:</p>
<ul class="simple">
<li><p>-1 to -0.7: Strong negative</p></li>
<li><p>-0.7 to -0.3: Moderate negative</p></li>
<li><p>-0.3 to 0.3: Weak/no linear relationship</p></li>
<li><p>0.3 to 0.7: Moderate positive</p></li>
<li><p>0.7 to 1: Strong positive</p></li>
</ul>
<p>Test for significance:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">cor.test</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span><span class="p">,</span><span class="w"> </span><span class="n">mtcars</span><span class="o">$</span><span class="n">wt</span><span class="p">)</span>
</pre></div>
</div>
<p><em>See also</em>: <code class="docutils literal notranslate"><span class="pre">cor.test()</span></code>, <code class="docutils literal notranslate"><span class="pre">cov()</span></code></p>
</div></blockquote>
<p><strong>mean(x, trim = 0, na.rm = FALSE)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Calculate arithmetic mean
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?mean</span></code> in R console
<em>Key arguments</em>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">na.rm</span></code>: Remove NAs before calculation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trim</span></code>: Fraction to trim from each end</p></li>
</ul>
<p>Basic usage with NAs:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="kc">NA</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="nf">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[1] NA</span>
<span class="gp">&gt; </span><span class="nf">mean</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="go">[1] 3</span>
</pre></div>
</div>
<p>Trimmed mean (robust to outliers):</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">100</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="nf">mean</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">[1] 22</span>
<span class="gp">&gt; </span><span class="nf">mean</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">trim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">)</span>
<span class="go">[1] 3</span>
</pre></div>
</div>
<p>The trimmed mean removes 20% from each end before calculating.</p>
<p><em>See also</em>: <code class="docutils literal notranslate"><span class="pre">median()</span></code>, <code class="docutils literal notranslate"><span class="pre">summary()</span></code></p>
</div></blockquote>
<p><strong>median(x, na.rm = FALSE)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Calculate median (middle value)
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?median</span></code> in R console</p>
<p>Odd number of values:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">median</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">))</span>
<span class="go">[1] 3</span>
</pre></div>
</div>
<p>Even number of values:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">median</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">))</span>
<span class="go">[1] 2.5</span>
</pre></div>
</div>
<p>Median is more robust than mean for skewed data:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="m">25</span><span class="p">,</span><span class="w"> </span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="m">35</span><span class="p">,</span><span class="w"> </span><span class="m">200</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="nf">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[1] 62</span>
<span class="gp">&gt; </span><span class="nf">median</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[1] 30</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>sd(x, na.rm = FALSE)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Calculate sample standard deviation
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?sd</span></code> in R console
<em>Note</em>: Uses n-1 denominator (sample SD)</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="m">9</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="nf">sd</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[1] 2.13809</span>
<span class="gp">&gt; </span><span class="nf">var</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[1] 4.571429</span>
</pre></div>
</div>
<p>The variance equals the square of the standard deviation.</p>
<p>Calculate coefficient of variation (relative variability):</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">cv</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">100</span>
<span class="gp">&gt; </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;CV:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;%&quot;</span><span class="p">)</span>
<span class="go">[1] &quot;CV: 42.8 %&quot;</span>
</pre></div>
</div>
<p><em>See also</em>: <code class="docutils literal notranslate"><span class="pre">var()</span></code>, <code class="docutils literal notranslate"><span class="pre">mad()</span></code> (robust alternative)</p>
</div></blockquote>
</section>
<section id="probability-distributions">
<h3><a class="toc-backref" href="#id31" role="doc-backlink">Probability &amp; Distributions</a><a class="headerlink" href="#probability-distributions" title="Link to this heading"></a></h3>
<p><strong>Normal Distribution Functions</strong></p>
<blockquote>
<div><p><strong>dnorm(x, mean = 0, sd = 1)</strong></p>
<p><em>Purpose</em>: Normal probability density
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?dnorm</span></code> in R console
<em>Use cases</em>: Overlay theoretical curves, calculate likelihoods</p>
<p>Standard normal density at x = 0:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">dnorm</span><span class="p">(</span><span class="m">0</span><span class="p">)</span>
<span class="go">[1] 0.3989423</span>
</pre></div>
</div>
<p>Custom parameters:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">dnorm</span><span class="p">(</span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">)</span>
<span class="go">[1] 0.02659615</span>
</pre></div>
</div>
<p>Use in ggplot2 for overlaying normal curve:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">after_stat</span><span class="p">(</span><span class="n">density</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dnorm</span><span class="p">,</span>
<span class="w">               </span><span class="n">args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span>
<span class="w">               </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>pnorm(q, mean = 0, sd = 1, lower.tail = TRUE)</strong></p>
<p><em>Purpose</em>: Normal cumulative distribution (probability)
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?pnorm</span></code> in R console</p>
<p>Standard normal probabilities:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">pnorm</span><span class="p">(</span><span class="m">1.96</span><span class="p">)</span>
<span class="go">[1] 0.9750021</span>
<span class="gp">&gt; </span><span class="nf">pnorm</span><span class="p">(</span><span class="m">1.96</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="go">[1] 0.0249979</span>
</pre></div>
</div>
<p>Two-tailed p-value:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="m">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">pnorm</span><span class="p">(</span><span class="o">-</span><span class="nf">abs</span><span class="p">(</span><span class="m">1.96</span><span class="p">))</span>
<span class="go">[1] 0.04999579</span>
</pre></div>
</div>
<p><strong>qnorm(p, mean = 0, sd = 1, lower.tail = TRUE)</strong></p>
<p><em>Purpose</em>: Normal quantiles (inverse CDF)
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?qnorm</span></code> in R console</p>
<p>Critical values:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">qnorm</span><span class="p">(</span><span class="m">0.975</span><span class="p">)</span>
<span class="go">[1] 1.959964</span>
<span class="gp">&gt; </span><span class="nf">qnorm</span><span class="p">(</span><span class="m">0.95</span><span class="p">)</span>
<span class="go">[1] 1.644854</span>
</pre></div>
</div>
<p>The first gives the two-tailed 95% critical value, the second gives one-tailed.</p>
<p>Calculate confidence interval:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">xbar</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">100</span><span class="p">;</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">15</span><span class="p">;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">25</span>
<span class="n">xbar</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">qnorm</span><span class="p">(</span><span class="m">0.975</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">s</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>rnorm(n, mean = 0, sd = 1)</strong></p>
<p><em>Purpose</em>: Generate random normal values
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?rnorm</span></code> in R console</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>
<span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">)</span>
<span class="nf">hist</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>t Distribution Functions</strong></p>
<blockquote>
<div><p><strong>pt(q, df, lower.tail = TRUE)</strong></p>
<p><em>Purpose</em>: Student’s t cumulative distribution
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?pt</span></code> in R console
<em>Use cases</em>: Calculate p-values for t-tests</p>
<p>One-sided p-value:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">t_stat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">2.5</span>
<span class="gp">&gt; </span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">24</span>
<span class="gp">&gt; </span><span class="nf">pt</span><span class="p">(</span><span class="n">t_stat</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="go">[1] 0.009963466</span>
</pre></div>
</div>
<p>Two-sided p-value:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="m">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">pt</span><span class="p">(</span><span class="o">-</span><span class="nf">abs</span><span class="p">(</span><span class="n">t_stat</span><span class="p">),</span><span class="w"> </span><span class="n">df</span><span class="p">)</span>
<span class="go">[1] 0.01992693</span>
</pre></div>
</div>
<p><strong>qt(p, df, lower.tail = TRUE)</strong></p>
<p><em>Purpose</em>: Student’s t quantiles
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?qt</span></code> in R console
<em>Use cases</em>: Critical values for confidence intervals</p>
<p>95% CI critical value:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">qt</span><span class="p">(</span><span class="m">0.975</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">24</span><span class="p">)</span>
<span class="go">[1] 2.063899</span>
</pre></div>
</div>
<p>Compare to normal:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">qnorm</span><span class="p">(</span><span class="m">0.975</span><span class="p">)</span>
<span class="go">[1] 1.959964</span>
</pre></div>
</div>
<p>The t critical value is larger due to heavier tails.</p>
<p><em>See also</em>: <code class="docutils literal notranslate"><span class="pre">dt()</span></code>, <code class="docutils literal notranslate"><span class="pre">rt()</span></code></p>
</div></blockquote>
<p><strong>Other Distributions</strong></p>
<blockquote>
<div><p><strong>dbinom(x, size, prob)</strong></p>
<p><em>Purpose</em>: Binomial probability mass function
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?dbinom</span></code> in R console</p>
<p>Probability of exactly 3 successes in 10 trials with p = 0.5:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">dbinom</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span>
<span class="go">[1] 0.1171875</span>
</pre></div>
</div>
<p>Full distribution:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span><span class="o">:</span><span class="m">10</span>
<span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">dbinom</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span>
<span class="nf">barplot</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">names.arg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>qtukey(p, nmeans, df)</strong></p>
<p><em>Purpose</em>: Tukey HSD critical values
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?qtukey</span></code> in R console</p>
<p>Critical value for 3 groups with df = 27:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">qtukey</span><span class="p">(</span><span class="m">0.95</span><span class="p">,</span><span class="w"> </span><span class="n">nmeans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">27</span><span class="p">)</span>
<span class="go">[1] 3.506426</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="simulation-functions">
<h3><a class="toc-backref" href="#id32" role="doc-backlink">Simulation Functions</a><a class="headerlink" href="#simulation-functions" title="Link to this heading"></a></h3>
<p><strong>set.seed(seed)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Set random number generator seed for reproducibility
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?set.seed</span></code> in R console</p>
<p>Without seed (different each time):</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">rnorm</span><span class="p">(</span><span class="m">3</span><span class="p">)</span>
<span class="go">[1]  0.3186301 -0.5817907  0.7145327</span>
<span class="gp">&gt; </span><span class="nf">rnorm</span><span class="p">(</span><span class="m">3</span><span class="p">)</span>
<span class="go">[1] -0.8252594 -0.3598138 -0.0109303</span>
</pre></div>
</div>
<p>With seed (reproducible):</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="nf">rnorm</span><span class="p">(</span><span class="m">3</span><span class="p">)</span>
<span class="go">[1] -0.5604756 -0.2301775  1.5587083</span>
<span class="gp">&gt; </span><span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="nf">rnorm</span><span class="p">(</span><span class="m">3</span><span class="p">)</span>
<span class="go">[1] -0.5604756 -0.2301775  1.5587083</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Random Generation Functions</strong></p>
<blockquote>
<div><p>All random generation functions take <code class="docutils literal notranslate"><span class="pre">n</span></code> (number of values) as the first argument.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">set.seed</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
<span class="nf">rnorm</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">)</span><span class="w">    </span><span class="c1"># Normal</span>
<span class="nf">runif</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w">      </span><span class="c1"># Uniform</span>
<span class="nf">rexp</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">                </span><span class="c1"># Exponential</span>
</pre></div>
</div>
<p>For simulation studies:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">n_sims</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1000</span>
<span class="n">means</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">replicate</span><span class="p">(</span><span class="n">n_sims</span><span class="p">,</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="nf">rnorm</span><span class="p">(</span><span class="m">30</span><span class="p">)))</span>
<span class="nf">hist</span><span class="p">(</span><span class="n">means</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Sampling Distribution of Mean&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="inference-functions">
<h3><a class="toc-backref" href="#id33" role="doc-backlink">Inference Functions</a><a class="headerlink" href="#inference-functions" title="Link to this heading"></a></h3>
<p><strong>t.test(x, y = NULL, alternative = “two.sided”, mu = 0, paired = FALSE, var.equal = FALSE, conf.level = 0.95)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: One and two sample t-tests
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?t.test</span></code> in R console
<em>When to use</em>: Compare means between 1-2 groups
<em>Key arguments</em>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alternative</span></code>: “two.sided”, “less”, “greater”</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mu</span></code>: Null hypothesis value (one-sample)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">paired</span></code>: TRUE for matched pairs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">var.equal</span></code>: TRUE assumes equal variances</p></li>
</ul>
<p><em>Common pitfalls</em>:</p>
<ul class="simple">
<li><p>Using paired = TRUE with independent samples</p></li>
<li><p>Not checking normality assumptions</p></li>
<li><p>Forgetting var.equal = FALSE for unequal variances</p></li>
</ul>
<p>One-sample test:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">98</span><span class="p">,</span><span class="w"> </span><span class="m">102</span><span class="p">,</span><span class="w"> </span><span class="m">101</span><span class="p">,</span><span class="w"> </span><span class="m">97</span><span class="p">,</span><span class="w"> </span><span class="m">103</span><span class="p">,</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="m">99</span><span class="p">,</span><span class="w"> </span><span class="m">98</span><span class="p">,</span><span class="w"> </span><span class="m">104</span><span class="p">,</span><span class="w"> </span><span class="m">101</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="nf">t.test</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span>

<span class="go">  One Sample t-test</span>

<span class="go">data:  x</span>
<span class="go">t = 0.63246, df = 9, p-value = 0.5425</span>
<span class="go">alternative hypothesis: true mean is not equal to 100</span>
<span class="go">95 percent confidence interval:</span>
<span class="go"> 98.41533 102.18467</span>
<span class="go">sample estimates:</span>
<span class="go">mean of x</span>
<span class="go">    100.3</span>
</pre></div>
</div>
<p>Two-sample independent test using built-in data:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">data</span><span class="p">(</span><span class="n">sleep</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="nf">t.test</span><span class="p">(</span><span class="n">extra</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">group</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sleep</span><span class="p">,</span><span class="w"> </span><span class="n">var.equal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>

<span class="go">  Welch Two Sample t-test</span>

<span class="go">data:  extra by group</span>
<span class="go">t = -1.8608, df = 17.776, p-value = 0.07939</span>
<span class="go">alternative hypothesis: true difference in means between group 1 and group 2 is not equal to 0</span>
<span class="go">95 percent confidence interval:</span>
<span class="go"> -3.3654832  0.2054832</span>
<span class="go">sample estimates:</span>
<span class="go">mean in group 1 mean in group 2</span>
<span class="go">           0.75            2.33</span>
</pre></div>
</div>
<p><strong>Paired t-test - Three equivalent approaches:</strong></p>
<p>Method 1 - Using paired = TRUE with two vectors:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">before</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">85</span><span class="p">,</span><span class="w"> </span><span class="m">88</span><span class="p">,</span><span class="w"> </span><span class="m">90</span><span class="p">,</span><span class="w"> </span><span class="m">92</span><span class="p">,</span><span class="w"> </span><span class="m">87</span><span class="p">)</span>
<span class="n">after</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">88</span><span class="p">,</span><span class="w"> </span><span class="m">90</span><span class="p">,</span><span class="w"> </span><span class="m">91</span><span class="p">,</span><span class="w"> </span><span class="m">94</span><span class="p">,</span><span class="w"> </span><span class="m">89</span><span class="p">)</span>
<span class="nf">t.test</span><span class="p">(</span><span class="n">before</span><span class="p">,</span><span class="w"> </span><span class="n">after</span><span class="p">,</span><span class="w"> </span><span class="n">paired</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
<p>Method 2 - Convert to one-sample test of differences:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">differences</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">after</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">before</span>
<span class="nf">t.test</span><span class="p">(</span><span class="n">differences</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Method 3 - Formula interface with paired data:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="c1"># Using sleep dataset (paired by ID)</span>
<span class="gp">&gt; </span><span class="nf">t.test</span><span class="p">(</span><span class="nf">Pair</span><span class="p">(</span><span class="n">extra</span><span class="p">[</span><span class="n">group</span><span class="o">==</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">extra</span><span class="p">[</span><span class="n">group</span><span class="o">==</span><span class="m">2</span><span class="p">])</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sleep</span><span class="p">)</span>

<span class="go">  Paired t-test</span>

<span class="go">data:  Pair(extra[group == 1], extra[group == 2])</span>
<span class="go">t = -4.0621, df = 9, p-value = 0.002833</span>
<span class="go">alternative hypothesis: true mean difference is not equal to 0</span>
<span class="go">95 percent confidence interval:</span>
<span class="go"> -2.4598858 -0.7001142</span>
<span class="go">sample estimates:</span>
<span class="go">mean difference</span>
<span class="go">          -1.58</span>
</pre></div>
</div>
<p>Extract components from results:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">result</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">t.test</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="n">result</span><span class="o">$</span><span class="n">p.value</span>
<span class="go">[1] 0.5424805</span>
<span class="gp">&gt; </span><span class="n">result</span><span class="o">$</span><span class="n">conf.int</span>
<span class="go">[1]  98.41533 102.18467</span>
<span class="go">attr(,&quot;conf.level&quot;)</span>
<span class="go">[1] 0.95</span>
<span class="gp">&gt; </span><span class="n">result</span><span class="o">$</span><span class="n">estimate</span>
<span class="go">mean of x</span>
<span class="go">    100.3</span>
</pre></div>
</div>
<p><strong>Checking assumptions</strong>:</p>
<p>Normality check:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">shapiro.test</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nf">qqnorm</span><span class="p">(</span><span class="n">x</span><span class="p">);</span><span class="w"> </span><span class="nf">qqline</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>Equal variances check:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">var.test</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p><em>See also</em>: <code class="docutils literal notranslate"><span class="pre">wilcox.test()</span></code> (non-parametric alternative)</p>
</div></blockquote>
<p><strong>aov(formula, data)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Analysis of variance (ANOVA)
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?aov</span></code> in R console
<em>When to use</em>: Compare means across 3+ groups</p>
<p>One-way ANOVA:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">aov</span><span class="p">(</span><span class="n">score</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">group</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
<span class="go">            Df Sum Sq Mean Sq F value Pr(&gt;F)</span>
<span class="go">group        2  520.3  260.15   8.214 0.0019 **</span>
<span class="go">Residuals   27  855.2   31.67</span>
<span class="go">---</span>
<span class="go">Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>
</pre></div>
</div>
<p>Check assumptions with diagnostic plots:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">  </span><span class="c1"># Residuals vs Fitted</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">  </span><span class="c1"># Normal Q-Q</span>
</pre></div>
</div>
<p>Test for equal variances:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">bartlett.test</span><span class="p">(</span><span class="n">score</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">group</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<p>Post-hoc comparisons:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">TukeyHSD</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="nf">TukeyHSD</span><span class="p">(</span><span class="n">fit</span><span class="p">))</span>
</pre></div>
</div>
<p><em>See also</em>: <code class="docutils literal notranslate"><span class="pre">anova()</span></code>, <code class="docutils literal notranslate"><span class="pre">TukeyHSD()</span></code>, <code class="docutils literal notranslate"><span class="pre">kruskal.test()</span></code></p>
</div></blockquote>
<p><strong>TukeyHSD(x, conf.level = 0.95)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Tukey’s honest significant differences
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?TukeyHSD</span></code> in R console
<em>When to use</em>: After significant ANOVA for pairwise comparisons</p>
<p>Following ANOVA:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">aov</span><span class="p">(</span><span class="n">score</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">group</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="n">tukey_result</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">TukeyHSD</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="n">tukey_result</span>
<span class="go">  Tukey multiple comparisons of means</span>
<span class="go">    95% family-wise confidence level</span>

<span class="go">Fit: aov(formula = score ~ group, data = df)</span>

<span class="go">$group</span>
<span class="go">        diff       lwr      upr     p adj</span>
<span class="go">B-A  -5.333 -12.20271 1.536038 0.1518711</span>
<span class="go">C-A   3.167  -3.70271 10.036038 0.5019442</span>
<span class="go">C-B   8.500   1.63062 15.369376 0.0125506</span>
</pre></div>
</div>
<p>Visual display:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span><span class="n">tukey_result</span><span class="p">)</span>
</pre></div>
</div>
<p>Confidence intervals not containing 0 indicate significant differences.</p>
</div></blockquote>
<p><strong>lm(formula, data)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Fit linear models
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?lm</span></code> in R console
<em>When to use</em>: Regression analysis, ANOVA via regression</p>
<p>Simple linear regression:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">rating</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="nf">summary</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span>

<span class="go">Call:</span>
<span class="go">lm(formula = rating ~ price, data = df)</span>

<span class="go">Residuals:</span>
<span class="go">     Min       1Q   Median       3Q      Max</span>
<span class="go">-2.83450 -0.83450 -0.03077  0.78231  2.70308</span>

<span class="go">Coefficients:</span>
<span class="go">            Estimate Std. Error t value Pr(&gt;|t|)</span>
<span class="go">(Intercept)  2.1234     0.2145   9.897 2.13e-10 ***</span>
<span class="go">price        0.5432     0.0532  10.211 9.77e-11 ***</span>
<span class="go">---</span>
<span class="go">Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>

<span class="go">Residual standard error: 1.234 on 28 degrees of freedom</span>
<span class="go">Multiple R-squared:  0.7882,      Adjusted R-squared:  0.7806</span>
<span class="go">F-statistic: 104.3 on 1 and 28 DF,  p-value: 9.77e-11</span>
</pre></div>
</div>
<p>Extract components:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">coef</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span><span class="w">           </span><span class="c1"># Coefficients</span>
<span class="nf">confint</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span><span class="w">        </span><span class="c1"># CI for coefficients</span>
<span class="nf">residuals</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span><span class="w">      </span><span class="c1"># Residuals</span>
<span class="nf">fitted</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span><span class="w">         </span><span class="c1"># Fitted values</span>
</pre></div>
</div>
<p>Diagnostic plots:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span><span class="w">  </span><span class="c1"># Produces 4 diagnostic plots</span>
</pre></div>
</div>
<p>ANOVA table:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">anova</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span>
</pre></div>
</div>
<p><em>See also</em>: <code class="docutils literal notranslate"><span class="pre">summary.lm()</span></code>, <code class="docutils literal notranslate"><span class="pre">predict.lm()</span></code>, <code class="docutils literal notranslate"><span class="pre">plot.lm()</span></code></p>
</div></blockquote>
<p><strong>predict(object, newdata, interval = “none”, level = 0.95)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Predictions from model fits
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?predict.lm</span></code> in R console
<em>Key arguments</em>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">interval</span></code>: “confidence” (mean response) or “prediction” (new obs)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">level</span></code>: Confidence level</p></li>
</ul>
<p><em>Critical distinction</em>:</p>
<ul class="simple">
<li><p><strong>Confidence interval</strong>: Uncertainty about mean response</p></li>
<li><p><strong>Prediction interval</strong>: Uncertainty about individual response (wider)</p></li>
</ul>
<p>Fit model first:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">rating</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<p>Point prediction:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">new_price</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span><span class="p">)</span>
<span class="gp">&gt; </span><span class="nf">predict</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span><span class="w"> </span><span class="n">new_price</span><span class="p">)</span>
<span class="go">       1</span>
<span class="go">29.28571</span>
</pre></div>
</div>
<p>Confidence interval (mean rating at price = 50):</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">predict</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span><span class="w"> </span><span class="n">new_price</span><span class="p">,</span><span class="w"> </span><span class="n">interval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;confidence&quot;</span><span class="p">)</span>
<span class="go">       fit      lwr      upr</span>
<span class="go">1 29.28571 28.47933 30.09209</span>
</pre></div>
</div>
<p>Prediction interval (individual rating at price = 50):</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">predict</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span><span class="w"> </span><span class="n">new_price</span><span class="p">,</span><span class="w"> </span><span class="n">interval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;prediction&quot;</span><span class="p">)</span>
<span class="go">       fit      lwr      upr</span>
<span class="go">1 29.28571 26.89414 31.67728</span>
</pre></div>
</div>
<p>Note that prediction intervals are always wider than confidence intervals.</p>
<p>Multiple predictions for plotting:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">new_prices</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="w">  </span><span class="n">price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">price</span><span class="p">),</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">price</span><span class="p">),</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">ci</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span><span class="w"> </span><span class="n">new_prices</span><span class="p">,</span><span class="w"> </span><span class="n">interval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;confidence&quot;</span><span class="p">)</span>
<span class="kc">pi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span><span class="w"> </span><span class="n">new_prices</span><span class="p">,</span><span class="w"> </span><span class="n">interval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;prediction&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot with bands:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span><span class="n">rating</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">)</span>
<span class="nf">abline</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">new_prices</span><span class="o">$</span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="n">ci</span><span class="p">[,</span><span class="s">&quot;lwr&quot;</span><span class="p">],</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">new_prices</span><span class="o">$</span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="n">ci</span><span class="p">[,</span><span class="s">&quot;upr&quot;</span><span class="p">],</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">new_prices</span><span class="o">$</span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="kc">pi</span><span class="p">[,</span><span class="s">&quot;lwr&quot;</span><span class="p">],</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">new_prices</span><span class="o">$</span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="kc">pi</span><span class="p">[,</span><span class="s">&quot;upr&quot;</span><span class="p">],</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><em>See also</em>: <code class="docutils literal notranslate"><span class="pre">fitted()</span></code>, <code class="docutils literal notranslate"><span class="pre">residuals()</span></code></p>
</div></blockquote>
<p><strong>Diagnostic Plots for Assumptions</strong></p>
<blockquote>
<div><p>For t-test (normality of residuals):</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">residuals</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="n">score</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">group</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">))</span>
<span class="nf">qqnorm</span><span class="p">(</span><span class="n">x</span><span class="p">);</span><span class="w"> </span><span class="nf">qqline</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nf">shapiro.test</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>For ANOVA:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">aov</span><span class="p">(</span><span class="n">score</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">group</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">  </span><span class="c1"># Constant variance</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">  </span><span class="c1"># Normality</span>
</pre></div>
</div>
<p>For regression:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">rating</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">)</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>
</pre></div>
</div>
<p>Manual residual plots:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span><span class="nf">fitted</span><span class="p">(</span><span class="n">mod</span><span class="p">),</span><span class="w"> </span><span class="nf">residuals</span><span class="p">(</span><span class="n">mod</span><span class="p">))</span>
<span class="nf">abline</span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Pattern interpretation:</p>
<ul class="simple">
<li><p>Random scatter: Good</p></li>
<li><p>Funnel shape: Heteroscedasticity</p></li>
<li><p>Curve: Non-linearity</p></li>
<li><p>Outliers: Influential points</p></li>
</ul>
</div></blockquote>
</section>
<section id="graphics-ggplot2">
<h3><a class="toc-backref" href="#id34" role="doc-backlink">Graphics (ggplot2)</a><a class="headerlink" href="#graphics-ggplot2" title="Link to this heading"></a></h3>
</section>
<section id="core-components">
<h3><a class="toc-backref" href="#id35" role="doc-backlink">Core Components</a><a class="headerlink" href="#core-components" title="Link to this heading"></a></h3>
<p><strong>ggplot(data, aes(…))</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Initialize a ggplot object
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?ggplot</span></code> in R console
<em>Structure</em>: Data + aesthetic mappings + layers</p>
<p>Basic setup creates blank plot with axes:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Width</span><span class="p">))</span>
</pre></div>
</div>
<p>Add layers with +:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Width</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span>
</pre></div>
</div>
<p>Save for reuse:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mpg</span><span class="p">))</span>
<span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_boxplot</span><span class="p">()</span>
<span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_violin</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>aes(…)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Map variables to visual properties
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?aes</span></code> in R console
<em>Common aesthetics</em>: x, y, color, fill, shape, size, alpha</p>
<p>Position aesthetics:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Width</span><span class="p">)</span>
</pre></div>
</div>
<p>Color by group:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Width</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">)</span>
</pre></div>
</div>
<p>Multiple aesthetics:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wt</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mpg</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hp</span><span class="p">)</span>
</pre></div>
</div>
<p>Can set in ggplot() or individual geoms:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Width</span><span class="p">))</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="geoms-geometric-objects">
<h3><a class="toc-backref" href="#id36" role="doc-backlink">Geoms (Geometric Objects)</a><a class="headerlink" href="#geoms-geometric-objects" title="Link to this heading"></a></h3>
<p><strong>geom_histogram(binwidth, bins, aes(y = after_stat(…)))</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Create histograms
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?geom_histogram</span></code> in R console
<em>Key arguments</em>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bins</span></code>: Number of bins (default 30)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">binwidth</span></code>: Width of bins</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aes(y</span> <span class="pre">=</span> <span class="pre">after_stat(density))</span></code>: Scale to density</p></li>
</ul>
<p>Basic histogram:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;lightblue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;black&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Density scaled for normal overlay:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">after_stat</span><span class="p">(</span><span class="n">density</span><span class="p">)),</span>
<span class="w">                </span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;lightblue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.7</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dnorm</span><span class="p">,</span>
<span class="w">               </span><span class="n">args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="p">),</span>
<span class="w">                          </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="p">)),</span>
<span class="w">               </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
<p>By group:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;dodge&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>geom_boxplot(outlier.shape, varwidth)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Box and whisker plots
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?geom_boxplot</span></code> in R console</p>
<p>Basic boxplot:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_boxplot</span><span class="p">()</span>
</pre></div>
</div>
<p>Horizontal orientation:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_boxplot</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">coord_flip</span><span class="p">()</span>
</pre></div>
</div>
<p>With individual points:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_boxplot</span><span class="p">(</span><span class="n">outlier.shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_jitter</span><span class="p">(</span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span>
</pre></div>
</div>
<p>Variable width by sample size:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_boxplot</span><span class="p">(</span><span class="n">varwidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>geom_point(), geom_line()</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Scatterplots and line plots
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?geom_point</span></code> or <code class="docutils literal notranslate"><span class="pre">?geom_line</span></code></p>
<p>Basic scatterplot:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wt</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mpg</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span>
</pre></div>
</div>
<p>Customize points:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wt</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mpg</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.7</span><span class="p">)</span>
</pre></div>
</div>
<p>Add regression line:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wt</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mpg</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;lm&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">se</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Time series (using built-in dataset):</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert to time series format</span>
<span class="nf">data</span><span class="p">(</span><span class="n">AirPassengers</span><span class="p">)</span>
<span class="n">ts_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="w">  </span><span class="n">date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.Date</span><span class="p">(</span><span class="nf">time</span><span class="p">(</span><span class="n">AirPassengers</span><span class="p">)),</span>
<span class="w">  </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">AirPassengers</span><span class="p">)</span>
<span class="p">)</span>

<span class="nf">ggplot</span><span class="p">(</span><span class="n">ts_data</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_line</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>geom_smooth(method, formula, se)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Add smoothed conditional means
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?geom_smooth</span></code> in R console
<em>Key arguments</em>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">method</span></code>: “lm”, “loess”, “gam”</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">se</span></code>: Show confidence band (TRUE/FALSE)</p></li>
</ul>
<p>Linear regression with confidence band:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wt</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mpg</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;lm&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Without confidence band:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wt</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mpg</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;lm&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">se</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
<p>By group:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wt</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mpg</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;lm&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>stat_qq(), stat_qq_line()</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Q-Q plots for normality assessment
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?stat_qq</span></code> in R console</p>
<p>Basic Q-Q plot:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">sample</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="m">100</span><span class="p">)),</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">sample</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sample</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">stat_qq</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">stat_qq_line</span><span class="p">()</span>
</pre></div>
</div>
<p>For residuals:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">wt</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mtcars</span><span class="p">)</span>
<span class="n">res_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">residuals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">residuals</span><span class="p">(</span><span class="n">mod</span><span class="p">))</span>

<span class="nf">ggplot</span><span class="p">(</span><span class="n">res_df</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">sample</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">residuals</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">stat_qq</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">stat_qq_line</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Normal Q-Q Plot of Residuals&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>geom_ribbon(aes(ymin, ymax))</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Area plots with upper/lower bounds
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?geom_ribbon</span></code> in R console
<em>Use case</em>: Custom confidence/prediction bands</p>
<p>Setup for regression bands:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mpg</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">wt</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mtcars</span><span class="p">)</span>
<span class="n">new_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">wt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">wt</span><span class="p">),</span>
<span class="w">                                </span><span class="nf">max</span><span class="p">(</span><span class="n">mtcars</span><span class="o">$</span><span class="n">wt</span><span class="p">),</span>
<span class="w">                                </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">))</span>

<span class="n">pred_ci</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span><span class="w"> </span><span class="n">new_data</span><span class="p">,</span><span class="w"> </span><span class="n">interval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;confidence&quot;</span><span class="p">)</span>
<span class="n">pred_pi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span><span class="w"> </span><span class="n">new_data</span><span class="p">,</span><span class="w"> </span><span class="n">interval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;prediction&quot;</span><span class="p">)</span>

<span class="n">plot_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cbind</span><span class="p">(</span><span class="n">new_data</span><span class="p">,</span>
<span class="w">                  </span><span class="n">ci_fit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pred_ci</span><span class="p">[,</span><span class="s">&quot;fit&quot;</span><span class="p">],</span>
<span class="w">                  </span><span class="n">ci_lwr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pred_ci</span><span class="p">[,</span><span class="s">&quot;lwr&quot;</span><span class="p">],</span>
<span class="w">                  </span><span class="n">ci_upr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pred_ci</span><span class="p">[,</span><span class="s">&quot;upr&quot;</span><span class="p">],</span>
<span class="w">                  </span><span class="n">pi_lwr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pred_pi</span><span class="p">[,</span><span class="s">&quot;lwr&quot;</span><span class="p">],</span>
<span class="w">                  </span><span class="n">pi_upr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pred_pi</span><span class="p">[,</span><span class="s">&quot;upr&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Plot with bands:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">plot_data</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wt</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_ribbon</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">ymin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pi_lwr</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pi_upr</span><span class="p">),</span>
<span class="w">             </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;grey90&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_ribbon</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">ymin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ci_lwr</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ci_upr</span><span class="p">),</span>
<span class="w">             </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;grey70&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_line</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ci_fit</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mtcars</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mpg</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Regression with CI and PI bands&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="plot-customization">
<h3><a class="toc-backref" href="#id37" role="doc-backlink">Plot Customization</a><a class="headerlink" href="#plot-customization" title="Link to this heading"></a></h3>
<p><strong>Labels and Titles</strong></p>
<blockquote>
<div><p>All labels at once:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Main Title&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">subtitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Subtitle&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;X-axis label&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Y-axis label&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Data source: ...&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Individual functions:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Main Title&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;X-axis&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot;Y-axis&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Math expressions:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">latex2exp</span><span class="p">)</span>
<span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">xlab</span><span class="p">(</span><span class="nf">TeX</span><span class="p">(</span><span class="s">&quot;$\\beta_1$&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ylab</span><span class="p">(</span><span class="nf">TeX</span><span class="p">(</span><span class="s">&quot;$\\hat{y}$&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Themes</strong></p>
<blockquote>
<div><p>Built-in themes:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">theme_minimal</span><span class="p">()</span>
<span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">theme_classic</span><span class="p">()</span>
<span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">theme_bw</span><span class="p">()</span>
</pre></div>
</div>
<p>Customize elements:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">theme</span><span class="p">(</span>
<span class="w">  </span><span class="n">axis.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">),</span>
<span class="w">  </span><span class="n">axis.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;bold&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">16</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">),</span>
<span class="w">  </span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;bottom&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Faceting</strong></p>
<blockquote>
<div><p>Separate panels by variable:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">score</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_histogram</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="w"> </span><span class="n">group</span><span class="p">)</span>
</pre></div>
</div>
<p>Grid layout:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">score</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_histogram</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">facet_grid</span><span class="p">(</span><span class="n">platform</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">group</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="tables-reporting">
<h3><a class="toc-backref" href="#id38" role="doc-backlink">Tables &amp; Reporting</a><a class="headerlink" href="#tables-reporting" title="Link to this heading"></a></h3>
<p><strong>knitr::kable(x, caption, digits, format)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Create formatted tables
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?knitr::kable</span></code> in R console</p>
<p>Basic table using built-in data:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">knitr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">kableExtra</span><span class="p">)</span>

<span class="c1"># Summary statistics by species</span>
<span class="n">summary_table</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">aggregate</span><span class="p">(</span><span class="n">Sepal.Length</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iris</span><span class="p">,</span>
<span class="w">                          </span><span class="n">FUN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
<span class="w">                                             </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
<span class="w">                                             </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="nf">kable</span><span class="p">(</span><span class="n">summary_table</span><span class="p">,</span>
<span class="w">      </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Summary Statistics by Species&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="n">digits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Enhanced styling:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">kable</span><span class="p">(</span><span class="n">summary_table</span><span class="p">,</span><span class="w"> </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Iris Summary by Species&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">kable_styling</span><span class="p">(</span><span class="n">bootstrap_options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;striped&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;hover&quot;</span><span class="p">),</span>
<span class="w">               </span><span class="n">full_width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">column_spec</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">bold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>gridExtra::grid.arrange(…)</strong></p>
<blockquote>
<div><p><em>Purpose</em>: Arrange multiple plots
<em>Help</em>: Type <code class="docutils literal notranslate"><span class="pre">?gridExtra::grid.arrange</span></code></p>
<p>Create and arrange plots:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">gridExtra</span><span class="p">)</span>

<span class="n">p1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Distribution of Sepal Length&quot;</span><span class="p">)</span>

<span class="n">p2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Species</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sepal.Length</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="nf">geom_boxplot</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">      </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Sepal Length by Species&quot;</span><span class="p">)</span>

<span class="nf">grid.arrange</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Different layouts:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">grid.arrange</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">,</span><span class="w"> </span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">,</span>
<span class="w">            </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">            </span><span class="n">top</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Four Panel Display&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</section>
</section>
</section>
<section id="best-practices-common-pitfalls">
<h1>Best Practices &amp; Common Pitfalls<a class="headerlink" href="#best-practices-common-pitfalls" title="Link to this heading"></a></h1>
<p>Standard validation workflow:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;data/file.csv&quot;</span><span class="p">)</span>

<span class="nf">str</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="w">                              </span><span class="c1"># Structure check</span>
<span class="nf">head</span><span class="p">(</span><span class="n">d</span><span class="p">);</span><span class="w"> </span><span class="nf">tail</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="w">                    </span><span class="c1"># First/last rows</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="w">                          </span><span class="c1"># Summary statistics</span>
<span class="nf">sapply</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span><span class="w"> </span><span class="c1"># Missing values</span>
<span class="nf">sapply</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">class</span><span class="p">)</span><span class="w">                    </span><span class="c1"># Data types</span>
</pre></div>
</div>
<p><strong>Before t-tests/ANOVA:</strong></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Normality</span>
<span class="nf">hist</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nf">qqnorm</span><span class="p">(</span><span class="n">x</span><span class="p">);</span><span class="w"> </span><span class="nf">qqline</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nf">shapiro.test</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># Equal variances</span>
<span class="nf">var.test</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span>
<span class="nf">boxplot</span><span class="p">(</span><span class="n">score</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">group</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Before regression:</strong></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">)</span>

<span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>
</pre></div>
</div>
<p>Check for:</p>
<ol class="arabic simple">
<li><p>Linearity (Residuals vs Fitted)</p></li>
<li><p>Normality (Q-Q plot)</p></li>
<li><p>Homoscedasticity (Scale-Location)</p></li>
<li><p>Influential points (Residuals vs Leverage)</p></li>
</ol>
<ol class="arabic">
<li><p><strong>Factor to numeric conversion</strong></p>
<p>Wrong (returns level indices):</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="n">f</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;4&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;6&quot;</span><span class="p">))</span>
<span class="gp">&gt; </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">[1] 1 2 3</span>
</pre></div>
</div>
<p>Correct:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
<span class="go">[1] 2 4 6</span>
</pre></div>
</div>
</li>
<li><p><strong>Missing data handling</strong></p>
<p>Wrong (silently propagates NA):</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">mean</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">))</span>
<span class="go">[1] NA</span>
</pre></div>
</div>
<p>Correct:</p>
<div class="highlight-rconsole notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt; </span><span class="nf">mean</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="go">[1] 2.333333</span>
</pre></div>
</div>
</li>
<li><p><strong>Confidence vs Prediction intervals</strong></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># CI: Where is the mean?</span>
<span class="nf">predict</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="p">,</span><span class="w"> </span><span class="n">interval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;confidence&quot;</span><span class="p">)</span>

<span class="c1"># PI: Where is a new observation?</span>
<span class="nf">predict</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="p">,</span><span class="w"> </span><span class="n">interval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;prediction&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Prediction intervals are always wider!</p>
</li>
<li><p><strong>Multiple testing without adjustment</strong></p>
<p>After ANOVA, use Tukey HSD:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">TukeyHSD</span><span class="p">(</span><span class="n">aov_fit</span><span class="p">)</span>
</pre></div>
</div>
<p>This adjusts for multiple comparisons automatically.</p>
</li>
</ol>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Setup</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">knitr</span><span class="p">)</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>

<span class="c1"># 2. Import and validate</span>
<span class="n">d</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;data/file.csv&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">stringsAsFactors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="nf">str</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

<span class="c1"># 3. Clean</span>
<span class="n">d_clean</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">d</span><span class="p">[</span><span class="nf">complete.cases</span><span class="p">(</span><span class="n">d</span><span class="p">),</span><span class="w"> </span><span class="p">]</span>

<span class="c1"># 4. Explore</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">d_clean</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme_minimal</span><span class="p">()</span>

<span class="c1"># 5. Model</span>
<span class="n">mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d_clean</span><span class="p">)</span>

<span class="c1"># 6. Diagnose</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">)</span>

<span class="c1"># 7. Report</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span>
<span class="nf">kable</span><span class="p">(</span><span class="nf">tidy</span><span class="p">(</span><span class="n">mod</span><span class="p">),</span><span class="w"> </span><span class="n">digits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span>
</pre></div>
</div>
<section id="appendix-quick-links">
<h2>Appendix: Quick Links<a class="headerlink" href="#appendix-quick-links" title="Link to this heading"></a></h2>
<section id="setup">
<h3>Setup<a class="headerlink" href="#setup" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://treese41528.github.io/STAT350/Computer_Assignment_Tutorials/Local_Install.html">Local Install</a></p></li>
<li><p><a class="reference external" href="https://treese41528.github.io/STAT350/Computer_Assignment_Tutorials/Scholar-Access.html">Scholar Access</a></p></li>
</ul>
</section>
<section id="assignments">
<h3>Assignments<a class="headerlink" href="#assignments" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://treese41528.github.io/STAT350/Computer_Assignment_Tutorials/Computer_Assignment_1_Tutorial.html">CA1 Tutorial</a> — R/RStudio basics</p></li>
<li><p><a class="reference external" href="https://treese41528.github.io/STAT350/Computer_Assignment_Tutorials/Computer_Assignment_2_Graphical_and_Numerical_Summaries_Tutorial.html">CA2 Tutorial</a> — EDA and summaries</p></li>
<li><p><a class="reference external" href="https://treese41528.github.io/STAT350/Computer_Assignment_Tutorials/Computer_Assignment_3_BasicHypothesisTesting_and_subsetting_Tutorial.html">CA3 Tutorial</a> — Hypothesis testing</p></li>
<li><p><a class="reference external" href="https://treese41528.github.io/STAT350/Computer_Assignment_Tutorials/Computer_Assignment_4_TwoSampleProcedures_Tutorial.html">CA4 Tutorial</a> — Two-sample procedures</p></li>
<li><p><a class="reference external" href="https://treese41528.github.io/STAT350/Computer_Assignment_Tutorials/Computer_Assignment_5_ANOVA_Tutorial.html">CA5 Tutorial</a> — ANOVA</p></li>
<li><p><a class="reference external" href="https://treese41528.github.io/STAT350/Computer_Assignment_Tutorials/Computer_Assignment_6_SimpleLinearRegression_Tutorial.html">CA6 Tutorial</a> — Linear regression</p></li>
</ul>
</section>
<section id="getting-help">
<h3>Getting Help<a class="headerlink" href="#getting-help" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>In R: <code class="docutils literal notranslate"><span class="pre">?function_name</span></code> or <code class="docutils literal notranslate"><span class="pre">help(function_name)</span></code></p></li>
<li><p>Examples: <code class="docutils literal notranslate"><span class="pre">example(function_name)</span></code></p></li>
<li><p>Online: <a class="reference external" href="https://www.rdocumentation.org/">https://www.rdocumentation.org/</a></p></li>
<li><p>Stack Overflow: <a class="reference external" href="https://stackoverflow.com/questions/tagged/r">https://stackoverflow.com/questions/tagged/r</a></p></li>
</ul>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../worksheets/worksheet_materials/worksheet22.html" class="btn btn-neutral float-left" title="&lt;no title&gt;" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../chapter1/index.html" class="btn btn-neutral float-right" title="1. Introduction to Statistics" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>