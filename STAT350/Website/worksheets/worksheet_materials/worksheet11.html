

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Worksheet 11: The Central Limit Theorem &mdash; STAT 350</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=da1f3f80" />
      <link rel="stylesheet" type="text/css" href="../../_static/credits.css?v=f7efa099" />

  
    <link rel="canonical" href="https://treese41528.github.io/STAT350/Website/worksheets/worksheet_materials/worksheet11.html" />
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../../_static/custom.js?v=3cc62c56"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Worksheet 12: Point Estimators and Unbiased Estimation" href="worksheet12.html" />
    <link rel="prev" title="Worksheet 10: Checking Normality and Introduction to Sampling Distributions" href="worksheet10.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            STAT 350: Introduction to Statistics
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Orientation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../course-intro.html">Course Introduction &amp; Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../course-intro.html#why-statistics-why-now">Why Statistics? Why Now?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-intro.html#course-roadmap">Course Roadmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-intro.html#a-clear-note-on-using-ai">A Clear Note on Using AI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-intro.html#getting-started-a-checklist">Getting Started: A Checklist</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../course-intro.html#homework-assignments-on-edfinity">Homework Assignments on Edfinity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../course-intro.html#miscellaneous-tips">Miscellaneous Tips</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Exam Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../exams/exams_index.html">Course Examinations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../exams/exams_index.html#general-exam-policies">General Exam Policies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../exams/exam_materials/exam1.html">Exam 1</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../exams/exam_materials/exam1.html#exam-locations-by-section">Exam Locations by Section</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../exams/exam_materials/exam1.html#exam-coverage">Exam Coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../exams/exam_materials/exam1.html#preparation-materials">Preparation Materials</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../exams/exam_materials/exam2.html">Exam 2</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../exams/exam_materials/exam2.html#exam-locations-by-section">Exam Locations by Section</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../exams/exam_materials/exam2.html#exam-coverage">Exam Coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../exams/exam_materials/exam2.html#additional-resources">Additional Resources</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../exams/exam_materials/exam2.html#preparation-materials">Preparation Materials</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../exams/exam_materials/final_exam.html">Final Exam</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../exams/exam_materials/final_exam.html#about-the-final-exam">About the Final Exam</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../exams/exam_materials/final_exam.html#required-review-materials">Required Review Materials</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../exams/exam_materials/final_exam.html#post-exam-2-preparation-materials">Post Exam 2 Preparation Materials</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../exams/exam_materials/final_exam.html#study-guide-resource">Study Guide Resource</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Worksheets</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../worksheets_index.html">Course Worksheets</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../worksheets_index.html#pedagogical-philosophy">Pedagogical Philosophy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../worksheets_index.html#implementation-guidelines">Implementation Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../worksheets_index.html#why-these-worksheets-matter">Why These Worksheets Matter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../worksheets_index.html#the-critical-role-of-simulation">The Critical Role of Simulation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../worksheets_index.html#worksheets">Worksheets</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="worksheet1.html">Worksheet 1: Exploring Data with R</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet1.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet1.html#part-1-loading-and-understanding-the-dataset">Part 1: Loading and Understanding the Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet1.html#part-2-initial-data-exploration">Part 2: Initial Data Exploration</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet1.html#part-3-frequency-tables">Part 3: Frequency Tables</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet1.html#part-4-univariate-analysis-of-uptake">Part 4: Univariate Analysis of Uptake</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet1.html#part-5-grouped-statistics-with-tapply">Part 5: Grouped Statistics with tapply</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet1.html#part-6-comparative-visualization-by-type">Part 6: Comparative Visualization by Type</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet1.html#part-7-exploring-the-concentration-effect">Part 7: Exploring the Concentration Effect</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet1.html#part-8-advanced-visualization-with-multiple-categories">Part 8: Advanced Visualization with Multiple Categories</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet1.html#reference-key-functions">Reference: Key Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet1.html#troubleshooting-guide">Troubleshooting Guide</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet1.html#additional-resources">Additional Resources</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet2.html">Worksheet 2: Set Theory and Probability Fundamentals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet2.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet2.html#part-1-set-theory-foundations">Part 1: Set Theory Foundations</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet2.html#part-2-probability-axioms">Part 2: Probability Axioms</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet2.html#part-3-applying-probability-rules">Part 3: Applying Probability Rules</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet2.html#part-4-the-inclusion-exclusion-principle">Part 4: The Inclusion-Exclusion Principle</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet2.html#key-takeaways">Key Takeaways</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet2.html#submission-guidelines">Submission Guidelines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet3.html">Worksheet 3: Conditional Probability and Bayes’ Theorem</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet3.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet3.html#part-1-understanding-conditional-probability">Part 1: Understanding Conditional Probability</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet3.html#part-2-tree-diagrams-and-sequential-sampling">Part 2: Tree Diagrams and Sequential Sampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet3.html#part-3-bayes-theorem-and-sequential-updating">Part 3: Bayes’ Theorem and Sequential Updating</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet3.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet4.html">Worksheet 4: Independence and Random Variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet4.html#part-1-independence-property">Part 1: Independence Property</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet4.html#part-2-independent-vs-mutually-exclusive-events">Part 2: Independent vs. Mutually Exclusive Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet4.html#part-3-introduction-to-random-variables">Part 3: Introduction to Random Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet4.html#part-4-probability-mass-functions">Part 4: Probability Mass Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet4.html#part-5-joint-probability-mass-functions">Part 5: Joint Probability Mass Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet4.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet5.html">Worksheet 5: Expected Value and Variance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet5.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet5.html#part-1-expected-value-and-lotus">Part 1: Expected Value and LOTUS</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet5.html#part-2-variance-and-its-properties">Part 2: Variance and Its Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet5.html#part-3-sums-of-random-variables">Part 3: Sums of Random Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet5.html#part-4-joint-probability-mass-functions">Part 4: Joint Probability Mass Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet5.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet6.html">Worksheet 6: Named Discrete Distributions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet6.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet6.html#part-1-the-bernoulli-and-binomial-distributions">Part 1: The Bernoulli and Binomial Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet6.html#the-binomial-distribution">The Binomial Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet6.html#part-2-the-poisson-distribution">Part 2: The Poisson Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet6.html#part-3-other-named-discrete-distributions">Part 3: Other Named Discrete Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet6.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet7.html">Worksheet 7: Continuous Random Variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet7.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet7.html#part-1-probability-density-functions">Part 1: Probability Density Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet7.html#part-2-finding-constants-for-valid-pdfs">Part 2: Finding Constants for Valid PDFs</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet7.html#part-3-expected-value-and-variance">Part 3: Expected Value and Variance</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet7.html#part-4-cumulative-distribution-functions">Part 4: Cumulative Distribution Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet7.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet8.html">Worksheet 8: Uniform and Exponential Distributions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet8.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet8.html#part-1-the-uniform-distribution">Part 1: The Uniform Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet8.html#part-2-the-exponential-distribution">Part 2: The Exponential Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet8.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet9.html">Worksheet 9: The Normal Distribution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet9.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet9.html#part-1-the-normal-distribution">Part 1: The Normal Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet9.html#part-2-the-standard-normal-table">Part 2: The Standard Normal Table</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet9.html#part-3-z-score-transformation">Part 3: Z-Score Transformation</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet9.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet10.html">Worksheet 10: Checking Normality and Introduction to Sampling Distributions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet10.html#part-1-checking-normality">Part 1: Checking Normality</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet10.html#part-2-introduction-to-sampling-distributions">Part 2: Introduction to Sampling Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet10.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Worksheet 11: The Central Limit Theorem</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tutorial-generating-the-sampling-distribution-of-bar-x">Tutorial: Generating the Sampling Distribution of <span class="math notranslate nohighlight">\(\bar{X}\)</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="#part-1-exploring-clt-with-skewed-distributions">Part 1: Exploring CLT with Skewed Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#part-2-application-of-the-clt">Part 2: Application of the CLT</a></li>
<li class="toctree-l4"><a class="reference internal" href="#part-3-beyond-mean-and-sum">Part 3: Beyond Mean and Sum</a></li>
<li class="toctree-l4"><a class="reference internal" href="#part-4-exploring-clt-generalizability-with-ai-assistance-exploration">Part 4: Exploring CLT Generalizability with AI Assistance (Exploration)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet12.html">Worksheet 12: Point Estimators and Unbiased Estimation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet12.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet12.html#part-1-estimating-parameters-of-the-exponential-distribution">Part 1: Estimating Parameters of the Exponential Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet12.html#part-2-estimating-the-maximum-of-a-uniform-distribution">Part 2: Estimating the Maximum of a Uniform Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet12.html#part-3-minimum-variance-unbiased-estimators-mvue">Part 3: Minimum Variance Unbiased Estimators (MVUE)</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet12.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet13.html">Worksheet 13: Introduction to Confidence Intervals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet13.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet13.html#part-1-pivotal-quantities-and-deriving-confidence-intervals">Part 1: Pivotal Quantities and Deriving Confidence Intervals</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet13.html#part-2-sample-size-determination">Part 2: Sample Size Determination</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet13.html#part-3-one-sided-confidence-bounds">Part 3: One-Sided Confidence Bounds</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet13.html#part-4-confidence-intervals-when-is-unknown">Part 4: Confidence Intervals When σ is Unknown</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet13.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Computer Assignments</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../R_computerAssignments/r_computer_assignments.html">R / RStudio Guide and Function Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../R_computerAssignments/r_computer_assignments.html#overview">Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_getting_started.html">Getting Started with R and RStudio</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../R_computerAssignments/r_getting_started.html#quick-start-r-rstudio-setup">Quick Start: R / RStudio Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../R_computerAssignments/r_getting_started.html#rstudio-orientation">RStudio Orientation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../R_computerAssignments/r_getting_started.html#packages-libraries-course-set">Packages / Libraries (Course Set)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../R_computerAssignments/r_getting_started.html#getting-started-with-swirl">Getting Started with swirl</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../R_computerAssignments/r_getting_started.html#alternative-r-learning-resources">Alternative R Learning Resources</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_quick_reference.html">Quick Reference Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_tutorials_assignments.html">Computer Assignments and Tutorials</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../R_computerAssignments/r_tutorials_assignments.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../R_computerAssignments/r_tutorials_assignments.html#assignment-structure-by-session">Assignment Structure by Session</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_tutorials_assignments.html#assignment-tutorials-links">Assignment Tutorials (Links)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_tutorials_assignments.html#course-pipeline-at-a-glance">Course Pipeline (At a Glance)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_function_reference_part1.html">Function Reference Part 1</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../R_computerAssignments/r_function_reference_part1.html#data-i-o-housekeeping">Data I/O &amp; Housekeeping</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../R_computerAssignments/r_function_reference_part1.html#data-structures-creation">Data Structures &amp; Creation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../R_computerAssignments/r_function_reference_part1.html#data-wrangling-utilities">Data Wrangling &amp; Utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../R_computerAssignments/r_function_reference_part1.html#descriptive-statistics-correlation">Descriptive Statistics &amp; Correlation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../R_computerAssignments/r_function_reference_part1.html#probability-distributions">Probability &amp; Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../R_computerAssignments/r_function_reference_part1.html#simulation-functions">Simulation Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_function_reference_part2.html">Function Reference Part 2: Inference Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../R_computerAssignments/r_function_reference_part2.html#diagnostic-plots-for-assumptions">Diagnostic Plots for Assumptions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_ggplot2_guide.html">Graphics (ggplot2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_ggplot2_guide.html#core-components">Core Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_ggplot2_guide.html#geoms-geometric-objects">Geoms (Geometric Objects)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_ggplot2_guide.html#categorical-data-visualization">Categorical Data Visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_ggplot2_guide.html#plot-customization">Plot Customization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_ggplot2_guide.html#tables-reporting">Tables &amp; Reporting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_best_practices.html">Best Practices &amp; Common Pitfalls</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../R_computerAssignments/r_best_practices.html#data-import-validation">Data Import &amp; Validation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../R_computerAssignments/r_best_practices.html#statistical-assumptions">Statistical Assumptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../R_computerAssignments/r_best_practices.html#common-errors-to-avoid">Common Errors to Avoid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../R_computerAssignments/r_best_practices.html#workflow-template">Workflow Template</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_datasets.html">Course Datasets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../R_computerAssignments/r_datasets.html#primary-course-dataset-apprating">Primary Course Dataset - AppRating</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../R_computerAssignments/r_datasets.html#tutorial-support-datasets">Tutorial Support Datasets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../R_computerAssignments/r_datasets.html#loading-datasets-in-r">Loading Datasets in R</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../R_computerAssignments/r_datasets.html#built-in-r-datasets-used-in-course">Built-in R Datasets Used in Course</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../R_computerAssignments/r_datasets.html#data-download-and-organization">Data Download and Organization</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Chapters</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../chapter1/index.html">1. Introduction to Statistics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter1/lectures/1-1-intro.html">1.1. What Is Statistics?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter1/lectures/1-2-probability-inference.html">1.2. Probability &amp; Statistical Inference: How Are They Associated?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chapter2/index.html">2. Graphical Summaries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter2/lectures/2-1-understanding-the-structure-of-data-set.html">2.1. Data Set Structure and Variable Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter2/lectures/2-2-tools-for-categorical-qualitative-data.html">2.2. Tools for Categorical (Qualitative) Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter2/lectures/2-3-tools-for-numerical-quantitative-data.html">2.3. Tools for Numerical (Quantitative) Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter2/lectures/2-4-exploring-quantitative-distributions-modality-shape-and-outliers.html">2.4. Exploring Quantitative Distributions: Modality, Skewness &amp; Outliers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chapter3/index.html">3. Numerical Summaries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter3/lectures/3-1-intro-numerical-summaries.html">3.1. Introduction to Numerical Summaries: Notation and Terminology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter3/lectures/3-2-measures-of-central-tendency.html">3.2. Measures of Central Tendency</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter3/lectures/3-3-measures-of-variability-range-variance-and-SD.html">3.3. Measures of Variability - Range, Variance, and Standard Deviation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter3/lectures/3-4-measures-of-variability-IQR-and-5-number-summary.html">3.4. Measures of Variability - Interquartile Range and Five-Number Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter3/lectures/3-5-choosing-the-right-measure-resistance-to-extreme-values.html">3.5. Choosing the Right Measure &amp; Comparing Measures Across Data Sets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chapter4/index.html">4. Probability</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter4/lectures/4-1-basic-set-theory.html">4.1. Basic Set Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter4/lectures/4-2-probability.html">4.2. Probability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter4/lectures/4-3-conditional-probability.html">4.3. Conditional Probability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter4/lectures/4-4-law-of-total-probability-and-bayes-rule.html">4.4. Law of Total Probability and Bayes’ Rule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter4/lectures/4-5-bayes-update-rule-example.html">4.5. Sequential Bayesian Updating</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter4/lectures/4-6-independence-of-events.html">4.6. Independence of Events</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chapter5/index.html">5. Discrete Distributions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter5/lectures/5-1-discrete-rvs-and-pmfs.html">5.1. Discrete Random Variables and Probability Mass Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter5/lectures/5-2-joint-pmfs.html">5.2. Joint Probability Mass Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter5/lectures/5-3-expected-value-of-discrete-rv.html">5.3. Expected Value of a Discrete Random Variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter5/lectures/5-4-variance-of-discrete-rv.html">5.4. Varianace of a Discrete Random Variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter5/lectures/5-5-covariance-of-dependent-rvs.html">5.5. Covariance of Dependent Random Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter5/lectures/5-6-binomial-distribution.html">5.6. The Binomial Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter5/lectures/5-7-poisson-distribution.html">5.7. The Poisson Distribution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chapter6/index.html">6. Continuous Distributions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter6/lectures/6-1-continuous-rvs-and-pdfs.html">6.1. Continuous Random Variables and Probability Density Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter6/lectures/6-2-expected-value-and-variance-of-cts-rvs.html">6.2. Expected Value and Variance of Continuous Random Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter6/lectures/6-3-cdfs.html">6.3. Cumulative Distribution Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter6/lectures/6-4-normal-distribution.html">6.4. Normal Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter6/lectures/6-5-uniform-distribution.html">6.5. Uniform Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter6/lectures/6-6-exponential-distribution.html">6.6. Exponential Distribution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chapter7/index.html">7. Sampling Distributions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter7/lectures/7-1-statistics-and-sampling-distributions.html">7.1. Statistics and Sampling Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter7/lectures/7-2-sampling-distribution-for-the-sample-mean.html">7.2. Sampling Distribution for the Sample Mean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter7/lectures/7-3-clt.html">7.3. The Central Limit Theorem (CLT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter7/lectures/7-4-discret-rvs-and-clt.html">7.4. Understanding Binomial and Poisson Distributions through CLT</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chapter8/index.html">8. Experimental Design</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter8/lectures/8-1-experimental-and-sampling-designs.html">8.1. Experimental and Sampling Designs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter8/lectures/8-2-experimental-design-principles.html">8.2. Experimental Design Principles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter8/lectures/8-3-basic-types-of-experimental-design.html">8.3. Basic Types of Experimental Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter8/lectures/8-4-addressing-potential-flaws-in-experimental-design.html">8.4. Addressing Potential Flaws in Experimental Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter8/lectures/8-5-examples-of-experimental-design.html">8.5. Examples of Experimental Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter8/lectures/8-6-sampling-design.html">8.6. Sampling Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter8/lectures/8-7-sampling-bias.html">8.7. Sampling Bias</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chapter9/index.html">9. Confidence Intervals and Bounds</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter9/lectures/9-1-intro-statistical-inference.html">9.1. Introduction to Statistical Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter9/lectures/9-2-ci-sigma-known.html">9.2. Confidence Intervals for the Population Mean, When σ is Known</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter9/lectures/9-3-precision-of-ci-and-sample-size-calculation.html">9.3. Precision of a Confidence Interval and Sample Size Calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter9/lectures/9-4-cb-sigma-known.html">9.4. Confidence Bounds for the Poulation Mean When σ is Known</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter9/lectures/9-5-ci-cb-sigma-unknown.html">9.5. Confidence Intervals and Bounds When σ is Unknown</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chapter10/index.html">10. Hypothesis Testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter10/lectures/10-1-ht-errors-and-power.html">10.1. Type I Error, Type II Error, and Power</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter10/lectures/10-2-ht-for-mean-sigma-known.html">10.2. Hypothesis Test for the Population Mean When σ is Known</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter10/lectures/10-3-ht-for-mean-sigma-unknown.html">10.3. Hypothesis Test for the Population Mean When σ Is Unknown</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter10/lectures/10-4-pvalue-significance-conclusion.html">10.4. P-values, Statistical Significance, and Formal Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chapter11/index.html">11. Two Sample Procedures</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter11/lectures/11-1-ci-ht-two-samples.html">11.1. Confidence Interval/Bound and Hypothesis Test for Two Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter11/lectures/11-2-comparing-two-means-independent-sigmas-known.html">11.2. Comparing the Means of Two Independent Populations - Population Variances Are Known</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter11/lectures/11-3-comparing-two-means-independent-pooled.html">11.3. Comparing the Means of Two Independent Populations - Pooled Variance Estimator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter11/lectures/11-4-comparing-two-means-independent-unpooled.html">11.4. Comparing the Means of Two Independent Populations - No Equal Variance Assumption</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter11/lectures/11-5-mean-of-paired-differences-two-dependent-populations.html">11.5. Analyzing the Mean of Paired Differences Between two Dependent Populations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chapter12/index.html">12. ANOVA</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter12/lectures/12-1-intro-one-way-anova.html">12.1. Introduction to One-Way ANOVA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter12/lectures/12-2-sources-of-variability.html">12.2. Different Sources of Variability in an ANOVA Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter12/lectures/12-3-f-test-and-relationship-to-t-test.html">12.3. One-Way ANOVA F-Test and Its Relationship to Two-Sample t-Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter12/lectures/12-4-multiple-comparison-procedures-family-wise-error-rates.html">12.4. Multiple Comparison Procedures and Family-Wise Error Rates</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chapter13/index.html">13. Simple Linear Regression</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter13/lectures/13-1-intro-to-lr-correlation-scatter-plots.html">13.1. Introduction to Linear Regression: Correlation and Scatter Plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter13/lectures/13-2-simple-linear-regression.html">13.2. Simple Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter13/lectures/13-3-diagnostics-inference.html">13.3. Model Diagnostics and Statistical Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter13/lectures/13-4-prediction-robustness.html">13.4. Prediction, Robustness, and Applied Examples</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">STAT 350: Introduction to Statistics</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../worksheets_index.html">Course Worksheets</a></li>
      <li class="breadcrumb-item active">Worksheet 11: The Central Limit Theorem</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/worksheets/worksheet_materials/worksheet11.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="worksheet-11-the-central-limit-theorem">
<span id="worksheet11"></span><h1>Worksheet 11: The Central Limit Theorem<a class="headerlink" href="#worksheet-11-the-central-limit-theorem" title="Link to this heading"></a></h1>
<div class="info admonition">
<p class="admonition-title">Learning Objectives</p>
<ul class="simple">
<li><p>Understand the Central Limit Theorem and its implications</p></li>
<li><p>Master the simulation process for generating sampling distributions</p></li>
<li><p>Explore how sampling distributions evolve with increasing sample size</p></li>
<li><p>Apply the CLT to compute probabilities for sample means and sums</p></li>
<li><p>Investigate the rate of convergence for different population distributions</p></li>
<li><p><strong>Implement CLT simulations and visualizations in R</strong></p></li>
</ul>
</div>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h2>
<p>In the previous worksheet, we studied sampling distributions by focusing on cases where the population itself was Normally distributed. We observed that when drawing random samples from a Normal population, the sample mean and sample sum remained Normally distributed regardless of sample size. However, real-world data often do not follow a Normal distribution, raising an important question: <em>What happens to the sampling distribution of the sample mean when the population itself is not Normal?</em></p>
<p>The <strong>Central Limit Theorem (CLT)</strong> answers this question. It states that if we take independent random samples of size <span class="math notranslate nohighlight">\(n\)</span> from any population with finite mean <span class="math notranslate nohighlight">\(\mu\)</span> and finite standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span>, then as <span class="math notranslate nohighlight">\(n\)</span> increases, the standardized sample mean</p>
<div class="math notranslate nohighlight">
\[Z_n = \frac{\bar{X} - \mu}{\sigma/\sqrt{n}}\]</div>
<p>and the standardized sample sum</p>
<div class="math notranslate nohighlight">
\[Z_n = \frac{S_n - n \cdot \mu}{\sigma \cdot \sqrt{n}}\]</div>
<p>converge “in distribution” to a standard Normal random variable:</p>
<div class="math notranslate nohighlight">
\[Z_n \rightarrow N(0,1), \text{ as } n \rightarrow \infty\]</div>
<p>This implies that for sufficiently large <span class="math notranslate nohighlight">\(n\)</span>, the sampling distributions can be approximated using the Normal distribution:</p>
<div class="math notranslate nohighlight">
\[\bar{X} \overset{\sim}{\approx} N\left(\mu, \frac{\sigma}{\sqrt{n}}\right)\]</div>
<div class="math notranslate nohighlight">
\[S_n \overset{\sim}{\approx} N\left(n \cdot \mu, \sigma \cdot \sqrt{n}\right)\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <strong>rate of convergence</strong> depends on the shape of the original population. If the population is already Normal, the sample mean follows a Normal distribution for any sample size. However, for skewed or heavy-tailed populations, a larger <span class="math notranslate nohighlight">\(n\)</span> is required for the Normal approximation to hold.</p>
</div>
<p>The CLT is fundamental because it allows us to make probabilistic statements about sample means, making statistical inference possible even when the original data are not Normally distributed.</p>
</section>
<section id="tutorial-generating-the-sampling-distribution-of-bar-x">
<h2>Tutorial: Generating the Sampling Distribution of <span class="math notranslate nohighlight">\(\bar{X}\)</span><a class="headerlink" href="#tutorial-generating-the-sampling-distribution-of-bar-x" title="Link to this heading"></a></h2>
<p>Before exploring the Central Limit Theorem with different distributions, you need to understand how to generate observations from the sampling distribution of <span class="math notranslate nohighlight">\(\bar{X}\)</span>. This tutorial will guide you through the step-by-step process.</p>
<div class="info admonition">
<p class="admonition-title">Key Concepts Review</p>
<p>Before beginning, ensure you understand these concepts:</p>
<ul class="simple">
<li><p><strong>Population</strong>: The entire group from which we sample, characterized by distribution parameters</p></li>
<li><p><strong>Sample</strong>: A subset of size <span class="math notranslate nohighlight">\(n\)</span> drawn from the population</p></li>
<li><p><strong>Sampling Distribution</strong>: The probability distribution of a statistic (like <span class="math notranslate nohighlight">\(\bar{X}\)</span>) across all possible samples</p></li>
<li><p><strong>Central Limit Theorem</strong>: States that <span class="math notranslate nohighlight">\(\bar{X}\)</span> approaches a Normal distribution as <span class="math notranslate nohighlight">\(n\)</span> increases</p></li>
</ul>
</div>
<section id="the-simulation-process-overview">
<h3>The Simulation Process Overview<a class="headerlink" href="#the-simulation-process-overview" title="Link to this heading"></a></h3>
<p>To generate the sampling distribution of <span class="math notranslate nohighlight">\(\bar{X}\)</span>, we need to:</p>
<ol class="arabic simple">
<li><p>Take many samples of size <span class="math notranslate nohighlight">\(n\)</span> from the population</p></li>
<li><p>Calculate <span class="math notranslate nohighlight">\(\bar{x}\)</span> for each sample</p></li>
<li><p>Examine the distribution of these sample means</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We denote <strong>SRS = 1500</strong> as the number of repeated samples we’ll take. Each sample contains <span class="math notranslate nohighlight">\(n\)</span> observations.</p>
</div>
</section>
<section id="step-by-step-example-standard-normal-distribution">
<h3>Step-by-Step Example: Standard Normal Distribution<a class="headerlink" href="#step-by-step-example-standard-normal-distribution" title="Link to this heading"></a></h3>
<p>Let’s assume <span class="math notranslate nohighlight">\(X \sim \text{Normal}(\mu=0, \sigma=1)\)</span> and we want to explore the sampling distribution of <span class="math notranslate nohighlight">\(\bar{X}\)</span> for sample size <span class="math notranslate nohighlight">\(n=10\)</span>.</p>
<p><strong>Step 1: Define the Parameters</strong></p>
<p>First, we define how many samples we’ll take and the size of each sample.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set parameters</span>
<span class="n">SRS</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1500</span><span class="w">  </span><span class="c1"># Number of repeated samples (do not change)</span>
<span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">10</span><span class="w">      </span><span class="c1"># Sample size for each sample</span>

<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;We will take&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">SRS</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;samples, each of size&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Total observations needed:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">SRS</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Step 2: Generate All Required Observations</strong></p>
<p>For each of the 1500 observations of <span class="math notranslate nohighlight">\(\bar{X}\)</span>, we must first obtain <span class="math notranslate nohighlight">\(n\)</span> observations from <span class="math notranslate nohighlight">\(X\)</span> and take their mean. Thus, we need <span class="math notranslate nohighlight">\(\text{SRS} \times n\)</span> total observations from <span class="math notranslate nohighlight">\(X\)</span>.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate all observations at once</span>
<span class="n">data.vec</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="n">SRS</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>

<span class="c1"># Check the length</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Length of data.vec:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">data.vec</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>What we have now:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>data.vec = [X₁, X₂, X₃, ..., X₁₅₀₀₀]

This is a single vector containing SRS × n = 15,000 random observations
</pre></div>
</div>
<p><strong>Step 3: Organize Data into Samples</strong></p>
<p>We now split <code class="docutils literal notranslate"><span class="pre">data.vec</span></code> into SRS = 1500 rows, each of size <span class="math notranslate nohighlight">\(n = 10\)</span>. Each row will represent one sample.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reorganize into matrix where each row is one sample</span>
<span class="n">data.mat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">matrix</span><span class="p">(</span><span class="n">data.vec</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SRS</span><span class="p">)</span>

<span class="c1"># Check dimensions</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Dimensions of data.mat:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">dim</span><span class="p">(</span><span class="n">data.mat</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Number of rows (samples):&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">nrow</span><span class="p">(</span><span class="n">data.mat</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Number of columns (n):&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">ncol</span><span class="p">(</span><span class="n">data.mat</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>What we have now:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>data.mat:

                 n observations
           ┌──────────────────────────────┐
     Row 1 │ X₁,₁   X₁,₂   ...   X₁,₁₀    │ ← Sample 1
     Row 2 │ X₂,₁   X₂,₂   ...   X₂,₁₀    │ ← Sample 2
SRS   ...  │          ...                 │
     Row   │                              │
     1500  │ X₁₅₀₀,₁ X₁₅₀₀,₂ ... X₁₅₀₀,₁₀ │ ← Sample 1500
           └──────────────────────────────┘
</pre></div>
</div>
<div class="tip admonition">
<p class="admonition-title">Understanding the matrix() Function</p>
<p>The <code class="docutils literal notranslate"><span class="pre">matrix()</span></code> function takes a vector and reorganizes it into a matrix:</p>
<ul class="simple">
<li><p><strong>Primary input</strong>: A vector of data</p></li>
<li><p><strong>nrow</strong>: Number of rows (samples)</p></li>
<li><p><strong>ncol</strong>: Number of columns (can be specified instead of nrow)</p></li>
<li><p><strong>Behavior</strong>: Fills the matrix column-by-column by default</p></li>
</ul>
<p>When the vector length is a multiple of <code class="docutils literal notranslate"><span class="pre">nrow</span></code>, specifying <code class="docutils literal notranslate"><span class="pre">nrow</span></code> automatically determines <code class="docutils literal notranslate"><span class="pre">ncol</span></code>.</p>
</div>
<p><strong>Step 4: Calculate Sample Means</strong></p>
<p>Now we calculate the mean of each row (each sample) to get our 1500 sample means.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate mean of each row</span>
<span class="n">avg</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="n">data.mat</span><span class="p">,</span><span class="w"> </span><span class="n">MARGIN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">FUN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span>

<span class="c1"># Check the result</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Length of avg:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">avg</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;First 15 sample means:\n&quot;</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">head</span><span class="p">(</span><span class="n">avg</span><span class="p">,</span><span class="w"> </span><span class="m">15</span><span class="p">))</span>
</pre></div>
</div>
<p>What we have now:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>avg = [x̄₁, x̄₂, x̄₃, ..., x̄₁₅₀₀]

A vector of 1500 sample means, one from each sample
</pre></div>
</div>
<div class="tip admonition">
<p class="admonition-title">Understanding the apply() Function</p>
<p>The <code class="docutils literal notranslate"><span class="pre">apply()</span></code> function applies a function to rows or columns of a matrix:</p>
<ul class="simple">
<li><p><strong>Primary input</strong>: A matrix</p></li>
<li><p><strong>MARGIN = 1</strong>: Apply function to each row</p></li>
<li><p><strong>MARGIN = 2</strong>: Apply function to each column</p></li>
<li><p><strong>FUN</strong>: The function to apply (e.g., <code class="docutils literal notranslate"><span class="pre">mean</span></code>, <code class="docutils literal notranslate"><span class="pre">sum</span></code>, <code class="docutils literal notranslate"><span class="pre">var</span></code>)</p></li>
</ul>
<p>Result: A vector where each element is the function applied to one row (or column)</p>
</div>
<p><strong>Step 5: Calculate Experimental Statistics</strong></p>
<p>Now we can calculate the mean and standard deviation of our 1500 sample means and compare them to theoretical values.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate experimental mean and SD of the sample means</span>
<span class="n">mean_of_sample_means</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">avg</span><span class="p">)</span>
<span class="n">sd_of_sample_means</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">avg</span><span class="p">)</span>

<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Experimental mean of sample means:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">mean_of_sample_means</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Experimental SD of sample means:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">sd_of_sample_means</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>

<span class="c1"># Compare with theoretical values</span>
<span class="n">theoretical_mean</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span><span class="w">  </span><span class="c1"># E[X̄] = μ</span>
<span class="n">theoretical_sd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w">  </span><span class="c1"># SD(X̄) = σ/√n</span>

<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;\nTheoretical mean:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">theoretical_mean</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Theoretical SD:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">theoretical_sd</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>

<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;\nDifference in means:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="n">mean_of_sample_means</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">theoretical_mean</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Difference in SDs:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="n">sd_of_sample_means</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">theoretical_sd</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Key Theoretical Relationships:</strong></p>
<ul class="simple">
<li><p>Expected value: <span class="math notranslate nohighlight">\(E[\bar{X}] = E[X] = \mu\)</span></p></li>
<li><p>Variance: <span class="math notranslate nohighlight">\(\text{Var}(\bar{X}) = \text{Var}(X)/n = \sigma^2/n\)</span></p></li>
<li><p>Standard deviation: <span class="math notranslate nohighlight">\(\text{SD}(\bar{X}) = \sigma/\sqrt{n}\)</span></p></li>
</ul>
</div>
<p><strong>Step 6: Visualize the Sampling Distribution</strong></p>
<p>Create a histogram with overlaid density curves to visualize how well the sampling distribution matches a Normal distribution.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="c1"># Create histogram with density overlay</span>
<span class="n">title</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;Sampling Distribution of X̄ (n =&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;)&quot;</span><span class="p">)</span>

<span class="nf">ggplot</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">avg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg</span><span class="p">),</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">after_stat</span><span class="p">(</span><span class="n">density</span><span class="p">)),</span>
<span class="w">                 </span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;grey&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;black&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_density</span><span class="p">(</span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">  </span><span class="c1"># Empirical density</span>
<span class="w">  </span><span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dnorm</span><span class="p">,</span>
<span class="w">                </span><span class="n">args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xbar</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">),</span>
<span class="w">                </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">  </span><span class="c1"># Normal overlay</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;Sample Mean&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot;Density&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme_minimal</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Step 7: Create a Q-Q Plot</strong></p>
<p>A Q-Q (quantile-quantile) plot helps assess whether the data follows a Normal distribution.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create Q-Q plot to assess normality</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">avg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg</span><span class="p">),</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">sample</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">stat_qq</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_abline</span><span class="p">(</span><span class="n">slope</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">intercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xbar</span><span class="p">,</span>
<span class="w">              </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;Normal Q-Q Plot (n =&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;)&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;Theoretical Quantiles&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot;Sample Quantiles&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme_minimal</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="interpreting-the-results">
<h3>Interpreting the Results<a class="headerlink" href="#interpreting-the-results" title="Link to this heading"></a></h3>
<p><strong>Histogram with Overlays:</strong></p>
<ul class="simple">
<li><p><strong>Gray bars</strong>: The empirical distribution of your 1500 sample means</p></li>
<li><p><strong>Red curve</strong>: Kernel density estimate (smooth version of histogram)</p></li>
<li><p><strong>Blue curve</strong>: Normal distribution with experimental mean and SD</p></li>
</ul>
<p>If the CLT applies well, all three should align closely.</p>
<p><strong>Q-Q Plot:</strong></p>
<ul class="simple">
<li><p><strong>Points</strong>: Your sample means plotted against theoretical Normal quantiles</p></li>
<li><p><strong>Red line</strong>: Reference line for perfect normality</p></li>
<li><p><strong>Interpretation</strong>:</p>
<ul>
<li><p>Points following the line indicates Normal distribution</p></li>
<li><p>S-shaped pattern indicates skewed distribution</p></li>
<li><p>Points deviating at ends indicates heavy or light tails</p></li>
</ul>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Common Mistakes:</strong></p>
<ul class="simple">
<li><p>Forgetting to multiply <code class="docutils literal notranslate"><span class="pre">SRS</span> <span class="pre">*</span> <span class="pre">n</span></code> when generating initial data</p></li>
<li><p>Using wrong MARGIN in <code class="docutils literal notranslate"><span class="pre">apply()</span></code> (use <code class="docutils literal notranslate"><span class="pre">1</span></code> for row means, <code class="docutils literal notranslate"><span class="pre">2</span></code> for column means)</p></li>
<li><p>Comparing experimental statistics to wrong theoretical values</p></li>
<li><p>Not using <code class="docutils literal notranslate"><span class="pre">nrow</span> <span class="pre">=</span> <span class="pre">SRS</span></code> in the <code class="docutils literal notranslate"><span class="pre">matrix()</span></code> call</p></li>
<li><p>Using <code class="docutils literal notranslate"><span class="pre">ncol</span></code> instead of <code class="docutils literal notranslate"><span class="pre">nrow</span></code> when organizing samples</p></li>
</ul>
</div>
</section>
<section id="additional-examples-working-with-different-statistics">
<h3>Additional Examples: Working with Different Statistics<a class="headerlink" href="#additional-examples-working-with-different-statistics" title="Link to this heading"></a></h3>
<p><strong>Example: Sample Sum Instead of Sample Mean</strong></p>
<p>To calculate the sample sum instead of the sample mean, change Step 4:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate sum of each row (instead of mean)</span>
<span class="n">sample_sums</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="n">data.mat</span><span class="p">,</span><span class="w"> </span><span class="n">MARGIN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">FUN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum</span><span class="p">)</span>

<span class="c1"># Theoretical parameters for sample sum</span>
<span class="n">theoretical_mean_sum</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">0</span><span class="w">  </span><span class="c1"># n × μ</span>
<span class="n">theoretical_sd_sum</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w">  </span><span class="c1"># σ × √n</span>
</pre></div>
</div>
<p><strong>Example: Sample Variance</strong></p>
<p>To calculate the sample variance for each sample:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate variance of each row</span>
<span class="n">sample_vars</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="n">data.mat</span><span class="p">,</span><span class="w"> </span><span class="n">MARGIN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">FUN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">var</span><span class="p">)</span>

<span class="c1"># Note: Theoretical parameters for variance are more complex</span>
<span class="c1"># E[S²] = σ², but the distribution converges more slowly</span>
</pre></div>
</div>
<p><strong>Example: Different Distribution Functions</strong></p>
<p>For different population distributions, only Step 2 changes:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Uniform distribution</span>
<span class="n">data.vec</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">runif</span><span class="p">(</span><span class="n">SRS</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>

<span class="c1"># Gamma distribution</span>
<span class="n">data.vec</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rgamma</span><span class="p">(</span><span class="n">SRS</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">beta</span><span class="p">)</span>

<span class="c1"># Exponential distribution</span>
<span class="n">data.vec</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rexp</span><span class="p">(</span><span class="n">SRS</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lambda</span><span class="p">)</span>

<span class="c1"># Poisson distribution</span>
<span class="n">data.vec</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rpois</span><span class="p">(</span><span class="n">SRS</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">lambda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lambda</span><span class="p">)</span>
</pre></div>
</div>
<p>All other steps remain the same!</p>
<p><strong>Example: Theoretical Parameters for Different Distributions</strong></p>
<p>For Uniform(a, b):</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">theoretical_mean</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2</span>
<span class="n">theoretical_sd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">((</span><span class="n">b</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">12</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
<p>For Gamma(α, β):</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">theoretical_mean</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">beta</span>
<span class="n">theoretical_sd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">beta</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
<p>For Exponential(λ):</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">theoretical_mean</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">lambda</span>
<span class="n">theoretical_sd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">lambda</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
<p>For Poisson(λ):</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">theoretical_mean</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lambda</span>
<span class="n">theoretical_sd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">lambda</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Example: Creating a Reusable Function</strong></p>
<p>You can wrap the entire process in a function:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">simulate_sampling_dist</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">distribution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;norm&quot;</span><span class="p">,</span>
<span class="w">                                  </span><span class="n">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(),</span><span class="w"> </span><span class="n">n_sim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1500</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1"># Generate data based on distribution</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">distribution</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;norm&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">data.vec</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n_sim</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">params</span><span class="o">$</span><span class="n">mean</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">params</span><span class="o">$</span><span class="n">sd</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">distribution</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;gamma&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">data.vec</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rgamma</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n_sim</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">params</span><span class="o">$</span><span class="n">alpha</span><span class="p">,</span>
<span class="w">                      </span><span class="n">scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">params</span><span class="o">$</span><span class="n">beta</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="c1"># Add more distributions as needed</span>

<span class="w">  </span><span class="c1"># Organize into samples</span>
<span class="w">  </span><span class="n">data.mat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">matrix</span><span class="p">(</span><span class="n">data.vec</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n_sim</span><span class="p">)</span>

<span class="w">  </span><span class="c1"># Calculate sample means</span>
<span class="w">  </span><span class="n">sample_means</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="n">data.mat</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span>

<span class="w">  </span><span class="c1"># Return results</span>
<span class="w">  </span><span class="kr">return</span><span class="p">(</span><span class="n">sample_means</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Use the function</span>
<span class="n">means</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">simulate_sampling_dist</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">distribution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;norm&quot;</span><span class="p">,</span>
<span class="w">                               </span><span class="n">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">))</span>
</pre></div>
</div>
<p><strong>Example: Comparing Multiple Sample Sizes</strong></p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">gridExtra</span><span class="p">)</span>

<span class="c1"># Create plots for different n values</span>
<span class="n">n_values</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="m">50</span><span class="p">)</span>
<span class="n">plot_list</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">()</span>

<span class="kr">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nf">seq_along</span><span class="p">(</span><span class="n">n_values</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">n_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="w">  </span><span class="c1"># Generate sampling distribution</span>
<span class="w">  </span><span class="n">data.vec</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">1500</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="w">  </span><span class="n">data.mat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">matrix</span><span class="p">(</span><span class="n">data.vec</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1500</span><span class="p">)</span>
<span class="w">  </span><span class="n">sample_means</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="n">data.mat</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span>

<span class="w">  </span><span class="c1"># Create plot</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">means</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sample_means</span><span class="p">),</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">means</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">after_stat</span><span class="p">(</span><span class="n">density</span><span class="p">)),</span><span class="w"> </span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30</span><span class="p">,</span>
<span class="w">                  </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;grey&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;black&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dnorm</span><span class="p">,</span>
<span class="w">                 </span><span class="n">args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)),</span>
<span class="w">                 </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ggtitle</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;n =&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme_minimal</span><span class="p">()</span>

<span class="w">  </span><span class="n">plot_list</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p</span>
<span class="p">}</span>

<span class="c1"># Display all plots</span>
<span class="nf">grid.arrange</span><span class="p">(</span><span class="n">grobs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plot_list</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="part-1-exploring-clt-with-skewed-distributions">
<h2>Part 1: Exploring CLT with Skewed Distributions<a class="headerlink" href="#part-1-exploring-clt-with-skewed-distributions" title="Link to this heading"></a></h2>
<p>In this exercise, you will investigate how the Central Limit Theorem applies when sampling from a <strong>skewed population</strong>. The goal is to observe how the distributions of the sample mean and sample sum evolve as the sample size increases.</p>
<div class="info admonition">
<p class="admonition-title">The Gamma Distribution</p>
<p>The <strong>Gamma distribution</strong> is defined by two parameters:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span> (shape parameter)</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta\)</span> (scale parameter)</p></li>
</ul>
<p>If <span class="math notranslate nohighlight">\(X \sim \text{Gamma}(\alpha, \beta)\)</span> then:</p>
<ul class="simple">
<li><p>Mean: <span class="math notranslate nohighlight">\(E[X] = \alpha \cdot \beta\)</span></p></li>
<li><p>Variance: <span class="math notranslate nohighlight">\(\text{Var}(X) = \alpha \cdot \beta^2\)</span></p></li>
<li><p>Standard Deviation: <span class="math notranslate nohighlight">\(\sigma = \sqrt{\alpha} \cdot \beta\)</span></p></li>
</ul>
</div>
<p><strong>Question 1:</strong> For this experiment, use a right-skewed Gamma distribution with <span class="math notranslate nohighlight">\(X \sim \text{Gamma}(\alpha = 0.5, \beta = 5)\)</span>.</p>
<p><strong>Sampling Distribution of the Sample Mean</strong></p>
<blockquote>
<div><ol class="lowerroman simple">
<li><p>Generate 1500 samples from <span class="math notranslate nohighlight">\(X \sim \text{Gamma}(\alpha = 0.5, \beta = 5)\)</span> for different sample sizes <span class="math notranslate nohighlight">\(n\)</span>, starting with <span class="math notranslate nohighlight">\(n = 5\)</span>.</p></li>
<li><p>Compute the sample mean for each sample.</p></li>
<li><p>Create histograms of the sample means for each <span class="math notranslate nohighlight">\(n\)</span>.</p></li>
<li><p>Overlay a Normal density curve using the CLT approximation:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\bar{X} \overset{\sim}{\approx} N\left(\mu, \frac{\sigma}{\sqrt{n}}\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu = \alpha \cdot \beta\)</span> and <span class="math notranslate nohighlight">\(\sigma = \sqrt{\alpha} \cdot \beta\)</span>.</p>
<ol class="loweralpha simple" start="22">
<li><p>Repeat these steps increasing <span class="math notranslate nohighlight">\(n\)</span> by units of 5 until you believe the approximation is reasonable.</p></li>
</ol>
</div></blockquote>
<div class="tip admonition">
<p class="admonition-title">Guidance for Part 1a</p>
<p><strong>What to modify from the tutorial:</strong></p>
<ul class="simple">
<li><p>In Step 2, replace <code class="docutils literal notranslate"><span class="pre">rnorm()</span></code> with <code class="docutils literal notranslate"><span class="pre">rgamma(SRS</span> <span class="pre">*</span> <span class="pre">n,</span> <span class="pre">shape</span> <span class="pre">=</span> <span class="pre">0.5,</span> <span class="pre">scale</span> <span class="pre">=</span> <span class="pre">5)</span></code></p></li>
<li><p>Calculate theoretical parameters.</p></li>
<li><p>Test multiple values of <code class="docutils literal notranslate"><span class="pre">n</span></code> (start with 5, then try 10, 15, 20, etc.)</p></li>
<li><p>For each <code class="docutils literal notranslate"><span class="pre">n</span></code>, create the histogram and Q-Q plot to assess normality</p></li>
<li><p>Look for when the distribution becomes symmetric and bell-shaped</p></li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Remember that the standard deviation of <span class="math notranslate nohighlight">\(\bar{X}\)</span> is <span class="math notranslate nohighlight">\(\sigma/\sqrt{n}\)</span>, not <span class="math notranslate nohighlight">\(\sigma\)</span>. The distribution becomes more concentrated as <span class="math notranslate nohighlight">\(n\)</span> increases.</p>
</div>
<ol class="loweralpha">
<li><p><strong>Answer the following questions:</strong></p>
<ol class="lowerroman simple">
<li><p>How does increasing <span class="math notranslate nohighlight">\(n\)</span> affect the shape of the sampling distribution?</p></li>
<li><p>For which <span class="math notranslate nohighlight">\(n\)</span> does the sampling distribution for the sample mean appear approximately Normal?</p></li>
</ol>
</li>
<li><p><strong>Sampling Distribution of the Sample Sum</strong></p>
<p>Repeat the above experiment but for the sampling distribution of the sample sum <span class="math notranslate nohighlight">\(S_n = X_1 + X_2 + \cdots + X_n\)</span>.</p>
</li>
</ol>
<div class="tip admonition">
<p class="admonition-title">Guidance for Part 1c</p>
<p><strong>What to modify from the tutorial:</strong></p>
<ul class="simple">
<li><p>In Step 4, replace <code class="docutils literal notranslate"><span class="pre">apply(data.mat,</span> <span class="pre">1,</span> <span class="pre">mean)</span></code> with <code class="docutils literal notranslate"><span class="pre">apply(data.mat,</span> <span class="pre">1,</span> <span class="pre">sum)</span></code></p></li>
<li><p>Calculate theoretical parameters for the sum.</p></li>
<li><p>Notice that both the mean AND standard deviation increase with <span class="math notranslate nohighlight">\(n\)</span> for the sum</p></li>
<li><p>Create histograms showing how the sum’s distribution changes with <span class="math notranslate nohighlight">\(n\)</span></p></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the sample sum, the CLT tells us that <span class="math notranslate nohighlight">\(S_n \overset{\sim}{\approx} N(n \cdot \mu, \sigma \cdot \sqrt{n})\)</span>. Notice that both the mean AND the standard deviation increase with <span class="math notranslate nohighlight">\(n\)</span>.</p>
</div>
<ol class="loweralpha simple" start="3">
<li><p><strong>Answer the following questions:</strong></p>
<ol class="lowerroman simple">
<li><p>How does increasing <span class="math notranslate nohighlight">\(n\)</span> affect the shape of the sampling distribution of <span class="math notranslate nohighlight">\(S_n\)</span>?</p></li>
<li><p>For which <span class="math notranslate nohighlight">\(n\)</span> does the sampling distribution for the sample sum appear approximately Normal?</p></li>
</ol>
</li>
</ol>
<div class="warning admonition">
<p class="admonition-title">Important Distinction</p>
<p><strong>Disclaimer:</strong> The Central Limit Theorem relies on certain conditions, specifically that the population has a <strong>finite mean and finite variance</strong>. The Gamma distribution used in this exercise satisfies these conditions, allowing the sample mean and sum to eventually follow a Normal distribution as <span class="math notranslate nohighlight">\(n\)</span> increases.</p>
<p>However, for highly skewed distributions, the required <span class="math notranslate nohighlight">\(n\)</span> for reasonable Normal approximation can be quite large. Additionally, the CLT <strong>does not hold</strong> for distributions like the <strong>Cauchy distribution</strong>, which lacks both a finite mean and finite variance. As an exercise, try repeating this experiment using the Cauchy distribution and observe whether the sample mean and sum approach Normality as <span class="math notranslate nohighlight">\(n\)</span> increases.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For discrete distributions, the CLT still applies, but when approximating a discrete sampling distribution with a continuous Normal distribution, a <strong>continuity correction</strong> is sometimes necessary for greater accuracy. The correction involves adjusting probability bounds by 0.5 in either direction when using the Normal approximation. While not explored in this worksheet, it’s an important consideration when applying the CLT to discrete data.</p>
</div>
</section>
<section id="part-2-application-of-the-clt">
<h2>Part 2: Application of the CLT<a class="headerlink" href="#part-2-application-of-the-clt" title="Link to this heading"></a></h2>
<p><strong>Question 2:</strong> A medical company is developing an implantable drug delivery device that gradually releases medication into a patient’s bloodstream. The company is testing how long these devices function before they fail due to mechanical wear and depletion of the drug reservoir.</p>
<p>Based on historical data, the time until failure (in months) follows a Gamma distribution:</p>
<div class="math notranslate nohighlight">
\[X \sim \text{Gamma}(\alpha = 3, \beta = 6)\]</div>
<p>To ensure patient safety, the company wants to assess the probability that a group of implants meets certain performance standards.</p>
<ol class="loweralpha simple">
<li><p>A study collects a random sample of <span class="math notranslate nohighlight">\(n = 45\)</span> implants and records the time each device functions before failure.</p>
<ol class="lowerroman simple">
<li><p><strong>Conduct a quick check through simulation</strong> to determine whether the Normal approximation is reasonable for the distribution of <span class="math notranslate nohighlight">\(\bar{X}\)</span> with <span class="math notranslate nohighlight">\(n = 45\)</span>. (Just change your settings from your previous simulations.)</p></li>
<li><p>Determine the approximate distribution of <span class="math notranslate nohighlight">\(\bar{X}\)</span> using the CLT, including the parameters of the distribution.</p></li>
<li><p>Compute the probability that the average life span of a sample of 45 implants <strong>exceeds 19 months</strong>.</p></li>
<li><p>Check that these results hold empirically. Obtain 5000 SRS of size <span class="math notranslate nohighlight">\(n = 45\)</span> from the <span class="math notranslate nohighlight">\(\text{Gamma}(\alpha = 3, \beta = 6)\)</span> distribution and compute 5000 sample means <span class="math notranslate nohighlight">\(\bar{x}_1, \bar{x}_2, \ldots, \bar{x}_{5000}\)</span>. Determine what proportion of the sample means exceeds 19. Was this proportion close to your answer using the CLT approximation?</p></li>
</ol>
</li>
</ol>
<div class="tip admonition">
<p class="admonition-title">Guidance for Part 2a(iv)</p>
<p><strong>What to modify from the tutorial:</strong></p>
<ul class="simple">
<li><p>Change <code class="docutils literal notranslate"><span class="pre">SRS</span> <span class="pre">&lt;-</span> <span class="pre">1500</span></code> to <code class="docutils literal notranslate"><span class="pre">SRS</span> <span class="pre">&lt;-</span> <span class="pre">5000</span></code></p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">rgamma(5000</span> <span class="pre">*</span> <span class="pre">45,</span> <span class="pre">shape</span> <span class="pre">=</span> <span class="pre">3,</span> <span class="pre">scale</span> <span class="pre">=</span> <span class="pre">6)</span></code></p></li>
<li><p>After calculating sample means, use <code class="docutils literal notranslate"><span class="pre">sum(sample_means</span> <span class="pre">&gt;</span> <span class="pre">19)</span> <span class="pre">/</span> <span class="pre">5000</span></code> to find the proportion</p></li>
<li><p>Compare this empirical proportion to your theoretical answer from part (iii)</p></li>
</ul>
<ol class="loweralpha" start="22">
<li><p>Find the <strong>90th percentile</strong> for the sample mean failure time. That is, determine <span class="math notranslate nohighlight">\(x_{0.9}\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[P(\bar{X} \leq x_{0.9}) = 0.9\]</div>
</li>
</ol>
</div>
</section>
<section id="part-3-beyond-mean-and-sum">
<h2>Part 3: Beyond Mean and Sum<a class="headerlink" href="#part-3-beyond-mean-and-sum" title="Link to this heading"></a></h2>
<p><strong>Question 3:</strong> In the previous exercises, you examined how the Central Limit Theorem applies to the sample mean and sample sum. In this problem, you will investigate whether the CLT also applies to the <strong>sample variance</strong> <span class="math notranslate nohighlight">\(S^2\)</span>.</p>
<ol class="loweralpha simple">
<li><p>Generate samples from <span class="math notranslate nohighlight">\(X \sim \text{Gamma}(\alpha = 0.5, \beta = 5)\)</span> for different values of <span class="math notranslate nohighlight">\(n\)</span>.</p>
<ol class="lowerroman simple">
<li><p>Generate 1500 samples for different sizes of <span class="math notranslate nohighlight">\(n\)</span> starting with <span class="math notranslate nohighlight">\(n = 2\)</span>.</p></li>
<li><p>Compute the sample variance <span class="math notranslate nohighlight">\(S^2\)</span> for each sample.</p></li>
<li><p>Create histograms and overlay Normal density curves.</p></li>
<li><p>Repeat these steps increasing <span class="math notranslate nohighlight">\(n\)</span> by units of 50 and report what you observe.</p></li>
</ol>
</li>
</ol>
<div class="tip admonition">
<p class="admonition-title">Guidance for Part 3a</p>
<p><strong>What to modify from the tutorial:</strong></p>
<ul class="simple">
<li><p>In Step 4, replace <code class="docutils literal notranslate"><span class="pre">apply(data.mat,</span> <span class="pre">1,</span> <span class="pre">mean)</span></code> with <code class="docutils literal notranslate"><span class="pre">apply(data.mat,</span> <span class="pre">1,</span> <span class="pre">var)</span></code></p></li>
<li><p>Note: Theoretical mean of <span class="math notranslate nohighlight">\(S^2\)</span> is <span class="math notranslate nohighlight">\(\sigma^2 = \alpha \cdot \beta^2\)</span></p></li>
<li><p>Test values: <span class="math notranslate nohighlight">\(n = 2, 50, 100, 150, 200, 250\)</span></p></li>
<li><p>Observe how many samples are needed before the distribution looks Normal</p></li>
</ul>
</div>
<ol class="loweralpha simple" start="2">
<li><p>Does the sample variance appear to follow a Normal distribution as <span class="math notranslate nohighlight">\(n\)</span> increases? How does the required <span class="math notranslate nohighlight">\(n\)</span> for Normality compare to that of the sample mean?</p></li>
</ol>
<div class="important admonition">
<p class="admonition-title">Key Insight</p>
<p>While the Central Limit Theorem applies to many statistics beyond the sample mean, <strong>the rate of convergence varies significantly</strong>. The sample variance requires a much larger sample size to achieve approximate normality compared to the sample mean.</p>
<p>This is why statistical inference for variance often uses different distributions (like the chi-square distribution) rather than relying solely on the Normal approximation from CLT.</p>
<p><strong>Important: Avoid Simple Rules of Thumb</strong></p>
<p>You may encounter rules like “n ≥ 30 is sufficient for CLT” or “CLT works for any n &gt; 50.” These oversimplifications can be dangerously misleading. The required sample size depends heavily on:</p>
<ul class="simple">
<li><p><strong>Population shape</strong>: Highly skewed distributions (like our Gamma(0.5, 5)) require much larger n than symmetric distributions</p></li>
<li><p><strong>The statistic being studied</strong>: Variance converges far slower than the mean</p></li>
<li><p><strong>Tail behavior</strong>: Heavy-tailed distributions need larger samples</p></li>
<li><p><strong>Practical requirements</strong>: How accurate does your Normal approximation need to be?</p></li>
</ul>
<p><strong>Better Approach: Use Domain Knowledge and Simulation</strong></p>
<p>Instead of blindly applying rules of thumb:</p>
<ol class="arabic simple">
<li><p><strong>Apply domain knowledge</strong>: What do you know about the phenomenon you’re studying? Income data tends to be right-skewed. Human heights are roughly symmetric. Waiting times are often exponentially distributed. Rare events have heavy tails. Use this contextual understanding to anticipate whether you’ll need larger or smaller samples.</p></li>
<li><p><strong>Consider the statistic</strong>: Is it a smooth function of means (fast convergence) or does it depend on extreme values (slow convergence)?</p></li>
<li><p><strong>Think about your application</strong>: Does your problem require accuracy in the tails of the distribution, or just the center?</p></li>
<li><p><strong>When in doubt, simulate</strong>: Run the simulation process you learned in this worksheet to empirically check whether the Normal approximation is reasonable for your specific situation. The code you wrote takes minutes to run and gives empirical evidence specific to your exact problem.</p></li>
</ol>
<p>Developing this judgment through domain knowledge and simulation is far more valuable than memorizing arbitrary cutoffs. Statistical practice requires thoughtful analysis, not mechanical rule-following.</p>
</div>
</section>
<section id="part-4-exploring-clt-generalizability-with-ai-assistance-exploration">
<h2>Part 4: Exploring CLT Generalizability with AI Assistance (Exploration)<a class="headerlink" href="#part-4-exploring-clt-generalizability-with-ai-assistance-exploration" title="Link to this heading"></a></h2>
<p><strong>Question 4:</strong> In this worksheet, you’ve explored how the CLT applies to the sample mean, sample sum, and sample variance. But what about other statistics? Does the CLT apply to the sample median? The sample maximum? The range?</p>
<p>In this exercise, you’ll use an AI assistant (like ChatGPT, Claude, or others) to investigate the general conditions under which the CLT applies to different sample statistics. This is an independent exploration activity - you won’t submit written answers, but you should run simulations and take notes for your own understanding.</p>
<div class="info admonition">
<p class="admonition-title">Learning to Ask Good Questions</p>
<p>Working effectively with AI requires learning to craft precise, well-structured prompts. This skill is increasingly important in modern statistical practice. You’ll develop a multi-stage prompt strategy to deeply understand a statistical concept.</p>
</div>
<p><strong>Step 1: Initial Exploration Prompt</strong></p>
<p>Start with a broad question to understand the landscape:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Prompt 1:
&quot;I&#39;m learning about the Central Limit Theorem. I&#39;ve already studied how it
applies to sample means, sums, and variance - I know the mean converges
fastest, and variance requires much larger sample sizes.

Does the CLT apply to other sample statistics like the median, maximum,
minimum, or range? Please provide a general overview of which statistics
have CLT-like behavior and which do not.&quot;
</pre></div>
</div>
<p>After receiving the response, read it carefully and consider:</p>
<ul class="simple">
<li><p>Which statistics does the AI say have CLT-like behavior?</p></li>
<li><p>Which statistics does the AI say do NOT have standard CLT behavior?</p></li>
<li><p>Are there any terms or concepts mentioned that you don’t understand?</p></li>
</ul>
<p><strong>Step 2: Clarification and Deepening Prompt</strong></p>
<p>Now ask for clarification on specific points:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Prompt 2:
&quot;You mentioned that [specific statistic from the response] has/doesn&#39;t have
CLT-like behavior. Can you explain:
1. What are the mathematical conditions required for a statistic to satisfy
   the CLT?
2. Why specifically does [the statistic] meet or fail these conditions?
3. How does its convergence rate compare to the sample mean and variance?

Please include the technical terms but also provide intuitive explanations.&quot;
</pre></div>
</div>
<p>Pay attention to the mathematical conditions the AI identifies and why they matter.</p>
<p><strong>Step 3: Verification Through Simulation Prompt</strong></p>
<p>Now ask the AI to help you verify its claims:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Prompt 3:
&quot;Help me design an R simulation to test whether the sample median from a
Gamma(0.5, 5) distribution follows a Normal distribution as sample size
increases. I already know how to simulate sample means using the matrix
and apply() approach from my tutorial. What modifications do I need to
make to test the median, and what should I expect to see?&quot;
</pre></div>
</div>
<p>Based on the AI’s response, modify your tutorial code to test the sample median:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your simulation code here</span>
<span class="c1"># Test sample sizes: n = 5, 10, 20, 50, 100, 200</span>

<span class="c1"># Create histograms and Q-Q plots</span>
<span class="c1"># Compare convergence to what you saw with mean and variance</span>
</pre></div>
</div>
<p><strong>Step 4: Critical Analysis Prompt</strong></p>
<p>Finally, critically evaluate what you’ve learned:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Prompt 4:
&quot;I ran simulations for the sample median with n = 5, 10, 20, 50, 100, 200
from a Gamma(0.5, 5) distribution. [Describe what you observed - does it
look Normal? How large does n need to be?]

How does this compare to what you predicted? Where would the median rank
in terms of convergence speed compared to the mean and variance I already
studied? Are there any nuances about the median&#39;s convergence that I
should understand?&quot;
</pre></div>
</div>
<p>Consider in your notes:</p>
<ul class="simple">
<li><p>Does the sample median satisfy the CLT based on your simulations?</p></li>
<li><p>How do you rank convergence rates: sample mean, sample variance, and sample median?</p></li>
<li><p>What sample size is needed for the median to appear approximately Normal?</p></li>
<li><p>What does “asymptotic normality” mean and how does it relate to CLT?</p></li>
</ul>
<p><strong>Step 5: Synthesis and Generalization</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Prompt 5:
&quot;Based on our discussion, can you provide a general principle: What
characteristics make a sample statistic &#39;well-behaved&#39; under the CLT
(fast convergence like the mean) versus &#39;poorly-behaved&#39; (slow convergence
like variance, or no convergence at all)? Use specific examples to
illustrate, and explain where median-like statistics fit in this spectrum.&quot;
</pre></div>
</div>
<p>Synthesize what you’ve learned:</p>
<ul class="simple">
<li><p>What makes a statistic converge quickly to normality?</p></li>
<li><p>What makes a statistic converge slowly or not at all?</p></li>
<li><p>How did your understanding evolve across the five prompts?</p></li>
<li><p>Did the AI make any claims inconsistent with your simulations?</p></li>
</ul>
<div class="warning admonition">
<p class="admonition-title">Critical AI Literacy</p>
<p><strong>Important Reminders:</strong></p>
<ul class="simple">
<li><p>AI assistants can make mistakes, especially with technical details</p></li>
<li><p>Always verify AI claims through simulation, mathematical derivation, or authoritative sources</p></li>
<li><p>Different AI systems may give different answers - this doesn’t mean one is “correct”</p></li>
<li><p>The goal is not to get “the answer” from AI, but to use AI as a tool for guided exploration</p></li>
<li><p>Your simulations and mathematical reasoning are the ultimate arbiters of truth</p></li>
</ul>
</div>
<div class="tip admonition">
<p class="admonition-title">Extension Challenge</p>
<p>Try this same five-step process with another statistic you haven’t explored yet:</p>
<ul class="simple">
<li><p>Sample standard deviation</p></li>
<li><p>Sample range (max - min)</p></li>
<li><p>Sample interquartile range</p></li>
<li><p>75th percentile</p></li>
<li><p>Sample minimum or maximum</p></li>
</ul>
<p>Compare convergence rates across all statistics you’ve explored. Can you develop a general ranking from fastest to slowest convergence?</p>
</div>
</section>
<section id="key-takeaways">
<h2>Key Takeaways<a class="headerlink" href="#key-takeaways" title="Link to this heading"></a></h2>
<div class="important admonition">
<p class="admonition-title">Summary</p>
<ul class="simple">
<li><p>The <strong>Central Limit Theorem</strong> states that sample means and sums approach Normal distributions as <span class="math notranslate nohighlight">\(n\)</span> increases, regardless of the population distribution (provided it has finite mean and variance)</p></li>
<li><p><strong>Simulation methodology</strong> follows four key steps: (1) Generate SRS × n observations, (2) Organize into matrix with nrow = SRS, (3) Apply mean/sum function to rows, (4) Analyze resulting sampling distribution</p></li>
<li><p>The <strong>rate of convergence</strong> depends critically on the population’s shape - symmetric distributions converge quickly, while highly skewed distributions require much larger sample sizes</p></li>
<li><p>For sample means: <span class="math notranslate nohighlight">\(\bar{X} \approx N\left(\mu, \frac{\sigma}{\sqrt{n}}\right)\)</span> for large <span class="math notranslate nohighlight">\(n\)</span></p></li>
<li><p>For sample sums: <span class="math notranslate nohighlight">\(S_n \approx N(n\mu, \sigma\sqrt{n})\)</span> for large <span class="math notranslate nohighlight">\(n\)</span></p></li>
<li><p>The CLT requires <strong>finite mean and variance</strong> - it fails for heavy-tailed distributions like the Cauchy distribution</p></li>
<li><p>Different statistics (mean, variance, median, range) have <strong>vastly different convergence rates</strong> - the sample mean typically converges fastest</p></li>
<li><p><strong>Simulation</strong> is an invaluable tool for verifying when CLT approximations are appropriate before applying them to real problems</p></li>
<li><p>The CLT is the foundation of <strong>statistical inference</strong> - it justifies confidence intervals, hypothesis tests, and many other procedures</p></li>
</ul>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="worksheet10.html" class="btn btn-neutral float-left" title="Worksheet 10: Checking Normality and Introduction to Sampling Distributions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="worksheet12.html" class="btn btn-neutral float-right" title="Worksheet 12: Point Estimators and Unbiased Estimation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
  <p class="footer-credits-inline">
    <strong>Website Credits:</strong>
    Website development by Dr. Timothy Reese and Halin Shin.
    Generative AI tools were used to draft and refine some prose, code, and documentation; all content was reviewed by the instructors.
    Models: OpenAI o3 (2025-04-16 release) and Anthropic Claude Opus 4.1 (2025-08-05).
  </p>


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>