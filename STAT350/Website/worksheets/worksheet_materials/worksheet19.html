

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Worksheet 19: Multiple Comparisons and Post-Hoc Testing &mdash; STAT 350</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=9c3e77be" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=2f168d12" />
      <link rel="stylesheet" type="text/css" href="../../_static/credits.css?v=f7efa099" />

  
    <link rel="canonical" href="https://treese41528.github.io/STAT350/Website/worksheets/worksheet_materials/worksheet19.html" />
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=30646c52"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../../_static/togglebutton.js?v=1ae7504c"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script src="../../_static/design-tabs.js?v=f930bc37"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
      <script src="../../_static/custom.js?v=7e0058eb"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Worksheet 20: Introduction to Simple Linear Regression" href="worksheet20.html" />
    <link rel="prev" title="Worksheet 18: One-Way ANOVA (Analysis of Variance)" href="worksheet18.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            STAT 350: Introduction to Statistics
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Orientation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../course-intro.html">Course Introduction &amp; Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../course-intro.html#why-statistics-why-now">Why Statistics? Why Now?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-intro.html#office-hours">Office Hours</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-intro.html#course-roadmap">Course Roadmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-intro.html#a-clear-note-on-using-ai">A Clear Note on Using AI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../course-intro.html#getting-started-a-checklist">Getting Started: A Checklist</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../course-intro.html#homework-assignments-on-edfinity">Homework Assignments on Edfinity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../course-intro.html#miscellaneous-tips">Miscellaneous Tips</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Exam Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../exams/exams_index.html">Course Examinations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../exams/exams_index.html#general-exam-policies">General Exam Policies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../exams/exam_materials/exam1.html">Exam 1</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../exams/exam_materials/exam1.html#exam-locations-by-section">Exam Locations by Section</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../exams/exam_materials/exam1.html#exam-coverage">Exam Coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../exams/exam_materials/exam1.html#preparation-materials">Preparation Materials</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../exams/exam_materials/exam2.html">Exam 2</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../exams/exam_materials/exam2.html#exam-locations-by-section">Exam Locations by Section</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../exams/exam_materials/exam2.html#exam-coverage">Exam Coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../exams/exam_materials/exam2.html#preparation-materials">Preparation Materials</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../exams/exam_materials/final_exam.html">Final Exam</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../exams/exam_materials/final_exam.html#about-the-final-exam">About the Final Exam</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../exams/exam_materials/final_exam.html#required-review-materials">Required Review Materials</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../exams/exam_materials/final_exam.html#study-guide-resource">Study Guide Resource</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Worksheets</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../worksheets_index.html">Course Worksheets</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../worksheets_index.html#pedagogical-philosophy">Pedagogical Philosophy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../worksheets_index.html#implementation-guidelines">Implementation Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../worksheets_index.html#why-these-worksheets-matter">Why These Worksheets Matter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../worksheets_index.html#the-critical-role-of-simulation">The Critical Role of Simulation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../worksheets_index.html#worksheets">Worksheets</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="worksheet1.html">Worksheet 1: Exploring Data with R</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet1.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet1.html#part-1-loading-and-understanding-the-dataset">Part 1: Loading and Understanding the Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet1.html#part-2-initial-data-exploration">Part 2: Initial Data Exploration</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet1.html#part-3-frequency-tables">Part 3: Frequency Tables</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet1.html#part-4-univariate-analysis-of-uptake">Part 4: Univariate Analysis of Uptake</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet1.html#part-5-grouped-statistics-with-tapply">Part 5: Grouped Statistics with tapply</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet1.html#part-6-comparative-visualization-by-type">Part 6: Comparative Visualization by Type</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet1.html#part-7-exploring-the-concentration-effect">Part 7: Exploring the Concentration Effect</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet1.html#part-8-advanced-visualization-with-multiple-categories">Part 8: Advanced Visualization with Multiple Categories</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet1.html#reference-key-functions">Reference: Key Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet1.html#troubleshooting-guide">Troubleshooting Guide</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet1.html#additional-resources">Additional Resources</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet2.html">Worksheet 2: Set Theory and Probability Fundamentals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet2.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet2.html#part-1-set-theory-foundations">Part 1: Set Theory Foundations</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet2.html#part-2-probability-axioms">Part 2: Probability Axioms</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet2.html#part-3-applying-probability-rules">Part 3: Applying Probability Rules</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet2.html#part-4-the-inclusion-exclusion-principle">Part 4: The Inclusion-Exclusion Principle</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet2.html#key-takeaways">Key Takeaways</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet2.html#submission-guidelines">Submission Guidelines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet3.html">Worksheet 3: Conditional Probability and Bayes’ Theorem</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet3.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet3.html#part-1-understanding-conditional-probability">Part 1: Understanding Conditional Probability</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet3.html#part-2-tree-diagrams-and-sequential-sampling">Part 2: Tree Diagrams and Sequential Sampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet3.html#part-3-bayes-theorem-and-sequential-updating">Part 3: Bayes’ Theorem and Sequential Updating</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet3.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet4.html">Worksheet 4: Independence and Random Variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet4.html#part-1-independence-property">Part 1: Independence Property</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet4.html#part-2-independent-vs-mutually-exclusive-events">Part 2: Independent vs. Mutually Exclusive Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet4.html#part-3-introduction-to-random-variables">Part 3: Introduction to Random Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet4.html#part-4-probability-mass-functions">Part 4: Probability Mass Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet4.html#part-5-joint-probability-mass-functions">Part 5: Joint Probability Mass Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet4.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet5.html">Worksheet 5: Expected Value and Variance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet5.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet5.html#part-1-expected-value-and-lotus">Part 1: Expected Value and LOTUS</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet5.html#part-2-variance-and-its-properties">Part 2: Variance and Its Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet5.html#part-3-sums-of-random-variables">Part 3: Sums of Random Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet5.html#part-4-joint-probability-mass-functions">Part 4: Joint Probability Mass Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet5.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet6.html">Worksheet 6: Named Discrete Distributions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet6.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet6.html#part-1-the-bernoulli-and-binomial-distributions">Part 1: The Bernoulli and Binomial Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet6.html#the-binomial-distribution">The Binomial Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet6.html#part-2-the-poisson-distribution">Part 2: The Poisson Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet6.html#part-3-other-named-discrete-distributions">Part 3: Other Named Discrete Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet6.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet7.html">Worksheet 7: Continuous Random Variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet7.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet7.html#part-1-probability-density-functions">Part 1: Probability Density Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet7.html#part-2-finding-constants-for-valid-pdfs">Part 2: Finding Constants for Valid PDFs</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet7.html#part-3-expected-value-and-variance">Part 3: Expected Value and Variance</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet7.html#part-4-cumulative-distribution-functions">Part 4: Cumulative Distribution Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet7.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet8.html">Worksheet 8: Uniform and Exponential Distributions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet8.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet8.html#part-1-the-uniform-distribution">Part 1: The Uniform Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet8.html#part-2-the-exponential-distribution">Part 2: The Exponential Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet8.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet9.html">Worksheet 9: The Normal Distribution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet9.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet9.html#part-1-the-normal-distribution">Part 1: The Normal Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet9.html#part-2-the-standard-normal-table">Part 2: The Standard Normal Table</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet9.html#part-3-z-score-transformation">Part 3: Z-Score Transformation</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet9.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet10.html">Worksheet 10: Checking Normality and Introduction to Sampling Distributions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet10.html#part-1-checking-normality">Part 1: Checking Normality</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet10.html#part-2-introduction-to-sampling-distributions">Part 2: Introduction to Sampling Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet10.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet11.html">Worksheet 11: The Central Limit Theorem</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet11.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet11.html#tutorial-generating-the-sampling-distribution-of-bar-x">Tutorial: Generating the Sampling Distribution of <span class="math notranslate nohighlight">\(\bar{X}\)</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet11.html#part-1-exploring-clt-with-skewed-distributions">Part 1: Exploring CLT with Skewed Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet11.html#part-2-application-of-the-clt">Part 2: Application of the CLT</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet11.html#part-3-beyond-mean-and-sum">Part 3: Beyond Mean and Sum</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet11.html#part-4-exploring-clt-generalizability-with-ai-assistance-exploration">Part 4: Exploring CLT Generalizability with AI Assistance (Exploration)</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet11.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet12.html">Worksheet 12: Point Estimators and Unbiased Estimation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet12.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet12.html#part-1-estimating-parameters-of-the-exponential-distribution">Part 1: Estimating Parameters of the Exponential Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet12.html#part-2-estimating-the-maximum-of-a-uniform-distribution">Part 2: Estimating the Maximum of a Uniform Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet12.html#part-3-minimum-variance-unbiased-estimators-mvue">Part 3: Minimum Variance Unbiased Estimators (MVUE)</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet12.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet13.html">Worksheet 13: Introduction to Confidence Intervals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet13.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet13.html#part-1-pivotal-quantities-and-deriving-confidence-intervals">Part 1: Pivotal Quantities and Deriving Confidence Intervals</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet13.html#part-2-sample-size-determination">Part 2: Sample Size Determination</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet13.html#part-3-one-sided-confidence-bounds">Part 3: One-Sided Confidence Bounds</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet13.html#part-4-confidence-intervals-when-is-unknown">Part 4: Confidence Intervals When σ is Unknown</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet13.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet14.html">Worksheet 14: Student’s t-Distribution and Statistical Power</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet14.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet14.html#assumptions-for-t-distribution-inference">Assumptions for t-Distribution Inference</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet14.html#part-1-analyzing-chick-growth-with-confidence-intervals">Part 1: Analyzing Chick Growth with Confidence Intervals</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet14.html#part-2-introduction-to-hypothesis-testing">Part 2: Introduction to Hypothesis Testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet14.html#part-3-sample-size-determination-and-power-analysis">Part 3: Sample Size Determination and Power Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet14.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet15.html">Worksheet 15: Hypothesis Testing for a Single Mean</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet15.html#the-hypothesis-testing-framework">The Hypothesis Testing Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet15.html#the-test-statistic-known">The Test Statistic (Known σ)</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet15.html#distribution-of-the-test-statistic">Distribution of the Test Statistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet15.html#the-p-value">The p-value</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet15.html#question-1a-simulation-when-null-hypothesis-is-true">Question 1a: Simulation When Null Hypothesis is True</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet15.html#question-1b-simulation-when-null-hypothesis-is-false">Question 1b: Simulation When Null Hypothesis is False</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet15.html#question-1c-comparing-the-two-scenarios">Question 1c: Comparing the Two Scenarios</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet15.html#the-t-test-statistic">The t-Test Statistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet15.html#properties-of-the-t-distribution">Properties of the t-Distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet15.html#question-2a-assumptions-and-exploratory-analysis">Question 2a: Assumptions and Exploratory Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet15.html#question-2b-full-hypothesis-testing-procedure">Question 2b: Full Hypothesis Testing Procedure</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet15.html#question-2c-manual-verification">Question 2c: Manual Verification</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet15.html#question-2d-confidence-bound">Question 2d: Confidence Bound</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet15.html#question-2e-power-calculation">Question 2e: Power Calculation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet16.html">Worksheet 16: Two-Sample Inference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet16.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet16.html#part-1-independent-vs-paired-designs">Part 1: Independent vs. Paired Designs</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet16.html#part-2-independent-samples-with-known-variances">Part 2: Independent Samples with Known Variances</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet16.html#part-3-pooled-two-sample-t-test-equal-variances">Part 3: Pooled Two-Sample t-Test (Equal Variances)</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet16.html#part-4-welch-s-two-sample-t-test-unequal-variances">Part 4: Welch’s Two-Sample t-Test (Unequal Variances)</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet16.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet17.html">Worksheet 17: Paired Sample Inference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet17.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet17.html#part-1-theory-and-procedure-for-paired-samples">Part 1: Theory and Procedure for Paired Samples</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet17.html#part-2-sleep-study-analysis">Part 2: Sleep Study Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet17.html#part-3-sample-size-calculation-for-paired-designs">Part 3: Sample Size Calculation for Paired Designs</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet17.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet18.html">Worksheet 18: One-Way ANOVA (Analysis of Variance)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet18.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet18.html#why-use-one-way-anova">Why Use One-Way ANOVA?</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet18.html#one-way-anova-assumptions">One-Way ANOVA Assumptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet18.html#one-way-anova-f-test-statistic-and-sources-of-variation">One-Way ANOVA F-test Statistic and Sources of Variation</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet18.html#notation-and-setup">Notation and Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet18.html#part-1-computing-the-overall-sample-mean">Part 1: Computing the Overall Sample Mean</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet18.html#part-2-checking-the-equal-variance-assumption">Part 2: Checking the Equal Variance Assumption</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet18.html#part-3-pooled-variance-estimator">Part 3: Pooled Variance Estimator</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet18.html#part-4-within-group-variability-sum-of-squares-within-sse">Part 4: Within-Group Variability (Sum of Squares Within, SSE)</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet18.html#part-5-between-group-variability-sum-of-squares-among-ssa">Part 5: Between-Group Variability (Sum of Squares Among, SSA)</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet18.html#part-6-total-variability-and-partitioning">Part 6: Total Variability and Partitioning</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet18.html#part-7-degrees-of-freedom">Part 7: Degrees of Freedom</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet18.html#part-8-mean-squares">Part 8: Mean Squares</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet18.html#part-9-the-f-test-statistic">Part 9: The F-Test Statistic</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet18.html#part-10-computing-the-p-value-and-making-a-decision">Part 10: Computing the P-Value and Making a Decision</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet18.html#part-11-completing-the-anova-table">Part 11: Completing the ANOVA Table</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet18.html#part-12-limitations-and-follow-up-questions">Part 12: Limitations and Follow-Up Questions</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet18.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Worksheet 19: Multiple Comparisons and Post-Hoc Testing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-multiple-comparisons-problem">The Multiple Comparisons Problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="#methods-to-control-the-family-wise-error-rate">Methods to Control the Family-Wise Error Rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="#part-1-simulation-study-type-i-error-with-multiple-comparison-methods">Part 1: Simulation Study - Type I Error with Multiple Comparison Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="#part-2-applying-tukey-s-hsd-to-worksheet-18-data">Part 2: Applying Tukey’s HSD to Worksheet 18 Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#part-3-comprehensive-anova-analysis-toothgrowth-dataset">Part 3: Comprehensive ANOVA Analysis - ToothGrowth Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet20.html">Worksheet 20: Introduction to Simple Linear Regression</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet20.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet20.html#from-anova-to-regression-same-core-ideas-new-application">From ANOVA to Regression: Same Core Ideas, New Application</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet20.html#the-simple-linear-regression-model">The Simple Linear Regression Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet20.html#least-squares">Least Squares</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet20.html#part-1-deriving-least-squares-estimators">Part 1: Deriving Least Squares Estimators</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet20.html#part-2-the-general-simple-linear-regression-estimators">Part 2: The General Simple Linear Regression Estimators</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet20.html#part-3-sampling-distributions-of-regression-estimators">Part 3: Sampling Distributions of Regression Estimators</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet20.html#part-4-practice-problems">Part 4: Practice Problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet20.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet21.html">Worksheet 21: Inference for Simple Linear Regression</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet21.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet21.html#part-1-sampling-distributions-of-regression-estimators">Part 1: Sampling Distributions of Regression Estimators</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet21.html#part-2-checking-regression-assumptions">Part 2: Checking Regression Assumptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet21.html#part-3-bird-data-analysis">Part 3: Bird Data Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet21.html#part-4-regression-anova">Part 4: Regression ANOVA</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet21.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="worksheet22.html">Worksheet 22: Model Assessment and Prediction in Regression</a><ul>
<li class="toctree-l4"><a class="reference internal" href="worksheet22.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet22.html#part-1-the-coefficient-of-determination">Part 1: The Coefficient of Determination</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet22.html#part-2-confidence-intervals-vs-prediction-intervals">Part 2: Confidence Intervals vs. Prediction Intervals</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet22.html#part-3-simulation-study-ci-vs-pi-coverage">Part 3: Simulation Study — CI vs. PI Coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet22.html#part-4-prediction-with-the-bird-data">Part 4: Prediction with the Bird Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet22.html#part-5-diamonds-data-analysis">Part 5: Diamonds Data Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="worksheet22.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Computer Assignments</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../R_computerAssignments/r_computer_assignments.html">R / RStudio Guide and Function Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../R_computerAssignments/r_getting_started.html">Getting Started with R and RStudio</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_getting_started.html#quick-start-r-rstudio-setup">Quick Start: R / RStudio Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_getting_started.html#rstudio-orientation">RStudio Orientation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_getting_started.html#packages-libraries-course-set">Packages / Libraries (Course Set)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_getting_started.html#getting-started-with-swirl">Getting Started with swirl</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../R_computerAssignments/r_getting_started.html#setup-and-use-swirl">Setup and Use swirl</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../R_computerAssignments/r_datasets.html">Course Datasets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_datasets.html#primary-course-dataset-apprating">Primary Course Dataset - AppRating</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_datasets.html#tutorial-support-datasets">Tutorial Support Datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_datasets.html#loading-datasets-in-r">Loading Datasets in R</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_datasets.html#built-in-r-datasets-used-in-course">Built-in R Datasets Used in Course</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_datasets.html#data-download-and-organization">Data Download and Organization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../R_computerAssignments/r_tutorials_assignments.html">Computer Assignments and Tutorials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_tutorials_assignments.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_tutorials_assignments.html#assignment-structure">Assignment Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_tutorials_assignments.html#assignment-tutorials-links">Assignment Tutorials (Links)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_tutorials_assignments.html#course-pipeline-at-a-glance">Course Pipeline (At a Glance)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_tutorials_assignments.html#more-help-and-reference-pages">More Help and Reference Pages</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../R_computerAssignments/r_best_practices.html">Best Practices &amp; Common Pitfalls</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_best_practices.html#data-import-validation">Data Import &amp; Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_best_practices.html#statistical-assumptions">Statistical Assumptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_best_practices.html#common-errors-to-avoid">Common Errors to Avoid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_best_practices.html#workflow-template">Workflow Template</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../R_computerAssignments/r_ggplot2_guide.html">Graphics (ggplot2)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_ggplot2_guide.html#core-components">Core Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_ggplot2_guide.html#geoms-geometric-objects">Geoms (Geometric Objects)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_ggplot2_guide.html#categorical-data-visualization">Categorical Data Visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_ggplot2_guide.html#plot-customization">Plot Customization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_ggplot2_guide.html#tables-reporting">Tables &amp; Reporting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../R_computerAssignments/r_function_reference_part1.html">Function Reference Part 1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_function_reference_part1.html#data-i-o-housekeeping">Data I/O &amp; Housekeeping</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_function_reference_part1.html#data-structures-creation">Data Structures &amp; Creation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_function_reference_part1.html#data-wrangling-utilities">Data Wrangling &amp; Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_function_reference_part1.html#descriptive-statistics-correlation">Descriptive Statistics &amp; Correlation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_function_reference_part1.html#probability-distributions">Probability &amp; Distributions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_function_reference_part1.html#simulation-functions">Simulation Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../R_computerAssignments/r_function_reference_part2.html">Function Reference Part 2: Inference Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_function_reference_part2.html#diagnostic-plots-for-assumptions">Diagnostic Plots for Assumptions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../R_computerAssignments/r_alternative_resources.html">Alternative Resources (Tutorials)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_alternative_resources.html#general-r-data-science">General R &amp; Data Science</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_alternative_resources.html#ggplot2-visualization">ggplot2 Visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_alternative_resources.html#tidyverse">Tidyverse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_alternative_resources.html#video-content">Video Content</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_alternative_resources.html#quick-reference">Quick Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../R_computerAssignments/r_alternative_resources.html#base-r">Base R</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Chapters</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../chapter1/index.html">1. Introduction to Statistics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter1/lectures/1-1-intro.html">1.1. What Is Statistics?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter1/lectures/1-2-probability-inference.html">1.2. Probability &amp; Statistical Inference: How Are They Associated?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chapter2/index.html">2. Graphical Summaries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter2/lectures/2-1-understanding-the-structure-of-data-set.html">2.1. Data Set Structure and Variable Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter2/lectures/2-2-tools-for-categorical-qualitative-data.html">2.2. Tools for Categorical (Qualitative) Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter2/lectures/2-3-tools-for-numerical-quantitative-data.html">2.3. Tools for Numerical (Quantitative) Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter2/lectures/2-4-exploring-quantitative-distributions-modality-shape-and-outliers.html">2.4. Exploring Quantitative Distributions: Modality, Skewness &amp; Outliers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chapter3/index.html">3. Numerical Summaries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter3/lectures/3-1-intro-numerical-summaries.html">3.1. Introduction to Numerical Summaries: Notation and Terminology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter3/lectures/3-2-measures-of-central-tendency.html">3.2. Measures of Central Tendency</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter3/lectures/3-3-measures-of-variability-range-variance-and-SD.html">3.3. Measures of Variability - Range, Variance, and Standard Deviation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter3/lectures/3-4-measures-of-variability-IQR-and-5-number-summary.html">3.4. Measures of Variability - Interquartile Range and Five-Number Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter3/lectures/3-5-choosing-the-right-measure-resistance-to-extreme-values.html">3.5. Choosing the Right Measure &amp; Comparing Measures Across Data Sets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chapter4/index.html">4. Probability</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter4/lectures/4-1-basic-set-theory.html">4.1. Basic Set Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter4/lectures/4-2-probability.html">4.2. Probability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter4/lectures/4-3-conditional-probability.html">4.3. Conditional Probability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter4/lectures/4-4-law-of-total-probability-and-bayes-rule.html">4.4. Law of Total Probability and Bayes’ Rule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter4/lectures/4-5-bayes-update-rule-example.html">4.5. Sequential Bayesian Updating</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter4/lectures/4-6-independence-of-events.html">4.6. Independence of Events</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chapter5/index.html">5. Discrete Distributions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter5/lectures/5-1-discrete-rvs-and-pmfs.html">5.1. Discrete Random Variables and Probability Mass Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter5/lectures/5-2-joint-pmfs.html">5.2. Joint Probability Mass Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter5/lectures/5-3-expected-value-of-discrete-rv.html">5.3. Expected Value of a Discrete Random Variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter5/lectures/5-4-variance-of-discrete-rv.html">5.4. Varianace of a Discrete Random Variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter5/lectures/5-5-covariance-of-dependent-rvs.html">5.5. Covariance of Dependent Random Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter5/lectures/5-6-binomial-distribution.html">5.6. The Binomial Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter5/lectures/5-7-poisson-distribution.html">5.7. The Poisson Distribution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chapter6/index.html">6. Continuous Distributions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter6/lectures/6-1-continuous-rvs-and-pdfs.html">6.1. Continuous Random Variables and Probability Density Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter6/lectures/6-2-expected-value-and-variance-of-cts-rvs.html">6.2. Expected Value and Variance of Continuous Random Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter6/lectures/6-3-cdfs.html">6.3. Cumulative Distribution Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter6/lectures/6-4-normal-distribution.html">6.4. Normal Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter6/lectures/6-5-uniform-distribution.html">6.5. Uniform Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter6/lectures/6-6-exponential-distribution.html">6.6. Exponential Distribution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chapter7/index.html">7. Sampling Distributions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter7/lectures/7-1-statistics-and-sampling-distributions.html">7.1. Statistics and Sampling Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter7/lectures/7-2-sampling-distribution-for-the-sample-mean.html">7.2. Sampling Distribution for the Sample Mean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter7/lectures/7-3-clt.html">7.3. The Central Limit Theorem (CLT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter7/lectures/7-4-discret-rvs-and-clt.html">7.4. Understanding Binomial and Poisson Distributions through CLT</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chapter8/index.html">8. Experimental Design</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter8/lectures/8-1-experimental-and-sampling-designs.html">8.1. Experimental and Sampling Designs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter8/lectures/8-2-experimental-design-principles.html">8.2. Experimental Design Principles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter8/lectures/8-3-basic-types-of-experimental-design.html">8.3. Basic Types of Experimental Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter8/lectures/8-4-addressing-potential-flaws-in-experimental-design.html">8.4. Addressing Potential Flaws in Experimental Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter8/lectures/8-5-examples-of-experimental-design.html">8.5. Examples of Experimental Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter8/lectures/8-6-sampling-design.html">8.6. Sampling Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter8/lectures/8-7-sampling-bias.html">8.7. Sampling Bias</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chapter9/index.html">9. Confidence Intervals and Bounds</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter9/lectures/9-1-intro-statistical-inference.html">9.1. Introduction to Statistical Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter9/lectures/9-2-ci-sigma-known.html">9.2. Confidence Intervals for the Population Mean, When σ is Known</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter9/lectures/9-3-precision-of-ci-and-sample-size-calculation.html">9.3. Precision of a Confidence Interval</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter9/lectures/9-4-cb-sigma-known.html">9.4. Confidence Bounds for the Poulation Mean When σ is Known</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter9/lectures/9-5-ci-cb-sigma-unknown.html">9.5. Confidence Intervals and Bounds When σ is Unknown</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chapter10/index.html">10. Hypothesis Testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter10/lectures/10-1-ht-errors-and-power.html">10.1. The Foundation of Hypothesis Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter10/lectures/10-2-ht-for-mean-sigma-known.html">10.2. Hypothesis Test for the Population Mean When σ is Known</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter10/lectures/10-3-ht-for-mean-sigma-unknown.html">10.3. Connecting CI and HT; <em>t</em>-Test for μ When σ Is Unknown</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter10/lectures/10-4-pvalue-significance-conclusion.html">10.4. The Four Steps to Hypothesis Testing and Understanding the Result</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chapter11/index.html">11. Two Sample Procedures</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter11/lectures/11-1-ci-ht-two-samples.html">11.1. Statistical Inference for Two Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter11/lectures/11-2-comparing-two-means-independent-sigmas-known.html">11.2. Independent Two-Sample Analysis When Population Variances Are Known</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter11/lectures/11-3-comparing-two-means-independent-pooled.html">11.3. Independent Two-Sample Analysis - Pooled Variance Estimator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter11/lectures/11-4-comparing-two-means-independent-unpooled.html">11.4. Independent Two-Sample Analysis - No Equal Variance Assumption</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter11/lectures/11-5-mean-of-paired-differences-two-dependent-populations.html">11.5. Paired Two-Sample Analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chapter12/index.html">12. ANOVA</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter12/lectures/12-1-intro-one-way-anova.html">12.1. Introduction to One-Way ANOVA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter12/lectures/12-2-sources-of-variability.html">12.2. Different Sources of Variability in ANOVA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter12/lectures/12-3-f-test-and-relationship-to-t-test.html">12.3. ANOVA F-Test and Its Relationship to Two-Sample <em>t</em>-Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter12/lectures/12-4-multiple-comparison-procedures-family-wise-error-rates.html">12.4. Multiple Comparison Procedures</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../chapter13/index.html">13. Simple Linear Regression</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chapter13/lectures/13-1-intro-to-lr-correlation-scatter-plots.html">13.1. Introduction to Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter13/lectures/13-2-simple-linear-regression.html">13.2. Simple Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter13/lectures/13-3-diagnostics-inference.html">13.3. Model Diagnostics and Statistical Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chapter13/lectures/13-4-prediction-robustness.html">13.4. Prediction and Robustness</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">STAT 350: Introduction to Statistics</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../worksheets_index.html">Course Worksheets</a></li>
      <li class="breadcrumb-item active">Worksheet 19: Multiple Comparisons and Post-Hoc Testing</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/worksheets/worksheet_materials/worksheet19.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="worksheet-19-multiple-comparisons-and-post-hoc-testing">
<span id="worksheet19"></span><h1>Worksheet 19: Multiple Comparisons and Post-Hoc Testing<a class="headerlink" href="#worksheet-19-multiple-comparisons-and-post-hoc-testing" title="Link to this heading"></a></h1>
<div class="info admonition">
<p class="admonition-title">Learning Objectives 🎯</p>
<ul class="simple">
<li><p><strong>Understand</strong> the multiple comparisons problem and why controlling family-wise error rate is essential</p></li>
<li><p><strong>Compare</strong> different post-hoc methods: Tukey’s HSD, Bonferroni, and Scheffé’s method</p></li>
<li><p><strong>Apply</strong> Tukey’s Honestly Significant Difference (HSD) procedure after significant ANOVA results</p></li>
<li><p><strong>Interpret</strong> confidence intervals for pairwise differences between group means</p></li>
<li><p><strong>Conduct</strong> simulation studies to evaluate Type I error rates and statistical power</p></li>
<li><p><strong>Analyze</strong> real datasets using one-way ANOVA followed by appropriate post-hoc comparisons</p></li>
<li><p><strong>Create</strong> visual summaries of multiple comparison results using R</p></li>
</ul>
</div>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h2>
<p>In <a class="reference internal" href="worksheet18.html#worksheet18"><span class="std std-ref">Worksheet 18: One-Way ANOVA (Analysis of Variance)</span></a>, we introduced One-Way Analysis of Variance (ANOVA) as a powerful statistical method for comparing multiple group means simultaneously, while controlling the overall Type I error rate. When ANOVA produces a statistically significant result, we conclude at least one group mean differs from the others. However, the ANOVA test alone does not reveal specifically which group means differ. Identifying precisely where these differences occur requires further pairwise comparisons between individual groups.</p>
</section>
<section id="the-multiple-comparisons-problem">
<h2>The Multiple Comparisons Problem<a class="headerlink" href="#the-multiple-comparisons-problem" title="Link to this heading"></a></h2>
<p>Consider an agricultural study involving a single crop type, where researchers evaluate the effectiveness of 30 different fertilizer treatments to maximize crop yield. Suppose there are 10 plots of land randomly assigned to each fertilizer, for a total of 300 observations (30 groups × 10 observations per group). An ANOVA conducted on the collected yield data might show strong statistical evidence that at least one fertilizer type leads to significantly different crop yields compared to the others.</p>
<p>Once the ANOVA reveals differences among these 30 fertilizer groups, the logical next question is:</p>
<p><em>“Exactly which fertilizers differ significantly in their average yield performance?”</em></p>
<p>To answer this, researchers typically consider making separate pairwise comparisons. However, with 30 fertilizer treatments, the total number of pairwise comparisons required is substantial:</p>
<div class="math notranslate nohighlight">
\[\binom{30}{2} = \frac{30 \times 29}{2} = 435 \text{ pairwise comparisons}\]</div>
<p>If each of these 435 comparisons is conducted individually at the standard significance level of 5 percent, the probability of incorrectly declaring at least one significant difference (Type I error) dramatically exceeds the desired 5 percent level. If we (naively) treat these comparisons as independent, then an approximate upper bound on the overall Type I error rate can be computed as:</p>
<div class="math notranslate nohighlight">
\[P(\text{at least one Type I error}) \approx 1 - (1 - 0.05)^{435} \approx 1 - (0.95)^{435}\]</div>
<p>Under the assumption of independence, this value is very close to 1, implying an almost certain chance of making at least one false claim of difference. Of course, in practice, these tests may not be fully independent, so the actual value can differ. However, this rough approximation still demonstrates that the risk of false discoveries quickly becomes unacceptably large when many comparisons are made without adjusting the procedure.</p>
</section>
<section id="methods-to-control-the-family-wise-error-rate">
<h2>Methods to Control the Family-Wise Error Rate<a class="headerlink" href="#methods-to-control-the-family-wise-error-rate" title="Link to this heading"></a></h2>
<p>To avoid drawing unreliable conclusions, researchers employ <strong>multiple comparison procedures</strong> that help ensure the probability of making one or more false discoveries (Type I errors) across all comparisons remains at or below the desired level (for example, 5 percent). Common methods include:</p>
<section id="scheffe-s-method">
<h3>Scheffé’s Method<a class="headerlink" href="#scheffe-s-method" title="Link to this heading"></a></h3>
<p><strong>Scheffé’s method</strong> is designed to allow testing of any contrast (a contrast is a linear combination of group means used to compare one set of groups to another), making it more flexible than methods intended solely for pairwise comparisons. It sets an appropriate critical value that controls the family-wise error rate for all possible linear contrasts.</p>
<p><strong>Assumptions:</strong> Scheffé’s method relies on independence of observations and approximate normality in each group, along with no extreme differences in variances.</p>
<p><strong>Conservativeness:</strong> Scheffé’s method is often considered the most conservative among these classical procedures. It produces relatively wide intervals for differences, so it may require stronger evidence to declare a difference significant.</p>
<p><strong>Issues:</strong> While it accommodates any linear contrast, Scheffé’s method is frequently the most conservative among these procedures. It yields wide confidence intervals and demands strong evidence for significance, thus lowering power and making it harder to detect real effects in studies with many groups.</p>
</section>
<section id="bonferroni-correction">
<h3>Bonferroni Correction<a class="headerlink" href="#bonferroni-correction" title="Link to this heading"></a></h3>
<p>The <strong>Bonferroni correction</strong> is the simplest approach for controlling the family-wise error rate. It divides the chosen alpha by the total number of comparisons, making each individual test more stringent. This method ensures that the overall rate of false positives stays at or below the intended alpha level, no matter how many comparisons are performed.</p>
<p><strong>Assumptions:</strong> Groups should be (approximately) normal and sampled independently, with no extreme differences in variances. The Bonferroni method can be used with both pre-planned and unplanned comparisons.</p>
<p><strong>Conservativeness:</strong> It is known to be quite conservative, which lowers the chance of detecting real differences when a large number of comparisons are performed. The corrected threshold for significance may become so small that many true effects remain undiscovered.</p>
<p><strong>Issues:</strong> When a large number of comparisons are performed, Bonferroni’s strict cutoff makes it extremely conservative, often leading to a very small per-test alpha. This can greatly reduce the power to detect true differences, increasing the chance of overlooking meaningful effects.</p>
</section>
<section id="tukey-s-honestly-significant-difference-hsd">
<h3>Tukey’s Honestly Significant Difference (HSD)<a class="headerlink" href="#tukey-s-honestly-significant-difference-hsd" title="Link to this heading"></a></h3>
<p><strong>Tukey’s HSD</strong> focuses on pairwise comparisons of group means following a significant one-way ANOVA. It calculates a single critical difference, derived from the studentized range, that applies to all pairwise comparisons. An extended version, often called Tukey-Kramer, adjusts for unequal sample sizes.</p>
<p><strong>Assumptions:</strong> Data in each group should be sampled independently from (approximately) normal populations, with variances that are not drastically different. While Tukey-Kramer can address unequal group sizes, extreme imbalance or variance irregularities may still lower its accuracy.</p>
<p><strong>Conservativeness:</strong> Compared to Bonferroni, Tukey’s methods are typically less conservative for pairwise tests, allowing better power to detect genuine differences among multiple groups.</p>
<p><strong>Issues:</strong> Because Tukey’s procedure depends on the studentized range distribution (which models the maximum spread of group means), it is especially sensitive to outliers and non-normal data. A single extreme observation or heavy skew can inflate the observed range, undermining the accuracy and power of the test. Moreover, Tukey’s HSD is limited to pairwise comparisons.</p>
</section>
<section id="advice-on-selection">
<h3>Advice on Selection<a class="headerlink" href="#advice-on-selection" title="Link to this heading"></a></h3>
<div class="tip admonition">
<p class="admonition-title">Choosing a Method 💡</p>
<ul class="simple">
<li><p>If you need to compare <strong>any combination of group means</strong>, Scheffé’s method grants the greatest flexibility, though with lowered power.</p></li>
<li><p>If you have a <strong>large number of comparisons</strong> but want a very simple control method, Bonferroni guarantees a strict overall alpha but at the cost of potentially missing real differences.</p></li>
<li><p>If your sole interest is in <strong>pairwise comparisons</strong> among multiple groups, Tukey’s HSD usually strikes a better balance between error control and power, provided data are not severely non-normal or highly imbalanced in sample size.</p></li>
</ul>
</div>
<p>We will focus on using <strong>Tukey’s procedure</strong> in this course, given that our primary concern is pairwise comparisons. Bonferroni is easy to apply and offers strict error control, but it often becomes too conservative with many comparisons. Scheffé’s method allows more complex comparisons and is the most flexible but is also the most conservative. Because we wish to pinpoint which pairs of group means differ, and because Tukey’s method balances effectiveness and simplicity in doing so, it will be our primary tool.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In situations where the number of groups is in the thousands, classical methods like Bonferroni, Scheffé, or Tukey’s HSD can become too conservative and impractical. Instead, researchers often use methods that control the <strong>false discovery rate</strong>, such as the Benjamini-Hochberg procedure, which aim to limit the proportion of false positives rather than insisting on zero or one false discovery across thousands of comparisons.</p>
</div>
</section>
</section>
<section id="part-1-simulation-study-type-i-error-with-multiple-comparison-methods">
<h2>Part 1: Simulation Study - Type I Error with Multiple Comparison Methods<a class="headerlink" href="#part-1-simulation-study-type-i-error-with-multiple-comparison-methods" title="Link to this heading"></a></h2>
<p>We will generate data from multiple groups, all sharing the same true mean. Because there are no real differences, any claim that a pair of groups differs is a false discovery.</p>
<p>The steps below will:</p>
<ol class="arabic simple">
<li><p>Generate data from multiple groups all sharing the same true mean (hence no real differences).</p></li>
<li><p>Run an ANOVA on each simulated dataset to check if it is significant.</p></li>
<li><p>If ANOVA is significant, apply Scheffé, Bonferroni, and Tukey’s HSD to see whether they claim any differences.</p></li>
<li><p>Record how often these methods incorrectly identify group differences (false positives) under a scenario of no true differences.</p></li>
</ol>
<section id="simulation-code">
<h3>Simulation Code<a class="headerlink" href="#simulation-code" title="Link to this heading"></a></h3>
<p>Below is the complete R code for the simulation study. Copy this code and save it as <code class="docutils literal notranslate"><span class="pre">MultipleComparison_Sim.R</span></code> or run it directly in R.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#--------------------------------------------------------------------------</span>
<span class="c1"># Simulation Study: ANOVA and Post-Hoc Tests with Flexible Mean Configuration</span>
<span class="c1">#--------------------------------------------------------------------------</span>
<span class="c1"># Purpose:</span>
<span class="c1"># This script simulates data for a one-way ANOVA design with two possible cases:</span>
<span class="c1"># 1. Null case: All group means are equal (H0 true)</span>
<span class="c1"># 2. Alternative case: Some group means differ (H1 true)</span>
<span class="c1">#</span>
<span class="c1"># It evaluates:</span>
<span class="c1"># 1. The Type I error rate of the overall ANOVA F-test (case 1)</span>
<span class="c1"># 2. The power of ANOVA to detect differences (case 2)</span>
<span class="c1"># 3. The performance of three common post-hoc multiple comparison procedures</span>
<span class="c1">#    (Scheffe, Bonferroni, Tukey HSD) in controlling error rates or detecting</span>
<span class="c1">#    true differences</span>
<span class="c1">#--------------------------------------------------------------------------</span>

<span class="c1"># Load necessary libraries (implicitly uses stats package)</span>

<span class="c1"># --- Simulation Parameters ---</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span><span class="w">   </span><span class="c1"># Ensure reproducibility</span>
<span class="n">N</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1500</span><span class="w">       </span><span class="c1"># Number of simulated datasets (replications)</span>
<span class="n">k</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">10</span><span class="w">          </span><span class="c1"># Number of groups to compare</span>
<span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">50</span><span class="w">         </span><span class="c1"># Observations per group (equal sample sizes assumed)</span>
<span class="n">alpha</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0.05</span><span class="w">   </span><span class="c1"># Significance level (threshold for p-values)</span>

<span class="c1"># --- Common Parameters ---</span>
<span class="n">base_mean</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="c1"># Base mean value for all groups</span>
<span class="n">sd_true</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">8</span><span class="w">    </span><span class="c1"># Common standard deviation for all groups (homoscedasticity)</span>
<span class="n">total_obs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="c1"># Total observations in each simulated dataset</span>

<span class="c1"># --- Case Selection ---</span>
<span class="c1"># Set simulation_case to 1 for Null Hypothesis (all means equal)</span>
<span class="c1"># Set simulation_case to 2 for Alternative Hypothesis (some means differ)</span>
<span class="n">simulation_case</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="w">  </span><span class="c1"># Set to null case for testing Type I error</span>

<span class="c1"># --- Setup Group Means Based on Case ---</span>
<span class="n">set_group_means</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">case_number</span><span class="p">,</span><span class="w"> </span><span class="n">base_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">effect_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">case_number</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1"># Case 1: All means equal (H0 true)</span>
<span class="w">    </span><span class="n">true_means</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="n">base_value</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span>
<span class="w">    </span><span class="nf">names</span><span class="p">(</span><span class="n">true_means</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">paste0</span><span class="p">(</span><span class="s">&quot;Group&quot;</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">k</span><span class="p">)</span>
<span class="w">    </span><span class="kr">return</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span>
<span class="w">      </span><span class="n">means</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">true_means</span><span class="p">,</span>
<span class="w">      </span><span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Null case (H0): All group means equal&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="n">h0_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span>
<span class="w">    </span><span class="p">))</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1"># Case 2: Some means differ (H1 true)</span>
<span class="w">    </span><span class="c1"># Randomly determine how many groups will have different means (at least 1)</span>
<span class="w">    </span><span class="n">n_diff_groups</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">min</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="m">-1</span><span class="p">),</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">  </span><span class="c1"># At least 1, at most 3 or k-1</span>
<span class="w">    </span><span class="n">diff_group_indices</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">n_diff_groups</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># Generate means</span>
<span class="w">    </span><span class="n">true_means</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="n">base_value</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># Create reasonable effect sizes (not too extreme)</span>
<span class="w">    </span><span class="kr">for</span><span class="w"> </span><span class="p">(</span><span class="n">idx</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="n">diff_group_indices</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1"># Generate random effects between 0.5 and 1.5 times the specified effect size</span>
<span class="w">      </span><span class="n">effect_multiplier</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">runif</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">1.5</span><span class="p">)</span>
<span class="w">      </span><span class="c1"># Randomly choose direction of effect (positive or negative)</span>
<span class="w">      </span><span class="n">direction</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="w">      </span><span class="n">true_means</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">base_value</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">effect_multiplier</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">effect_size</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sd_true</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nf">names</span><span class="p">(</span><span class="n">true_means</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">paste0</span><span class="p">(</span><span class="s">&quot;Group&quot;</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">k</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># Create a matrix of which pairs actually differ</span>
<span class="w">    </span><span class="n">pairs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">combn</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
<span class="w">    </span><span class="n">n_pairs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ncol</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
<span class="w">    </span><span class="n">true_diff_matrix</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">logical</span><span class="p">(</span><span class="n">n_pairs</span><span class="p">)</span>
<span class="w">    </span><span class="kr">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">n_pairs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">true_diff_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="n">true_means</span><span class="p">[</span><span class="n">pairs</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">true_means</span><span class="p">[</span><span class="n">pairs</span><span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="n">i</span><span class="p">]])</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">1e-10</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kr">return</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span>
<span class="w">      </span><span class="n">means</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">true_means</span><span class="p">,</span>
<span class="w">      </span><span class="n">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">paste0</span><span class="p">(</span><span class="s">&quot;Alternative case (H1): &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n_diff_groups</span><span class="p">,</span><span class="w"> </span><span class="s">&quot; group(s) with different means&quot;</span><span class="p">),</span>
<span class="w">      </span><span class="n">h0_true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span>
<span class="w">      </span><span class="n">diff_groups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">diff_group_indices</span><span class="p">,</span>
<span class="w">      </span><span class="n">true_diff_pairs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">true_diff_matrix</span><span class="p">,</span>
<span class="w">      </span><span class="n">n_true_diff_pairs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">true_diff_matrix</span><span class="p">),</span>
<span class="w">      </span><span class="n">n_equal_pairs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n_pairs</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">true_diff_matrix</span><span class="p">)</span>
<span class="w">    </span><span class="p">))</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Set up simulation case</span>
<span class="n">case_config</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">set_group_means</span><span class="p">(</span><span class="n">simulation_case</span><span class="p">,</span><span class="w"> </span><span class="n">base_mean</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">effect_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.75</span><span class="p">)</span>
<span class="n">true_means</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">case_config</span><span class="o">$</span><span class="n">means</span>

<span class="c1"># --- Create a group factor that will be reused for all datasets ---</span>
<span class="n">group_factor</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">))</span>

<span class="c1">#--------------------------------------------------------------------------</span>
<span class="c1"># Step 1: Generate all Simulated Datasets</span>
<span class="c1">#--------------------------------------------------------------------------</span>
<span class="c1"># Generate data for all simulations at once</span>
<span class="n">generate_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">true_means</span><span class="p">,</span><span class="w"> </span><span class="n">n_per_group</span><span class="p">,</span><span class="w"> </span><span class="n">n_simulations</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">true_means</span><span class="p">)</span>
<span class="w">  </span><span class="n">total_obs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n_per_group</span>

<span class="w">  </span><span class="c1"># Create a matrix to hold all simulated datasets</span>
<span class="w">  </span><span class="n">all_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">matrix</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n_simulations</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">total_obs</span><span class="p">)</span>

<span class="w">  </span><span class="c1"># Fill the matrix with data</span>
<span class="w">  </span><span class="kr">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">n_simulations</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">row_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">numeric</span><span class="p">(</span><span class="n">total_obs</span><span class="p">)</span>
<span class="w">    </span><span class="kr">for</span><span class="w"> </span><span class="p">(</span><span class="n">g</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">start_idx</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">g</span><span class="m">-1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n_per_group</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span>
<span class="w">      </span><span class="n">end_idx</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n_per_group</span>
<span class="w">      </span><span class="n">row_data</span><span class="p">[</span><span class="n">start_idx</span><span class="o">:</span><span class="n">end_idx</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="n">n_per_group</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">true_means</span><span class="p">[</span><span class="n">g</span><span class="p">],</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sd</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">all_data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">row_data</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kr">return</span><span class="p">(</span><span class="n">all_data</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Generate the data</span>
<span class="n">all_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">generate_data</span><span class="p">(</span><span class="n">true_means</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">sd_true</span><span class="p">)</span>

<span class="c1">#--------------------------------------------------------------------------</span>
<span class="c1"># Step 2: Run ANOVA on each dataset</span>
<span class="c1">#--------------------------------------------------------------------------</span>

<span class="c1"># Function to perform ANOVA on a single row (one simulated dataset)</span>
<span class="n">run_anova</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">dataset_row</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">data_anova</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataset_row</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">group_factor</span><span class="p">)</span>
<span class="w">  </span><span class="n">anova_result</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">aov</span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">group</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_anova</span><span class="p">)</span>
<span class="w">  </span><span class="n">anova_summary</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="n">anova_result</span><span class="p">)</span>
<span class="w">  </span><span class="n">p_value</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">anova_summary</span><span class="p">[[</span><span class="m">1</span><span class="p">]]</span><span class="o">$</span><span class="s">&quot;Pr(&gt;F)&quot;</span><span class="p">[</span><span class="m">1</span><span class="p">]</span>
<span class="w">  </span><span class="kr">return</span><span class="p">(</span><span class="n">p_value</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Apply the run_anova function to each row (dataset) of the all_data matrix</span>
<span class="n">p_values_anova</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="n">all_data</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">run_anova</span><span class="p">)</span>

<span class="c1"># Identify significant ANOVA results</span>
<span class="n">significant_indices</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">which</span><span class="p">(</span><span class="n">p_values_anova</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">alpha</span><span class="p">)</span>
<span class="n">n_sig_anova</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">significant_indices</span><span class="p">)</span>
<span class="n">anova_sig_rate</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">n_sig_anova</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">N</span>

<span class="c1">#--------------------------------------------------------------------------</span>
<span class="c1"># Step 3: Perform Multiple Comparison Tests (Post-Hoc)</span>
<span class="c1">#         ONLY on datasets where ANOVA was significant</span>
<span class="c1">#--------------------------------------------------------------------------</span>
<span class="c1"># Initialize variables</span>
<span class="n">n_pairs_total</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2</span>
<span class="n">multi_test_results_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NULL</span>
<span class="n">conditional_scheffe_FWER</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="n">conditional_bonferroni_FWER</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="n">conditional_tukey_FWER</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="n">unconditional_scheffe_FWER</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="n">unconditional_bonferroni_FWER</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="n">unconditional_tukey_FWER</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="n">scheffe_PCER</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="n">bonferroni_PCER</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="n">tukey_PCER</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="n">scheffe_avg_discoveries</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="n">bonferroni_avg_discoveries</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="n">tukey_avg_discoveries</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="n">error_summary_table</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NULL</span>

<span class="c1"># Function for multiple comparisons</span>
<span class="n">perform_multiple_tests</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">dataset_row</span><span class="p">,</span><span class="w"> </span><span class="n">true_diff_pairs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">data_test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataset_row</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">group_factor</span><span class="p">)</span>
<span class="w">  </span><span class="n">anova_result</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">aov</span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">group</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_test</span><span class="p">)</span>
<span class="w">  </span><span class="n">anova_summary</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="n">anova_result</span><span class="p">)</span>
<span class="w">  </span><span class="n">mse</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">anova_summary</span><span class="p">[[</span><span class="m">1</span><span class="p">]]</span><span class="o">$</span><span class="s">&quot;Mean Sq&quot;</span><span class="p">[</span><span class="m">2</span><span class="p">]</span>
<span class="w">  </span><span class="n">group_means</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tapply</span><span class="p">(</span><span class="n">data_test</span><span class="o">$</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">data_test</span><span class="o">$</span><span class="n">group</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span>

<span class="w">  </span><span class="c1"># For all pairwise comparisons</span>
<span class="w">  </span><span class="n">pairs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">combn</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
<span class="w">  </span><span class="n">n_pairs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ncol</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
<span class="w">  </span><span class="n">mean_diffs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="n">group_means</span><span class="p">[</span><span class="n">pairs</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">group_means</span><span class="p">[</span><span class="n">pairs</span><span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="p">]])</span>
<span class="w">  </span><span class="n">se_diff</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="m">1</span><span class="o">/</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="o">/</span><span class="n">n</span><span class="p">))</span>
<span class="w">  </span><span class="n">t_stats</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mean_diffs</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">se_diff</span>

<span class="w">  </span><span class="c1"># Get degrees of freedom</span>
<span class="w">  </span><span class="n">df_between</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span>
<span class="w">  </span><span class="n">df_within</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">k</span>

<span class="w">  </span><span class="c1"># Scheffe test</span>
<span class="w">  </span><span class="n">scheffe_F_crit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">qf</span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">df_between</span><span class="p">,</span><span class="w"> </span><span class="n">df_within</span><span class="p">)</span>
<span class="w">  </span><span class="n">scheffe_t_crit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">df_between</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">scheffe_F_crit</span><span class="p">)</span>
<span class="w">  </span><span class="n">scheffe_significant</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">t_stats</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">scheffe_t_crit</span>
<span class="w">  </span><span class="n">scheffe_significant_count</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">scheffe_significant</span><span class="p">)</span>

<span class="w">  </span><span class="c1"># Bonferroni test</span>
<span class="w">  </span><span class="n">bonferroni_alpha_adj</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">n_pairs</span>
<span class="w">  </span><span class="n">bonferroni_t_crit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">qt</span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">bonferroni_alpha_adj</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">df_within</span><span class="p">)</span>
<span class="w">  </span><span class="n">bonferroni_significant</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">t_stats</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">bonferroni_t_crit</span>
<span class="w">  </span><span class="n">bonferroni_significant_count</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">bonferroni_significant</span><span class="p">)</span>

<span class="w">  </span><span class="c1"># Tukey HSD test</span>
<span class="w">  </span><span class="n">tukey_result</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">TukeyHSD</span><span class="p">(</span><span class="n">anova_result</span><span class="p">,</span><span class="w"> </span><span class="n">conf.level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">alpha</span><span class="p">)</span>
<span class="w">  </span><span class="n">tukey_p_values_adj</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tukey_result</span><span class="o">$</span><span class="n">group</span><span class="p">[,</span><span class="w"> </span><span class="s">&quot;p adj&quot;</span><span class="p">]</span>
<span class="w">  </span><span class="n">tukey_significant</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tukey_p_values_adj</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">alpha</span>
<span class="w">  </span><span class="n">tukey_significant_count</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">tukey_significant</span><span class="p">)</span>

<span class="w">  </span><span class="c1"># If true pairs info is provided, calculate true positive and false positive counts</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nf">is.null</span><span class="p">(</span><span class="n">true_diff_pairs</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1"># Calculate true positives and false positives</span>
<span class="w">    </span><span class="n">scheffe_tp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">scheffe_significant</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">true_diff_pairs</span><span class="p">)</span>
<span class="w">    </span><span class="n">scheffe_fp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">scheffe_significant</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">true_diff_pairs</span><span class="p">)</span>

<span class="w">    </span><span class="n">bonferroni_tp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">bonferroni_significant</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">true_diff_pairs</span><span class="p">)</span>
<span class="w">    </span><span class="n">bonferroni_fp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">bonferroni_significant</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">true_diff_pairs</span><span class="p">)</span>

<span class="w">    </span><span class="n">tukey_tp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">tukey_significant</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">true_diff_pairs</span><span class="p">)</span>
<span class="w">    </span><span class="n">tukey_fp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">tukey_significant</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">true_diff_pairs</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># Return counts along with TP/FP breakdown</span>
<span class="w">    </span><span class="kr">return</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span>
<span class="w">      </span><span class="n">scheffe_n_sig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scheffe_significant_count</span><span class="p">,</span>
<span class="w">      </span><span class="n">scheffe_any_sig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">scheffe_significant_count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">),</span>
<span class="w">      </span><span class="n">scheffe_tp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scheffe_tp</span><span class="p">,</span>
<span class="w">      </span><span class="n">scheffe_fp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scheffe_fp</span><span class="p">,</span>

<span class="w">      </span><span class="n">bonferroni_n_sig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bonferroni_significant_count</span><span class="p">,</span>
<span class="w">      </span><span class="n">bonferroni_any_sig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">bonferroni_significant_count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">),</span>
<span class="w">      </span><span class="n">bonferroni_tp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bonferroni_tp</span><span class="p">,</span>
<span class="w">      </span><span class="n">bonferroni_fp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bonferroni_fp</span><span class="p">,</span>

<span class="w">      </span><span class="n">tukey_n_sig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tukey_significant_count</span><span class="p">,</span>
<span class="w">      </span><span class="n">tukey_any_sig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">tukey_significant_count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">),</span>
<span class="w">      </span><span class="n">tukey_tp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tukey_tp</span><span class="p">,</span>
<span class="w">      </span><span class="n">tukey_fp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tukey_fp</span>
<span class="w">    </span><span class="p">))</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1"># Basic return when no true pairs info provided</span>
<span class="w">    </span><span class="kr">return</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span>
<span class="w">      </span><span class="n">scheffe_n_sig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scheffe_significant_count</span><span class="p">,</span>
<span class="w">      </span><span class="n">scheffe_any_sig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">scheffe_significant_count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">),</span>
<span class="w">      </span><span class="n">bonferroni_n_sig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bonferroni_significant_count</span><span class="p">,</span>
<span class="w">      </span><span class="n">bonferroni_any_sig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">bonferroni_significant_count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">),</span>
<span class="w">      </span><span class="n">tukey_n_sig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tukey_significant_count</span><span class="p">,</span>
<span class="w">      </span><span class="n">tukey_any_sig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">tukey_significant_count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<span class="w">    </span><span class="p">))</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Proceed with calculations only if there are significant ANOVAs</span>
<span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">n_sig_anova</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">significant_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">all_data</span><span class="p">[</span><span class="n">significant_indices</span><span class="p">,</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">drop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">]</span>

<span class="w">  </span><span class="c1"># Apply the multiple comparison function</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">case_config</span><span class="o">$</span><span class="n">h0_true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1"># For null case, don&#39;t need to track true/false positives</span>
<span class="w">    </span><span class="n">multi_test_results</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">t</span><span class="p">(</span><span class="nf">apply</span><span class="p">(</span><span class="n">significant_data</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">perform_multiple_tests</span><span class="p">))</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1"># For alternative case, track true/false positives</span>
<span class="w">    </span><span class="n">multi_test_results</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">t</span><span class="p">(</span><span class="nf">apply</span><span class="p">(</span><span class="n">significant_data</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">row</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nf">perform_multiple_tests</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="w"> </span><span class="n">true_diff_pairs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">case_config</span><span class="o">$</span><span class="n">true_diff_pairs</span><span class="p">)</span>
<span class="w">    </span><span class="p">}))</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="n">multi_test_results_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="n">multi_test_results</span><span class="p">)</span>

<span class="w">  </span><span class="c1"># Calculate FWER and other metrics</span>
<span class="w">  </span><span class="n">conditional_scheffe_FWER</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">scheffe_any_sig</span><span class="p">)</span>
<span class="w">  </span><span class="n">conditional_bonferroni_FWER</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">bonferroni_any_sig</span><span class="p">)</span>
<span class="w">  </span><span class="n">conditional_tukey_FWER</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">tukey_any_sig</span><span class="p">)</span>

<span class="w">  </span><span class="c1"># Calculate Unconditional FWER</span>
<span class="w">  </span><span class="n">unconditional_scheffe_FWER</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">conditional_scheffe_FWER</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">anova_sig_rate</span>
<span class="w">  </span><span class="n">unconditional_bonferroni_FWER</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">conditional_bonferroni_FWER</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">anova_sig_rate</span>
<span class="w">  </span><span class="n">unconditional_tukey_FWER</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">conditional_tukey_FWER</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">anova_sig_rate</span>

<span class="w">  </span><span class="c1"># For null case, all discoveries are false positives</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">case_config</span><span class="o">$</span><span class="n">h0_true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1"># Calculate per-comparison error rates</span>
<span class="w">    </span><span class="n">total_comparisons_performed</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">n_sig_anova</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n_pairs_total</span>

<span class="w">    </span><span class="n">scheffe_PCER</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">scheffe_n_sig</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">total_comparisons_performed</span>
<span class="w">    </span><span class="n">bonferroni_PCER</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">bonferroni_n_sig</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">total_comparisons_performed</span>
<span class="w">    </span><span class="n">tukey_PCER</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">tukey_n_sig</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">total_comparisons_performed</span>

<span class="w">    </span><span class="n">scheffe_avg_discoveries</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">scheffe_n_sig</span><span class="p">)</span>
<span class="w">    </span><span class="n">bonferroni_avg_discoveries</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">bonferroni_n_sig</span><span class="p">)</span>
<span class="w">    </span><span class="n">tukey_avg_discoveries</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">tukey_n_sig</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># Summary table for null case</span>
<span class="w">    </span><span class="n">error_summary_table</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="w">      </span><span class="n">Method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Scheffe&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Bonferroni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Tukey HSD&quot;</span><span class="p">),</span>
<span class="w">      </span><span class="n">Conditional_FWER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">conditional_scheffe_FWER</span><span class="p">,</span><span class="w"> </span><span class="n">conditional_bonferroni_FWER</span><span class="p">,</span><span class="w"> </span><span class="n">conditional_tukey_FWER</span><span class="p">),</span><span class="w"> </span><span class="m">4</span><span class="p">),</span>
<span class="w">      </span><span class="n">Unconditional_FWER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">unconditional_scheffe_FWER</span><span class="p">,</span><span class="w"> </span><span class="n">unconditional_bonferroni_FWER</span><span class="p">,</span><span class="w"> </span><span class="n">unconditional_tukey_FWER</span><span class="p">),</span><span class="w"> </span><span class="m">4</span><span class="p">),</span>
<span class="w">      </span><span class="n">Per_Comparison_Error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">scheffe_PCER</span><span class="p">,</span><span class="w"> </span><span class="n">bonferroni_PCER</span><span class="p">,</span><span class="w"> </span><span class="n">tukey_PCER</span><span class="p">),</span><span class="w"> </span><span class="m">4</span><span class="p">),</span>
<span class="w">      </span><span class="n">Avg_False_Discoveries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">scheffe_avg_discoveries</span><span class="p">,</span><span class="w"> </span><span class="n">bonferroni_avg_discoveries</span><span class="p">,</span><span class="w"> </span><span class="n">tukey_avg_discoveries</span><span class="p">),</span><span class="w"> </span><span class="m">3</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1"># For alternative case, calculate TPR and FPR</span>
<span class="w">    </span><span class="c1"># Total possible true positives across all sig datasets</span>
<span class="w">    </span><span class="n">total_possible_tp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">n_sig_anova</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">case_config</span><span class="o">$</span><span class="n">n_true_diff_pairs</span>
<span class="w">    </span><span class="c1"># Total possible false positives across all sig datasets</span>
<span class="w">    </span><span class="n">total_possible_fp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">n_sig_anova</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">case_config</span><span class="o">$</span><span class="n">n_equal_pairs</span>

<span class="w">    </span><span class="c1"># Prevent division by zero</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">total_possible_tp</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">scheffe_tpr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">scheffe_tp</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">total_possible_tp</span>
<span class="w">      </span><span class="n">bonferroni_tpr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">bonferroni_tp</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">total_possible_tp</span>
<span class="w">      </span><span class="n">tukey_tpr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">tukey_tp</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">total_possible_tp</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1"># If there are no true differences, set TPR to NA</span>
<span class="w">      </span><span class="n">scheffe_tpr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="w">      </span><span class="n">bonferroni_tpr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="w">      </span><span class="n">tukey_tpr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="w">      </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Warning: No true differences between groups (check case setup)\n&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">total_possible_fp</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">scheffe_fpr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">scheffe_fp</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">total_possible_fp</span>
<span class="w">      </span><span class="n">bonferroni_fpr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">bonferroni_fp</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">total_possible_fp</span>
<span class="w">      </span><span class="n">tukey_fpr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">tukey_fp</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">total_possible_fp</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1"># If all pairs differ, set FPR to NA</span>
<span class="w">      </span><span class="n">scheffe_fpr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="w">      </span><span class="n">bonferroni_fpr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="w">      </span><span class="n">tukey_fpr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="w">      </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Warning: All pairs have different means (no null pairs to measure FPR)\n&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1"># Calculate average discoveries</span>
<span class="w">    </span><span class="n">scheffe_avg_discoveries</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">scheffe_n_sig</span><span class="p">)</span>
<span class="w">    </span><span class="n">bonferroni_avg_discoveries</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">bonferroni_n_sig</span><span class="p">)</span>
<span class="w">    </span><span class="n">tukey_avg_discoveries</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">tukey_n_sig</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># Calculate avg true/false positives</span>
<span class="w">    </span><span class="n">scheffe_avg_tp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">scheffe_tp</span><span class="p">)</span>
<span class="w">    </span><span class="n">scheffe_avg_fp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">scheffe_fp</span><span class="p">)</span>

<span class="w">    </span><span class="n">bonferroni_avg_tp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">bonferroni_tp</span><span class="p">)</span>
<span class="w">    </span><span class="n">bonferroni_avg_fp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">bonferroni_fp</span><span class="p">)</span>

<span class="w">    </span><span class="n">tukey_avg_tp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">tukey_tp</span><span class="p">)</span>
<span class="w">    </span><span class="n">tukey_avg_fp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">tukey_fp</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># Summary table for alternative case</span>
<span class="w">    </span><span class="n">error_summary_table</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="w">      </span><span class="n">Method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Scheffe&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Bonferroni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Tukey HSD&quot;</span><span class="p">),</span>
<span class="w">      </span><span class="n">True_Positive_Rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">scheffe_tpr</span><span class="p">,</span><span class="w"> </span><span class="n">bonferroni_tpr</span><span class="p">,</span><span class="w"> </span><span class="n">tukey_tpr</span><span class="p">),</span><span class="w"> </span><span class="m">4</span><span class="p">),</span>
<span class="w">      </span><span class="n">False_Positive_Rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">scheffe_fpr</span><span class="p">,</span><span class="w"> </span><span class="n">bonferroni_fpr</span><span class="p">,</span><span class="w"> </span><span class="n">tukey_fpr</span><span class="p">),</span><span class="w"> </span><span class="m">4</span><span class="p">),</span>
<span class="w">      </span><span class="n">Avg_TP_per_dataset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">scheffe_avg_tp</span><span class="p">,</span><span class="w"> </span><span class="n">bonferroni_avg_tp</span><span class="p">,</span><span class="w"> </span><span class="n">tukey_avg_tp</span><span class="p">),</span><span class="w"> </span><span class="m">3</span><span class="p">),</span>
<span class="w">      </span><span class="n">Avg_FP_per_dataset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">scheffe_avg_fp</span><span class="p">,</span><span class="w"> </span><span class="n">bonferroni_avg_fp</span><span class="p">,</span><span class="w"> </span><span class="n">tukey_avg_fp</span><span class="p">),</span><span class="w"> </span><span class="m">3</span><span class="p">),</span>
<span class="w">      </span><span class="n">Total_Discoveries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">scheffe_avg_discoveries</span><span class="p">,</span><span class="w"> </span><span class="n">bonferroni_avg_discoveries</span><span class="p">,</span><span class="w"> </span><span class="n">tukey_avg_discoveries</span><span class="p">),</span><span class="w"> </span><span class="m">3</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span><span class="w"> </span><span class="c1"># End if(n_sig_anova &gt; 0)</span>

<span class="c1">#--------------------------------------------------------------------------</span>
<span class="c1"># Step 4: Generate Output</span>
<span class="c1">#--------------------------------------------------------------------------</span>

<span class="c1"># --- Report Case Information and ANOVA Results ---</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;--- ANOVA Simulation Results ---\n&quot;</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Case:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">case_config</span><span class="o">$</span><span class="n">description</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Total number of simulations (N):&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Number of groups (k):&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Sample size per group (n):&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;True group means:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="n">true_means</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">collapse</span><span class="o">=</span><span class="s">&quot;, &quot;</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Common standard deviation:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sd_true</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Significance level (alpha):&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>

<span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">case_config</span><span class="o">$</span><span class="n">h0_true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1"># Additional info for alternative case</span>
<span class="w">  </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;\nTrue difference information:\n&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="n">pairs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">combn</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
<span class="w">  </span><span class="n">n_pairs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ncol</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
<span class="w">  </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Total pairs:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n_pairs</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Pairs with true differences:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">case_config</span><span class="o">$</span><span class="n">n_true_diff_pairs</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Pairs with equal means:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">case_config</span><span class="o">$</span><span class="n">n_equal_pairs</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>

<span class="w">  </span><span class="c1"># Print which pairs actually differ</span>
<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">case_config</span><span class="o">$</span><span class="n">n_true_diff_pairs</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Pairs that differ: &quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kr">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">n_pairs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">case_config</span><span class="o">$</span><span class="n">true_diff_pairs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nf">cat</span><span class="p">(</span><span class="nf">paste0</span><span class="p">(</span><span class="s">&quot;(&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pairs</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="s">&quot;,&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pairs</span><span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="s">&quot;) &quot;</span><span class="p">))</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;--------------------------------------------------------\n&quot;</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Number of significant ANOVAs:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n_sig_anova</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Proportion of significant ANOVAs:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">anova_sig_rate</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>

<span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">case_config</span><span class="o">$</span><span class="n">h0_true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;(This is the observed Type I Error Rate; expected to be ≈&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;)\n\n&quot;</span><span class="p">)</span>
<span class="p">}</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;(This is the observed Power; depends on effect sizes)\n\n&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># --- Report Post-Hoc Test Results ---</span>
<span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">n_sig_anova</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="nf">is.null</span><span class="p">(</span><span class="n">multi_test_results_df</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;--- Multiple Comparison Test Results ---\n&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Number of datasets with significant ANOVA:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n_sig_anova</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Number of pairwise comparisons per dataset:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n_pairs_total</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;-----------------------------------------------------------------------\n&quot;</span><span class="p">)</span>

<span class="w">  </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">case_config</span><span class="o">$</span><span class="n">h0_true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1"># For null case, report error rates</span>
<span class="w">    </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;\n--- Type I Error Control in Post-Hoc Tests ---\n&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># Helper function to print method results</span>
<span class="w">    </span><span class="n">print_method_results</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">method_name</span><span class="p">,</span><span class="w"> </span><span class="n">any_sig_vec</span><span class="p">,</span><span class="w"> </span><span class="n">n_sig_vec</span><span class="p">,</span><span class="w"> </span><span class="n">cond_fwer</span><span class="p">,</span><span class="w"> </span><span class="n">uncond_fwer</span><span class="p">,</span><span class="w"> </span><span class="n">pcer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nf">cat</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">method_name</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Test:\n&quot;</span><span class="p">))</span>
<span class="w">      </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Datasets with &gt;= 1 significant difference (false discovery):&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">any_sig_vec</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Conditional FWER (Prop. datasets with any false discovery):&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">cond_fwer</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Unconditional FWER (overall probability of false discovery):&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">uncond_fwer</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Average number of false discoveries per dataset:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="nf">mean</span><span class="p">(</span><span class="n">n_sig_vec</span><span class="p">),</span><span class="w"> </span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Per-Comparison Error Rate (PCER):&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">pcer</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1"># Print results for each method</span>
<span class="w">    </span><span class="nf">print_method_results</span><span class="p">(</span><span class="s">&quot;Scheffe&quot;</span><span class="p">,</span>
<span class="w">                         </span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">scheffe_any_sig</span><span class="p">,</span>
<span class="w">                         </span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">scheffe_n_sig</span><span class="p">,</span>
<span class="w">                         </span><span class="n">conditional_scheffe_FWER</span><span class="p">,</span>
<span class="w">                         </span><span class="n">unconditional_scheffe_FWER</span><span class="p">,</span>
<span class="w">                         </span><span class="n">scheffe_PCER</span><span class="p">)</span>

<span class="w">    </span><span class="nf">print_method_results</span><span class="p">(</span><span class="s">&quot;Bonferroni&quot;</span><span class="p">,</span>
<span class="w">                         </span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">bonferroni_any_sig</span><span class="p">,</span>
<span class="w">                         </span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">bonferroni_n_sig</span><span class="p">,</span>
<span class="w">                         </span><span class="n">conditional_bonferroni_FWER</span><span class="p">,</span>
<span class="w">                         </span><span class="n">unconditional_bonferroni_FWER</span><span class="p">,</span>
<span class="w">                         </span><span class="n">bonferroni_PCER</span><span class="p">)</span>

<span class="w">    </span><span class="nf">print_method_results</span><span class="p">(</span><span class="s">&quot;Tukey HSD&quot;</span><span class="p">,</span>
<span class="w">                         </span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">tukey_any_sig</span><span class="p">,</span>
<span class="w">                         </span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">tukey_n_sig</span><span class="p">,</span>
<span class="w">                         </span><span class="n">conditional_tukey_FWER</span><span class="p">,</span>
<span class="w">                         </span><span class="n">unconditional_tukey_FWER</span><span class="p">,</span>
<span class="w">                         </span><span class="n">tukey_PCER</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># Print Summary Table</span>
<span class="w">    </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;\n--- Summary Table: Multiple Comparison Error Rates ---\n&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">print</span><span class="p">(</span><span class="n">error_summary_table</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># Print Interpretation Notes</span>
<span class="w">    </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;\n--- Interpretation Notes for Null Case (H0 True) ---\n&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot; - Simulation Context: All population group means are equal, so any significant difference\n&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;   found is a Type I error (false discovery).\n&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot; - Conditional FWER: P(at least one false pairwise discovery | ANOVA was significant)\n&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot; - Unconditional FWER: Overall P(at least one false pairwise discovery) = Conditional FWER × P(ANOVA significant)\n&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot; - Expected Pattern: Scheffe is most conservative (lowest FWER), followed by Bonferroni,\n&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;   then Tukey HSD, with all controlling FWER at or below alpha = &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>

<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1"># For alternative case, report power and TP/FP rates</span>
<span class="w">    </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;\n--- Power Analysis for Post-Hoc Tests ---\n&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># Helper function to print method results for alternative case</span>
<span class="w">    </span><span class="n">print_power_results</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">method_name</span><span class="p">,</span><span class="w"> </span><span class="n">any_sig_vec</span><span class="p">,</span><span class="w"> </span><span class="n">tp_vec</span><span class="p">,</span><span class="w"> </span><span class="n">fp_vec</span><span class="p">,</span><span class="w"> </span><span class="n">tp_rate</span><span class="p">,</span><span class="w"> </span><span class="n">fp_rate</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nf">cat</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">method_name</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Test:\n&quot;</span><span class="p">))</span>
<span class="w">      </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Datasets with &gt;= 1 significant difference detected:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">any_sig_vec</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Conditional Detection Rate (proportion of significant ANOVAs where method found a difference):&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nf">round</span><span class="p">(</span><span class="nf">mean</span><span class="p">(</span><span class="n">any_sig_vec</span><span class="p">),</span><span class="w"> </span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>

<span class="w">      </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">tp_rate</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;True Positive Rate (among possible true differences):&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">tp_rate</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;True Positive Rate: N/A (no true differences to detect)\n&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">fp_rate</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;False Positive Rate (among truly equal pairs):&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">fp_rate</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;False Positive Rate: N/A (no equal pairs to falsely detect)\n&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Average true discoveries per dataset:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="nf">mean</span><span class="p">(</span><span class="n">tp_vec</span><span class="p">),</span><span class="w"> </span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Average false discoveries per dataset:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="nf">mean</span><span class="p">(</span><span class="n">fp_vec</span><span class="p">),</span><span class="w"> </span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1"># Print results for each method using true/false positive rates</span>
<span class="w">    </span><span class="nf">print_power_results</span><span class="p">(</span><span class="s">&quot;Scheffe&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">scheffe_any_sig</span><span class="p">,</span>
<span class="w">                        </span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">scheffe_tp</span><span class="p">,</span>
<span class="w">                        </span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">scheffe_fp</span><span class="p">,</span>
<span class="w">                        </span><span class="n">scheffe_tpr</span><span class="p">,</span>
<span class="w">                        </span><span class="n">scheffe_fpr</span><span class="p">)</span>

<span class="w">    </span><span class="nf">print_power_results</span><span class="p">(</span><span class="s">&quot;Bonferroni&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">bonferroni_any_sig</span><span class="p">,</span>
<span class="w">                        </span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">bonferroni_tp</span><span class="p">,</span>
<span class="w">                        </span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">bonferroni_fp</span><span class="p">,</span>
<span class="w">                        </span><span class="n">bonferroni_tpr</span><span class="p">,</span>
<span class="w">                        </span><span class="n">bonferroni_fpr</span><span class="p">)</span>

<span class="w">    </span><span class="nf">print_power_results</span><span class="p">(</span><span class="s">&quot;Tukey HSD&quot;</span><span class="p">,</span>
<span class="w">                        </span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">tukey_any_sig</span><span class="p">,</span>
<span class="w">                        </span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">tukey_tp</span><span class="p">,</span>
<span class="w">                        </span><span class="n">multi_test_results_df</span><span class="o">$</span><span class="n">tukey_fp</span><span class="p">,</span>
<span class="w">                        </span><span class="n">tukey_tpr</span><span class="p">,</span>
<span class="w">                        </span><span class="n">tukey_fpr</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># Print Summary Table for alternative case</span>
<span class="w">    </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;\n--- Summary Table: Post-Hoc Test Performance ---\n&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">print</span><span class="p">(</span><span class="n">error_summary_table</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># Print Interpretation Notes</span>
<span class="w">    </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;\n--- Interpretation Notes for Alternative Case (H1 True) ---\n&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot; - Simulation Context: Some population means differ, so methods should ideally detect these differences.\n&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot; - True Positive Rate: Proportion of truly different pairs that were correctly identified.\n&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot; - False Positive Rate: Proportion of truly equal pairs that were incorrectly identified as different.\n&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot; - Expected Pattern: Tukey HSD often has best balance of TPR and FPR for pairwise comparisons,\n&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;   with Bonferroni and Scheffe being more conservative (lower TPR but also lower FPR).\n&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>

<span class="p">}</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1"># Message if no significant ANOVAs occurred</span>
<span class="w">  </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;--- Multiple Comparison Test Results ---\n&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="nf">cat</span><span class="p">(</span><span class="s">&quot;No significant ANOVA results found to perform multiple comparison tests.\n&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;\n--- End of Simulation ---\n&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="part-1a-no-real-differences-type-i-error">
<h3>Part 1A: No Real Differences (Type I Error)<a class="headerlink" href="#part-1a-no-real-differences-type-i-error" title="Link to this heading"></a></h3>
<p><strong>Instructions:</strong></p>
<ol class="arabic simple">
<li><p>Copy the simulation code above into an R script file or run it directly in your R console.</p></li>
<li><p>The code is initially set to <code class="docutils literal notranslate"><span class="pre">simulation_case</span> <span class="pre">=</span> <span class="pre">1</span></code> for the null hypothesis (all means equal).</p></li>
<li><p>Inside the script, modify <span class="math notranslate nohighlight">\(k\)</span> to 4, 8, and 16 in separate runs to see how the number of groups affects the chance of false positives.</p></li>
<li><p>You can also adjust the sample size per group <span class="math notranslate nohighlight">\(n\)</span> if you want to explore further.</p></li>
</ol>
<p><strong>Record Your Findings:</strong></p>
<p>Note how often ANOVA itself yields a false positive (Type I error).</p>
<p>For those runs where ANOVA is significant, see how frequently each post-hoc method (Scheffé, Bonferroni, Tukey) flags at least one pairwise difference (conditional error rate).</p>
<p>Observe that you can also derive an overall (unconditional) false positive rate for each post-hoc method.</p>
<p><strong>Question 1a:</strong> Record your simulation results for different values of <span class="math notranslate nohighlight">\(k\)</span>:</p>
<p>For <span class="math notranslate nohighlight">\(k = 4\)</span> groups:</p>
<ul class="simple">
<li><p>ANOVA Type I Error Rate: ____________</p></li>
<li><p>Scheffé Conditional False Positive Rate: ____________</p></li>
<li><p>Bonferroni Conditional False Positive Rate: ____________</p></li>
<li><p>Tukey Conditional False Positive Rate: ____________</p></li>
</ul>
<p>For <span class="math notranslate nohighlight">\(k = 8\)</span> groups:</p>
<ul class="simple">
<li><p>ANOVA Type I Error Rate: ____________</p></li>
<li><p>Scheffé Conditional False Positive Rate: ____________</p></li>
<li><p>Bonferroni Conditional False Positive Rate: ____________</p></li>
<li><p>Tukey Conditional False Positive Rate: ____________</p></li>
</ul>
<p>For <span class="math notranslate nohighlight">\(k = 16\)</span> groups:</p>
<ul class="simple">
<li><p>ANOVA Type I Error Rate: ____________</p></li>
<li><p>Scheffé Conditional False Positive Rate: ____________</p></li>
<li><p>Bonferroni Conditional False Positive Rate: ____________</p></li>
<li><p>Tukey Conditional False Positive Rate: ____________</p></li>
</ul>
<p><strong>Question 1b:</strong> Interpret: Which procedure is most conservative? Which is least likely to discover false differences? How does increasing <span class="math notranslate nohighlight">\(k\)</span> change these error rates?</p>
<p>[Space for your interpretation]</p>
</section>
<section id="part-1b-some-real-differences-statistical-power">
<h3>Part 1B: Some Real Differences (Statistical Power)<a class="headerlink" href="#part-1b-some-real-differences-statistical-power" title="Link to this heading"></a></h3>
<p><strong>Objective:</strong> See how often ANOVA and each post-hoc method detect genuine differences among the groups, while still controlling false discoveries on the groups that are actually the same.</p>
<p><strong>Instructions:</strong></p>
<ol class="arabic simple">
<li><p>In the simulation code, change the line <code class="docutils literal notranslate"><span class="pre">simulation_case</span> <span class="pre">&lt;-</span> <span class="pre">1</span></code> to <code class="docutils literal notranslate"><span class="pre">simulation_case</span> <span class="pre">&lt;-</span> <span class="pre">2</span></code>.</p></li>
<li><p>The code randomly picks a few groups to shift away from the baseline mean. This simulates real differences in some groups.</p></li>
<li><p>Run the code again for the same values of <span class="math notranslate nohighlight">\(k\)</span> in <span class="math notranslate nohighlight">\(\{4, 8, 16\}\)</span> and any sample size per group you prefer.</p></li>
</ol>
<p><strong>Record Your Findings:</strong></p>
<ul class="simple">
<li><p><strong>Power of ANOVA:</strong> The proportion of simulations in which ANOVA correctly signals at least one group difference is present.</p></li>
<li><p><strong>True Positive Rate (TPR) for Each Post-Hoc Method:</strong> Among pairs of groups that truly differ, how many were detected?</p></li>
<li><p><strong>False Positive Rate (FPR) for Each Post-Hoc Method:</strong> Among pairs that are actually the same, how many were incorrectly flagged?</p></li>
</ul>
<p><strong>Question 1c:</strong> Record your simulation results for different values of <span class="math notranslate nohighlight">\(k\)</span>:</p>
<p>For <span class="math notranslate nohighlight">\(k = 4\)</span> groups:</p>
<ul class="simple">
<li><p>ANOVA Power: ____________</p></li>
<li><p>Scheffé TPR: ____________  |  Scheffé FPR: ____________</p></li>
<li><p>Bonferroni TPR: ____________  |  Bonferroni FPR: ____________</p></li>
<li><p>Tukey TPR: ____________  |  Tukey FPR: ____________</p></li>
</ul>
<p>For <span class="math notranslate nohighlight">\(k = 8\)</span> groups:</p>
<ul class="simple">
<li><p>ANOVA Power: ____________</p></li>
<li><p>Scheffé TPR: ____________  |  Scheffé FPR: ____________</p></li>
<li><p>Bonferroni TPR: ____________  |  Bonferroni FPR: ____________</p></li>
<li><p>Tukey TPR: ____________  |  Tukey FPR: ____________</p></li>
</ul>
<p>For <span class="math notranslate nohighlight">\(k = 16\)</span> groups:</p>
<ul class="simple">
<li><p>ANOVA Power: ____________</p></li>
<li><p>Scheffé TPR: ____________  |  Scheffé FPR: ____________</p></li>
<li><p>Bonferroni TPR: ____________  |  Bonferroni FPR: ____________</p></li>
<li><p>Tukey TPR: ____________  |  Tukey FPR: ____________</p></li>
</ul>
<p><strong>Question 1d:</strong> Interpret: Which method finds genuine differences most reliably (highest TPR)? Which method keeps false positives (FPR) lower? How does this balance compare between Scheffé, Bonferroni, and Tukey?</p>
<p>[Space for your interpretation]</p>
</section>
</section>
<section id="part-2-applying-tukey-s-hsd-to-worksheet-18-data">
<h2>Part 2: Applying Tukey’s HSD to Worksheet 18 Data<a class="headerlink" href="#part-2-applying-tukey-s-hsd-to-worksheet-18-data" title="Link to this heading"></a></h2>
<p>In <a class="reference internal" href="worksheet18.html#worksheet18"><span class="std std-ref">Worksheet 18: One-Way ANOVA (Analysis of Variance)</span></a>, we confirmed (using a one-way ANOVA) that at least one group mean differs significantly among our three treatment groups (A, B, and C). However, ANOVA alone did not tell us which groups differ from each other. We will now address this question by applying Tukey’s Honestly Significant Difference (HSD) procedure to the same data.</p>
<p><strong>Given Summary Statistics:</strong></p>
<table class="docutils align-center" style="width: 60%">
<thead>
<tr class="row-odd"><th class="head"><p>Group</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(n_i\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\bar{X}_i\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(s_i^2\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>A</p></td>
<td><p>10</p></td>
<td><p>20</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td><p>B</p></td>
<td><p>8</p></td>
<td><p>22</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p>C</p></td>
<td><p>7</p></td>
<td><p>18</p></td>
<td><p>3</p></td>
</tr>
</tbody>
</table>
<section id="tukey-s-hsd-method">
<h3>Tukey’s HSD Method<a class="headerlink" href="#tukey-s-hsd-method" title="Link to this heading"></a></h3>
<p>Tukey’s HSD specifically handles pairwise comparisons after a significant ANOVA:</p>
<ul class="simple">
<li><p>It uses the studentized range distribution to determine a single critical difference that applies to all pairs of group means simultaneously.</p></li>
<li><p>This approach keeps the overall Type I error rate at or below the chosen alpha (often 0.05), avoiding the inflation that would occur from naively doing many separate t-tests.</p></li>
</ul>
<p><strong>Question 2a:</strong> At a significance level <span class="math notranslate nohighlight">\(\alpha = 0.05\)</span>, compute the Tukey parameter (qtukey).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">qtukey()</span></code> function in R with parameters: significance level, number of groups <span class="math notranslate nohighlight">\(k\)</span>, and degrees of freedom for within-group variance <span class="math notranslate nohighlight">\(df_{\text{within}}\)</span>.</p>
</div>
<p>Tukey parameter: <span class="math notranslate nohighlight">\(q_{\alpha, k, df}\)</span> = ____________</p>
<p><strong>Question 2b:</strong> Using your summary statistics, degrees of freedom for the within-group variance, and your within-group mean squares estimate <span class="math notranslate nohighlight">\(\text{MSE}\)</span>, and Tukey parameter obtain your margin of error estimate:</p>
<div class="math notranslate nohighlight">
\[\text{Margin of Error} = q_{\alpha, k, df} \times \sqrt{\frac{\text{MSE}}{2} \left( \frac{1}{n_i} + \frac{1}{n_j} \right)}\]</div>
<p>Calculate the margin of error for each pairwise comparison.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You should have calculated <span class="math notranslate nohighlight">\(\text{MSE}\)</span> in Worksheet 18. If not, compute it from the pooled variance: <span class="math notranslate nohighlight">\(\text{MSE} = s_p^2\)</span>.</p>
</div>
<p>For groups A and B:</p>
<p>Margin of Error: ____________</p>
<p>For groups A and C:</p>
<p>Margin of Error: ____________</p>
<p>For groups B and C:</p>
<p>Margin of Error: ____________</p>
<p><strong>Question 2c:</strong> Complete the table below:</p>
<table class="docutils align-center" style="width: 100%">
<thead>
<tr class="row-odd"><th class="head"><p>Difference (Order)</p></th>
<th class="head"><p>Difference (Numeric)</p></th>
<th class="head"><p>Lower CI</p></th>
<th class="head"><p>Upper CI</p></th>
<th class="head"><p>Significant (yes/no)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\mu_A - \mu_B\)</span></p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\mu_A - \mu_C\)</span></p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\mu_B - \mu_C\)</span></p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A difference is significant if the confidence interval does not contain zero.</p>
</div>
<p><strong>Question 2d:</strong> Provide a graphical comparison. See the lecture notes on how to construct this.</p>
<p><strong>Question 2e:</strong> Provide a formal decision and conclusion in context.</p>
<p><strong>Decision:</strong></p>
<p>[State which pairwise comparisons are significant]</p>
<p><strong>Conclusion:</strong></p>
<p>[Provide a comprehensive conclusion about which treatment groups differ from each other and what this means in the context of the study]</p>
</section>
</section>
<section id="part-3-comprehensive-anova-analysis-toothgrowth-dataset">
<h2>Part 3: Comprehensive ANOVA Analysis - ToothGrowth Dataset<a class="headerlink" href="#part-3-comprehensive-anova-analysis-toothgrowth-dataset" title="Link to this heading"></a></h2>
<p>You will work with the <code class="docutils literal notranslate"><span class="pre">ToothGrowth</span></code> dataset in R, which includes 60 observations of tooth length (<code class="docutils literal notranslate"><span class="pre">len</span></code>) for guinea pigs under different supplement types (<code class="docutils literal notranslate"><span class="pre">supp</span></code>) and dose levels (<code class="docutils literal notranslate"><span class="pre">dose</span></code>). However, you must combine these two variables into a single factor with six possible levels (OJ_0.5, OJ_1, OJ_2, VC_0.5, VC_1, VC_2) to treat it as a one-way ANOVA problem.</p>
<p><strong>Question 3a:</strong> Load the dataset and create a new factor variable called <code class="docutils literal notranslate"><span class="pre">group</span></code>, by concatenating <code class="docutils literal notranslate"><span class="pre">supp</span></code> and <code class="docutils literal notranslate"><span class="pre">dose</span></code> (e.g., “OJ_0.5”, etc.).</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the dataset</span>
<span class="nf">data</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="p">)</span>

<span class="c1"># View the first few rows to verify</span>
<span class="nf">head</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="p">)</span>

<span class="c1"># Check the levels of the new factor</span>
<span class="nf">levels</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="o">$</span><span class="n">group</span><span class="p">)</span>

<span class="c1"># Create the combined group factor</span>
<span class="n">ToothGrowth</span><span class="o">$</span><span class="n">group</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="o">$</span><span class="n">supp</span><span class="p">,</span><span class="w"> </span><span class="n">ToothGrowth</span><span class="o">$</span><span class="n">dose</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="o">=</span><span class="s">&quot;_&quot;</span><span class="p">))</span>
<span class="nf">table</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="o">$</span><span class="n">group</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Question 3b:</strong> For each of the six levels in your new factor (<code class="docutils literal notranslate"><span class="pre">group</span></code>), compute the sample size (<span class="math notranslate nohighlight">\(n\)</span>), sample mean, and sample standard deviation. Provide the summary statistics below. Write a brief commentary on any major differences you see among the sample group means.</p>
<table class="docutils align-center" style="width: 80%">
<thead>
<tr class="row-odd"><th class="head"><p>Group</p></th>
<th class="head"><p>Sample Size <span class="math notranslate nohighlight">\(n_i\)</span></p></th>
<th class="head"><p>Group Sample Means <span class="math notranslate nohighlight">\(\bar{X}_i\)</span></p></th>
<th class="head"><p>Group Sample SDs <span class="math notranslate nohighlight">\(s_i\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>OJ_0.5</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>OJ_1</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>OJ_2</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>VC_0.5</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>VC_1</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>VC_2</p></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>Commentary on group means:</strong></p>
<p>[Describe any patterns or major differences you observe]</p>
<p><strong>Question 3c:</strong> Formal ANOVA Hypothesis Setup (Steps 1 &amp; 2): Define the parameter(s) of interest and state the null and alternative hypotheses.</p>
<p><strong>Parameter(s) of Interest:</strong></p>
<p>[Define the population means for each group]</p>
<p><strong>Hypotheses:</strong></p>
<p><span class="math notranslate nohighlight">\(H_0\)</span>:</p>
<p><span class="math notranslate nohighlight">\(H_A\)</span>:</p>
<p><strong>Question 3d:</strong> Check Assumptions (Visual Inspection):</p>
<p>Create the following visualizations:</p>
<ol class="arabic simple">
<li><p><strong>Side-by-Side Boxplots:</strong> Plot the distribution of <code class="docutils literal notranslate"><span class="pre">len</span></code> by the newly created factor <code class="docutils literal notranslate"><span class="pre">group</span></code>.</p></li>
<li><p><strong>Effects Plot:</strong> Plot just the group means connected by lines to see how average tooth length changes across levels.</p></li>
<li><p><strong>Histograms with Normal Overlays:</strong> Create a grid of histograms (all using the same scale for ease of comparison), each for one group, overlaid with both (i) a smooth kernel density curve and (ii) a fitted Normal curve using that group’s mean and sd.</p></li>
<li><p><strong>QQ Plots:</strong> Create a grid of QQ plots.</p></li>
</ol>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="c1"># 1. Side-by-side boxplots</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">group</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">len</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w"> </span><span class="nf">geom_boxplot</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s">&quot;lightblue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">outlier.color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w"> </span><span class="nf">stat_boxplot</span><span class="p">(</span><span class="n">geom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;errorbar&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w"> </span><span class="nf">stat_summary</span><span class="p">(</span><span class="n">fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">geom</span><span class="w"> </span><span class="o">=</span><span class="s">&quot;point&quot;</span><span class="p">)</span><span class="o">+</span>
<span class="w"> </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Side-by-Side Boxplots of Tooth Length by Combined Group&quot;</span><span class="p">)</span>

<span class="c1"># 2. Effects plot (means)</span>
<span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">group</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">len</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w"> </span><span class="nf">stat_summary</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span><span class="w"> </span><span class="n">geom</span><span class="o">=</span><span class="s">&quot;point&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w"> </span><span class="nf">stat_summary</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span><span class="w"> </span><span class="n">geom</span><span class="o">=</span><span class="s">&quot;line&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="m">1</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w"> </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Effects Plot of Mean Tooth Length by Combined Group&quot;</span><span class="p">)</span>


<span class="w"> </span><span class="c1"># 3. Summary table: n, mean, sd</span>
<span class="w"> </span><span class="n">group_levels</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">levels</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="o">$</span><span class="n">group</span><span class="p">)</span>
<span class="w"> </span><span class="n">n_vec</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tapply</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="o">$</span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="n">ToothGrowth</span><span class="o">$</span><span class="n">group</span><span class="p">,</span><span class="w"> </span><span class="n">length</span><span class="p">)</span>
<span class="w"> </span><span class="n">mean_vec</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tapply</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="o">$</span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="n">ToothGrowth</span><span class="o">$</span><span class="n">group</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span>
<span class="w"> </span><span class="n">sd_vec</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tapply</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="o">$</span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="n">ToothGrowth</span><span class="o">$</span><span class="n">group</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="p">)</span>

<span class="w"> </span><span class="n">summary_table</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span>
<span class="w"> </span><span class="n">Group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">group_levels</span><span class="p">,</span>
<span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">n_vec</span><span class="p">),</span>
<span class="w"> </span><span class="n">Mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">mean_vec</span><span class="p">),</span>
<span class="w"> </span><span class="n">StdDev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">sd_vec</span><span class="p">)</span>
<span class="w"> </span><span class="p">)</span>
<span class="w"> </span><span class="nf">print</span><span class="p">(</span><span class="n">summary_table</span><span class="p">)</span>


<span class="c1"># 3. Histograms with normal overlays</span>
<span class="w"> </span><span class="n">xbar</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tapply</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="o">$</span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="n">ToothGrowth</span><span class="o">$</span><span class="n">group</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span>
<span class="w"> </span><span class="n">s</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tapply</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="o">$</span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="n">ToothGrowth</span><span class="o">$</span><span class="n">group</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="p">)</span>

<span class="w"> </span><span class="n">ToothGrowth</span><span class="o">$</span><span class="n">normal.density</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">x</span><span class="p">){</span>
<span class="w"> </span><span class="nf">dnorm</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s">&quot;len&quot;</span><span class="p">]),</span>
<span class="w">         </span><span class="n">xbar</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s">&quot;group&quot;</span><span class="p">]],</span><span class="w"> </span><span class="n">s</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s">&quot;group&quot;</span><span class="p">]])})</span>

<span class="w"> </span><span class="n">n_bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span>

<span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">len</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w"> </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">after_stat</span><span class="p">(</span><span class="n">density</span><span class="p">)),</span>
<span class="w">                 </span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n_bins</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;grey&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;black&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w"> </span><span class="nf">facet_wrap</span><span class="p">(</span><span class="n">group</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w"> </span><span class="nf">geom_density</span><span class="p">(</span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w"> </span><span class="nf">geom_line</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">normal.density</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w"> </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Histograms w/ Kernel (red) &amp; Normal (blue), by group&quot;</span><span class="p">)</span>

<span class="c1"># 4. QQ plots</span>
<span class="w"> </span><span class="n">qq_plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">ToothGrowth</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="n">len</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w"> </span><span class="nf">stat_qq</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w"> </span><span class="nf">stat_qq_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w"> </span><span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">group</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="o">=</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w"> </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;QQ Plots by Combined Group&quot;</span><span class="p">)</span>
<span class="w"> </span><span class="nf">print</span><span class="p">(</span><span class="n">qq_plot</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Question 3e:</strong> Using the summary statistics and graphs check the assumptions before proceeding with analysis. Also mention why the independence assumption is likely reasonable.</p>
<p><strong>Normality assumption:</strong></p>
<p>[Comment on whether the data appear approximately normal within each group]</p>
<p><strong>Equal variance assumption:</strong></p>
<p>[Check the ratio of largest to smallest standard deviation]</p>
<p><strong>Independence assumption:</strong></p>
<p>[Explain why independence is reasonable for this study]</p>
<p><strong>Question 3f:</strong> Perform the ANOVA at <span class="math notranslate nohighlight">\(\alpha = 0.05\)</span> (Using <code class="docutils literal notranslate"><span class="pre">aov</span></code> in R) and perform Steps 3 &amp; 4 of the Formal Hypothesis Procedure.</p>
<p><strong>Test Statistic:</strong> <span class="math notranslate nohighlight">\(F\)</span> = ____________</p>
<p><strong>P-value:</strong> ____________</p>
<p><strong>Decision:</strong></p>
<p>[Reject or Fail to reject <span class="math notranslate nohighlight">\(H_0\)</span>]</p>
<p><strong>Conclusion:</strong></p>
<p>[State your conclusion in context of tooth growth and supplement/dose combinations]</p>
<p><strong>Question 3g:</strong> Since we do reject the null with 6 distinct groups, perform a post-hoc analysis using Tukey’s HSD (<code class="docutils literal notranslate"><span class="pre">TukeyHSD</span></code> function in R). Provide a graphical representation of the results of the TukeyHSD and provide a formal conclusion.</p>
<p><strong>Tukey HSD Results:</strong></p>
<p>[Summarize which pairwise comparisons are significant]</p>
<p><strong>Formal Conclusion:</strong></p>
<p>[Provide a comprehensive conclusion about which supplement/dose combinations differ significantly from each other and what this means for tooth growth]</p>
</section>
<section id="key-takeaways">
<h2>Key Takeaways<a class="headerlink" href="#key-takeaways" title="Link to this heading"></a></h2>
<div class="important admonition">
<p class="admonition-title">Summary 📝</p>
<ul class="simple">
<li><p><strong>The multiple comparisons problem</strong> arises when conducting many pairwise tests after ANOVA, which inflates the family-wise Type I error rate far beyond the nominal significance level unless corrected.</p></li>
<li><p><strong>Tukey’s Honestly Significant Difference (HSD)</strong> provides a balanced approach to pairwise comparisons that controls the family-wise error rate while maintaining reasonable power to detect true differences, making it the preferred method for most ANOVA follow-up analyses.</p></li>
<li><p><strong>The studentized range distribution</strong> underlies Tukey’s method, providing a single critical value that accounts for all <span class="math notranslate nohighlight">\(\binom{k}{2}\)</span> pairwise comparisons simultaneously, avoiding the need to adjust alpha for each individual test.</p></li>
<li><p><strong>Confidence intervals for mean differences</strong> in Tukey’s HSD indicate which pairs of groups differ significantly: intervals that exclude zero correspond to significant differences at the specified alpha level.</p></li>
<li><p><strong>Bonferroni correction</strong> is the simplest multiple comparison adjustment (dividing alpha by the number of comparisons) but becomes overly conservative with many comparisons, reducing power to detect real effects.</p></li>
<li><p><strong>Scheffé’s method</strong> is the most flexible, allowing any contrast comparison, but is also the most conservative and typically has the lowest power among the three methods discussed.</p></li>
<li><p><strong>Simulation studies</strong> reveal the trade-offs between methods: Tukey’s HSD generally provides the best balance of Type I error control and power for pairwise comparisons, while Scheffé is more conservative and Bonferroni becomes increasingly conservative as the number of comparisons grows.</p></li>
<li><p><strong>Post-hoc testing requires prior significant ANOVA</strong> results to be most meaningful, as conducting multiple comparisons without evidence of any differences increases the overall error rate without theoretical justification.</p></li>
<li><p><strong>Visual representations</strong> of Tukey HSD results, showing confidence intervals for all pairwise differences, provide an intuitive way to understand the pattern of similarities and differences among multiple groups.</p></li>
<li><p><strong>R provides comprehensive tools</strong> for multiple comparisons through functions like <code class="docutils literal notranslate"><span class="pre">TukeyHSD()</span></code>, which automatically compute adjusted confidence intervals and p-values for all pairwise comparisons following ANOVA.</p></li>
</ul>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="worksheet18.html" class="btn btn-neutral float-left" title="Worksheet 18: One-Way ANOVA (Analysis of Variance)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="worksheet20.html" class="btn btn-neutral float-right" title="Worksheet 20: Introduction to Simple Linear Regression" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
  <p class="footer-credits-inline">
    <strong>Website Credits:</strong>
    Website development by Dr. Timothy Reese and Halin Shin.
    Generative AI tools were used to draft and refine some prose, code, and documentation; all content was reviewed by the instructors.
    Models: OpenAI o3 (2025-04-16 release) and Anthropic Claude Opus 4.1 (2025-08-05).
  </p>


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 

<!-- Floating Chat Button -->
<button id="chatbot-toggle" class="chatbot-fab" aria-label="Open AI Course Assistant" aria-expanded="false">
  <span class="chatbot-fab-badge">BETA</span>
  <svg class="chatbot-fab-icon chatbot-icon-open" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
          d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"/>
  </svg>
  <svg class="chatbot-fab-icon chatbot-icon-close" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="display:none;">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
  </svg>
  <span class="chatbot-fab-text">Ask AI Assistant</span>
</button>

<!-- Chat Panel - Fullscreen -->
<div id="chatbot-panel" class="chatbot-panel" aria-hidden="true">
  <div class="chatbot-panel-topbar">
    <button id="chatbot-close" class="chatbot-panel-close-minimal" aria-label="Close chat">
      <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
      </svg>
    </button>
    <a href="https://advert-cingular-employer-humor.trycloudflare.com/" 
       target="_blank" 
       rel="noopener noreferrer" 
       class="chatbot-newtab">
      <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
              d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
      </svg>
      Open in new tab
    </a>
  </div>
  <iframe id="chatbot-iframe" class="chatbot-iframe" title="STAT 350 AI Course Assistant"></iframe>
</div>

<script>
(function() {
  const CHATBOT_BASE_URL = 'https://advert-cingular-employer-humor.trycloudflare.com/';
  
  const toggle = document.getElementById('chatbot-toggle');
  const panel = document.getElementById('chatbot-panel');
  const closeBtn = document.getElementById('chatbot-close');
  const iframe = document.getElementById('chatbot-iframe');
  const iconOpen = toggle.querySelector('.chatbot-icon-open');
  const iconClose = toggle.querySelector('.chatbot-icon-close');
  
  let isOpen = false;
  let iframeLoaded = false;
  
  function getPageContext() {
    const pageTitle = document.title || '';
    const pageUrl = window.location.href;
    const pagePath = window.location.pathname;
    
    const h1 = document.querySelector('.rst-content h1, h1');
    const heading = h1 ? h1.textContent.replace(/[¶#]/g, '').trim() : '';
    
    const breadcrumbs = document.querySelectorAll('.wy-breadcrumbs li a');
    const breadcrumbPath = Array.from(breadcrumbs).map(a => a.textContent.trim()).join(' > ');
    
    const chapterMatch = pagePath.match(/chapter(\d+)/i);
    const chapter = chapterMatch ? 'Chapter ' + chapterMatch[1] : '';
    
    return {
      title: heading || pageTitle,
      url: pageUrl,
      path: pagePath,
      breadcrumbs: breadcrumbPath,
      chapter: chapter
    };
  }
  
  function buildChatbotUrl(context) {
    const params = new URLSearchParams();
    if (context.title) params.set('page_title', context.title);
    if (context.url) params.set('page_url', context.url);
    if (context.chapter) params.set('chapter', context.chapter);
    if (context.breadcrumbs) params.set('breadcrumbs', context.breadcrumbs);
    
    const queryString = params.toString();
    return queryString ? CHATBOT_BASE_URL + '?' + queryString : CHATBOT_BASE_URL;
  }
  
  function openChat() {
    const context = getPageContext();
    
    const newUrl = buildChatbotUrl(context);
    if (!iframeLoaded || iframe.dataset.lastUrl !== context.url) {
      iframe.src = newUrl;
      iframe.dataset.lastUrl = context.url;
      iframeLoaded = true;
    }
    
    panel.classList.add('chatbot-panel-open');
    panel.setAttribute('aria-hidden', 'false');
    toggle.setAttribute('aria-expanded', 'true');
    iconOpen.style.display = 'none';
    iconClose.style.display = 'block';
    toggle.querySelector('.chatbot-fab-text').textContent = 'Close';
    isOpen = true;
    
    toggle.classList.add('chatbot-fab-opened');
    
    // Prevent body scroll when panel is open
    document.body.style.overflow = 'hidden';
  }
  
  function closeChat() {
    panel.classList.remove('chatbot-panel-open');
    panel.setAttribute('aria-hidden', 'true');
    toggle.setAttribute('aria-expanded', 'false');
    iconOpen.style.display = 'block';
    iconClose.style.display = 'none';
    toggle.querySelector('.chatbot-fab-text').textContent = 'Ask AI Assistant';
    isOpen = false;
    
    // Restore body scroll
    document.body.style.overflow = '';
  }
  
  function toggleChat() {
    if (isOpen) {
      closeChat();
    } else {
      openChat();
    }
  }
  
  toggle.addEventListener('click', toggleChat);
  closeBtn.addEventListener('click', closeChat);
  
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && isOpen) {
      closeChat();
    }
  });
})();
</script>


</body>
</html>