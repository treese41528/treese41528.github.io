<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>STAT 418 - Accessible Slides</title>

  <!-- KaTeX CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" crossorigin="anonymous">

  <style>
    /* ═══════════════════════════════════════════════════════════════════
       CSS RESET & BASE STYLES
       ═══════════════════════════════════════════════════════════════════ */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      /* ── Purdue Brand ── */
      --purdue-gold: #CEB888;
      --purdue-gold-accessible: #b8a060;
      --purdue-black: #000000;

      /* ── Gray ── */
      --gray-50: #f9fafb; --gray-100: #f3f4f6; --gray-200: #e5e7eb;
      --gray-300: #d1d5db; --gray-400: #9ca3af; --gray-500: #6b7280;
      --gray-600: #4b5563; --gray-700: #374151; --gray-800: #1f2937; --gray-900: #111827;

      /* ── Slate ── */
      --slate-50: #f8fafc; --slate-100: #f1f5f9; --slate-200: #e2e8f0;
      --slate-300: #cbd5e1; --slate-400: #94a3b8; --slate-500: #64748b;
      --slate-600: #475569; --slate-700: #334155; --slate-800: #1e293b; --slate-900: #0f172a;

      /* ── Blue ── */
      --blue-50: #eff6ff; --blue-100: #dbeafe; --blue-200: #bfdbfe;
      --blue-300: #93c5fd; --blue-400: #60a5fa; --blue-500: #3b82f6;
      --blue-600: #2563eb; --blue-700: #1d4ed8; --blue-800: #1e40af; --blue-900: #1e3a8a;

      /* ── Indigo ── */
      --indigo-50: #eef2ff; --indigo-100: #e0e7ff; --indigo-200: #c7d2fe;
      --indigo-300: #a5b4fc; --indigo-400: #818cf8; --indigo-500: #6366f1;
      --indigo-600: #4f46e5; --indigo-700: #4338ca; --indigo-800: #3730a3; --indigo-900: #312e81;

      /* ── Violet ── */
      --violet-50: #f5f3ff; --violet-100: #ede9fe; --violet-200: #ddd6fe;
      --violet-300: #c4b5fd; --violet-400: #a78bfa; --violet-500: #8b5cf6;
      --violet-600: #7c3aed; --violet-700: #6d28d9; --violet-800: #5b21b6; --violet-900: #4c1d95;

      /* ── Purple ── */
      --purple-50: #faf5ff; --purple-100: #f3e8ff; --purple-200: #e9d5ff;
      --purple-300: #d8b4fe; --purple-400: #c084fc; --purple-500: #a855f7;
      --purple-600: #9333ea; --purple-700: #7c3aed; --purple-800: #6b21a8; --purple-900: #581c87;

      /* ── Teal ── */
      --teal-50: #f0fdfa; --teal-100: #ccfbf1; --teal-200: #99f6e4;
      --teal-300: #5eead4; --teal-400: #2dd4bf; --teal-500: #14b8a6;
      --teal-600: #0d9488; --teal-700: #0f766e; --teal-800: #115e59; --teal-900: #134e4a;

      /* ── Cyan ── */
      --cyan-50: #ecfeff; --cyan-100: #cffafe; --cyan-200: #a5f3fc;
      --cyan-300: #67e8f9; --cyan-400: #22d3ee; --cyan-500: #06b6d4;
      --cyan-600: #0891b2; --cyan-700: #0e7490; --cyan-800: #155e75; --cyan-900: #164e63;

      /* ── Emerald ── */
      --emerald-50: #ecfdf5; --emerald-100: #d1fae5; --emerald-200: #a7f3d0;
      --emerald-300: #6ee7b7; --emerald-400: #34d399; --emerald-500: #10b981;
      --emerald-600: #059669; --emerald-700: #047857; --emerald-800: #065f46; --emerald-900: #064e3b;

      /* ── Green ── */
      --green-50: #f0fdf4; --green-100: #dcfce7; --green-200: #bbf7d0;
      --green-300: #86efac; --green-400: #4ade80; --green-500: #22c55e;
      --green-600: #16a34a; --green-700: #15803d; --green-800: #166534; --green-900: #14532d;

      /* ── Yellow ── */
      --yellow-50: #fefce8; --yellow-100: #fef9c3; --yellow-200: #fef08a;
      --yellow-300: #fde047; --yellow-400: #facc15; --yellow-500: #eab308;
      --yellow-600: #ca8a04; --yellow-700: #a16207; --yellow-800: #854d0e; --yellow-900: #713f12;

      /* ── Amber ── */
      --amber-50: #fffbeb; --amber-100: #fef3c7; --amber-200: #fde68a;
      --amber-300: #fcd34d; --amber-400: #fbbf24; --amber-500: #f59e0b;
      --amber-600: #d97706; --amber-700: #b45309; --amber-800: #92400e; --amber-900: #78350f;

      /* ── Orange ── */
      --orange-50: #fff7ed; --orange-100: #ffedd5; --orange-200: #fed7aa;
      --orange-300: #fdba74; --orange-400: #fb923c; --orange-500: #f97316;
      --orange-600: #ea580c; --orange-700: #c2410c; --orange-800: #9a3412; --orange-900: #7c2d12;

      /* ── Red ── */
      --red-50: #fef2f2; --red-100: #fee2e2; --red-200: #fecaca;
      --red-300: #fca5a5; --red-400: #f87171; --red-500: #ef4444;
      --red-600: #dc2626; --red-700: #b91c1c; --red-800: #991b1b; --red-900: #7f1d1d;

      /* ── Rose ── */
      --rose-50: #fff1f2; --rose-100: #ffe4e6; --rose-200: #fecdd3;
      --rose-300: #fda4af; --rose-400: #fb7185; --rose-500: #f43f5e;
      --rose-600: #e11d48; --rose-700: #be123c; --rose-800: #9f1239; --rose-900: #881337;

      /* ── Pink ── */
      --pink-50: #fdf2f8; --pink-100: #fce7f3; --pink-200: #fbcfe8;
      --pink-300: #f9a8d4; --pink-400: #f472b6; --pink-500: #ec4899;
      --pink-600: #db2777; --pink-700: #be185d; --pink-800: #9d174d; --pink-900: #831843;

      /* ── Focus ring ── */
      --focus-ring: #fbbf24;
      --focus-ring-offset: 2px;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--gray-50);
      color: var(--gray-900);
      overflow: hidden;
      line-height: 1.6;
      font-size: 18px;
    }

    #root { height: 100vh; display: flex; flex-direction: column; }

    /* ═══════════════════════════════════════════════════════════════════
       ACCESSIBILITY: SKIP LINK
       ═══════════════════════════════════════════════════════════════════ */
    .skip-link {
      position: absolute;
      top: -100px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--purdue-gold);
      color: var(--purdue-black);
      padding: 0.75rem 1.5rem;
      border-radius: 0 0 0.5rem 0.5rem;
      font-weight: 600;
      z-index: 9999;
      text-decoration: none;
      transition: top 0.2s;
    }

    .skip-link:focus {
      top: 0;
      outline: 3px solid var(--focus-ring);
      outline-offset: 2px;
    }

    /* ═══════════════════════════════════════════════════════════════════
       ACCESSIBILITY: FOCUS STYLES
       ═══════════════════════════════════════════════════════════════════ */
    *:focus:not(:focus-visible) { outline: none; }

    *:focus-visible {
      outline: 3px solid var(--focus-ring);
      outline-offset: var(--focus-ring-offset);
    }

    .slide-header *:focus-visible,
    .slide-nav *:focus-visible {
      outline-color: var(--purdue-gold);
      outline-offset: 2px;
    }

    /* ═══════════════════════════════════════════════════════════════════
       ACCESSIBILITY: REDUCED MOTION
       ═══════════════════════════════════════════════════════════════════ */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
      .current-indicator { animation: none; }
    }

    /* ═══════════════════════════════════════════════════════════════════
       ACCESSIBILITY: SCREEN READER ONLY
       ═══════════════════════════════════════════════════════════════════ */
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    /* ═══════════════════════════════════════════════════════════════════
       ACCESSIBILITY: LIVE REGION DEFAULTS
       ═══════════════════════════════════════════════════════════════════ */
    [aria-live="polite"],
    [aria-live="assertive"] { position: relative; }

    /* ═══════════════════════════════════════════════════════════════════
       KaTeX OVERRIDES
       ═══════════════════════════════════════════════════════════════════ */
    .katex-mathml { position: absolute !important; clip: rect(1px, 1px, 1px, 1px) !important; }
    .katex, .katex * { box-sizing: content-box; }
    .katex { color: inherit; font-size: 1.1em; }

    /* ═══════════════════════════════════════════════════════════════════
       DISPLAY
       ═══════════════════════════════════════════════════════════════════ */
    .block { display: block; }
    .inline-block { display: inline-block; }
    .inline { display: inline; }
    .hidden { display: none; }
    .invisible { visibility: hidden; }

    /* ═══════════════════════════════════════════════════════════════════
       FLEXBOX
       ═══════════════════════════════════════════════════════════════════ */
    .flex { display: flex; }
    .inline-flex { display: inline-flex; }
    .flex-col { flex-direction: column; }
    .flex-row { flex-direction: row; }
    .flex-col-reverse { flex-direction: column-reverse; }
    .flex-row-reverse { flex-direction: row-reverse; }
    .flex-1 { flex: 1 1 0%; min-height: 0; min-width: 0; }
    .flex-auto { flex: 1 1 auto; }
    .flex-none { flex: none; }
    .flex-shrink-0 { flex-shrink: 0; }
    .shrink-0 { flex-shrink: 0; }
    .flex-grow { flex-grow: 1; }
    .flex-grow-0 { flex-grow: 0; }
    .flex-wrap { flex-wrap: wrap; }
    .flex-nowrap { flex-wrap: nowrap; }
    .items-center { align-items: center; }
    .items-start { align-items: flex-start; }
    .items-end { align-items: flex-end; }
    .items-stretch { align-items: stretch; }
    .items-baseline { align-items: baseline; }
    .justify-center { justify-content: center; }
    .justify-between { justify-content: space-between; }
    .justify-around { justify-content: space-around; }
    .justify-start { justify-content: flex-start; }
    .justify-end { justify-content: flex-end; }
    .justify-evenly { justify-content: space-evenly; }
    .self-center { align-self: center; }
    .self-start { align-self: flex-start; }
    .self-end { align-self: flex-end; }
    .self-stretch { align-self: stretch; }
    .content-center { align-content: center; }
    .content-start { align-content: flex-start; }

    /* ═══════════════════════════════════════════════════════════════════
       GRID
       ═══════════════════════════════════════════════════════════════════ */
    .grid { display: grid; }
    .grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
    .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
    .grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
    .grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
    .grid-cols-5 { grid-template-columns: repeat(5, minmax(0, 1fr)); }
    .grid-cols-6 { grid-template-columns: repeat(6, minmax(0, 1fr)); }
    .grid-rows-2 { grid-template-rows: repeat(2, minmax(0, 1fr)); }
    .grid-rows-3 { grid-template-rows: repeat(3, minmax(0, 1fr)); }
    .col-span-1 { grid-column: span 1 / span 1; }
    .col-span-2 { grid-column: span 2 / span 2; }
    .col-span-3 { grid-column: span 3 / span 3; }
    .col-span-4 { grid-column: span 4 / span 4; }
    .col-span-full { grid-column: 1 / -1; }
    .row-span-2 { grid-row: span 2 / span 2; }
    .row-span-3 { grid-row: span 3 / span 3; }
    .row-span-full { grid-row: 1 / -1; }

    /* ═══════════════════════════════════════════════════════════════════
       GAP
       ═══════════════════════════════════════════════════════════════════ */
    .gap-0 { gap: 0; }
    .gap-0\.5 { gap: 0.125rem; }
    .gap-1 { gap: 0.25rem; }
    .gap-1\.5 { gap: 0.375rem; }
    .gap-2 { gap: 0.5rem; }
    .gap-2\.5 { gap: 0.625rem; }
    .gap-3 { gap: 0.75rem; }
    .gap-4 { gap: 1rem; }
    .gap-5 { gap: 1.25rem; }
    .gap-6 { gap: 1.5rem; }
    .gap-8 { gap: 2rem; }
    .gap-10 { gap: 2.5rem; }
    .gap-12 { gap: 3rem; }
    .gap-x-2 { column-gap: 0.5rem; }
    .gap-x-3 { column-gap: 0.75rem; }
    .gap-x-4 { column-gap: 1rem; }
    .gap-x-6 { column-gap: 1.5rem; }
    .gap-x-8 { column-gap: 2rem; }
    .gap-y-1 { row-gap: 0.25rem; }
    .gap-y-2 { row-gap: 0.5rem; }
    .gap-y-3 { row-gap: 0.75rem; }
    .gap-y-4 { row-gap: 1rem; }

    /* ═══════════════════════════════════════════════════════════════════
       WIDTH
       ═══════════════════════════════════════════════════════════════════ */
    .w-0 { width: 0; }
    .w-1 { width: 0.25rem; }
    .w-2 { width: 0.5rem; }
    .w-3 { width: 0.75rem; }
    .w-4 { width: 1rem; }
    .w-5 { width: 1.25rem; }
    .w-6 { width: 1.5rem; }
    .w-7 { width: 1.75rem; }
    .w-8 { width: 2rem; }
    .w-10 { width: 2.5rem; }
    .w-12 { width: 3rem; }
    .w-16 { width: 4rem; }
    .w-20 { width: 5rem; }
    .w-24 { width: 6rem; }
    .w-32 { width: 8rem; }
    .w-40 { width: 10rem; }
    .w-48 { width: 12rem; }
    .w-56 { width: 14rem; }
    .w-64 { width: 16rem; }
    .w-full { width: 100%; }
    .w-auto { width: auto; }
    .w-screen { width: 100vw; }
    .w-fit { width: fit-content; }
    .w-1\/2 { width: 50%; }
    .w-1\/3 { width: 33.333333%; }
    .w-2\/3 { width: 66.666667%; }
    .w-1\/4 { width: 25%; }
    .w-3\/4 { width: 75%; }
    .w-1\/5 { width: 20%; }
    .w-2\/5 { width: 40%; }
    .w-3\/5 { width: 60%; }
    .w-4\/5 { width: 80%; }
    .w-\[28\%\] { width: 28%; }
    .w-\[72\%\] { width: 72%; }
    .w-\[45\%\] { width: 45%; }
    .w-\[55\%\] { width: 55%; }
    .w-\[30\%\] { width: 30%; }
    .w-\[35\%\] { width: 35%; }
    .w-\[40\%\] { width: 40%; }
    .w-\[60\%\] { width: 60%; }
    .w-\[65\%\] { width: 65%; }
    .w-\[70\%\] { width: 70%; }

    .min-w-0 { min-width: 0; }
    .min-w-full { min-width: 100%; }
    .max-w-xs { max-width: 20rem; }
    .max-w-sm { max-width: 24rem; }
    .max-w-md { max-width: 28rem; }
    .max-w-lg { max-width: 32rem; }
    .max-w-xl { max-width: 36rem; }
    .max-w-2xl { max-width: 42rem; }
    .max-w-3xl { max-width: 48rem; }
    .max-w-4xl { max-width: 56rem; }
    .max-w-5xl { max-width: 64rem; }
    .max-w-6xl { max-width: 72rem; }
    .max-w-full { max-width: 100%; }
    .max-w-none { max-width: none; }
    .max-w-prose { max-width: 65ch; }

    /* ═══════════════════════════════════════════════════════════════════
       HEIGHT
       ═══════════════════════════════════════════════════════════════════ */
    .h-0 { height: 0; }
    .h-0\.5 { height: 0.125rem; }
    .h-1 { height: 0.25rem; }
    .h-1\.5 { height: 0.375rem; }
    .h-2 { height: 0.5rem; }
    .h-3 { height: 0.75rem; }
    .h-4 { height: 1rem; }
    .h-5 { height: 1.25rem; }
    .h-6 { height: 1.5rem; }
    .h-7 { height: 1.75rem; }
    .h-8 { height: 2rem; }
    .h-10 { height: 2.5rem; }
    .h-12 { height: 3rem; }
    .h-16 { height: 4rem; }
    .h-20 { height: 5rem; }
    .h-24 { height: 6rem; }
    .h-32 { height: 8rem; }
    .h-40 { height: 10rem; }
    .h-48 { height: 12rem; }
    .h-56 { height: 14rem; }
    .h-64 { height: 16rem; }
    .h-140 { height: 35rem; }
    .h-full { height: 100%; }
    .h-screen { height: 100vh; }
    .h-auto { height: auto; }
    .h-fit { height: fit-content; }

    .min-h-0 { min-height: 0; }
    .min-h-full { min-height: 100%; }
    .min-h-screen { min-height: 100vh; }
    .max-h-32 { max-height: 8rem; }
    .max-h-40 { max-height: 10rem; }
    .max-h-44 { max-height: 11rem; }
    .max-h-48 { max-height: 12rem; }
    .max-h-52 { max-height: 13rem; }
    .max-h-56 { max-height: 14rem; }
    .max-h-64 { max-height: 16rem; }
    .max-h-72 { max-height: 18rem; }
    .max-h-80 { max-height: 20rem; }
    .max-h-96 { max-height: 24rem; }
    .max-h-full { max-height: 100%; }

    /* ═══════════════════════════════════════════════════════════════════
       OVERFLOW
       ═══════════════════════════════════════════════════════════════════ */
    .overflow-auto { overflow: auto; }
    .overflow-hidden { overflow: hidden; }
    .overflow-visible { overflow: visible; }
    .overflow-scroll { overflow: scroll; }
    .overflow-x-auto { overflow-x: auto; }
    .overflow-x-hidden { overflow-x: hidden; }
    .overflow-y-auto { overflow-y: auto; }
    .overflow-y-hidden { overflow-y: hidden; }

    /* ═══════════════════════════════════════════════════════════════════
       POSITIONING
       ═══════════════════════════════════════════════════════════════════ */
    .static { position: static; }
    .relative { position: relative; }
    .absolute { position: absolute; }
    .fixed { position: fixed; }
    .sticky { position: sticky; }
    .inset-0 { top: 0; right: 0; bottom: 0; left: 0; }
    .inset-x-0 { left: 0; right: 0; }
    .inset-y-0 { top: 0; bottom: 0; }
    .top-0 { top: 0; }
    .top-1 { top: 0.25rem; }
    .top-2 { top: 0.5rem; }
    .top-4 { top: 1rem; }
    .right-0 { right: 0; }
    .right-1 { right: 0.25rem; }
    .right-2 { right: 0.5rem; }
    .right-4 { right: 1rem; }
    .bottom-0 { bottom: 0; }
    .bottom-1 { bottom: 0.25rem; }
    .bottom-2 { bottom: 0.5rem; }
    .bottom-4 { bottom: 1rem; }
    .left-0 { left: 0; }
    .left-1 { left: 0.25rem; }
    .left-2 { left: 0.5rem; }
    .left-4 { left: 1rem; }
    .-top-1 { top: -0.25rem; }
    .-top-2 { top: -0.5rem; }
    .-right-1 { right: -0.25rem; }
    .-right-2 { right: -0.5rem; }
    .left-1\/2 { left: 50%; }
    .top-1\/2 { top: 50%; }

    .z-0 { z-index: 0; }
    .z-10 { z-index: 10; }
    .z-20 { z-index: 20; }
    .z-30 { z-index: 30; }
    .z-40 { z-index: 40; }
    .z-50 { z-index: 50; }

    /* ═══════════════════════════════════════════════════════════════════
       PADDING
       ═══════════════════════════════════════════════════════════════════ */
    .p-0 { padding: 0; }
    .p-0\.5 { padding: 0.125rem; }
    .p-1 { padding: 0.25rem; }
    .p-1\.5 { padding: 0.375rem; }
    .p-2 { padding: 0.5rem; }
    .p-2\.5 { padding: 0.625rem; }
    .p-3 { padding: 0.75rem; }
    .p-4 { padding: 1rem; }
    .p-5 { padding: 1.25rem; }
    .p-6 { padding: 1.5rem; }
    .p-8 { padding: 2rem; }
    .p-10 { padding: 2.5rem; }
    .p-12 { padding: 3rem; }
    .px-1 { padding-left: 0.25rem; padding-right: 0.25rem; }
    .px-1\.5 { padding-left: 0.375rem; padding-right: 0.375rem; }
    .px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
    .px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }
    .px-4 { padding-left: 1rem; padding-right: 1rem; }
    .px-5 { padding-left: 1.25rem; padding-right: 1.25rem; }
    .px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
    .px-8 { padding-left: 2rem; padding-right: 2rem; }
    .py-0\.5 { padding-top: 0.125rem; padding-bottom: 0.125rem; }
    .py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
    .py-1\.5 { padding-top: 0.375rem; padding-bottom: 0.375rem; }
    .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
    .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
    .py-4 { padding-top: 1rem; padding-bottom: 1rem; }
    .py-6 { padding-top: 1.5rem; padding-bottom: 1.5rem; }
    .pt-1 { padding-top: 0.25rem; }
    .pt-2 { padding-top: 0.5rem; }
    .pt-3 { padding-top: 0.75rem; }
    .pt-4 { padding-top: 1rem; }
    .pb-1 { padding-bottom: 0.25rem; }
    .pb-2 { padding-bottom: 0.5rem; }
    .pb-3 { padding-bottom: 0.75rem; }
    .pb-4 { padding-bottom: 1rem; }
    .pl-2 { padding-left: 0.5rem; }
    .pl-3 { padding-left: 0.75rem; }
    .pl-4 { padding-left: 1rem; }
    .pl-5 { padding-left: 1.25rem; }
    .pl-6 { padding-left: 1.5rem; }
    .pr-2 { padding-right: 0.5rem; }
    .pr-3 { padding-right: 0.75rem; }
    .pr-4 { padding-right: 1rem; }

    /* ═══════════════════════════════════════════════════════════════════
       MARGIN
       ═══════════════════════════════════════════════════════════════════ */
    .m-0 { margin: 0; }
    .m-1 { margin: 0.25rem; }
    .m-2 { margin: 0.5rem; }
    .m-auto { margin: auto; }
    .mx-auto { margin-left: auto; margin-right: auto; }
    .mx-1 { margin-left: 0.25rem; margin-right: 0.25rem; }
    .mx-2 { margin-left: 0.5rem; margin-right: 0.5rem; }
    .my-1 { margin-top: 0.25rem; margin-bottom: 0.25rem; }
    .my-2 { margin-top: 0.5rem; margin-bottom: 0.5rem; }
    .my-3 { margin-top: 0.75rem; margin-bottom: 0.75rem; }
    .my-4 { margin-top: 1rem; margin-bottom: 1rem; }
    .mt-0 { margin-top: 0; }
    .mt-0\.5 { margin-top: 0.125rem; }
    .mt-1 { margin-top: 0.25rem; }
    .mt-1\.5 { margin-top: 0.375rem; }
    .mt-2 { margin-top: 0.5rem; }
    .mt-3 { margin-top: 0.75rem; }
    .mt-4 { margin-top: 1rem; }
    .mt-5 { margin-top: 1.25rem; }
    .mt-6 { margin-top: 1.5rem; }
    .mt-8 { margin-top: 2rem; }
    .mt-auto { margin-top: auto; }
    .mb-0 { margin-bottom: 0; }
    .mb-0\.5 { margin-bottom: 0.125rem; }
    .mb-1 { margin-bottom: 0.25rem; }
    .mb-1\.5 { margin-bottom: 0.375rem; }
    .mb-2 { margin-bottom: 0.5rem; }
    .mb-3 { margin-bottom: 0.75rem; }
    .mb-4 { margin-bottom: 1rem; }
    .mb-5 { margin-bottom: 1.25rem; }
    .mb-6 { margin-bottom: 1.5rem; }
    .mb-8 { margin-bottom: 2rem; }
    .ml-0 { margin-left: 0; }
    .ml-1 { margin-left: 0.25rem; }
    .ml-2 { margin-left: 0.5rem; }
    .ml-3 { margin-left: 0.75rem; }
    .ml-4 { margin-left: 1rem; }
    .ml-auto { margin-left: auto; }
    .mr-0 { margin-right: 0; }
    .mr-1 { margin-right: 0.25rem; }
    .mr-2 { margin-right: 0.5rem; }
    .mr-3 { margin-right: 0.75rem; }
    .mr-4 { margin-right: 1rem; }
    .mr-auto { margin-right: auto; }
    .-mt-1 { margin-top: -0.25rem; }
    .-mt-2 { margin-top: -0.5rem; }
    .-mt-3 { margin-top: -0.75rem; }
    .-mt-4 { margin-top: -1rem; }
    .-ml-1 { margin-left: -0.25rem; }
    .-mr-1 { margin-right: -0.25rem; }
    .-mb-1 { margin-bottom: -0.25rem; }

    .space-y-0\.5 > * + * { margin-top: 0.125rem; }
    .space-y-1 > * + * { margin-top: 0.25rem; }
    .space-y-1\.5 > * + * { margin-top: 0.375rem; }
    .space-y-2 > * + * { margin-top: 0.5rem; }
    .space-y-3 > * + * { margin-top: 0.75rem; }
    .space-y-4 > * + * { margin-top: 1rem; }
    .space-y-5 > * + * { margin-top: 1.25rem; }
    .space-y-6 > * + * { margin-top: 1.5rem; }
    .space-x-1 > * + * { margin-left: 0.25rem; }
    .space-x-2 > * + * { margin-left: 0.5rem; }
    .space-x-3 > * + * { margin-left: 0.75rem; }
    .space-x-4 > * + * { margin-left: 1rem; }
    .space-x-6 > * + * { margin-left: 1.5rem; }

    /* ═══════════════════════════════════════════════════════════════════
       TYPOGRAPHY — FONT SIZE
       ═══════════════════════════════════════════════════════════════════ */
    .text-\[9px\]  { font-size: 9px;  line-height: 1.4; }
    .text-\[10px\] { font-size: 10px; line-height: 1.4; }
    .text-\[11px\] { font-size: 11px; line-height: 1.4; }
    .text-\[12px\] { font-size: 12px; line-height: 1.4; }
    .text-\[13px\] { font-size: 13px; line-height: 1.5; }
    .text-\[14px\] { font-size: 14px; line-height: 1.5; }
    .text-xs   { font-size: 0.75rem;  line-height: 1rem; }
    .text-sm   { font-size: 0.875rem; line-height: 1.25rem; }
    .text-base { font-size: 1rem;     line-height: 1.5rem; }
    .text-lg   { font-size: 1.125rem; line-height: 1.75rem; }
    .text-xl   { font-size: 1.25rem;  line-height: 1.75rem; }
    .text-2xl  { font-size: 1.5rem;   line-height: 2rem; }
    .text-3xl  { font-size: 1.875rem; line-height: 2.25rem; }
    .text-4xl  { font-size: 2.25rem;  line-height: 2.5rem; }
    .text-5xl  { font-size: 3rem;     line-height: 1; }
    .text-6xl  { font-size: 3.75rem;  line-height: 1; }

    /* ── Font Family ── */
    .font-mono { font-family: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Consolas, 'Liberation Mono', monospace; }
    .font-sans { font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
    .font-serif { font-family: Georgia, Cambria, 'Times New Roman', Times, serif; }

    /* ── Font Weight ── */
    .font-thin { font-weight: 100; }
    .font-light { font-weight: 300; }
    .font-normal { font-weight: 400; }
    .font-medium { font-weight: 500; }
    .font-semibold { font-weight: 600; }
    .font-bold { font-weight: 700; }
    .font-extrabold { font-weight: 800; }

    /* ── Font Style / Decoration / Transform ── */
    .italic { font-style: italic; }
    .not-italic { font-style: normal; }
    .underline { text-decoration: underline; }
    .line-through { text-decoration: line-through; }
    .no-underline { text-decoration: none; }
    .uppercase { text-transform: uppercase; }
    .lowercase { text-transform: lowercase; }
    .capitalize { text-transform: capitalize; }
    .normal-case { text-transform: none; }

    /* ── Text Align ── */
    .text-left { text-align: left; }
    .text-center { text-align: center; }
    .text-right { text-align: right; }
    .text-justify { text-align: justify; }

    /* ── Spacing / Height ── */
    .tracking-tighter { letter-spacing: -0.05em; }
    .tracking-tight { letter-spacing: -0.025em; }
    .tracking-normal { letter-spacing: 0; }
    .tracking-wide { letter-spacing: 0.025em; }
    .tracking-wider { letter-spacing: 0.05em; }
    .tracking-widest { letter-spacing: 0.1em; }
    .leading-none { line-height: 1; }
    .leading-tight { line-height: 1.25; }
    .leading-snug { line-height: 1.375; }
    .leading-normal { line-height: 1.5; }
    .leading-relaxed { line-height: 1.625; }
    .leading-loose { line-height: 2; }

    /* ── Wrapping / Overflow ── */
    .whitespace-normal { white-space: normal; }
    .whitespace-nowrap { white-space: nowrap; }
    .whitespace-pre { white-space: pre; }
    .whitespace-pre-wrap { white-space: pre-wrap; }
    .whitespace-pre-line { white-space: pre-line; }
    .break-words { overflow-wrap: break-word; }
    .break-all { word-break: break-all; }
    .truncate { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .line-clamp-1 { display: -webkit-box; -webkit-line-clamp: 1; -webkit-box-orient: vertical; overflow: hidden; }
    .line-clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
    .line-clamp-3 { display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }

    /* ═══════════════════════════════════════════════════════════════════
       TEXT COLORS — Full Palette
       ═══════════════════════════════════════════════════════════════════ */
    .text-transparent { color: transparent; }
    .text-white { color: #ffffff; }
    .text-black { color: #000000; }

    /* Gray */
    .text-gray-100 { color: var(--gray-100); }
    .text-gray-200 { color: var(--gray-200); }
    .text-gray-300 { color: var(--gray-300); }
    .text-gray-400 { color: var(--gray-400); }
    .text-gray-500 { color: var(--gray-500); }
    .text-gray-600 { color: var(--gray-600); }
    .text-gray-700 { color: var(--gray-700); }
    .text-gray-800 { color: var(--gray-800); }
    .text-gray-900 { color: var(--gray-900); }

    /* Slate */
    .text-slate-100 { color: var(--slate-100); }
    .text-slate-200 { color: var(--slate-200); }
    .text-slate-300 { color: var(--slate-300); }
    .text-slate-400 { color: var(--slate-400); }
    .text-slate-500 { color: var(--slate-500); }
    .text-slate-600 { color: var(--slate-600); }
    .text-slate-700 { color: var(--slate-700); }
    .text-slate-800 { color: var(--slate-800); }
    .text-slate-900 { color: var(--slate-900); }

    /* Blue */
    .text-blue-100 { color: var(--blue-100); }
    .text-blue-200 { color: var(--blue-200); }
    .text-blue-300 { color: var(--blue-300); }
    .text-blue-400 { color: var(--blue-400); }
    .text-blue-500 { color: var(--blue-500); }
    .text-blue-600 { color: var(--blue-600); }
    .text-blue-700 { color: var(--blue-700); }
    .text-blue-800 { color: var(--blue-800); }
    .text-blue-900 { color: var(--blue-900); }

    /* Indigo */
    .text-indigo-100 { color: var(--indigo-100); }
    .text-indigo-200 { color: var(--indigo-200); }
    .text-indigo-300 { color: var(--indigo-300); }
    .text-indigo-400 { color: var(--indigo-400); }
    .text-indigo-500 { color: var(--indigo-500); }
    .text-indigo-600 { color: var(--indigo-600); }
    .text-indigo-700 { color: var(--indigo-700); }
    .text-indigo-800 { color: var(--indigo-800); }
    .text-indigo-900 { color: var(--indigo-900); }

    /* Violet */
    .text-violet-100 { color: var(--violet-100); }
    .text-violet-200 { color: var(--violet-200); }
    .text-violet-300 { color: var(--violet-300); }
    .text-violet-400 { color: var(--violet-400); }
    .text-violet-500 { color: var(--violet-500); }
    .text-violet-600 { color: var(--violet-600); }
    .text-violet-700 { color: var(--violet-700); }
    .text-violet-800 { color: var(--violet-800); }
    .text-violet-900 { color: var(--violet-900); }

    /* Purple */
    .text-purple-100 { color: var(--purple-100); }
    .text-purple-200 { color: var(--purple-200); }
    .text-purple-300 { color: var(--purple-300); }
    .text-purple-400 { color: var(--purple-400); }
    .text-purple-500 { color: var(--purple-500); }
    .text-purple-600 { color: var(--purple-600); }
    .text-purple-700 { color: var(--purple-700); }
    .text-purple-800 { color: var(--purple-800); }
    .text-purple-900 { color: var(--purple-900); }

    /* Teal */
    .text-teal-100 { color: var(--teal-100); }
    .text-teal-200 { color: var(--teal-200); }
    .text-teal-300 { color: var(--teal-300); }
    .text-teal-400 { color: var(--teal-400); }
    .text-teal-500 { color: var(--teal-500); }
    .text-teal-600 { color: var(--teal-600); }
    .text-teal-700 { color: var(--teal-700); }
    .text-teal-800 { color: var(--teal-800); }

    /* Cyan */
    .text-cyan-100 { color: var(--cyan-100); }
    .text-cyan-200 { color: var(--cyan-200); }
    .text-cyan-300 { color: var(--cyan-300); }
    .text-cyan-400 { color: var(--cyan-400); }
    .text-cyan-500 { color: var(--cyan-500); }
    .text-cyan-600 { color: var(--cyan-600); }
    .text-cyan-700 { color: var(--cyan-700); }
    .text-cyan-800 { color: var(--cyan-800); }

    /* Emerald */
    .text-emerald-100 { color: var(--emerald-100); }
    .text-emerald-200 { color: var(--emerald-200); }
    .text-emerald-300 { color: var(--emerald-300); }
    .text-emerald-400 { color: var(--emerald-400); }
    .text-emerald-500 { color: var(--emerald-500); }
    .text-emerald-600 { color: var(--emerald-600); }
    .text-emerald-700 { color: var(--emerald-700); }
    .text-emerald-800 { color: var(--emerald-800); }

    /* Green */
    .text-green-100 { color: var(--green-100); }
    .text-green-200 { color: var(--green-200); }
    .text-green-300 { color: var(--green-300); }
    .text-green-400 { color: var(--green-400); }
    .text-green-500 { color: var(--green-500); }
    .text-green-600 { color: var(--green-600); }
    .text-green-700 { color: var(--green-700); }
    .text-green-800 { color: var(--green-800); }

    /* Yellow */
    .text-yellow-100 { color: var(--yellow-100); }
    .text-yellow-200 { color: var(--yellow-200); }
    .text-yellow-300 { color: var(--yellow-300); }
    .text-yellow-400 { color: var(--yellow-400); }
    .text-yellow-500 { color: var(--yellow-500); }
    .text-yellow-600 { color: var(--yellow-600); }
    .text-yellow-700 { color: var(--yellow-700); }
    .text-yellow-800 { color: var(--yellow-800); }

    /* Amber */
    .text-amber-100 { color: var(--amber-100); }
    .text-amber-200 { color: var(--amber-200); }
    .text-amber-300 { color: var(--amber-300); }
    .text-amber-400 { color: var(--amber-400); }
    .text-amber-500 { color: var(--amber-500); }
    .text-amber-600 { color: var(--amber-600); }
    .text-amber-700 { color: var(--amber-700); }
    .text-amber-800 { color: var(--amber-800); }

    /* Orange */
    .text-orange-100 { color: var(--orange-100); }
    .text-orange-200 { color: var(--orange-200); }
    .text-orange-300 { color: var(--orange-300); }
    .text-orange-400 { color: var(--orange-400); }
    .text-orange-500 { color: var(--orange-500); }
    .text-orange-600 { color: var(--orange-600); }
    .text-orange-700 { color: var(--orange-700); }
    .text-orange-800 { color: var(--orange-800); }

    /* Red */
    .text-red-100 { color: var(--red-100); }
    .text-red-200 { color: var(--red-200); }
    .text-red-300 { color: var(--red-300); }
    .text-red-400 { color: var(--red-400); }
    .text-red-500 { color: var(--red-500); }
    .text-red-600 { color: var(--red-600); }
    .text-red-700 { color: var(--red-700); }
    .text-red-800 { color: var(--red-800); }

    /* Rose */
    .text-rose-100 { color: var(--rose-100); }
    .text-rose-200 { color: var(--rose-200); }
    .text-rose-300 { color: var(--rose-300); }
    .text-rose-400 { color: var(--rose-400); }
    .text-rose-500 { color: var(--rose-500); }
    .text-rose-600 { color: var(--rose-600); }
    .text-rose-700 { color: var(--rose-700); }
    .text-rose-800 { color: var(--rose-800); }

    /* Pink */
    .text-pink-100 { color: var(--pink-100); }
    .text-pink-200 { color: var(--pink-200); }
    .text-pink-300 { color: var(--pink-300); }
    .text-pink-400 { color: var(--pink-400); }
    .text-pink-500 { color: var(--pink-500); }
    .text-pink-600 { color: var(--pink-600); }
    .text-pink-700 { color: var(--pink-700); }
    .text-pink-800 { color: var(--pink-800); }

    /* ═══════════════════════════════════════════════════════════════════
       BACKGROUND COLORS — Full Palette
       (NOTE: bg-* classes set ONLY background — no text color side effects)
       ═══════════════════════════════════════════════════════════════════ */
    .bg-transparent { background-color: transparent; }
    .bg-white { background-color: #ffffff; }
    .bg-black { background-color: #000000; }

    /* Gray */
    .bg-gray-50 { background-color: var(--gray-50); }
    .bg-gray-100 { background-color: var(--gray-100); }
    .bg-gray-200 { background-color: var(--gray-200); }
    .bg-gray-300 { background-color: var(--gray-300); }
    .bg-gray-400 { background-color: var(--gray-400); }
    .bg-gray-500 { background-color: var(--gray-500); }
    .bg-gray-600 { background-color: var(--gray-600); }
    .bg-gray-700 { background-color: var(--gray-700); }
    .bg-gray-800 { background-color: var(--gray-800); }
    .bg-gray-900 { background-color: var(--gray-900); }

    /* Slate */
    .bg-slate-50 { background-color: var(--slate-50); }
    .bg-slate-100 { background-color: var(--slate-100); }
    .bg-slate-200 { background-color: var(--slate-200); }
    .bg-slate-300 { background-color: var(--slate-300); }
    .bg-slate-600 { background-color: var(--slate-600); }
    .bg-slate-700 { background-color: var(--slate-700); }
    .bg-slate-800 { background-color: var(--slate-800); }
    .bg-slate-900 { background-color: var(--slate-900); }

    /* Blue */
    .bg-blue-50 { background-color: var(--blue-50); }
    .bg-blue-100 { background-color: var(--blue-100); }
    .bg-blue-200 { background-color: var(--blue-200); }
    .bg-blue-500 { background-color: var(--blue-500); }
    .bg-blue-600 { background-color: var(--blue-600); }
    .bg-blue-700 { background-color: var(--blue-700); }
    .bg-blue-800 { background-color: var(--blue-800); }
    .bg-blue-900 { background-color: var(--blue-900); }

    /* Indigo */
    .bg-indigo-50 { background-color: var(--indigo-50); }
    .bg-indigo-100 { background-color: var(--indigo-100); }
    .bg-indigo-500 { background-color: var(--indigo-500); }
    .bg-indigo-600 { background-color: var(--indigo-600); }
    .bg-indigo-700 { background-color: var(--indigo-700); }
    .bg-indigo-800 { background-color: var(--indigo-800); }
    .bg-indigo-900 { background-color: var(--indigo-900); }

    /* Violet */
    .bg-violet-50 { background-color: var(--violet-50); }
    .bg-violet-100 { background-color: var(--violet-100); }
    .bg-violet-500 { background-color: var(--violet-500); }
    .bg-violet-600 { background-color: var(--violet-600); }
    .bg-violet-700 { background-color: var(--violet-700); }
    .bg-violet-800 { background-color: var(--violet-800); }
    .bg-violet-900 { background-color: var(--violet-900); }

    /* Purple */
    .bg-purple-50 { background-color: var(--purple-50); }
    .bg-purple-100 { background-color: var(--purple-100); }
    .bg-purple-200 { background-color: var(--purple-200); }
    .bg-purple-500 { background-color: var(--purple-500); }
    .bg-purple-600 { background-color: var(--purple-600); }
    .bg-purple-700 { background-color: var(--purple-700); }
    .bg-purple-800 { background-color: var(--purple-800); }
    .bg-purple-900 { background-color: var(--purple-900); }

    /* Teal */
    .bg-teal-50 { background-color: var(--teal-50); }
    .bg-teal-100 { background-color: var(--teal-100); }
    .bg-teal-500 { background-color: var(--teal-500); }
    .bg-teal-600 { background-color: var(--teal-600); }
    .bg-teal-700 { background-color: var(--teal-700); }

    /* Cyan */
    .bg-cyan-50 { background-color: var(--cyan-50); }
    .bg-cyan-100 { background-color: var(--cyan-100); }
    .bg-cyan-500 { background-color: var(--cyan-500); }

    /* Emerald */
    .bg-emerald-50 { background-color: var(--emerald-50); }
    .bg-emerald-100 { background-color: var(--emerald-100); }
    .bg-emerald-500 { background-color: var(--emerald-500); }
    .bg-emerald-600 { background-color: var(--emerald-600); }

    /* Green */
    .bg-green-50 { background-color: var(--green-50); }
    .bg-green-100 { background-color: var(--green-100); }
    .bg-green-200 { background-color: var(--green-200); }
    .bg-green-500 { background-color: var(--green-500); }

    /* Yellow */
    .bg-yellow-50 { background-color: var(--yellow-50); }
    .bg-yellow-100 { background-color: var(--yellow-100); }
    .bg-yellow-200 { background-color: var(--yellow-200); }
    .bg-yellow-400 { background-color: var(--yellow-400); }
    .bg-yellow-500 { background-color: var(--yellow-500); }

    /* Amber */
    .bg-amber-50 { background-color: var(--amber-50); }
    .bg-amber-100 { background-color: var(--amber-100); }
    .bg-amber-200 { background-color: var(--amber-200); }
    .bg-amber-400 { background-color: var(--amber-400); }
    .bg-amber-500 { background-color: var(--amber-500); }
    .bg-amber-600 { background-color: var(--amber-600); }

    /* Orange */
    .bg-orange-50 { background-color: var(--orange-50); }
    .bg-orange-100 { background-color: var(--orange-100); }
    .bg-orange-500 { background-color: var(--orange-500); }

    /* Red */
    .bg-red-50 { background-color: var(--red-50); }
    .bg-red-100 { background-color: var(--red-100); }
    .bg-red-200 { background-color: var(--red-200); }
    .bg-red-500 { background-color: var(--red-500); }
    .bg-red-600 { background-color: var(--red-600); }

    /* Rose */
    .bg-rose-50 { background-color: var(--rose-50); }
    .bg-rose-100 { background-color: var(--rose-100); }
    .bg-rose-500 { background-color: var(--rose-500); }

    /* Pink */
    .bg-pink-50 { background-color: var(--pink-50); }
    .bg-pink-100 { background-color: var(--pink-100); }

    /* ── Semi-transparent backgrounds ── */
    .bg-white\/5 { background-color: rgb(255 255 255 / 0.05); }
    .bg-white\/10 { background-color: rgb(255 255 255 / 0.1); }
    .bg-white\/15 { background-color: rgb(255 255 255 / 0.15); }
    .bg-white\/20 { background-color: rgb(255 255 255 / 0.2); }
    .bg-white\/30 { background-color: rgb(255 255 255 / 0.3); }
    .bg-white\/40 { background-color: rgb(255 255 255 / 0.4); }
    .bg-white\/50 { background-color: rgb(255 255 255 / 0.5); }
    .bg-white\/60 { background-color: rgb(255 255 255 / 0.6); }
    .bg-white\/70 { background-color: rgb(255 255 255 / 0.7); }
    .bg-white\/75 { background-color: rgb(255 255 255 / 0.75); }
    .bg-white\/80 { background-color: rgb(255 255 255 / 0.8); }
    .bg-white\/85 { background-color: rgb(255 255 255 / 0.85); }
    .bg-white\/90 { background-color: rgb(255 255 255 / 0.9); }
    .bg-white\/95 { background-color: rgb(255 255 255 / 0.95); }
    .bg-black\/5 { background-color: rgb(0 0 0 / 0.05); }
    .bg-black\/10 { background-color: rgb(0 0 0 / 0.1); }
    .bg-black\/20 { background-color: rgb(0 0 0 / 0.2); }
    .bg-black\/50 { background-color: rgb(0 0 0 / 0.5); }
    .bg-black\/60 { background-color: rgb(0 0 0 / 0.6); }
    .bg-black\/70 { background-color: rgb(0 0 0 / 0.7); }
    .bg-black\/75 { background-color: rgb(0 0 0 / 0.75); }
    .bg-black\/80 { background-color: rgb(0 0 0 / 0.8); }
    .bg-black\/85 { background-color: rgb(0 0 0 / 0.85); }
    .bg-black\/90 { background-color: rgb(0 0 0 / 0.9); }
    .bg-black\/95 { background-color: rgb(0 0 0 / 0.95); }
    .bg-blue-500\/10 { background-color: rgb(59 130 246 / 0.1); }
    .bg-blue-500\/20 { background-color: rgb(59 130 246 / 0.2); }
    .bg-blue-500\/30 { background-color: rgb(59 130 246 / 0.3); }
    .bg-blue-600\/30 { background-color: rgb(37 99 235 / 0.3); }
    .bg-purple-500\/10 { background-color: rgb(168 85 247 / 0.1); }
    .bg-purple-500\/20 { background-color: rgb(168 85 247 / 0.2); }
    .bg-purple-500\/30 { background-color: rgb(168 85 247 / 0.3); }
    .bg-purple-600\/30 { background-color: rgb(147 51 234 / 0.3); }
    .bg-green-500\/10 { background-color: rgb(34 197 94 / 0.1); }
    .bg-green-500\/20 { background-color: rgb(34 197 94 / 0.2); }
    .bg-green-500\/30 { background-color: rgb(34 197 94 / 0.3); }
    .bg-amber-500\/10 { background-color: rgb(245 158 11 / 0.1); }
    .bg-amber-500\/20 { background-color: rgb(245 158 11 / 0.2); }
    .bg-amber-500\/30 { background-color: rgb(245 158 11 / 0.3); }
    .bg-amber-600\/30 { background-color: rgb(217 119 6 / 0.3); }
    .bg-red-500\/10 { background-color: rgb(239 68 68 / 0.1); }
    .bg-red-500\/20 { background-color: rgb(239 68 68 / 0.2); }
    .bg-pink-500\/30 { background-color: rgb(236 72 153 / 0.3); }
    .bg-pink-600\/30 { background-color: rgb(219 39 119 / 0.3); }
    .bg-emerald-500\/20 { background-color: rgb(16 185 129 / 0.2); }
    .bg-emerald-500\/30 { background-color: rgb(16 185 129 / 0.3); }
    .bg-emerald-600\/30 { background-color: rgb(5 150 105 / 0.3); }
    .bg-indigo-500\/20 { background-color: rgb(99 102 241 / 0.2); }
    .bg-indigo-500\/30 { background-color: rgb(99 102 241 / 0.3); }
    .bg-teal-500\/20 { background-color: rgb(20 184 166 / 0.2); }
    .bg-teal-500\/30 { background-color: rgb(20 184 166 / 0.3); }
    .bg-violet-500\/20 { background-color: rgb(139 92 246 / 0.2); }
    .bg-violet-500\/30 { background-color: rgb(139 92 246 / 0.3); }
    .bg-cyan-500\/20 { background-color: rgb(6 182 212 / 0.2); }
    .bg-cyan-500\/30 { background-color: rgb(6 182 212 / 0.3); }
    .bg-yellow-500\/20 { background-color: rgb(234 179 8 / 0.2); }
    .bg-orange-500\/20 { background-color: rgb(249 115 22 / 0.2); }

    /* ═══════════════════════════════════════════════════════════════════
       GRADIENTS
       ═══════════════════════════════════════════════════════════════════ */
    .bg-gradient-to-r  { background-image: linear-gradient(to right, var(--tw-gradient-stops)); }
    .bg-gradient-to-l  { background-image: linear-gradient(to left, var(--tw-gradient-stops)); }
    .bg-gradient-to-t  { background-image: linear-gradient(to top, var(--tw-gradient-stops)); }
    .bg-gradient-to-b  { background-image: linear-gradient(to bottom, var(--tw-gradient-stops)); }
    .bg-gradient-to-br { background-image: linear-gradient(to bottom right, var(--tw-gradient-stops)); }
    .bg-gradient-to-bl { background-image: linear-gradient(to bottom left, var(--tw-gradient-stops)); }
    .bg-gradient-to-tr { background-image: linear-gradient(to top right, var(--tw-gradient-stops)); }
    .bg-gradient-to-tl { background-image: linear-gradient(to top left, var(--tw-gradient-stops)); }

    /* ── from-* : comprehensive 50–900 coverage ── */
    .from-white      { --tw-gradient-from: #ffffff; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-black      { --tw-gradient-from: #000000; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-transparent { --tw-gradient-from: transparent; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }

    .from-slate-50   { --tw-gradient-from: var(--slate-50);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-slate-100  { --tw-gradient-from: var(--slate-100); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-slate-200  { --tw-gradient-from: var(--slate-200); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-slate-600  { --tw-gradient-from: var(--slate-600); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-slate-700  { --tw-gradient-from: var(--slate-700); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-slate-800  { --tw-gradient-from: var(--slate-800); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-slate-900  { --tw-gradient-from: var(--slate-900); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }

    .from-gray-50    { --tw-gradient-from: var(--gray-50);   --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-gray-100   { --tw-gradient-from: var(--gray-100);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-gray-200   { --tw-gradient-from: var(--gray-200);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-gray-700   { --tw-gradient-from: var(--gray-700);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-gray-800   { --tw-gradient-from: var(--gray-800);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-gray-900   { --tw-gradient-from: var(--gray-900);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }

    .from-blue-50    { --tw-gradient-from: var(--blue-50);   --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-blue-100   { --tw-gradient-from: var(--blue-100);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-blue-200   { --tw-gradient-from: var(--blue-200);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-blue-400   { --tw-gradient-from: var(--blue-400);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-blue-500   { --tw-gradient-from: var(--blue-500);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-blue-600   { --tw-gradient-from: var(--blue-600);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-blue-700   { --tw-gradient-from: var(--blue-700);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-blue-800   { --tw-gradient-from: var(--blue-800);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-blue-900   { --tw-gradient-from: var(--blue-900);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }

    .from-indigo-50  { --tw-gradient-from: var(--indigo-50);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-indigo-100 { --tw-gradient-from: var(--indigo-100); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-indigo-200 { --tw-gradient-from: var(--indigo-200); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-indigo-400 { --tw-gradient-from: var(--indigo-400); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-indigo-500 { --tw-gradient-from: var(--indigo-500); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-indigo-600 { --tw-gradient-from: var(--indigo-600); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-indigo-700 { --tw-gradient-from: var(--indigo-700); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-indigo-800 { --tw-gradient-from: var(--indigo-800); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-indigo-900 { --tw-gradient-from: var(--indigo-900); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }

    .from-violet-50  { --tw-gradient-from: var(--violet-50);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-violet-100 { --tw-gradient-from: var(--violet-100); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-violet-200 { --tw-gradient-from: var(--violet-200); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-violet-400 { --tw-gradient-from: var(--violet-400); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-violet-500 { --tw-gradient-from: var(--violet-500); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-violet-600 { --tw-gradient-from: var(--violet-600); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-violet-700 { --tw-gradient-from: var(--violet-700); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-violet-800 { --tw-gradient-from: var(--violet-800); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-violet-900 { --tw-gradient-from: var(--violet-900); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }

    .from-purple-50  { --tw-gradient-from: var(--purple-50);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-purple-100 { --tw-gradient-from: var(--purple-100); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-purple-200 { --tw-gradient-from: var(--purple-200); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-purple-400 { --tw-gradient-from: var(--purple-400); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-purple-500 { --tw-gradient-from: var(--purple-500); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-purple-600 { --tw-gradient-from: var(--purple-600); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-purple-700 { --tw-gradient-from: var(--purple-700); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-purple-800 { --tw-gradient-from: var(--purple-800); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-purple-900 { --tw-gradient-from: var(--purple-900); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }

    .from-teal-50    { --tw-gradient-from: var(--teal-50);   --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-teal-100   { --tw-gradient-from: var(--teal-100);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-teal-200   { --tw-gradient-from: var(--teal-200);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-teal-400   { --tw-gradient-from: var(--teal-400);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-teal-500   { --tw-gradient-from: var(--teal-500);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-teal-600   { --tw-gradient-from: var(--teal-600);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-teal-700   { --tw-gradient-from: var(--teal-700);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-teal-800   { --tw-gradient-from: var(--teal-800);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-teal-900   { --tw-gradient-from: var(--teal-900);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }

    .from-cyan-50    { --tw-gradient-from: var(--cyan-50);   --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-cyan-100   { --tw-gradient-from: var(--cyan-100);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-cyan-200   { --tw-gradient-from: var(--cyan-200);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-cyan-400   { --tw-gradient-from: var(--cyan-400);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-cyan-500   { --tw-gradient-from: var(--cyan-500);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-cyan-600   { --tw-gradient-from: var(--cyan-600);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-cyan-700   { --tw-gradient-from: var(--cyan-700);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-cyan-800   { --tw-gradient-from: var(--cyan-800);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }

    .from-emerald-50 { --tw-gradient-from: var(--emerald-50);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-emerald-100 { --tw-gradient-from: var(--emerald-100); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-emerald-200 { --tw-gradient-from: var(--emerald-200); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-emerald-400 { --tw-gradient-from: var(--emerald-400); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-emerald-500 { --tw-gradient-from: var(--emerald-500); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-emerald-600 { --tw-gradient-from: var(--emerald-600); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-emerald-700 { --tw-gradient-from: var(--emerald-700); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-emerald-800 { --tw-gradient-from: var(--emerald-800); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-emerald-900 { --tw-gradient-from: var(--emerald-900); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }

    .from-green-50   { --tw-gradient-from: var(--green-50);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-green-100  { --tw-gradient-from: var(--green-100); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-green-200  { --tw-gradient-from: var(--green-200); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-green-400  { --tw-gradient-from: var(--green-400); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-green-500  { --tw-gradient-from: var(--green-500); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-green-600  { --tw-gradient-from: var(--green-600); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-green-700  { --tw-gradient-from: var(--green-700); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-green-800  { --tw-gradient-from: var(--green-800); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }

    .from-amber-50   { --tw-gradient-from: var(--amber-50);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-amber-100  { --tw-gradient-from: var(--amber-100); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-amber-200  { --tw-gradient-from: var(--amber-200); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-amber-400  { --tw-gradient-from: var(--amber-400); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-amber-500  { --tw-gradient-from: var(--amber-500); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-amber-600  { --tw-gradient-from: var(--amber-600); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }

    .from-yellow-400 { --tw-gradient-from: var(--yellow-400); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-yellow-500 { --tw-gradient-from: var(--yellow-500); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }

    .from-orange-400 { --tw-gradient-from: var(--orange-400); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-orange-500 { --tw-gradient-from: var(--orange-500); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-orange-600 { --tw-gradient-from: var(--orange-600); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }

    .from-red-50     { --tw-gradient-from: var(--red-50);    --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-red-100    { --tw-gradient-from: var(--red-100);   --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-red-200    { --tw-gradient-from: var(--red-200);   --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-red-400    { --tw-gradient-from: var(--red-400);   --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-red-500    { --tw-gradient-from: var(--red-500);   --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-red-600    { --tw-gradient-from: var(--red-600);   --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-red-700    { --tw-gradient-from: var(--red-700);   --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-red-800    { --tw-gradient-from: var(--red-800);   --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-red-900    { --tw-gradient-from: var(--red-900);   --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }

    .from-rose-50    { --tw-gradient-from: var(--rose-50);   --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-rose-100   { --tw-gradient-from: var(--rose-100);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-rose-200   { --tw-gradient-from: var(--rose-200);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-rose-400   { --tw-gradient-from: var(--rose-400);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-rose-500   { --tw-gradient-from: var(--rose-500);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-rose-600   { --tw-gradient-from: var(--rose-600);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-rose-800   { --tw-gradient-from: var(--rose-800);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-rose-900   { --tw-gradient-from: var(--rose-900);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }

    .from-pink-50    { --tw-gradient-from: var(--pink-50);   --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-pink-100   { --tw-gradient-from: var(--pink-100);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-pink-200   { --tw-gradient-from: var(--pink-200);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-pink-400   { --tw-gradient-from: var(--pink-400);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-pink-500   { --tw-gradient-from: var(--pink-500);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-pink-600   { --tw-gradient-from: var(--pink-600);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }

    /* ── via-* : comprehensive ── */
    .via-slate-700   { --tw-gradient-stops: var(--tw-gradient-from), var(--slate-700), var(--tw-gradient-to, transparent); }
    .via-slate-800   { --tw-gradient-stops: var(--tw-gradient-from), var(--slate-800), var(--tw-gradient-to, transparent); }
    .via-gray-700    { --tw-gradient-stops: var(--tw-gradient-from), var(--gray-700), var(--tw-gradient-to, transparent); }
    .via-gray-800    { --tw-gradient-stops: var(--tw-gradient-from), var(--gray-800), var(--tw-gradient-to, transparent); }
    .via-blue-500    { --tw-gradient-stops: var(--tw-gradient-from), var(--blue-500), var(--tw-gradient-to, transparent); }
    .via-blue-600    { --tw-gradient-stops: var(--tw-gradient-from), var(--blue-600), var(--tw-gradient-to, transparent); }
    .via-blue-700    { --tw-gradient-stops: var(--tw-gradient-from), var(--blue-700), var(--tw-gradient-to, transparent); }
    .via-blue-800    { --tw-gradient-stops: var(--tw-gradient-from), var(--blue-800), var(--tw-gradient-to, transparent); }
    .via-blue-900    { --tw-gradient-stops: var(--tw-gradient-from), var(--blue-900), var(--tw-gradient-to, transparent); }
    .via-indigo-500  { --tw-gradient-stops: var(--tw-gradient-from), var(--indigo-500), var(--tw-gradient-to, transparent); }
    .via-indigo-600  { --tw-gradient-stops: var(--tw-gradient-from), var(--indigo-600), var(--tw-gradient-to, transparent); }
    .via-indigo-700  { --tw-gradient-stops: var(--tw-gradient-from), var(--indigo-700), var(--tw-gradient-to, transparent); }
    .via-indigo-800  { --tw-gradient-stops: var(--tw-gradient-from), var(--indigo-800), var(--tw-gradient-to, transparent); }
    .via-indigo-900  { --tw-gradient-stops: var(--tw-gradient-from), var(--indigo-900), var(--tw-gradient-to, transparent); }
    .via-violet-500  { --tw-gradient-stops: var(--tw-gradient-from), var(--violet-500), var(--tw-gradient-to, transparent); }
    .via-violet-600  { --tw-gradient-stops: var(--tw-gradient-from), var(--violet-600), var(--tw-gradient-to, transparent); }
    .via-violet-700  { --tw-gradient-stops: var(--tw-gradient-from), var(--violet-700), var(--tw-gradient-to, transparent); }
    .via-violet-800  { --tw-gradient-stops: var(--tw-gradient-from), var(--violet-800), var(--tw-gradient-to, transparent); }
    .via-violet-900  { --tw-gradient-stops: var(--tw-gradient-from), var(--violet-900), var(--tw-gradient-to, transparent); }
    .via-purple-500  { --tw-gradient-stops: var(--tw-gradient-from), var(--purple-500), var(--tw-gradient-to, transparent); }
    .via-purple-600  { --tw-gradient-stops: var(--tw-gradient-from), var(--purple-600), var(--tw-gradient-to, transparent); }
    .via-purple-700  { --tw-gradient-stops: var(--tw-gradient-from), var(--purple-700), var(--tw-gradient-to, transparent); }
    .via-purple-800  { --tw-gradient-stops: var(--tw-gradient-from), var(--purple-800), var(--tw-gradient-to, transparent); }
    .via-purple-900  { --tw-gradient-stops: var(--tw-gradient-from), var(--purple-900), var(--tw-gradient-to, transparent); }
    .via-teal-500    { --tw-gradient-stops: var(--tw-gradient-from), var(--teal-500), var(--tw-gradient-to, transparent); }
    .via-teal-600    { --tw-gradient-stops: var(--tw-gradient-from), var(--teal-600), var(--tw-gradient-to, transparent); }
    .via-teal-700    { --tw-gradient-stops: var(--tw-gradient-from), var(--teal-700), var(--tw-gradient-to, transparent); }
    .via-teal-800    { --tw-gradient-stops: var(--tw-gradient-from), var(--teal-800), var(--tw-gradient-to, transparent); }
    .via-emerald-500 { --tw-gradient-stops: var(--tw-gradient-from), var(--emerald-500), var(--tw-gradient-to, transparent); }
    .via-emerald-600 { --tw-gradient-stops: var(--tw-gradient-from), var(--emerald-600), var(--tw-gradient-to, transparent); }
    .via-emerald-700 { --tw-gradient-stops: var(--tw-gradient-from), var(--emerald-700), var(--tw-gradient-to, transparent); }
    .via-emerald-800 { --tw-gradient-stops: var(--tw-gradient-from), var(--emerald-800), var(--tw-gradient-to, transparent); }
    .via-green-500   { --tw-gradient-stops: var(--tw-gradient-from), var(--green-500), var(--tw-gradient-to, transparent); }
    .via-green-600   { --tw-gradient-stops: var(--tw-gradient-from), var(--green-600), var(--tw-gradient-to, transparent); }
    .via-amber-400   { --tw-gradient-stops: var(--tw-gradient-from), var(--amber-400), var(--tw-gradient-to, transparent); }
    .via-amber-500   { --tw-gradient-stops: var(--tw-gradient-from), var(--amber-500), var(--tw-gradient-to, transparent); }
    .via-red-500     { --tw-gradient-stops: var(--tw-gradient-from), var(--red-500), var(--tw-gradient-to, transparent); }
    .via-red-600     { --tw-gradient-stops: var(--tw-gradient-from), var(--red-600), var(--tw-gradient-to, transparent); }
    .via-red-700     { --tw-gradient-stops: var(--tw-gradient-from), var(--red-700), var(--tw-gradient-to, transparent); }
    .via-rose-500    { --tw-gradient-stops: var(--tw-gradient-from), var(--rose-500), var(--tw-gradient-to, transparent); }
    .via-rose-600    { --tw-gradient-stops: var(--tw-gradient-from), var(--rose-600), var(--tw-gradient-to, transparent); }
    .via-pink-500    { --tw-gradient-stops: var(--tw-gradient-from), var(--pink-500), var(--tw-gradient-to, transparent); }
    .via-cyan-500    { --tw-gradient-stops: var(--tw-gradient-from), var(--cyan-500), var(--tw-gradient-to, transparent); }
    .via-cyan-600    { --tw-gradient-stops: var(--tw-gradient-from), var(--cyan-600), var(--tw-gradient-to, transparent); }
    .via-orange-500  { --tw-gradient-stops: var(--tw-gradient-from), var(--orange-500), var(--tw-gradient-to, transparent); }

    /* ── to-* : comprehensive ── */
    .to-transparent  { --tw-gradient-to: transparent; }
    .to-white        { --tw-gradient-to: #ffffff; }
    .to-black        { --tw-gradient-to: #000000; }
    .to-gray-50      { --tw-gradient-to: var(--gray-50); }
    .to-gray-100     { --tw-gradient-to: var(--gray-100); }
    .to-gray-900     { --tw-gradient-to: var(--gray-900); }
    .to-slate-100    { --tw-gradient-to: var(--slate-100); }
    .to-slate-800    { --tw-gradient-to: var(--slate-800); }
    .to-slate-900    { --tw-gradient-to: var(--slate-900); }
    .to-blue-50      { --tw-gradient-to: var(--blue-50); }
    .to-blue-100     { --tw-gradient-to: var(--blue-100); }
    .to-blue-200     { --tw-gradient-to: var(--blue-200); }
    .to-blue-400     { --tw-gradient-to: var(--blue-400); }
    .to-blue-500     { --tw-gradient-to: var(--blue-500); }
    .to-blue-600     { --tw-gradient-to: var(--blue-600); }
    .to-blue-700     { --tw-gradient-to: var(--blue-700); }
    .to-blue-800     { --tw-gradient-to: var(--blue-800); }
    .to-blue-900     { --tw-gradient-to: var(--blue-900); }
    .to-indigo-50    { --tw-gradient-to: var(--indigo-50); }
    .to-indigo-100   { --tw-gradient-to: var(--indigo-100); }
    .to-indigo-400   { --tw-gradient-to: var(--indigo-400); }
    .to-indigo-500   { --tw-gradient-to: var(--indigo-500); }
    .to-indigo-600   { --tw-gradient-to: var(--indigo-600); }
    .to-indigo-700   { --tw-gradient-to: var(--indigo-700); }
    .to-indigo-800   { --tw-gradient-to: var(--indigo-800); }
    .to-indigo-900   { --tw-gradient-to: var(--indigo-900); }
    .to-violet-50    { --tw-gradient-to: var(--violet-50); }
    .to-violet-100   { --tw-gradient-to: var(--violet-100); }
    .to-violet-200   { --tw-gradient-to: var(--violet-200); }
    .to-violet-400   { --tw-gradient-to: var(--violet-400); }
    .to-violet-500   { --tw-gradient-to: var(--violet-500); }
    .to-violet-600   { --tw-gradient-to: var(--violet-600); }
    .to-violet-700   { --tw-gradient-to: var(--violet-700); }
    .to-violet-800   { --tw-gradient-to: var(--violet-800); }
    .to-violet-900   { --tw-gradient-to: var(--violet-900); }
    .to-purple-50    { --tw-gradient-to: var(--purple-50); }
    .to-purple-100   { --tw-gradient-to: var(--purple-100); }
    .to-purple-200   { --tw-gradient-to: var(--purple-200); }
    .to-purple-400   { --tw-gradient-to: var(--purple-400); }
    .to-purple-500   { --tw-gradient-to: var(--purple-500); }
    .to-purple-600   { --tw-gradient-to: var(--purple-600); }
    .to-purple-700   { --tw-gradient-to: var(--purple-700); }
    .to-purple-800   { --tw-gradient-to: var(--purple-800); }
    .to-purple-900   { --tw-gradient-to: var(--purple-900); }
    .to-teal-50      { --tw-gradient-to: var(--teal-50); }
    .to-teal-100     { --tw-gradient-to: var(--teal-100); }
    .to-teal-200     { --tw-gradient-to: var(--teal-200); }
    .to-teal-400     { --tw-gradient-to: var(--teal-400); }
    .to-teal-500     { --tw-gradient-to: var(--teal-500); }
    .to-teal-600     { --tw-gradient-to: var(--teal-600); }
    .to-teal-700     { --tw-gradient-to: var(--teal-700); }
    .to-teal-800     { --tw-gradient-to: var(--teal-800); }
    .to-teal-900     { --tw-gradient-to: var(--teal-900); }
    .to-cyan-50      { --tw-gradient-to: var(--cyan-50); }
    .to-cyan-100     { --tw-gradient-to: var(--cyan-100); }
    .to-cyan-200     { --tw-gradient-to: var(--cyan-200); }
    .to-cyan-400     { --tw-gradient-to: var(--cyan-400); }
    .to-cyan-500     { --tw-gradient-to: var(--cyan-500); }
    .to-cyan-600     { --tw-gradient-to: var(--cyan-600); }
    .to-cyan-800     { --tw-gradient-to: var(--cyan-800); }
    .to-cyan-900     { --tw-gradient-to: var(--cyan-900); }
    .to-emerald-50   { --tw-gradient-to: var(--emerald-50); }
    .to-emerald-100  { --tw-gradient-to: var(--emerald-100); }
    .to-emerald-400  { --tw-gradient-to: var(--emerald-400); }
    .to-emerald-500  { --tw-gradient-to: var(--emerald-500); }
    .to-emerald-600  { --tw-gradient-to: var(--emerald-600); }
    .to-emerald-700  { --tw-gradient-to: var(--emerald-700); }
    .to-emerald-800  { --tw-gradient-to: var(--emerald-800); }
    .to-emerald-900  { --tw-gradient-to: var(--emerald-900); }
    .to-green-50     { --tw-gradient-to: var(--green-50); }
    .to-green-100    { --tw-gradient-to: var(--green-100); }
    .to-green-400    { --tw-gradient-to: var(--green-400); }
    .to-green-500    { --tw-gradient-to: var(--green-500); }
    .to-green-600    { --tw-gradient-to: var(--green-600); }
    .to-green-700    { --tw-gradient-to: var(--green-700); }
    .to-green-800    { --tw-gradient-to: var(--green-800); }
    .to-amber-50     { --tw-gradient-to: var(--amber-50); }
    .to-amber-100    { --tw-gradient-to: var(--amber-100); }
    .to-amber-200    { --tw-gradient-to: var(--amber-200); }
    .to-amber-400    { --tw-gradient-to: var(--amber-400); }
    .to-amber-500    { --tw-gradient-to: var(--amber-500); }
    .to-amber-600    { --tw-gradient-to: var(--amber-600); }
    .to-yellow-400   { --tw-gradient-to: var(--yellow-400); }
    .to-yellow-500   { --tw-gradient-to: var(--yellow-500); }
    .to-orange-50    { --tw-gradient-to: var(--orange-50); }
    .to-orange-100   { --tw-gradient-to: var(--orange-100); }
    .to-orange-400   { --tw-gradient-to: var(--orange-400); }
    .to-orange-500   { --tw-gradient-to: var(--orange-500); }
    .to-orange-600   { --tw-gradient-to: var(--orange-600); }
    .to-red-50       { --tw-gradient-to: var(--red-50); }
    .to-red-100      { --tw-gradient-to: var(--red-100); }
    .to-red-200      { --tw-gradient-to: var(--red-200); }
    .to-red-400      { --tw-gradient-to: var(--red-400); }
    .to-red-500      { --tw-gradient-to: var(--red-500); }
    .to-red-600      { --tw-gradient-to: var(--red-600); }
    .to-red-700      { --tw-gradient-to: var(--red-700); }
    .to-red-800      { --tw-gradient-to: var(--red-800); }
    .to-red-900      { --tw-gradient-to: var(--red-900); }
    .to-rose-50      { --tw-gradient-to: var(--rose-50); }
    .to-rose-100     { --tw-gradient-to: var(--rose-100); }
    .to-rose-200     { --tw-gradient-to: var(--rose-200); }
    .to-rose-400     { --tw-gradient-to: var(--rose-400); }
    .to-rose-500     { --tw-gradient-to: var(--rose-500); }
    .to-rose-600     { --tw-gradient-to: var(--rose-600); }
    .to-rose-800     { --tw-gradient-to: var(--rose-800); }
    .to-rose-900     { --tw-gradient-to: var(--rose-900); }
    .to-pink-50      { --tw-gradient-to: var(--pink-50); }
    .to-pink-100     { --tw-gradient-to: var(--pink-100); }
    .to-pink-200     { --tw-gradient-to: var(--pink-200); }
    .to-pink-400     { --tw-gradient-to: var(--pink-400); }
    .to-pink-500     { --tw-gradient-to: var(--pink-500); }
    .to-pink-600     { --tw-gradient-to: var(--pink-600); }

    /* ── Semi-transparent gradient stops ── */
    .from-purple-500\/30 { --tw-gradient-from: rgb(168 85 247 / 0.3); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-purple-500\/20 { --tw-gradient-from: rgb(168 85 247 / 0.2); --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-blue-500\/30   { --tw-gradient-from: rgb(59 130 246 / 0.3);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-green-500\/30  { --tw-gradient-from: rgb(34 197 94 / 0.3);   --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-amber-500\/30  { --tw-gradient-from: rgb(245 158 11 / 0.3);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-red-500\/30    { --tw-gradient-from: rgb(239 68 68 / 0.3);   --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-teal-500\/30   { --tw-gradient-from: rgb(20 184 166 / 0.3);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
    .from-indigo-500\/30 { --tw-gradient-from: rgb(99 102 241 / 0.3);  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }

    .to-pink-500\/30     { --tw-gradient-to: rgb(236 72 153 / 0.3); }
    .to-purple-500\/30   { --tw-gradient-to: rgb(168 85 247 / 0.3); }
    .to-blue-500\/30     { --tw-gradient-to: rgb(59 130 246 / 0.3); }
    .to-green-500\/30    { --tw-gradient-to: rgb(34 197 94 / 0.3); }
    .to-amber-500\/30    { --tw-gradient-to: rgb(245 158 11 / 0.3); }
    .to-red-500\/30      { --tw-gradient-to: rgb(239 68 68 / 0.3); }
    .to-teal-500\/30     { --tw-gradient-to: rgb(20 184 166 / 0.3); }
    .to-indigo-500\/30   { --tw-gradient-to: rgb(99 102 241 / 0.3); }
    .to-transparent      { --tw-gradient-to: transparent; }

    /* ═══════════════════════════════════════════════════════════════════
       BORDERS
       ═══════════════════════════════════════════════════════════════════ */
    .border { border: 1px solid; }
    .border-0 { border-width: 0; }
    .border-2 { border: 2px solid; }
    .border-4 { border: 4px solid; }
    .border-b { border-bottom: 1px solid; }
    .border-b-2 { border-bottom: 2px solid; }
    .border-b-4 { border-bottom: 4px solid; }
    .border-t { border-top: 1px solid; }
    .border-t-2 { border-top: 2px solid; }
    .border-l { border-left: 1px solid; }
    .border-l-2 { border-left: 2px solid; }
    .border-l-4 { border-left: 4px solid; }
    .border-r { border-right: 1px solid; }
    .border-r-2 { border-right: 2px solid; }

    .border-transparent { border-color: transparent; }
    .border-white { border-color: #ffffff; }
    .border-black { border-color: #000000; }

    /* Solid border colors (comprehensive) */
    .border-gray-100 { border-color: var(--gray-100); }
    .border-gray-200 { border-color: var(--gray-200); }
    .border-gray-300 { border-color: var(--gray-300); }
    .border-gray-400 { border-color: var(--gray-400); }
    .border-gray-500 { border-color: var(--gray-500); }
    .border-slate-200 { border-color: var(--slate-200); }
    .border-slate-300 { border-color: var(--slate-300); }
    .border-slate-400 { border-color: var(--slate-400); }
    .border-slate-500 { border-color: var(--slate-500); }
    .border-slate-600 { border-color: var(--slate-600); }
    .border-slate-700 { border-color: var(--slate-700); }
    .border-blue-100 { border-color: var(--blue-100); }
    .border-blue-200 { border-color: var(--blue-200); }
    .border-blue-300 { border-color: var(--blue-300); }
    .border-blue-400 { border-color: var(--blue-400); }
    .border-blue-500 { border-color: var(--blue-500); }
    .border-blue-600 { border-color: var(--blue-600); }
    .border-indigo-200 { border-color: var(--indigo-200); }
    .border-indigo-300 { border-color: var(--indigo-300); }
    .border-indigo-400 { border-color: var(--indigo-400); }
    .border-indigo-500 { border-color: var(--indigo-500); }
    .border-violet-200 { border-color: var(--violet-200); }
    .border-violet-300 { border-color: var(--violet-300); }
    .border-violet-400 { border-color: var(--violet-400); }
    .border-purple-100 { border-color: var(--purple-100); }
    .border-purple-200 { border-color: var(--purple-200); }
    .border-purple-300 { border-color: var(--purple-300); }
    .border-purple-400 { border-color: var(--purple-400); }
    .border-purple-500 { border-color: var(--purple-500); }
    .border-purple-600 { border-color: var(--purple-600); }
    .border-teal-200 { border-color: var(--teal-200); }
    .border-teal-300 { border-color: var(--teal-300); }
    .border-teal-400 { border-color: var(--teal-400); }
    .border-cyan-200 { border-color: var(--cyan-200); }
    .border-cyan-300 { border-color: var(--cyan-300); }
    .border-emerald-100 { border-color: var(--emerald-100); }
    .border-emerald-200 { border-color: var(--emerald-200); }
    .border-emerald-300 { border-color: var(--emerald-300); }
    .border-emerald-400 { border-color: var(--emerald-400); }
    .border-emerald-500 { border-color: var(--emerald-500); }
    .border-emerald-600 { border-color: var(--emerald-600); }
    .border-green-200 { border-color: var(--green-200); }
    .border-green-300 { border-color: var(--green-300); }
    .border-green-400 { border-color: var(--green-400); }
    .border-green-500 { border-color: var(--green-500); }
    .border-yellow-200 { border-color: var(--yellow-200); }
    .border-yellow-300 { border-color: var(--yellow-300); }
    .border-yellow-400 { border-color: var(--yellow-400); }
    .border-amber-200 { border-color: var(--amber-200); }
    .border-amber-300 { border-color: var(--amber-300); }
    .border-amber-400 { border-color: var(--amber-400); }
    .border-amber-500 { border-color: var(--amber-500); }
    .border-orange-200 { border-color: var(--orange-200); }
    .border-orange-300 { border-color: var(--orange-300); }
    .border-red-200 { border-color: var(--red-200); }
    .border-red-300 { border-color: var(--red-300); }
    .border-red-400 { border-color: var(--red-400); }
    .border-rose-200 { border-color: var(--rose-200); }
    .border-rose-300 { border-color: var(--rose-300); }
    .border-pink-200 { border-color: var(--pink-200); }
    .border-pink-300 { border-color: var(--pink-300); }

    /* Semi-transparent borders */
    .border-white\/10 { border-color: rgb(255 255 255 / 0.1); }
    .border-white\/20 { border-color: rgb(255 255 255 / 0.2); }
    .border-white\/30 { border-color: rgb(255 255 255 / 0.3); }
    .border-blue-400\/30 { border-color: rgb(96 165 250 / 0.3); }
    .border-purple-400\/30 { border-color: rgb(192 132 252 / 0.3); }
    .border-purple-300\/30 { border-color: rgb(216 180 254 / 0.3); }
    .border-green-400\/30 { border-color: rgb(74 222 128 / 0.3); }
    .border-green-400\/50 { border-color: rgb(74 222 128 / 0.5); }
    .border-amber-400\/30 { border-color: rgb(251 191 36 / 0.3); }
    .border-pink-400\/30 { border-color: rgb(244 114 182 / 0.3); }
    .border-emerald-400\/30 { border-color: rgb(52 211 153 / 0.3); }
    .border-red-400\/30 { border-color: rgb(248 113 113 / 0.3); }
    .border-indigo-400\/30 { border-color: rgb(129 140 248 / 0.3); }
    .border-teal-400\/30 { border-color: rgb(45 212 191 / 0.3); }
    .border-violet-400\/30 { border-color: rgb(167 139 250 / 0.3); }
    .border-cyan-400\/30 { border-color: rgb(34 211 238 / 0.3); }

    /* ═══════════════════════════════════════════════════════════════════
       BORDER RADIUS
       ═══════════════════════════════════════════════════════════════════ */
    .rounded-none { border-radius: 0; }
    .rounded-sm { border-radius: 0.125rem; }
    .rounded { border-radius: 0.25rem; }
    .rounded-md { border-radius: 0.375rem; }
    .rounded-lg { border-radius: 0.5rem; }
    .rounded-xl { border-radius: 0.75rem; }
    .rounded-2xl { border-radius: 1rem; }
    .rounded-3xl { border-radius: 1.5rem; }
    .rounded-full { border-radius: 9999px; }
    .rounded-t { border-radius: 0.25rem 0.25rem 0 0; }
    .rounded-t-lg { border-radius: 0.5rem 0.5rem 0 0; }
    .rounded-t-xl { border-radius: 0.75rem 0.75rem 0 0; }
    .rounded-b { border-radius: 0 0 0.25rem 0.25rem; }
    .rounded-b-lg { border-radius: 0 0 0.5rem 0.5rem; }
    .rounded-b-xl { border-radius: 0 0 0.75rem 0.75rem; }
    .rounded-l { border-radius: 0.25rem 0 0 0.25rem; }
    .rounded-l-lg { border-radius: 0.5rem 0 0 0.5rem; }
    .rounded-r { border-radius: 0 0.25rem 0.25rem 0; }
    .rounded-r-lg { border-radius: 0 0.5rem 0.5rem 0; }

    /* ═══════════════════════════════════════════════════════════════════
       SHADOWS
       ═══════════════════════════════════════════════════════════════════ */
    .shadow-sm { box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05); }
    .shadow { box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1); }
    .shadow-md { box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); }
    .shadow-lg { box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1); }
    .shadow-xl { box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1); }
    .shadow-2xl { box-shadow: 0 25px 50px -12px rgb(0 0 0 / 0.25); }
    .shadow-inner { box-shadow: inset 0 2px 4px 0 rgb(0 0 0 / 0.05); }
    .shadow-none { box-shadow: none; }

    /* ═══════════════════════════════════════════════════════════════════
       OPACITY
       ═══════════════════════════════════════════════════════════════════ */
    .opacity-0 { opacity: 0; }
    .opacity-5 { opacity: 0.05; }
    .opacity-10 { opacity: 0.1; }
    .opacity-20 { opacity: 0.2; }
    .opacity-25 { opacity: 0.25; }
    .opacity-30 { opacity: 0.3; }
    .opacity-40 { opacity: 0.4; }
    .opacity-50 { opacity: 0.5; }
    .opacity-60 { opacity: 0.6; }
    .opacity-70 { opacity: 0.7; }
    .opacity-75 { opacity: 0.75; }
    .opacity-80 { opacity: 0.8; }
    .opacity-90 { opacity: 0.9; }
    .opacity-95 { opacity: 0.95; }
    .opacity-100 { opacity: 1; }

    /* ═══════════════════════════════════════════════════════════════════
       TRANSFORMS
       ═══════════════════════════════════════════════════════════════════ */
    .transform { transform: var(--tw-transform); }
    .translate-x-0 { transform: translateX(0); }
    .translate-y-0 { transform: translateY(0); }
    .-translate-x-1\/2 { transform: translateX(-50%); }
    .-translate-y-1\/2 { transform: translateY(-50%); }
    .translate-x-1\/2 { transform: translateX(50%); }
    .rotate-0 { transform: rotate(0deg); }
    .rotate-45 { transform: rotate(45deg); }
    .rotate-90 { transform: rotate(90deg); }
    .rotate-180 { transform: rotate(180deg); }
    .-rotate-45 { transform: rotate(-45deg); }
    .-rotate-90 { transform: rotate(-90deg); }
    .scale-75 { transform: scale(0.75); }
    .scale-90 { transform: scale(0.9); }
    .scale-95 { transform: scale(0.95); }
    .scale-100 { transform: scale(1); }
    .scale-105 { transform: scale(1.05); }
    .scale-110 { transform: scale(1.1); }
    .scale-125 { transform: scale(1.25); }
    .scale-150 { transform: scale(1.5); }

    /* ═══════════════════════════════════════════════════════════════════
       TRANSITIONS & ANIMATIONS
       ═══════════════════════════════════════════════════════════════════ */
    .transition-none { transition-property: none; }
    .transition-all { transition: all 150ms cubic-bezier(0.4, 0, 0.2, 1); }
    .transition-colors { transition: color 150ms, background-color 150ms, border-color 150ms, fill 150ms, stroke 150ms; }
    .transition-opacity { transition: opacity 150ms cubic-bezier(0.4, 0, 0.2, 1); }
    .transition-shadow { transition: box-shadow 150ms cubic-bezier(0.4, 0, 0.2, 1); }
    .transition-transform { transition: transform 150ms cubic-bezier(0.4, 0, 0.2, 1); }
    .duration-75 { transition-duration: 75ms; }
    .duration-100 { transition-duration: 100ms; }
    .duration-150 { transition-duration: 150ms; }
    .duration-200 { transition-duration: 200ms; }
    .duration-300 { transition-duration: 300ms; }
    .duration-500 { transition-duration: 500ms; }
    .ease-in { transition-timing-function: cubic-bezier(0.4, 0, 1, 1); }
    .ease-out { transition-timing-function: cubic-bezier(0, 0, 0.2, 1); }
    .ease-in-out { transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); }

    .animate-pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
    .animate-spin { animation: spin 1s linear infinite; }
    .animate-bounce { animation: bounce-anim 1s infinite; }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    @keyframes bounce-anim { 0%, 100% { transform: translateY(-25%); animation-timing-function: cubic-bezier(0.8,0,1,1); } 50% { transform: translateY(0); animation-timing-function: cubic-bezier(0,0,0.2,1); } }

    /* ═══════════════════════════════════════════════════════════════════
       FILTERS & EFFECTS
       ═══════════════════════════════════════════════════════════════════ */
    .backdrop-blur-sm { backdrop-filter: blur(4px); }
    .backdrop-blur { backdrop-filter: blur(8px); }
    .backdrop-blur-md { backdrop-filter: blur(12px); }
    .backdrop-blur-lg { backdrop-filter: blur(16px); }
    .blur-sm { filter: blur(4px); }
    .blur { filter: blur(8px); }
    .brightness-50 { filter: brightness(0.5); }
    .brightness-75 { filter: brightness(0.75); }
    .brightness-100 { filter: brightness(1); }
    .brightness-125 { filter: brightness(1.25); }
    .grayscale { filter: grayscale(100%); }
    .grayscale-0 { filter: grayscale(0); }

    /* ═══════════════════════════════════════════════════════════════════
       MISCELLANEOUS UTILITIES
       ═══════════════════════════════════════════════════════════════════ */
    .object-contain { object-fit: contain; }
    .object-cover { object-fit: cover; }
    .object-fill { object-fit: fill; }
    .object-center { object-position: center; }
    .cursor-pointer { cursor: pointer; }
    .cursor-default { cursor: default; }
    .cursor-not-allowed { cursor: not-allowed; }
    .select-none { user-select: none; }
    .select-text { user-select: text; }
    .select-all { user-select: all; }
    .pointer-events-none { pointer-events: none; }
    .pointer-events-auto { pointer-events: auto; }
    .resize-none { resize: none; }
    .list-none { list-style-type: none; }
    .list-disc { list-style-type: disc; }
    .list-decimal { list-style-type: decimal; }
    .list-inside { list-style-position: inside; }
    .list-outside { list-style-position: outside; }
    .appearance-none { appearance: none; }
    .outline-none { outline: 2px solid transparent; outline-offset: 2px; }

    /* ═══════════════════════════════════════════════════════════════════
       BUTTONS — Reset
       ═══════════════════════════════════════════════════════════════════ */
    button { cursor: pointer; border: none; background: none; font-family: inherit; }
    button:disabled { cursor: not-allowed; opacity: 0.5; }

    /* ═══════════════════════════════════════════════════════════════════
       CODE — Scoped to avoid bleeding into dark code blocks
       ═══════════════════════════════════════════════════════════════════ */
    code {
      font-family: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Consolas, monospace;
      background-color: #fef3c7;
      color: #92400e;
      padding: 0.125rem 0.25rem;
      border-radius: 0.25rem;
      font-size: 0.875em;
    }

    /* Reset code styling inside dark code block containers */
    [class*="bg-gray-900"] code,
    [class*="bg-gray-800"] code,
    [class*="bg-slate-900"] code,
    [class*="bg-slate-800"] code,
    [class*="bg-slate-700"] code,
    [class*="bg-black"] code {
      background-color: transparent;
      color: inherit;
      padding: 0;
      font-size: inherit;
    }

    pre { margin: 0; white-space: pre-wrap; word-break: break-word; }

    /* ── Image containment (prevents oversized images) ── */
    img {
      max-width: 100%;
      height: auto;
      display: block;
    }

    /* Inside flex containers, images must respect parent bounds */
    .flex-1 > img,
    .flex-1 img {
      max-height: 100%;
      object-fit: contain;
    }

    /* ═══════════════════════════════════════════════════════════════════
       TABLE DEFAULTS
       ═══════════════════════════════════════════════════════════════════ */
    table { border-collapse: collapse; }
    .table-auto { table-layout: auto; }
    .table-fixed { table-layout: fixed; }
    .border-collapse { border-collapse: collapse; }
    .border-separate { border-collapse: separate; }
    .border-spacing-0 { border-spacing: 0; }
    td, th { vertical-align: middle; }

    /* ═══════════════════════════════════════════════════════════════════
       HOVER / GROUP UTILITIES
       ═══════════════════════════════════════════════════════════════════ */
    .group:hover .group-hover\:opacity-100 { opacity: 1; }
    .group:hover .group-hover\:visible { visibility: visible; }
    .group:hover .group-hover\:text-white { color: #ffffff; }
    .group:hover .group-hover\:bg-white\/20 { background-color: rgb(255 255 255 / 0.2); }
    .hover\:bg-gray-100:hover { background-color: var(--gray-100); }
    .hover\:bg-gray-200:hover { background-color: var(--gray-200); }
    .hover\:bg-gray-700:hover { background-color: var(--gray-700); }
    .hover\:bg-blue-100:hover { background-color: var(--blue-100); }
    .hover\:bg-white\/10:hover { background-color: rgb(255 255 255 / 0.1); }
    .hover\:bg-white\/20:hover { background-color: rgb(255 255 255 / 0.2); }
    .hover\:text-blue-700:hover { color: var(--blue-700); }
    .hover\:text-white:hover { color: #ffffff; }
    .hover\:shadow-lg:hover { box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1); }
    .hover\:shadow-xl:hover { box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1); }
    .hover\:scale-105:hover { transform: scale(1.05); }
    .hover\:scale-102:hover { transform: scale(1.02); }
    .hover\:opacity-80:hover { opacity: 0.8; }
    .hover\:underline:hover { text-decoration: underline; }
    .hover\:no-underline:hover { text-decoration: none; }

    /* ═══════════════════════════════════════════════════════════════════
       SLIDE CONTAINER
       ═══════════════════════════════════════════════════════════════════ */
    .slide-container {
      height: 100vh;
      display: flex;
      flex-direction: column;
      background: var(--gray-100);
    }

    .slide-header {
      background: var(--purdue-black);
      color: white;
      padding: 0.5rem 1rem;
      flex-shrink: 0;
    }

    .header-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
    }

    .header-title {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .header-title .purdue { font-weight: 700; font-size: 1.125rem; }
    .header-title .course { color: var(--purdue-gold); font-size: 1rem; }

    .header-slide-info {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .slide-counter {
      color: var(--purdue-gold);
      font-family: monospace;
      font-size: 1rem;
    }

    .current-section {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      background: rgba(206, 184, 136, 0.2);
      padding: 0.25rem 0.75rem;
      border-radius: 0.375rem;
    }

    .current-section .icon { font-size: 1rem; }
    .current-section .name { color: var(--purdue-gold); font-size: 0.875rem; }

    /* ═══════════════════════════════════════════════════════════════════
       PROGRESS BAR — ACCESSIBLE
       ═══════════════════════════════════════════════════════════════════ */
    .progress-container {
      position: relative;
      width: 100%;
      padding: 0.5rem 0;
    }

    .section-labels {
      display: flex;
      margin-bottom: 0.5rem;
    }

    .section-label {
      text-align: center;
      font-size: 0.75rem;
      font-weight: 600;
      padding: 0.25rem;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      transition: all 0.3s ease;
      cursor: pointer;
      border-radius: 0.25rem;
    }

    .section-label.active { color: #fcd34d; }
    .section-label.completed { color: #86efac; }
    .section-label.future { color: #94a3b8; }
    .section-label:hover {
      color: var(--purdue-gold);
      background: rgba(255,255,255,0.1);
    }

    .progress-sections {
      display: flex;
      gap: 4px;
      height: 20px;
      align-items: flex-end;
    }

    .section-group {
      display: flex;
      gap: 1px;
      border-radius: 3px;
      overflow: hidden;
      transition: all 0.3s ease;
      position: relative;
    }

    .section-group.active {
      box-shadow: 0 0 0 2px var(--amber-400), 0 0 12px rgba(251, 191, 36, 0.4);
    }

    .slide-bar {
      min-width: 6px;
      flex: 1;
      cursor: pointer;
      transition: all 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
      position: relative;
    }

    .slide-bar.current {
      height: 18px;
      background: linear-gradient(180deg, #ffffff 0%, #e2e8f0 100%);
      box-shadow: 0 0 8px rgba(255, 255, 255, 0.8), 0 0 20px rgba(251, 191, 36, 0.5);
      border-radius: 2px;
      z-index: 5;
    }

    .slide-bar.active-past { height: 14px; background: linear-gradient(180deg, var(--amber-400) 0%, var(--amber-600) 100%); }
    .slide-bar.active-past:hover, .slide-bar.active-past:focus-visible { height: 16px; background: linear-gradient(180deg, #fcd34d 0%, var(--amber-500) 100%); }
    .slide-bar.active-future { height: 10px; background: linear-gradient(180deg, var(--amber-700) 0%, var(--amber-800) 100%); }
    .slide-bar.active-future:hover, .slide-bar.active-future:focus-visible { height: 14px; background: linear-gradient(180deg, var(--amber-500) 0%, var(--amber-600) 100%); }
    .slide-bar.completed { height: 12px; background: linear-gradient(180deg, var(--green-400) 0%, var(--emerald-600) 100%); }
    .slide-bar.completed:hover, .slide-bar.completed:focus-visible { height: 14px; background: linear-gradient(180deg, #86efac 0%, var(--emerald-500) 100%); }
    .slide-bar.future { height: 8px; background: linear-gradient(180deg, var(--slate-500) 0%, var(--slate-600) 100%); }
    .slide-bar.future:hover, .slide-bar.future:focus-visible { height: 12px; background: linear-gradient(180deg, var(--slate-400) 0%, var(--slate-500) 100%); }

    .slide-bar::before {
      content: attr(data-tooltip);
      position: absolute;
      bottom: calc(100% + 8px);
      left: 50%;
      transform: translateX(-50%) scale(0.8);
      background: var(--slate-900);
      color: white;
      padding: 0.375rem 0.625rem;
      border-radius: 0.25rem;
      font-size: 0.75rem;
      white-space: nowrap;
      opacity: 0;
      transition: all 0.15s ease;
      pointer-events: none;
      z-index: 30;
    }

    .slide-bar:hover::before, .slide-bar:focus-visible::before {
      opacity: 1;
      transform: translateX(-50%) scale(1);
    }

    .current-indicator {
      position: absolute;
      bottom: -8px;
      left: 50%;
      transform: translateX(-50%);
      width: 6px;
      height: 6px;
      background: var(--amber-400);
      border-radius: 50%;
      box-shadow: 0 0 8px var(--amber-400);
      animation: bounce 1s ease-in-out infinite;
    }

    @keyframes bounce {
      0%, 100% { transform: translateX(-50%) translateY(0); }
      50% { transform: translateX(-50%) translateY(-3px); }
    }

    .section-progress-text {
      position: absolute;
      top: -18px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 0.65rem;
      font-weight: 700;
      color: #fcd34d;
      white-space: nowrap;
      opacity: 0;
      transition: opacity 0.2s;
    }

    .section-group.active .section-progress-text { opacity: 1; }

    .progress-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 0.5rem;
      font-size: 0.75rem;
    }

    .progress-counter {
      font-family: monospace;
      font-weight: 700;
      color: #fcd34d;
      background: var(--slate-800);
      padding: 0.25rem 0.625rem;
      border-radius: 0.25rem;
    }

    .progress-legend {
      display: flex;
      gap: 1rem;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 0.35rem;
      color: #cbd5e1;
      font-size: 0.75rem;
    }

    .legend-bar { width: 12px; border-radius: 2px; }
    .legend-bar.completed { height: 10px; background: var(--green-400); }
    .legend-bar.active { height: 12px; background: var(--amber-400); }
    .legend-bar.current { height: 14px; background: white; box-shadow: 0 0 4px rgba(255,255,255,0.5); }
    .legend-bar.future { height: 6px; background: var(--slate-500); }

    /* ═══════════════════════════════════════════════════════════════════
       SLIDE CONTENT
       ═══════════════════════════════════════════════════════════════════ */
    .slide-content {
      flex: 1;
      overflow-y: auto;
      padding: 1rem;
      display: flex;
      justify-content: center;
    }

    .slide-wrapper {
      width: 100%;
      max-width: 1400px;
      border-radius: 0.75rem;
      box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
      padding: 2rem 2.5rem;
      min-height: calc(100vh - 180px);
      display: flex;
      flex-direction: column;
    }

    .slide-wrapper > *:first-child { background-color: white; }

    .slide-wrapper > *:first-child[class*="bg-gradient"],
    .slide-wrapper > *:first-child[class*="bg-gray-900"],
    .slide-wrapper > *:first-child[class*="bg-slate-900"],
    .slide-wrapper > *:first-child[class*="bg-slate-800"],
    .slide-wrapper > *:first-child[class*="bg-black"] {
      background-color: transparent;
    }

    /* ═══════════════════════════════════════════════════════════════════
       NAVIGATION — ACCESSIBLE
       ═══════════════════════════════════════════════════════════════════ */
    .slide-nav {
      position: fixed;
      bottom: 1.5rem;
      right: 1.5rem;
      display: flex;
      gap: 0.5rem;
      background: rgba(0, 0, 0, 0.95);
      padding: 0.75rem;
      border-radius: 0.75rem;
      z-index: 100;
    }

    .slide-nav button {
      width: 3rem;
      height: 3rem;
      border-radius: 0.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.25rem;
      transition: background 0.2s;
      min-width: 44px;  /* WCAG touch target */
      min-height: 44px;
    }

    .slide-nav button:hover:not(:disabled),
    .slide-nav button:focus-visible:not(:disabled) {
      background: var(--gray-700);
    }

    .nav-divider {
      width: 1px;
      height: 2.5rem;
      background: var(--gray-600);
      align-self: center;
    }

    /* ═══════════════════════════════════════════════════════════════════
       HELP MODAL
       ═══════════════════════════════════════════════════════════════════ */
    .help-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.85);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .help-content {
      background: white;
      border-radius: 1rem;
      padding: 2rem;
      max-width: 500px;
      width: 90%;
      max-height: 90vh;
      overflow-y: auto;
    }

    .help-content h2 { margin-bottom: 1.5rem; }

    .help-grid {
      display: grid;
      grid-template-columns: auto 1fr;
      gap: 0.75rem 1rem;
      font-size: 1rem;
      align-items: center;
    }

    .help-key {
      font-family: monospace;
      background: var(--gray-100);
      padding: 0.375rem 0.75rem;
      border-radius: 0.375rem;
      font-size: 0.875rem;
      font-weight: 500;
    }

    .help-close-btn {
      margin-top: 1.5rem;
      width: 100%;
      background: var(--gray-900);
      color: white;
      padding: 0.875rem;
      border-radius: 0.5rem;
      font-size: 1rem;
      font-weight: 500;
      min-height: 44px;
    }

    .help-close-btn:hover, .help-close-btn:focus-visible { background: var(--gray-700); }

    /* ═══════════════════════════════════════════════════════════════════
       OVERVIEW MODE
       ═══════════════════════════════════════════════════════════════════ */
    .overview-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1rem;
      padding: 1rem;
      overflow-y: auto;
      height: 100vh;
      background: var(--slate-800);
    }

    .overview-header {
      grid-column: 1 / -1;
      padding: 1rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .overview-header h2 { color: white; }

    .overview-close-btn {
      background: var(--purdue-gold);
      color: black;
      padding: 0.625rem 1.5rem;
      border-radius: 0.5rem;
      font-weight: 500;
      font-size: 1rem;
      min-height: 44px;
    }

    .overview-close-btn:hover, .overview-close-btn:focus-visible { background: #d4c088; }

    .overview-card {
      background: white;
      border-radius: 0.5rem;
      overflow: hidden;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      aspect-ratio: 16/10;
      position: relative;
    }

    .overview-card:hover, .overview-card:focus-visible {
      transform: scale(1.02);
      box-shadow: 0 10px 40px rgba(0,0,0,0.3);
    }

    .overview-card.current { box-shadow: 0 0 0 4px var(--purdue-gold); }

    .overview-card-content {
      padding: 0.5rem;
      height: 100%;
      overflow: hidden;
      transform: scale(0.32);
      transform-origin: top left;
      width: 312%;
      height: 312%;
      pointer-events: none;
    }

    .overview-label {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(0,0,0,0.9);
      color: white;
      padding: 0.625rem 0.875rem;
      font-size: 0.875rem;
    }

    .overview-label .num {
      font-family: monospace;
      color: var(--purdue-gold);
      margin-right: 0.5rem;
      font-weight: 600;
    }

    /* ═══════════════════════════════════════════════════════════════════
       ACCESSIBILITY: HIGH CONTRAST MODE
       ═══════════════════════════════════════════════════════════════════ */
    @media (forced-colors: active) {
      .slide-bar { border: 1px solid currentColor; }
      .slide-bar.current { border: 2px solid Highlight; }
      .overview-card.current { border: 3px solid Highlight; }
      .skip-link:focus { outline: 3px solid Highlight; }
      .slide-nav button:focus-visible { outline: 2px solid Highlight; }
      /* Ensure all interactive elements remain visible */
      button, a, [role="button"], [tabindex] {
        forced-color-adjust: none;
      }
    }

    /* ═══════════════════════════════════════════════════════════════════
       ACCESSIBILITY: PREFERS COLOR SCHEME
       ═══════════════════════════════════════════════════════════════════ */
    @media (prefers-contrast: more) {
      .slide-wrapper { border: 2px solid var(--gray-900); }
      .border { border-width: 2px; }
      .text-gray-400, .text-gray-500, .text-slate-400, .text-slate-500 { color: var(--gray-700); }
    }

    /* ═══════════════════════════════════════════════════════════════════
       RESPONSIVE — TABLET
       ═══════════════════════════════════════════════════════════════════ */
    @media (max-width: 1024px) {
      .slide-wrapper { padding: 1.5rem; }
      .section-labels { display: none; }
      .grid-cols-5 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
      .grid-cols-4 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
    }

    /* ═══════════════════════════════════════════════════════════════════
       RESPONSIVE — MOBILE
       ═══════════════════════════════════════════════════════════════════ */
    @media (max-width: 768px) {
      .slide-wrapper { padding: 1rem; min-height: auto; }
      .grid-cols-2, .grid-cols-3, .grid-cols-4, .grid-cols-5, .grid-cols-6 {
        grid-template-columns: 1fr;
      }
      .slide-nav button { width: 3.5rem; height: 3.5rem; }
      .text-5xl { font-size: 2.25rem; }
      .text-4xl { font-size: 1.875rem; }
      .text-3xl { font-size: 1.5rem; }
      .p-8, .p-10, .p-12 { padding: 1.5rem; }
      /* Stack flex rows on mobile */
      .flex-row { flex-direction: column; }
    }

    /* ═══════════════════════════════════════════════════════════════════
       PRINT STYLES
       ═══════════════════════════════════════════════════════════════════ */
    @media print {
      .slide-nav, .slide-header, .progress-container, .skip-link { display: none !important; }
      .slide-content { overflow: visible; padding: 0; }
      .slide-wrapper { min-height: auto; box-shadow: none; page-break-after: always; }
      * { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" crossorigin="anonymous"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <script type="text/babel">
    const { useState, useEffect, useRef, useCallback, useMemo } = React;

    // ═══════════════════════════════════════════════════════════════════
    // LATEX COMPONENT
    // ═══════════════════════════════════════════════════════════════════
    const Latex = React.memo(({ math, display = false }) => {
      const ref = useRef(null);
      useEffect(() => {
        if (ref.current && math) {
          try {
            katex.render(math, ref.current, { displayMode: display, throwOnError: false, trust: true, strict: false });
          } catch (e) { ref.current.textContent = math; }
        }
      }, [math, display]);
      return <span ref={ref} aria-label={`Math: ${math}`} />;
    });

    // ═══════════════════════════════════════════════════════════════════
    // ACCESSIBILITY: LIVE REGION ANNOUNCER
    // ═══════════════════════════════════════════════════════════════════
    function LiveAnnouncer({ message, priority = 'polite' }) {
      return (
        <div 
          role="status" 
          aria-live={priority} 
          aria-atomic="true"
          className="sr-only"
        >
          {message}
        </div>
      );
    }

    // ═══════════════════════════════════════════════════════════════════
    // ACCESSIBILITY: FOCUS TRAP FOR MODALS
    // ═══════════════════════════════════════════════════════════════════
    function useFocusTrap(isActive, containerRef) {
      useEffect(() => {
        if (!isActive || !containerRef.current) return;
        
        const container = containerRef.current;
        const focusableElements = container.querySelectorAll(
          'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
        );
        const firstElement = focusableElements[0];
        const lastElement = focusableElements[focusableElements.length - 1];
        
        firstElement?.focus();
        
        const handleKeyDown = (e) => {
          if (e.key !== 'Tab') return;
          
          if (e.shiftKey) {
            if (document.activeElement === firstElement) {
              e.preventDefault();
              lastElement?.focus();
            }
          } else {
            if (document.activeElement === lastElement) {
              e.preventDefault();
              firstElement?.focus();
            }
          }
        };
        
        container.addEventListener('keydown', handleKeyDown);
        return () => container.removeEventListener('keydown', handleKeyDown);
      }, [isActive, containerRef]);
    }

    function AlertTriangle({ className = "", size = 24 }) {
        return React.createElement('svg', {
            xmlns: 'http://www.w3.org/2000/svg',
            width: size, height: size,
            viewBox: '0 0 24 24', fill: 'none',
            stroke: 'currentColor', strokeWidth: 2,
            strokeLinecap: 'round', strokeLinejoin: 'round',
            className
        },
            React.createElement('path', { d: 'm21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z' }),
            React.createElement('path', { d: 'M12 9v4' }),
            React.createElement('path', { d: 'M12 17h.01' })
        );
        }

    function CheckCircle({ className = "", size = 24 }) {
        return React.createElement('svg', {
            xmlns: 'http://www.w3.org/2000/svg',
            width: size, height: size,
            viewBox: '0 0 24 24', fill: 'none',
            stroke: 'currentColor', strokeWidth: 2,
            strokeLinecap: 'round', strokeLinejoin: 'round',
            className
        },
            React.createElement('path', { d: 'M22 11.08V12a10 10 0 1 1-5.93-9.14' }),
            React.createElement('path', { d: 'M22 4 12 14.01l-3-3' })
        );
        }

    function ChevronRight({ className = "", size = 24 }) {
        return React.createElement('svg', {
            xmlns: 'http://www.w3.org/2000/svg',
            width: size, height: size,
            viewBox: '0 0 24 24', fill: 'none',
            stroke: 'currentColor', strokeWidth: 2,
            strokeLinecap: 'round', strokeLinejoin: 'round',
            className
        },
            React.createElement('path', { d: 'm9 18 6-6-6-6' })
        );
        }

    function BookOpen({ className = "", size = 24 }) {
        return React.createElement('svg', {
            xmlns: 'http://www.w3.org/2000/svg',
            width: size, height: size,
            viewBox: '0 0 24 24', fill: 'none',
            stroke: 'currentColor', strokeWidth: 2,
            strokeLinecap: 'round', strokeLinejoin: 'round',
            className
        },
            React.createElement('path', { d: 'M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z' }),
            React.createElement('path', { d: 'M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z' })
        );
        }

    function ArrowRight({ className = "", size = 24 }) {
        return React.createElement('svg', {
            xmlns: 'http://www.w3.org/2000/svg',
            width: size, height: size,
            viewBox: '0 0 24 24', fill: 'none',
            stroke: 'currentColor', strokeWidth: 2,
            strokeLinecap: 'round', strokeLinejoin: 'round',
            className
        },
            React.createElement('path', { d: 'M5 12h14' }),
            React.createElement('path', { d: 'm12 5 7 7-7 7' })
        );
        }

    function HelpCircle({ className = "", size = 24 }) {
        return React.createElement('svg', {
            xmlns: 'http://www.w3.org/2000/svg',
            width: size, height: size,
            viewBox: '0 0 24 24', fill: 'none',
            stroke: 'currentColor', strokeWidth: 2,
            strokeLinecap: 'round', strokeLinejoin: 'round',
            className
        },
            React.createElement('circle', { cx: 12, cy: 12, r: 10 }),
            React.createElement('path', { d: 'M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3' }),
            React.createElement('path', { d: 'M12 17h.01' })
        );
        }

    function Target({ className = "", size = 24 }) {
        return React.createElement('svg', {
            xmlns: 'http://www.w3.org/2000/svg',
            width: size, height: size,
            viewBox: '0 0 24 24', fill: 'none',
            stroke: 'currentColor', strokeWidth: 2,
            strokeLinecap: 'round', strokeLinejoin: 'round',
            className
        },
            React.createElement('circle', { cx: 12, cy: 12, r: 10 }),
            React.createElement('circle', { cx: 12, cy: 12, r: 6 }),
            React.createElement('circle', { cx: 12, cy: 12, r: 2 })
        );
        }

    function TrendingUp({ className = "", size = 24 }) {
        return React.createElement('svg', {
            xmlns: 'http://www.w3.org/2000/svg',
            width: size, height: size,
            viewBox: '0 0 24 24', fill: 'none',
            stroke: 'currentColor', strokeWidth: 2,
            strokeLinecap: 'round', strokeLinejoin: 'round',
            className
        },
            React.createElement('polyline', { points: '22 7 13.5 15.5 8.5 10.5 2 17' }),
            React.createElement('polyline', { points: '16 7 22 7 22 13' })
        );
        }

    function TrendingDown({ className = "", size = 24 }) {
        return React.createElement('svg', {
            xmlns: 'http://www.w3.org/2000/svg',
            width: size, height: size,
            viewBox: '0 0 24 24', fill: 'none',
            stroke: 'currentColor', strokeWidth: 2,
            strokeLinecap: 'round', strokeLinejoin: 'round',
            className
        },
            React.createElement('polyline', { points: '22 17 13.5 8.5 8.5 13.5 2 7' }),
            React.createElement('polyline', { points: '16 17 22 17 22 11' })
        );
        }

    function Lightbulb({ className = "", size = 24 }) {
        return React.createElement('svg', {
            xmlns: 'http://www.w3.org/2000/svg',
            width: size, height: size,
            viewBox: '0 0 24 24', fill: 'none',
            stroke: 'currentColor', strokeWidth: 2,
            strokeLinecap: 'round', strokeLinejoin: 'round',
            className
        },
            React.createElement('path', { d: 'M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5' }),
            React.createElement('path', { d: 'M9 18h6' }),
            React.createElement('path', { d: 'M10 22h4' })
        );
        }

    function Eye({ className = "", size = 24 }) {
        return React.createElement('svg', {
            xmlns: 'http://www.w3.org/2000/svg',
            width: size, height: size,
            viewBox: '0 0 24 24', fill: 'none',
            stroke: 'currentColor', strokeWidth: 2,
            strokeLinecap: 'round', strokeLinejoin: 'round',
            className
        },
            React.createElement('path', { d: 'M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0' }),
            React.createElement('circle', { cx: 12, cy: 12, r: 3 })
        );
        }

    function Shield({ className = "", size = 24 }) {
        return React.createElement('svg', {
            xmlns: 'http://www.w3.org/2000/svg',
            width: size, height: size,
            viewBox: '0 0 24 24', fill: 'none',
            stroke: 'currentColor', strokeWidth: 2,
            strokeLinecap: 'round', strokeLinejoin: 'round',
            className
        },
            React.createElement('path', { d: 'M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z' })
        );
        }

    function XCircle({ className = "", size = 24 }) {
        return React.createElement('svg', {
            xmlns: 'http://www.w3.org/2000/svg',
            width: size, height: size,
            viewBox: '0 0 24 24', fill: 'none',
            stroke: 'currentColor', strokeWidth: 2,
            strokeLinecap: 'round', strokeLinejoin: 'round',
            className
        },
            React.createElement('circle', { cx: 12, cy: 12, r: 10 }),
            React.createElement('path', { d: 'm15 9-6 6' }),
            React.createElement('path', { d: 'm9 9 6 6' })
        );
        }

    function Zap({ className = "", size = 24 }) {
        return React.createElement('svg', {
            xmlns: 'http://www.w3.org/2000/svg',
            width: size, height: size,
            viewBox: '0 0 24 24', fill: 'none',
            stroke: 'currentColor', strokeWidth: 2,
            strokeLinecap: 'round', strokeLinejoin: 'round',
            className
        },
            React.createElement('path', { d: 'M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z' })
        );
        }    
        
    function Syringe({ className = "", size = 24 }) {
        return React.createElement('svg', {
            xmlns: 'http://www.w3.org/2000/svg',
            width: size, height: size,
            viewBox: '0 0 24 24', fill: 'none',
            stroke: 'currentColor', strokeWidth: 2,
            strokeLinecap: 'round', strokeLinejoin: 'round',
            className
        },
            React.createElement('path', { d: 'm18 2 4 4' }),
            React.createElement('path', { d: 'm17 7 3-3' }),
            React.createElement('path', { d: 'M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-.6-.6c-1-1-1-2.5 0-3.4L15 5' }),
            React.createElement('path', { d: 'm9 11 4 4' }),
            React.createElement('path', { d: 'm5 19-3 3' }),
            React.createElement('path', { d: 'm14 4 6 6' })
        );
        }
    // ═══════════════════════════════════════════════════════════════════
    // PASTE EXTRACTED SLIDES HERE
    // ═══════════════════════════════════════════════════════════════════

    // ═══════════════════════════════════════════════════════════════════════
    // SECTIONS CONFIG - Paste this into the 'sections' array in your template
    // ═══════════════════════════════════════════════════════════════════════
    const sections = [
      { id: '3.1', name: 'Exponential Families', startSlide: 1, icon: '📐', shortName: 'Exp Families' },
      { id: '3.2', name: 'Maximum Likelihood', startSlide: 21, icon: '📈', shortName: 'MLE' },
      { id: '3.3', name: 'Sampling Variability', startSlide: 47, icon: '📊', shortName: 'Variability' },
      { id: '3.4', name: 'Linear Models', startSlide: 63, icon: '📉', shortName: 'Linear' },
      { id: '3.5', name: 'Generalized Linear Models', startSlide: 95, icon: '🔗', shortName: 'GLMs' },
      { id: '3.6', name: 'Chapter Summary', startSlide: 128, icon: '🏁', shortName: 'Summary' },
    ];

    // ═══════════════════════════════════════════════════════════════════════
    // SLIDES REGISTRY - Paste this into the 'slides' array in your template
    // ═══════════════════════════════════════════════════════════════════════
    const slides = [
      { id: 1, title: 'Ch3 Hero', component: Slide01_Ch3Hero },
      { id: 2, title: 'Unification Problem', component: Slide02_UnificationProblem },
      { id: 3, title: 'Historical Origins', component: Slide03_HistoricalOrigins },
      { id: 4, title: 'Five Benefits', component: Slide04_FiveBenefits },
      { id: 5, title: 'Canonical Form', component: Slide05_CanonicalForm },
      { id: 6, title: 'Component Deep Dive', component: Slide06_ComponentDeepDive },
      { id: 7, title: 'Natural Parameter Space', component: Slide07_NaturalParameterSpace },
      { id: 8, title: 'Log Partition Function', component: Slide08_LogPartitionFunction },
      { id: 9, title: 'Bernoulli Conversion', component: Slide09_BernoulliConversion },
      { id: 10, title: 'Variance Functions', component: Slide100_VarianceFunctions },
      { id: 11, title: 'Link Functions', component: Slide101_LinkFunctions },
      { id: 12, title: 'Canonical Advantages', component: Slide102_CanonicalAdvantages },
      { id: 13, title: 'Score Equations', component: Slide103_ScoreEquations },
      { id: 14, title: 'Fisher Information', component: Slide104_FisherInformation },
      { id: 15, title: 'IRLS Algorithm', component: Slide105_IRLSAlgorithm },
      { id: 16, title: 'IRLS Convergence', component: Slide106_IRLSConvergence },
      { id: 17, title: 'Logistic Setup', component: Slide107_LogisticSetup },
      { id: 18, title: 'Logistic Curve', component: Slide108_LogisticCurve },
      { id: 19, title: 'Odds Ratios', component: Slide109_OddsRatios },
      { id: 20, title: 'Poisson Conversion', component: Slide10_PoissonConversion },
      { id: 21, title: 'Separation', component: Slide110_Separation },
      { id: 22, title: 'Firth Method', component: Slide111_FirthMethod },
      { id: 23, title: 'Logistic Python', component: Slide112_LogisticPython },
      { id: 24, title: 'Poisson Setup', component: Slide113_PoissonSetup },
      { id: 25, title: 'Rate Ratios', component: Slide114_RateRatios },
      { id: 26, title: 'Offsets', component: Slide115_Offsets },
      { id: 27, title: 'Overdispersion', component: Slide116_Overdispersion },
      { id: 28, title: 'Gamma Regression', component: Slide117_GammaRegression },
      { id: 29, title: 'Gamma Applications', component: Slide118_GammaApplications },
      { id: 30, title: 'Three Tests', component: Slide119_ThreeTests },
      { id: 31, title: 'Normal Conversion', component: Slide11_NormalConversion },
      { id: 32, title: 'Test Choice', component: Slide120_TestChoice },
      { id: 33, title: 'Confidence Intervals', component: Slide121_ConfidenceIntervals },
      { id: 34, title: 'Deviance', component: Slide122_Deviance },
      { id: 35, title: 'Residual Types', component: Slide123_ResidualTypes },
      { id: 36, title: 'Diagnostic Plots', component: Slide124_DiagnosticPlots },
      { id: 37, title: 'Model Selection', component: Slide125_ModelSelection },
      { id: 38, title: 'GLM Flowchart', component: Slide126_GLMFlowchart },
      { id: 39, title: 'GLM Summary', component: Slide127_GLMSummary },
      { id: 40, title: 'Inference Pipeline', component: Slide128_InferencePipeline },
      { id: 41, title: 'Core Formulas', component: Slide129_CoreFormulas },
      { id: 42, title: 'Normal Two Param', component: Slide12_NormalTwoParam },
      { id: 43, title: 'Key Takeaways', component: Slide130_KeyTakeaways },
      { id: 44, title: 'Exponential Conversion', component: Slide13_ExponentialConversion },
      { id: 45, title: 'Gamma Conversion', component: Slide14_GammaConversion },
      { id: 46, title: 'Summary Table', component: Slide15_SummaryTable },
      { id: 47, title: 'Mean Parameterization', component: Slide16_MeanParameterization },
      { id: 48, title: 'Full Rank Vs Curved', component: Slide17_FullRankVsCurved },
      { id: 49, title: 'IID Samples', component: Slide18_IIDSamples },
      { id: 50, title: 'Score Fisher', component: Slide19_ScoreFisher },
      { id: 51, title: 'Section Summary', component: Slide20_SectionSummary },
      { id: 52, title: 'Likelihood Not Probability', component: Slide21_LikelihoodNotProbability },
      { id: 53, title: 'MLE Hero', component: Slide21_MLEHero },
      { id: 54, title: 'Likelihood Function', component: Slide22_LikelihoodFunction },
      { id: 55, title: 'Log Likelihood', component: Slide22_LogLikelihood },
      { id: 56, title: 'Likelihood Not Probability', component: Slide23_LikelihoodNotProbability },
      { id: 57, title: 'Normal Log Likelihood', component: Slide23_NormalLogLikelihood },
      { id: 58, title: 'Log Likelihood', component: Slide24_LogLikelihood },
      { id: 59, title: 'Normal Log Likelihood', component: Slide25_NormalLogLikelihood },
      { id: 60, title: 'Score Function', component: Slide26_ScoreFunction },
      { id: 61, title: 'Score Properties', component: Slide27_ScoreProperties },
      { id: 62, title: 'Fisher Information Def', component: Slide28_FisherInformationDef },
      { id: 63, title: 'Information Matrix', component: Slide29_InformationMatrix },
      { id: 64, title: 'Observed Vs Expected', component: Slide30_ObservedVsExpected },
      { id: 65, title: 'Analytical ML Es', component: Slide31_AnalyticalMLEs },
      { id: 66, title: 'Bernoulli MLE', component: Slide32_BernoulliMLE },
      { id: 67, title: 'Normal MLE', component: Slide33_NormalMLE },
      { id: 68, title: 'When Analytical Fails', component: Slide34_WhenAnalyticalFails },
      { id: 69, title: 'Newton Raphson', component: Slide35_NewtonRaphson },
      { id: 70, title: 'Fisher Scoring', component: Slide36_FisherScoring },
      { id: 71, title: 'Scipy Optimize', component: Slide37_ScipyOptimize },
      { id: 72, title: 'Asymptotic Overview', component: Slide38_AsymptoticOverview },
      { id: 73, title: 'Consistency', component: Slide39_Consistency },
      { id: 74, title: 'Asymptotic Normality', component: Slide40_AsymptoticNormality },
      { id: 75, title: 'Cramer Rao', component: Slide41_CramerRao },
      { id: 76, title: 'Invariance', component: Slide42_Invariance },
      { id: 77, title: 'Three Tests', component: Slide43_ThreeTests },
      { id: 78, title: 'Test Comparison', component: Slide44_TestComparison },
      { id: 79, title: 'Confidence Intervals', component: Slide45_ConfidenceIntervals },
      { id: 80, title: 'MLE Summary', component: Slide46_MLESummary },
      { id: 81, title: 'Sampling Variability Hero', component: Slide47_SamplingVariabilityHero },
      { id: 82, title: 'What Is Estimator', component: Slide48_WhatIsEstimator },
      { id: 83, title: 'Bias Variance MSE', component: Slide49_BiasVarianceMSE },
      { id: 84, title: 'Consistency', component: Slide50_Consistency },
      { id: 85, title: 'Exact Sampling Distributions', component: Slide51_ExactSamplingDistributions },
      { id: 86, title: 'Exact Vs Asymptotic', component: Slide52_ExactVsAsymptotic },
      { id: 87, title: 'Why Transform', component: Slide53_WhyTransform },
      { id: 88, title: 'Delta Method Core', component: Slide54_DeltaMethodCore },
      { id: 89, title: 'Variance Amplification', component: Slide55_VarianceAmplification },
      { id: 90, title: 'Multivariate Delta', component: Slide56_MultivariateDelta },
      { id: 91, title: 'Vaccine Efficacy', component: Slide57_VaccineEfficacy },
      { id: 92, title: 'Delta Method Failure', component: Slide58_DeltaMethodFailure },
      { id: 93, title: 'Fisher Information', component: Slide59_FisherInformation },
      { id: 94, title: 'Observed Information', component: Slide60_ObservedInformation },
      { id: 95, title: 'Sandwich Estimator', component: Slide61_SandwichEstimator },
      { id: 96, title: 'Section33 Summary', component: Slide62_Section33Summary },
      { id: 97, title: 'Ch3_4 Hero', component: Slide63_Ch3_4Hero },
      { id: 98, title: 'Why Matrix Calculus', component: Slide64_WhyMatrixCalculus },
      { id: 99, title: 'Matrix Notation', component: Slide65_MatrixNotation },
      { id: 100, title: 'Differentiation Rules', component: Slide66_DifferentiationRules },
      { id: 101, title: 'Matrix Calculus Summary', component: Slide67_MatrixCalculusSummary },
      { id: 102, title: 'Linear Model', component: Slide68_LinearModel },
      { id: 103, title: 'Linear Meaning', component: Slide69_LinearMeaning },
      { id: 104, title: 'Gauss Markov Assumptions', component: Slide70_GaussMarkovAssumptions },
      { id: 105, title: 'OLS Calculus', component: Slide71_OLSCalculus },
      { id: 106, title: 'OLS Estimator', component: Slide72_OLSEstimator },
      { id: 107, title: 'OLS Geometry', component: Slide73_OLSGeometry },
      { id: 108, title: 'Orthogonality', component: Slide74_Orthogonality },
      { id: 109, title: 'Hat Matrix', component: Slide75_HatMatrix },
      { id: 110, title: 'Leverage', component: Slide76_Leverage },
      { id: 111, title: 'Unbiasedness', component: Slide77_Unbiasedness },
      { id: 112, title: 'Variance OLS', component: Slide78_VarianceOLS },
      { id: 113, title: 'Gauss Markov Theorem', component: Slide79_GaussMarkovTheorem },
      { id: 114, title: 'Gauss Markov Proof', component: Slide80_GaussMarkovProof },
      { id: 115, title: 'Assumption Failures', component: Slide81_AssumptionFailures },
      { id: 116, title: 'Estimating Sigma', component: Slide82_EstimatingSigma },
      { id: 117, title: 'Standard Errors', component: Slide83_StandardErrors },
      { id: 118, title: 'Distributional Results', component: Slide84_DistributionalResults },
      { id: 119, title: 't Tests', component: Slide85_tTests },
      { id: 120, title: 'F Tests', component: Slide86_FTests },
      { id: 121, title: 'C Ivs Prediction', component: Slide87_CIvsPrediction },
      { id: 122, title: 'Residual Diagnostics', component: Slide88_ResidualDiagnostics },
      { id: 123, title: 'Influence Measures', component: Slide89_InfluenceMeasures },
      { id: 124, title: 'Robust SE', component: Slide90_RobustSE },
      { id: 125, title: 'Numerical Stability', component: Slide91_NumericalStability },
      { id: 126, title: 'Statsmodels OLS', component: Slide92_StatsmodelsOLS },
      { id: 127, title: 'Statsmodels Vs Sklearn', component: Slide93_StatsmodelsVsSklearn },
      { id: 128, title: 'Section34 Summary', component: Slide94_Section34Summary },
      { id: 129, title: 'Ch3_5 Hero', component: Slide95_Ch3_5Hero },
      { id: 130, title: 'Problem With OLS', component: Slide96_ProblemWithOLS },
      { id: 131, title: 'Nelder Wedderburn', component: Slide97_NelderWedderburn },
      { id: 132, title: 'Three Components', component: Slide98_ThreeComponents },
      { id: 133, title: 'Random Component', component: Slide99_RandomComponent },
    ];

// ===========================================================================
// SLIDE COMPONENT DEFINITIONS - Paste these ABOVE the slides array
// ===========================================================================

// ═══════════════════════════════════════════════════════════════════════
//                           SLIDE 01: CH3 HERO
// ═══════════════════════════════════════════════════════════════════════

function Slide01_Ch3Hero() {
  return (
    <div className="flex flex-col h-full bg-gradient-to-br from-slate-900 via-indigo-900 to-slate-900 text-white p-6">
          {/* Header */}
          <div className="text-center mb-4">
            <div className="text-indigo-300 text-sm font-semibold uppercase tracking-wider mb-1">Chapter 3</div>
            <h1 className="text-4xl font-bold mb-2">Parametric Inference</h1>
            <p className="text-xl text-indigo-200">From Data to Parameters: The Inverse Problem</p>
          </div>
    
          {/* Central Question */}
          <div className="bg-white/10 backdrop-blur rounded-xl p-4 mb-4 border border-white/20">
            <div className="text-center">
              <div className="text-indigo-300 text-sm mb-2">The Fundamental Question</div>
              <div className="text-xl">
                Given observed data <Latex math="x_1, \ldots, x_n" />, what can we learn about the 
                unknown parameter <Latex math="\theta" /> that generated them?
              </div>
            </div>
          </div>
    
          {/* The Inversion */}
          <div className="grid grid-cols-2 gap-4 mb-4">
            <div className="bg-blue-500/20 rounded-xl p-3 border border-blue-400/30">
              <div className="text-blue-300 text-xs font-semibold mb-1">Chapter 2: Forward Problem</div>
              <div className="text-center my-2">
                <Latex math="\theta \;\xrightarrow{\text{sampling}}\; X_1, \ldots, X_n" display={true} />
              </div>
              <div className="text-sm text-blue-200">Know distribution, generate samples</div>
            </div>
            <div className="bg-purple-500/20 rounded-xl p-3 border border-purple-400/30">
              <div className="text-purple-300 text-xs font-semibold mb-1">Chapter 3: Inverse Problem</div>
              <div className="text-center my-2">
                <Latex math="x_1, \ldots, x_n \;\xrightarrow{\text{inference}}\; \hat{\theta}" display={true} />
              </div>
              <div className="text-sm text-purple-200">Have samples, learn parameters</div>
            </div>
          </div>
    
          {/* Five Pillars */}
          <div className="grid grid-cols-5 gap-2 flex-1">
            <div className="bg-indigo-500/20 rounded-lg p-2 border border-indigo-400/30 flex flex-col">
              <div className="text-2xl text-center mb-1">{"{"}<Latex math="\eta" />{"}"}</div>
              <div className="font-bold text-xs text-center text-indigo-300">3.1 Exponential Families</div>
              <div className="text-xs text-gray-300 mt-1 flex-1">Unifying framework for distributions</div>
            </div>
            <div className="bg-blue-500/20 rounded-lg p-2 border border-blue-400/30 flex flex-col">
              <div className="text-2xl text-center mb-1"><Latex math="\mathcal{L}" /></div>
              <div className="font-bold text-xs text-center text-blue-300">3.2 Maximum Likelihood</div>
              <div className="text-xs text-gray-300 mt-1 flex-1">Estimation via optimization</div>
            </div>
            <div className="bg-teal-500/20 rounded-lg p-2 border border-teal-400/30 flex flex-col">
              <div className="text-2xl text-center mb-1"><Latex math="\sigma_{\hat{\theta}}" /></div>
              <div className="font-bold text-xs text-center text-teal-300">3.3 Sampling Variability</div>
              <div className="text-xs text-gray-300 mt-1 flex-1">Uncertainty quantification</div>
            </div>
            <div className="bg-amber-500/20 rounded-lg p-2 border border-amber-400/30 flex flex-col">
              <div className="text-2xl text-center mb-1"><Latex math="\mathbf{X}\boldsymbol{\beta}" /></div>
              <div className="font-bold text-xs text-center text-amber-300">3.4 Linear Models</div>
              <div className="text-xs text-gray-300 mt-1 flex-1">OLS and Gauss-Markov</div>
            </div>
            <div className="bg-pink-500/20 rounded-lg p-2 border border-pink-400/30 flex flex-col">
              <div className="text-2xl text-center mb-1"><Latex math="g(\mu)" /></div>
              <div className="font-bold text-xs text-center text-pink-300">3.5 GLMs</div>
              <div className="text-xs text-gray-300 mt-1 flex-1">Beyond normal responses</div>
            </div>
          </div>
    
          {/* Footer */}
          <div className="mt-4 text-center text-sm text-gray-400">
            <strong>Foundation:</strong> LLN + CLT from Chapter 1 | <strong>Tools:</strong> Monte Carlo from Chapter 2
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                      SLIDE 02: UNIFICATION PROBLEM
// ═══════════════════════════════════════════════════════════════════════

function Slide02_UnificationProblem() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">The Unification Problem</h1>
          <p className="text-gray-600 mb-3">Are these distributions really so different?</p>
    
          {/* Figure: Four distributions unified */}
          <div className="mb-4">
            <img 
              src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/PartII/Chapter3/ch3_1_fig01_exponential_family_unification.png"
              alt="Four distributions (Bernoulli, Poisson, Normal, Exponential) shown with their exponential family components"
              className="w-2/5 mx-auto rounded-lg shadow-md"
            />
          </div>
    
          {/* Benefits preview */}
          <div className="grid grid-cols-3 gap-3 flex-1 mt-2">
            <div className="bg-slate-100 rounded-lg p-3 flex flex-col">
              <div className="font-semibold text-slate-700 text-sm mb-1">Unified Algorithms</div>
              <div className="text-xs text-slate-600 flex-1">MLE, Fisher scoring, IRLS work identically for ALL members</div>
            </div>
            <div className="bg-slate-100 rounded-lg p-3 flex flex-col">
              <div className="font-semibold text-slate-700 text-sm mb-1">Automatic Properties</div>
              <div className="text-xs text-slate-600 flex-1">Sufficiency, moment generation, conjugate priors come free</div>
            </div>
            <div className="bg-slate-100 rounded-lg p-3 flex flex-col">
              <div className="font-semibold text-slate-700 text-sm mb-1">GLM Foundation</div>
              <div className="text-xs text-slate-600 flex-1">Logistic, Poisson, Gamma regression all unified</div>
            </div>
          </div>
    
          {/* Question */}
          <div className="mt-3 bg-gray-100 rounded-lg p-2 text-center text-sm text-gray-600">
            <strong>Key Question:</strong> Why do these distributions (and essentially ONLY these) share this structure?
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                      SLIDE 03: HISTORICAL ORIGINS
// ═══════════════════════════════════════════════════════════════════════

function Slide03_HistoricalOrigins() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">Historical Origins</h1>
          <p className="text-gray-600 mb-3">From scattered results to unified theory</p>
    
          {/* Timeline */}
          <div className="relative mb-4">
            <div className="absolute top-6 left-0 right-0 h-1 bg-gradient-to-r from-blue-400 via-purple-400 to-indigo-400 rounded"></div>
            
            <div className="grid grid-cols-4 gap-2 relative">
              <div className="text-center">
                <div className="bg-blue-500 text-white rounded-full w-12 h-12 flex items-center justify-center mx-auto mb-2 text-sm font-bold relative z-10">1922</div>
                <div className="text-xs font-semibold text-blue-800">Fisher</div>
                <div className="text-xs text-blue-600">Sufficiency concept</div>
              </div>
              <div className="text-center">
                <div className="bg-purple-500 text-white rounded-full w-12 h-12 flex items-center justify-center mx-auto mb-2 text-sm font-bold relative z-10">1935</div>
                <div className="text-xs font-semibold text-purple-800">Neyman</div>
                <div className="text-xs text-purple-600">Factorization theorem</div>
              </div>
              <div className="text-center">
                <div className="bg-indigo-500 text-white rounded-full w-12 h-12 flex items-center justify-center mx-auto mb-2 text-sm font-bold relative z-10">1936</div>
                <div className="text-xs font-semibold text-indigo-800">K-P-D</div>
                <div className="text-xs text-indigo-600">Characterization theorem</div>
              </div>
              <div className="text-center">
                <div className="bg-pink-500 text-white rounded-full w-12 h-12 flex items-center justify-center mx-auto mb-2 text-sm font-bold relative z-10">1972</div>
                <div className="text-xs font-semibold text-pink-800">Nelder-Wedderburn</div>
                <div className="text-xs text-pink-600">GLMs</div>
              </div>
            </div>
          </div>
    
          <div className="grid grid-cols-2 gap-4 flex-1">
            {/* Fisher's insight */}
            <div className="bg-blue-50 rounded-xl p-4 border border-blue-200">
              <div className="font-semibold text-blue-800 mb-2">Fisher's Key Insight (1922)</div>
              <div className="text-sm text-blue-700 mb-2">
                For <Latex math="X_1, \ldots, X_n \sim \mathcal{N}(\mu, \sigma^2)" /> with known <Latex math="\sigma^2" />:
              </div>
              <div className="bg-white rounded-lg p-2 mb-2 text-center">
                <Latex math="\bar{X} \text{ captures ALL information about } \mu" display={true} />
              </div>
              <div className="text-xs text-blue-600">
                The individual values <Latex math="X_1, \ldots, X_n" /> beyond <Latex math="\bar{X}" /> tell us nothing more about <Latex math="\mu" />.
                This is <strong>sufficiency</strong>.
              </div>
            </div>
    
            {/* K-P-D theorem */}
            <div className="bg-indigo-50 rounded-xl p-4 border border-indigo-200">
              <div className="font-semibold text-indigo-800 mb-2">Koopman-Pitman-Darmois (1935-36)</div>
              <div className="bg-white rounded-lg p-3 border border-indigo-300 mb-2">
                <div className="text-sm text-indigo-800 font-semibold mb-1">The Characterization Theorem:</div>
                <div className="text-xs text-indigo-700">
                  If a family of distributions has a sufficient statistic of <strong>fixed dimension</strong> 
                  (independent of sample size <Latex math="n" />), then it must be an <strong>exponential family</strong>.
                </div>
              </div>
              <div className="text-xs text-indigo-600">
                This explains why exponential families dominatethey're the ONLY distributions with tractable sufficient statistics!
              </div>
            </div>
          </div>
    
          {/* Implication */}
          <div className="bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl p-3 mt-3 border border-amber-200">
            <div className="flex items-center gap-3">
              <div className="text-3xl">&#128161;</div>
              <div>
                <div className="font-semibold text-amber-800">The Practical Implication</div>
                <div className="text-sm text-amber-700">
                  Many distributions commonly used in science (binomial, Poisson, normal, gamma, etc.) 
                  happen to be exponential families. <strong>This is partly why they became standard tools.</strong>
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                         SLIDE 04: FIVE BENEFITS
// ═══════════════════════════════════════════════════════════════════════

function Slide04_FiveBenefits() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">Five Benefits of Exponential Families</h1>
          <p className="text-gray-600 mb-3">Why this structure matters for practice</p>
    
          <div className="grid grid-cols-2 gap-3 flex-1">
            {/* Benefit 1 */}
            <div className="bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-3 border border-blue-200">
              <div className="flex items-start gap-2">
                <div className="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold text-sm flex-shrink-0">1</div>
                <div>
                  <div className="font-semibold text-blue-800 mb-1">Unified Inference Algorithms</div>
                  <div className="text-sm text-blue-700 mb-2">
                    Same algorithms work <strong>identically</strong> for all members
                  </div>
                  <div className="bg-white rounded-lg p-2 text-xs text-blue-600">
                    One implementation: <code className="bg-blue-100 px-1 rounded">statsmodels.GLM</code>, <code className="bg-blue-100 px-1 rounded">glm()</code>
                  </div>
                </div>
              </div>
            </div>
    
            {/* Benefit 2 */}
            <div className="bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-3 border border-green-200">
              <div className="flex items-start gap-2">
                <div className="bg-green-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold text-sm flex-shrink-0">2</div>
                <div>
                  <div className="font-semibold text-green-800 mb-1">Automatic Sufficiency</div>
                  <div className="text-sm text-green-700 mb-2">
                    Sufficient statistics built into the structure
                  </div>
                  <div className="bg-white rounded-lg p-2 text-xs text-green-600">
                    No case-by-case derivation needed
                  </div>
                </div>
              </div>
            </div>
    
            {/* Benefit 3 */}
            <div className="bg-gradient-to-br from-amber-50 to-amber-100 rounded-xl p-3 border border-amber-200">
              <div className="flex items-start gap-2">
                <div className="bg-amber-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold text-sm flex-shrink-0">3</div>
                <div>
                  <div className="font-semibold text-amber-800 mb-1">Moments from Derivatives</div>
                  <div className="text-sm text-amber-700 mb-1">
                    Compute means and variances by differentiation
                  </div>
                  <div className="bg-white rounded-lg p-2 text-xs text-amber-600">
                    No integration required!
                  </div>
                </div>
              </div>
            </div>
    
            {/* Benefit 4 */}
            <div className="bg-gradient-to-br from-teal-50 to-teal-100 rounded-xl p-3 border border-teal-200">
              <div className="flex items-start gap-2">
                <div className="bg-teal-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold text-sm flex-shrink-0">4</div>
                <div>
                  <div className="font-semibold text-teal-800 mb-1">Conjugate Priors</div>
                  <div className="text-sm text-teal-700 mb-2">
                    Natural priors for Bayesian inference
                  </div>
                  <div className="bg-white rounded-lg p-2 text-xs text-teal-600">
                    Closed-form posterior updating
                  </div>
                </div>
              </div>
            </div>
    
            {/* Benefit 5 - spans full width */}
            <div className="col-span-2 bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-3 border border-purple-200">
              <div className="flex items-start gap-2">
                <div className="bg-purple-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold text-sm flex-shrink-0">5</div>
                <div className="flex-1">
                  <div className="font-semibold text-purple-800 mb-1">GLM Foundation</div>
                  <div className="text-sm text-purple-700 mb-2">
                    Generalized Linear Models unify regression for different response types
                  </div>
                  <div className="grid grid-cols-4 gap-2">
                    <div className="bg-white rounded-lg p-2 text-center">
                      <div className="text-xs font-semibold text-purple-800">Linear</div>
                      <div className="text-xs text-purple-600">Normal responses</div>
                    </div>
                    <div className="bg-white rounded-lg p-2 text-center">
                      <div className="text-xs font-semibold text-purple-800">Logistic</div>
                      <div className="text-xs text-purple-600">Binary responses</div>
                    </div>
                    <div className="bg-white rounded-lg p-2 text-center">
                      <div className="text-xs font-semibold text-purple-800">Poisson</div>
                      <div className="text-xs text-purple-600">Count responses</div>
                    </div>
                    <div className="bg-white rounded-lg p-2 text-center">
                      <div className="text-xs font-semibold text-purple-800">Gamma</div>
                      <div className="text-xs text-purple-600">Positive continuous</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom message */}
          <div className="mt-3 bg-slate-100 rounded-lg p-2 text-center text-sm text-slate-700">
            <strong>Key Insight:</strong> One mathematical framework unifies theory, algorithms, and software
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                        SLIDE 05: CANONICAL FORM
// ═══════════════════════════════════════════════════════════════════════

function Slide05_CanonicalForm() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">The Canonical Exponential Family</h1>
          <p className="text-gray-600 mb-2">The mathematical definition that unifies inference</p>
    
          {/* Main definition box */}
          <div className="bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl p-4 mb-3 text-white shadow-lg">
            <div className="text-indigo-200 text-sm font-semibold mb-2 text-center">DEFINITION: Canonical Exponential Family</div>
            <div className="bg-white/95 rounded-lg p-3 text-gray-900">
              <Latex math="p_\eta(x) = h(x) \exp\left\{ \eta^T T(x) - A(\eta) \right\}" display={true} />
            </div>
          </div>
    
          {/* Four components */}
          <div className="grid grid-cols-4 gap-2 mb-3">
            <div className="bg-blue-50 rounded-xl p-2 border-2 border-blue-300 flex flex-col">
              <div className="text-center mb-1">
                <div className="bg-blue-500 text-white rounded-lg px-2 py-1 inline-block font-mono">
                  <Latex math="T(x)" />
                </div>
              </div>
              <div className="font-semibold text-blue-800 text-xs mb-1 text-center">Sufficient Statistic</div>
              <div className="text-xs text-blue-700 flex-1">
                What you compute from data; captures all parameter information
              </div>
            </div>
    
            <div className="bg-purple-50 rounded-xl p-2 border-2 border-purple-300 flex flex-col">
              <div className="text-center mb-1">
                <div className="bg-purple-500 text-white rounded-lg px-2 py-1 inline-block font-mono">
                  <Latex math="\eta" />
                </div>
              </div>
              <div className="font-semibold text-purple-800 text-xs mb-1 text-center">Natural Parameter</div>
              <div className="text-xs text-purple-700 flex-1">
                Canonical form of parameter; makes math elegant
              </div>
            </div>
    
            <div className="bg-green-50 rounded-xl p-2 border-2 border-green-300 flex flex-col">
              <div className="text-center mb-1">
                <div className="bg-green-500 text-white rounded-lg px-2 py-1 inline-block font-mono">
                  <Latex math="A(\eta)" />
                </div>
              </div>
              <div className="font-semibold text-green-800 text-xs mb-1 text-center">Log-Partition Function</div>
              <div className="text-xs text-green-700 flex-1">
                Normalizer; derivatives give moments
              </div>
              <div className="text-xs text-green-800 bg-green-100 rounded p-1 mt-1">
                <Latex math="A(\eta) = \log \int h(x)e^{\eta^T T(x)}dx" />
              </div>
            </div>
    
            <div className="bg-amber-50 rounded-xl p-2 border-2 border-amber-300 flex flex-col">
              <div className="text-center mb-1">
                <div className="bg-amber-500 text-white rounded-lg px-2 py-1 inline-block font-mono">
                  <Latex math="h(x)" />
                </div>
              </div>
              <div className="font-semibold text-amber-800 text-xs mb-1 text-center">Base Measure Term</div>
              <div className="text-xs text-amber-700 flex-1">
                Depends on data but NOT on parameters (e.g., <Latex math="1/x!" /> for Poisson)
              </div>
            </div>
          </div>
    
          {/* Conversion recipe */}
          <div className="bg-slate-50 rounded-xl p-3 border border-slate-200 mb-3">
            <div className="font-semibold text-slate-800 text-sm mb-2">The Conversion Recipe</div>
            <div className="grid grid-cols-4 gap-2 text-xs">
              <div className="bg-white rounded-lg p-2 border border-slate-200">
                <div className="font-semibold text-slate-700 mb-1">Step 1</div>
                <div className="text-slate-600">Write PDF/PMF, take log</div>
              </div>
              <div className="bg-white rounded-lg p-2 border border-slate-200">
                <div className="font-semibold text-slate-700 mb-1">Step 2</div>
                <div className="text-slate-600">Find terms: (param) <Latex math="\times" /> (data)</div>
              </div>
              <div className="bg-white rounded-lg p-2 border border-slate-200">
                <div className="font-semibold text-slate-700 mb-1">Step 3</div>
                <div className="text-slate-600">Identify <Latex math="\eta" />, <Latex math="T(x)" /> from that product</div>
              </div>
              <div className="bg-white rounded-lg p-2 border border-slate-200">
                <div className="font-semibold text-slate-700 mb-1">Step 4</div>
                <div className="text-slate-600">Remaining param terms <Latex math="\to A(\eta)" /></div>
              </div>
            </div>
          </div>
    
          {/* Key insight */}
          <div className="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-2 border border-indigo-200">
            <div className="grid grid-cols-2 gap-3">
              <div>
                <div className="font-semibold text-indigo-700 text-sm mb-1">Why This Form?</div>
                <div className="text-xs text-indigo-600">
                  The product <Latex math="\eta^T T(x)" /> creates linear structure in the log-likelihood, 
                  guaranteeing convex optimization and elegant MLE theory
                </div>
              </div>
              <div>
                <div className="font-semibold text-purple-700 text-sm mb-1">Not Exponential Family?</div>
                <div className="text-xs text-purple-600">
                  If support depends on parameter (like Uniform(0, <Latex math="\theta" />)) or 
                  no fixed-dim sufficient statistic exists, it's not in the family
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                      SLIDE 06: COMPONENT DEEP DIVE
// ═══════════════════════════════════════════════════════════════════════

function Slide06_ComponentDeepDive() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">Component Deep Dive</h1>
          <p className="text-gray-600 mb-2">Understanding each piece with concrete examples</p>
    
          <div className="grid grid-cols-2 gap-3 flex-1">
            {/* T(x) */}
            <div className="bg-blue-50 rounded-xl p-3 border border-blue-200">
              <div className="flex items-center gap-2 mb-2">
                <div className="bg-blue-500 text-white rounded-lg px-2 py-1 font-mono text-lg">
                  <Latex math="T(x)" />
                </div>
                <span className="font-semibold text-blue-800">Sufficient Statistic</span>
              </div>
              <div className="text-sm text-blue-700 mb-2">
                Compresses data into what matters for inference
              </div>
              <div className="bg-white rounded-lg p-2 space-y-1 text-sm">
                <div className="flex justify-between items-center">
                  <span className="text-gray-600">Bernoulli:</span>
                  <span className="font-mono"><Latex math="T(x) = x" /></span>
                </div>
                <div className="flex justify-between items-center">
                  <span className="text-gray-600">Normal:</span>
                  <span className="font-mono"><Latex math="T(x) = (x, x^2)" /></span>
                </div>
                <div className="flex justify-between items-center">
                  <span className="text-gray-600">Gamma:</span>
                  <span className="font-mono"><Latex math="T(x) = (\log x, x)" /></span>
                </div>
              </div>
              <div className="mt-2 text-sm text-blue-600 bg-blue-100 rounded p-1">
                Dimension of T = number of parameters
              </div>
            </div>
    
            {/* eta */}
            <div className="bg-purple-50 rounded-xl p-3 border border-purple-200">
              <div className="flex items-center gap-2 mb-2">
                <div className="bg-purple-500 text-white rounded-lg px-2 py-1 font-mono text-lg">
                  <Latex math="\eta" />
                </div>
                <span className="font-semibold text-purple-800">Natural Parameter</span>
              </div>
              <div className="text-sm text-purple-700 mb-2">
                Canonical reparameterization for elegant math
              </div>
              <div className="bg-white rounded-lg p-2 space-y-1 text-sm">
                <div className="flex justify-between items-center">
                  <span className="text-gray-600">Bernoulli:</span>
                  <span className="font-mono"><Latex math="\eta = \log\frac{p}{1-p}" /></span>
                </div>
                <div className="flex justify-between items-center">
                  <span className="text-gray-600">Poisson:</span>
                  <span className="font-mono"><Latex math="\eta = \log \lambda" /></span>
                </div>
                <div className="flex justify-between items-center">
                  <span className="text-gray-600">Exponential:</span>
                  <span className="font-mono"><Latex math="\eta = -\lambda" /></span>
                </div>
              </div>
              <div className="mt-2 text-sm text-purple-600 bg-purple-100 rounded p-1">
                Often a transform of the "usual" parameter
              </div>
            </div>
    
            {/* A(eta) */}
            <div className="bg-green-50 rounded-xl p-3 border border-green-200">
              <div className="flex items-center gap-2 mb-2">
                <div className="bg-green-500 text-white rounded-lg px-2 py-1 font-mono text-lg">
                  <Latex math="A(\eta)" />
                </div>
                <span className="font-semibold text-green-800">Log-Partition Function</span>
              </div>
              <div className="text-sm text-green-700 mb-2">
                Normalizer + moment generator
              </div>
              <div className="bg-white rounded-lg p-2 space-y-1 text-sm">
                <div className="flex justify-between items-center">
                  <span className="text-gray-600">Bernoulli:</span>
                  <span className="font-mono"><Latex math="A(\eta) = \log(1+e^\eta)" /></span>
                </div>
                <div className="flex justify-between items-center">
                  <span className="text-gray-600">Poisson:</span>
                  <span className="font-mono"><Latex math="A(\eta) = e^\eta" /></span>
                </div>
                <div className="flex justify-between items-center">
                  <span className="text-gray-600">Exponential:</span>
                  <span className="font-mono"><Latex math="A(\eta) = -\log(-\eta)" /></span>
                </div>
              </div>
              <div className="mt-2 text-sm text-green-600 bg-green-100 rounded p-1 font-semibold">
                Always convex in <Latex math="\eta" />!
              </div>
            </div>
    
            {/* h(x) */}
            <div className="bg-amber-50 rounded-xl p-3 border border-amber-200">
              <div className="flex items-center gap-2 mb-2">
                <div className="bg-amber-500 text-white rounded-lg px-2 py-1 font-mono text-lg">
                  <Latex math="h(x)" />
                </div>
                <span className="font-semibold text-amber-800">Base Measure Term</span>
              </div>
              <div className="text-sm text-amber-700 mb-2">
                Baseline mass assignment (no parameters)
              </div>
              <div className="bg-white rounded-lg p-2 space-y-1 text-sm">
                <div className="flex justify-between items-center">
                  <span className="text-gray-600">Bernoulli:</span>
                  <span className="font-mono"><Latex math="h(x) = 1" /></span>
                </div>
                <div className="flex justify-between items-center">
                  <span className="text-gray-600">Poisson:</span>
                  <span className="font-mono"><Latex math="h(x) = 1/x!" /></span>
                </div>
                <div className="flex justify-between items-center">
                  <span className="text-gray-600">Exponential:</span>
                  <span className="font-mono"><Latex math="h(x) = \mathbf{1}_{x > 0}" /></span>
                </div>
              </div>
              <div className="mt-2 text-sm text-amber-600 bg-amber-100 rounded p-1">
                Exp tilt reweights this baseline
              </div>
            </div>
          </div>
    
          {/* Bottom insight */}
          <div className="mt-2 bg-slate-100 rounded-lg p-2 text-center">
            <span className="text-sm text-slate-700">
              <strong>Pattern:</strong> Same structure <Latex math="h(x)\exp\{\eta^T T(x) - A(\eta)\}" />, 
              different components give different distributions
            </span>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                    SLIDE 07: NATURAL PARAMETER SPACE
// ═══════════════════════════════════════════════════════════════════════

function Slide07_NaturalParameterSpace() {
  return (
    <div className="flex flex-col h-full p-3">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">The Natural Parameter Space</h1>
          <p className="text-gray-600 mb-2">Where can <Latex math="\eta" /> live? A convex set.</p>
    
          <div className="grid grid-cols-2 gap-3 mb-2">
            {/* Definition */}
            <div className="bg-indigo-50 rounded-xl p-3 border border-indigo-200">
              <div className="font-semibold text-indigo-800 text-lg mb-1">Definition</div>
              <div className="bg-white rounded-lg p-2 mb-1">
                <Latex math="\Xi = \left\{ \eta \in \mathbb{R}^s : A(\eta) < \infty \right\}" display={true} />
              </div>
              <div className="text-sm text-indigo-700">
                The set of <Latex math="\eta" /> where the density integrates to a finite value
              </div>
            </div>
    
            {/* Visual */}
            <div className="bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-3 border border-purple-200 flex flex-col justify-center">
              <div className="text-center mb-1">
                <div className="font-semibold text-purple-800">Convex Set</div>
              </div>
              <div className="flex justify-center items-center flex-1">
                <svg viewBox="0 0 200 120" className="w-full h-28">
                  <ellipse cx="100" cy="55" rx="80" ry="45" fill="#E9D5FF" stroke="#9333EA" strokeWidth="2"/>
                  <circle cx="50" cy="42" r="6" fill="#9333EA"/>
                  <circle cx="150" cy="68" r="6" fill="#9333EA"/>
                  <line x1="50" y1="42" x2="150" y2="68" stroke="#7C3AED" strokeWidth="2"/>
                  <circle cx="100" cy="55" r="5" fill="#7C3AED"/>
                  <text x="36" y="34" fontSize="14" fontWeight="bold" fill="#6B21A8">n1</text>
                  <text x="156" y="78" fontSize="14" fontWeight="bold" fill="#6B21A8">n2</text>
                  <text x="100" y="112" fontSize="13" fill="#6B21A8" textAnchor="middle" fontWeight="bold">Xi</text>
                </svg>
              </div>
              <div className="text-sm text-purple-700 text-center">
                Line segment between any two points stays inside
              </div>
            </div>
          </div>
    
          {/* Theorem with actual proof */}
          <div className="bg-green-50 rounded-xl p-3 border-2 border-green-300 mb-2 flex-1">
            <div className="font-semibold text-green-800 text-lg mb-1">Theorem: <Latex math="\Xi" /> is Convex (and <Latex math="A(\eta)" /> is Convex)</div>
            <div className="bg-white rounded-lg p-2 text-sm">
              <div className="text-gray-700 mb-1"><strong>Proof:</strong> Let <Latex math="\eta_1, \eta_2 \in \Xi" /> and <Latex math="\lambda \in (0,1)" />. We show <Latex math="\lambda\eta_1 + (1-\lambda)\eta_2 \in \Xi" />.</div>
              
              <div className="space-y-1 text-gray-700">
                <div><strong>Step 1:</strong> Rewrite the integrand as a product of powers:</div>
                <div className="text-center bg-gray-50 rounded p-2">
                  <Latex math="h(x)e^{[\lambda\eta_1 + (1-\lambda)\eta_2]^T T(x)} = \left[h(x)e^{\eta_1^T T(x)}\right]^\lambda \left[h(x)e^{\eta_2^T T(x)}\right]^{1-\lambda}" display={true} />
                </div>
                
                <div><strong>Step 2:</strong> Apply Hölder's inequality with <Latex math="p = 1/\lambda" />, <Latex math="q = 1/(1-\lambda)" />:</div>
                <div className="text-center bg-gray-50 rounded p-2">
                  <Latex math="\int h(x)e^{[\lambda\eta_1 + (1-\lambda)\eta_2]^T T(x)} dx \;\leq\; \left[\int h(x)e^{\eta_1^T T(x)} dx\right]^\lambda \left[\int h(x)e^{\eta_2^T T(x)} dx\right]^{1-\lambda}" display={true} />
                </div>
                
                <div><strong>Step 3:</strong> Take logs of both sides:</div>
                <div className="text-center bg-green-100 rounded p-2 border border-green-300">
                  <Latex math="A(\lambda\eta_1 + (1-\lambda)\eta_2) \;\leq\; \lambda A(\eta_1) + (1-\lambda)A(\eta_2) \;<\; \infty \quad \square" display={true} />
                </div>
              </div>
            </div>
          </div>
    
          {/* Why it matters */}
          <div className="grid grid-cols-3 gap-2">
            <div className="bg-amber-50 rounded-lg p-2 border border-amber-200">
              <div className="font-semibold text-amber-800 text-sm">Computational</div>
              <div className="text-xs text-amber-700">No local minima in optimization</div>
            </div>
            <div className="bg-amber-50 rounded-lg p-2 border border-amber-200">
              <div className="font-semibold text-amber-800 text-sm">Theoretical</div>
              <div className="text-xs text-amber-700">Log-likelihood concave; unique MLE</div>
            </div>
            <div className="bg-amber-50 rounded-lg p-2 border border-amber-200">
              <div className="font-semibold text-amber-800 text-sm">Algorithmic</div>
              <div className="text-xs text-amber-700">Newton-Raphson converges reliably</div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                    SLIDE 08: LOG PARTITION FUNCTION
// ═══════════════════════════════════════════════════════════════════════

function Slide08_LogPartitionFunction() {
  return (
    <div className="flex flex-col h-full p-3">
          <h1 className="text-2xl font-bold text-gray-900 mb-1">The Log-Partition Function</h1>
          <p className="text-gray-600 text-sm mb-2">Moments from derivatives, not integrals</p>
    
          {/* Main result */}
          <div className="bg-gradient-to-r from-green-500 to-teal-500 rounded-xl p-2 mb-2 text-white shadow-lg">
            <div className="text-green-100 text-xs font-semibold mb-1 text-center">THE MOMENT-GENERATING MAGIC</div>
            <div className="grid grid-cols-2 gap-2">
              <div className="bg-white/95 rounded-lg p-2 text-gray-900">
                <div className="text-center text-xs font-semibold text-green-800 mb-1">First Derivative</div>
                <Latex math="\nabla A(\eta) = \mathbb{E}_\eta[T(X)]" display={true} />
                <div className="text-xs text-center text-green-700">Mean of sufficient statistic</div>
              </div>
              <div className="bg-white/95 rounded-lg p-2 text-gray-900">
                <div className="text-center text-xs font-semibold text-teal-800 mb-1">Second Derivative</div>
                <Latex math="\nabla^2 A(\eta) = \text{Var}_\eta[T(X)]" display={true} />
                <div className="text-xs text-center text-teal-700">Variance (or covariance matrix)</div>
              </div>
            </div>
          </div>
    
          {/* Figure: Log-partition moments visualization */}
          <div className="flex-1 mb-2">
            <img 
              src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/PartII/Chapter3/ch3_1_fig02_log_partition_moments.png"
              alt="Log-partition function for Poisson showing mean and variance from derivatives"
              className="w-full h-full object-contain rounded-lg"
            />
          </div>
    
          {/* Caption and Fisher info */}
          <div className="grid grid-cols-2 gap-2">
            <div className="bg-blue-50 rounded-lg p-2 border border-blue-200">
              <div className="text-xs text-blue-700">
                <strong>Poisson Example:</strong> <Latex math="A(\eta) = e^\eta" /> so <Latex math="A'(\eta) = A''(\eta) = e^\eta = \lambda" />. 
                Red dots: theory. Blue/orange: simulation confirms it!
              </div>
            </div>
            <div className="bg-slate-100 rounded-lg p-2 text-center text-sm">
              <strong>Key:</strong> Fisher Info <Latex math="I(\eta) = \nabla^2 A(\eta)" />
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                     SLIDE 09: BERNOULLI CONVERSION
// ═══════════════════════════════════════════════════════════════════════

function Slide09_BernoulliConversion() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">Bernoulli <Latex math="\rightarrow" /> Exponential Form</h1>
          <p className="text-gray-600 mb-3">Converting the simplest discrete distribution</p>
    
          {/* Starting point */}
          <div className="bg-blue-50 rounded-xl p-3 mb-3 border border-blue-200">
            <div className="font-semibold text-blue-800 mb-2">Starting Point: Standard Bernoulli PMF</div>
            <div className="bg-white rounded-lg p-3 text-center">
              <Latex math="P(X = x) = p^x (1-p)^{1-x} \quad \text{for } x \in \{0, 1\}" display={true} />
            </div>
          </div>
    
          {/* Transformation steps */}
          <div className="bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl p-4 mb-3 border border-purple-200 flex-1">
            <div className="font-semibold text-purple-800 mb-2">Step-by-Step Conversion</div>
            <div className="space-y-2">
              <div className="flex items-center gap-3">
                <div className="bg-purple-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">1</div>
                <div className="bg-white rounded-lg p-2 flex-1 text-sm">
                  <span className="text-gray-500">Rewrite: </span>
                  <Latex math="p^x(1-p)^{1-x} = (1-p) \cdot \left(\frac{p}{1-p}\right)^x" />
                </div>
              </div>
              <div className="flex items-center gap-3">
                <div className="bg-purple-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">2</div>
                <div className="bg-white rounded-lg p-2 flex-1 text-sm">
                  <span className="text-gray-500">Exponentiate: </span>
                  <Latex math="= (1-p) \cdot \exp\left\{ x \log\frac{p}{1-p} \right\}" />
                </div>
              </div>
              <div className="flex items-center gap-3">
                <div className="bg-purple-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">3</div>
                <div className="bg-white rounded-lg p-2 flex-1 text-sm">
                  <span className="text-gray-500">Rearrange: </span>
                  <Latex math="= \exp\left\{ x \cdot \eta - \log(1+e^\eta) \right\}" />
                  <span className="text-gray-400 text-xs ml-2">where <Latex math="\eta = \log\frac{p}{1-p}" /></span>
                </div>
              </div>
            </div>
          </div>
    
          {/* Components identified */}
          <div className="grid grid-cols-4 gap-2 mb-3">
            <div className="bg-blue-100 rounded-lg p-2 text-center">
              <div className="text-xs text-blue-600 mb-1">Sufficient Stat</div>
              <div className="font-mono text-blue-800"><Latex math="T(x) = x" /></div>
            </div>
            <div className="bg-purple-100 rounded-lg p-2 text-center">
              <div className="text-xs text-purple-600 mb-1">Natural Param</div>
              <div className="font-mono text-purple-800"><Latex math="\eta = \log\frac{p}{1-p}" /></div>
            </div>
            <div className="bg-green-100 rounded-lg p-2 text-center">
              <div className="text-xs text-green-600 mb-1">Log-Partition</div>
              <div className="font-mono text-green-800"><Latex math="A(\eta) = \log(1+e^\eta)" /></div>
            </div>
            <div className="bg-amber-100 rounded-lg p-2 text-center">
              <div className="text-xs text-amber-600 mb-1">Carrier</div>
              <div className="font-mono text-amber-800"><Latex math="h(x) = 1" /></div>
            </div>
          </div>
    
          {/* Verification */}
          <div className="bg-green-50 rounded-xl p-3 border border-green-200">
            <div className="font-semibold text-green-800 mb-2">Verify: Moments from <Latex math="A(\eta)" /></div>
            <div className="grid grid-cols-2 gap-3 text-sm">
              <div className="bg-white rounded-lg p-2">
                <Latex math="A'(\eta) = \frac{e^\eta}{1+e^\eta} = p = \mathbb{E}[X]" /> <span className="text-green-600">✓</span>
              </div>
              <div className="bg-white rounded-lg p-2">
                <Latex math="A''(\eta) = \frac{e^\eta}{(1+e^\eta)^2} = p(1-p) = \text{Var}(X)" /> <span className="text-green-600">✓</span>
              </div>
            </div>
          </div>
    
          {/* Connection to GLM */}
          <div className="mt-2 bg-pink-50 rounded-lg p-2 text-center text-sm border border-pink-200">
            <span className="text-pink-800">
              <strong>GLM Connection:</strong> The logit <Latex math="\eta = \log(p/(1-p))" /> is the canonical link for logistic regression!
            </span>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                      SLIDE 100: VARIANCE FUNCTIONS
// ═══════════════════════════════════════════════════════════════════════

function Slide100_VarianceFunctions() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-emerald-800">Variance Functions</h1>
            <p className="text-gray-600">How variance depends on the mean</p>
          </div>
    
          {/* Key formula */}
          <div className="bg-emerald-50 border border-emerald-200 rounded-xl p-4 mb-4 text-center">
            <Latex math="\text{Var}(Y_i) = \phi \cdot V(\mu_i)" display={true} />
            <p className="text-sm text-emerald-700 mt-2">
              Variance = dispersion times variance function evaluated at mean
            </p>
          </div>
    
          {/* Variance function cards */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Normal */}
            <div className="bg-white border-2 border-gray-200 rounded-xl p-4">
              <div className="flex items-center justify-between mb-3">
                <span className="font-bold text-gray-800">Normal</span>
                <span className="bg-gray-200 text-gray-700 px-2 py-1 rounded text-xs">OLS baseline</span>
              </div>
              <div className="bg-gray-50 rounded-lg p-3 text-center mb-2">
                <Latex math="V(\mu) = 1" display={true} />
              </div>
              <p className="text-xs text-gray-600">
                Constant variance - homoskedasticity. <Latex math="\text{Var}(Y) = \sigma^2" /> for all observations.
              </p>
            </div>
    
            {/* Bernoulli */}
            <div className="bg-white border-2 border-red-200 rounded-xl p-4">
              <div className="flex items-center justify-between mb-3">
                <span className="font-bold text-red-800">Bernoulli</span>
                <span className="bg-red-100 text-red-700 px-2 py-1 rounded text-xs">Binary</span>
              </div>
              <div className="bg-red-50 rounded-lg p-3 text-center mb-2">
                <Latex math="V(\mu) = \mu(1-\mu)" display={true} />
              </div>
              <p className="text-xs text-gray-600">
                Maximum at <Latex math="\mu=0.5" />, approaches 0 near boundaries. Most uncertainty in the middle.
              </p>
            </div>
    
            {/* Poisson */}
            <div className="bg-white border-2 border-amber-200 rounded-xl p-4">
              <div className="flex items-center justify-between mb-3">
                <span className="font-bold text-amber-800">Poisson</span>
                <span className="bg-amber-100 text-amber-700 px-2 py-1 rounded text-xs">Counts</span>
              </div>
              <div className="bg-amber-50 rounded-lg p-3 text-center mb-2">
                <Latex math="V(\mu) = \mu" display={true} />
              </div>
              <p className="text-xs text-gray-600">
                Variance equals mean. Higher counts have higher variance. Basis for overdispersion tests.
              </p>
            </div>
    
            {/* Gamma */}
            <div className="bg-white border-2 border-green-200 rounded-xl p-4">
              <div className="flex items-center justify-between mb-3">
                <span className="font-bold text-green-800">Gamma</span>
                <span className="bg-green-100 text-green-700 px-2 py-1 rounded text-xs">Positive</span>
              </div>
              <div className="bg-green-50 rounded-lg p-3 text-center mb-2">
                <Latex math="V(\mu) = \mu^2" display={true} />
              </div>
              <p className="text-xs text-gray-600">
                Constant coefficient of variation: <Latex math="\text{CV} = \sigma/\mu = 1/\sqrt{\alpha}" />. SD proportional to mean.
              </p>
            </div>
          </div>
    
          {/* Bottom insight */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-gradient-to-r from-emerald-100 to-teal-100 rounded-xl p-3 border border-emerald-200">
              <p className="text-center text-emerald-900">
                <strong>Key insight:</strong> The variance function determines the IRLS weights.
                Observations with larger <Latex math="V(\mu)" /> get <em>less</em> weight in estimation.
              </p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                        SLIDE 101: LINK FUNCTIONS
// ═══════════════════════════════════════════════════════════════════════

function Slide101_LinkFunctions() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-purple-800">Link Functions</h1>
            <p className="text-gray-600">Connecting mean to linear predictor</p>
          </div>
    
          {/* Key relationship */}
          <div className="bg-purple-50 border border-purple-200 rounded-xl p-4 mb-4">
            <div className="grid grid-cols-3 gap-4 items-center text-center">
              <div>
                <p className="text-sm text-purple-600 mb-1">Mean</p>
                <div className="bg-white rounded-lg p-2">
                  <Latex math="\mu_i \in \mathcal{M}" />
                </div>
                <p className="text-xs text-gray-500 mt-1">(restricted range)</p>
              </div>
              <div>
                <Latex math="\xrightarrow{g(\cdot)}" />
                <br />
                <Latex math="\xleftarrow{g^{-1}(\cdot)}" />
              </div>
              <div>
                <p className="text-sm text-purple-600 mb-1">Linear Predictor</p>
                <div className="bg-white rounded-lg p-2">
                  <Latex math="\eta_i \in \mathbb{R}" />
                </div>
                <p className="text-xs text-gray-500 mt-1">(unrestricted)</p>
              </div>
            </div>
          </div>
    
          {/* Link function table */}
          <div className="flex-1 overflow-auto">
            <table className="w-full text-sm border-collapse">
              <thead>
                <tr className="bg-purple-600 text-white">
                  <th className="p-2 text-left rounded-tl-lg">Distribution</th>
                  <th className="p-2 text-center">Canonical Link</th>
                  <th className="p-2 text-center"><Latex math="g(\mu)" /></th>
                  <th className="p-2 text-center"><Latex math="g^{-1}(\eta)" /></th>
                  <th className="p-2 text-left rounded-tr-lg">Alternatives</th>
                </tr>
              </thead>
              <tbody>
                <tr className="bg-gray-50 border-b border-gray-200">
                  <td className="p-2 font-semibold">Normal</td>
                  <td className="p-2 text-center">Identity</td>
                  <td className="p-2 text-center"><Latex math="\mu" /></td>
                  <td className="p-2 text-center"><Latex math="\eta" /></td>
                  <td className="p-2 text-gray-500 text-xs">(rarely changed)</td>
                </tr>
                <tr className="bg-white border-b border-gray-200">
                  <td className="p-2 font-semibold">Bernoulli</td>
                  <td className="p-2 text-center">Logit</td>
                  <td className="p-2 text-center"><Latex math="\log\frac{\mu}{1-\mu}" /></td>
                  <td className="p-2 text-center"><Latex math="\frac{1}{1+e^{-\eta}}" /></td>
                  <td className="p-2 text-gray-500 text-xs">Probit, cloglog</td>
                </tr>
                <tr className="bg-gray-50 border-b border-gray-200">
                  <td className="p-2 font-semibold">Poisson</td>
                  <td className="p-2 text-center">Log</td>
                  <td className="p-2 text-center"><Latex math="\log \mu" /></td>
                  <td className="p-2 text-center"><Latex math="e^\eta" /></td>
                  <td className="p-2 text-gray-500 text-xs">Identity, sqrt</td>
                </tr>
                <tr className="bg-white">
                  <td className="p-2 font-semibold rounded-bl-lg">Gamma</td>
                  <td className="p-2 text-center">Inverse</td>
                  <td className="p-2 text-center"><Latex math="-1/\mu" /></td>
                  <td className="p-2 text-center"><Latex math="-1/\eta" /></td>
                  <td className="p-2 text-gray-500 text-xs rounded-br-lg"><strong>Log</strong> (common!)</td>
                </tr>
              </tbody>
            </table>
          </div>
    
          {/* Bottom: Canonical definition */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-gradient-to-r from-purple-100 to-violet-100 rounded-xl p-4 border border-purple-200">
              <div className="flex items-start gap-3">
                <div className="bg-purple-600 text-white rounded-full w-8 h-8 flex items-center justify-center flex-shrink-0 font-bold">!</div>
                <div>
                  <p className="font-semibold text-purple-900 mb-1">Canonical Link Definition</p>
                  <p className="text-sm text-purple-800">
                    The canonical link sets <Latex math="g(\mu) = \theta" /> (the natural parameter).
                    Since <Latex math="\mu = b'(\theta)" />, the canonical link is <Latex math="g = (b')^{-1}" />.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                     SLIDE 102: CANONICAL ADVANTAGES
// ═══════════════════════════════════════════════════════════════════════

function Slide102_CanonicalAdvantages() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-indigo-800">Why Canonical Links?</h1>
            <p className="text-gray-600">Computational and theoretical advantages</p>
          </div>
    
          {/* Advantages grid */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Advantage 1: Concave likelihood */}
            <div className="bg-gradient-to-br from-blue-50 to-blue-100 border-2 border-blue-300 rounded-xl p-4">
              <div className="flex items-center gap-2 mb-3">
                <span className="bg-blue-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold">1</span>
                <h3 className="font-bold text-blue-800">Concave Log-Likelihood</h3>
              </div>
              <div className="bg-white rounded-lg p-3 text-center mb-3">
                <Latex math="\ell(\boldsymbol{\beta}) \text{ is globally concave in } \boldsymbol{\beta}" display={true} />
              </div>
              <p className="text-sm text-blue-700">
                Unique global maximum guaranteed. No local optima. Optimization always converges to the MLE.
              </p>
            </div>
    
            {/* Advantage 2: Simplified score */}
            <div className="bg-gradient-to-br from-emerald-50 to-emerald-100 border-2 border-emerald-300 rounded-xl p-4">
              <div className="flex items-center gap-2 mb-3">
                <span className="bg-emerald-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold">2</span>
                <h3 className="font-bold text-emerald-800">Simplified Score</h3>
              </div>
              <div className="bg-white rounded-lg p-3 text-center mb-3">
                <Latex math="\mathbf{U}(\boldsymbol{\beta}) = \frac{1}{\phi}\mathbf{X}^\top(\mathbf{y} - \boldsymbol{\mu})" display={true} />
              </div>
              <p className="text-sm text-emerald-700">
                Residuals projected onto column space of X. Direct generalization of OLS normal equations!
              </p>
            </div>
    
            {/* Advantage 3: Information equality */}
            <div className="bg-gradient-to-br from-purple-50 to-purple-100 border-2 border-purple-300 rounded-xl p-4">
              <div className="flex items-center gap-2 mb-3">
                <span className="bg-purple-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold">3</span>
                <h3 className="font-bold text-purple-800">Information Equality</h3>
              </div>
              <div className="bg-white rounded-lg p-3 text-center mb-3">
                <Latex math="-\frac{\partial^2 \ell}{\partial \boldsymbol{\beta}\partial \boldsymbol{\beta}^\top} = \mathbf{I}(\boldsymbol{\beta})" display={true} />
              </div>
              <p className="text-sm text-purple-700">
                Observed = Expected information. Newton-Raphson = Fisher scoring. Same algorithm, guaranteed.
              </p>
            </div>
    
            {/* Advantage 4: Sufficient statistic */}
            <div className="bg-gradient-to-br from-amber-50 to-amber-100 border-2 border-amber-300 rounded-xl p-4">
              <div className="flex items-center gap-2 mb-3">
                <span className="bg-amber-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold">4</span>
                <h3 className="font-bold text-amber-800">Sufficient Statistic</h3>
              </div>
              <div className="bg-white rounded-lg p-3 text-center mb-3">
                <Latex math="\mathbf{X}^\top \mathbf{y} \text{ sufficient for } \boldsymbol{\beta}" display={true} />
              </div>
              <p className="text-sm text-amber-700">
                All information about parameters captured by inner products. No information loss in reduction.
              </p>
            </div>
          </div>
    
          {/* Bottom: Caveat */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-gray-100 rounded-xl p-3 border border-gray-300">
              <p className="text-center text-gray-700 text-sm">
                <strong>Caveat:</strong> Non-canonical links are sometimes preferred for interpretability or to ensure valid predictions.
                <br />
                Example: Log link for Gamma is almost universal despite inverse being canonical.
              </p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                       SLIDE 103: SCORE EQUATIONS
// ═══════════════════════════════════════════════════════════════════════

function Slide103_ScoreEquations() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-teal-800">Score Equations</h1>
            <p className="text-gray-600">Deriving the gradient of the log-likelihood</p>
          </div>
    
          {/* Chain rule */}
          <div className="bg-teal-50 border border-teal-200 rounded-xl p-3 mb-3">
            <p className="text-sm text-teal-800 font-semibold mb-2">The parameter chain:</p>
            <div className="text-center">
              <Latex math="\boldsymbol{\beta} \xrightarrow{\text{linear}} \eta_i = \mathbf{x}_i^\top\boldsymbol{\beta} \xrightarrow{g^{-1}} \mu_i \xrightarrow{\theta(\mu)} \theta_i" display={true} />
            </div>
          </div>
    
          {/* Main content - two column */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Left: General score */}
            <div className="flex flex-col">
              <h3 className="font-bold text-gray-700 mb-2">General Link</h3>
              
              <div className="bg-white border-2 border-gray-200 rounded-xl p-3 flex-1">
                <p className="text-sm text-gray-600 mb-2">Apply chain rule:</p>
                <div className="bg-gray-50 rounded p-2 text-center mb-3">
                  <Latex math="\frac{\partial \ell}{\partial \beta_j} = \sum_{i=1}^n \frac{y_i - \mu_i}{\phi \cdot V(\mu_i)} \cdot \frac{1}{g'(\mu_i)} \cdot x_{ij}" display={true} />
                </div>
                
                <p className="text-sm text-gray-600 mb-2">In matrix form:</p>
                <div className="bg-blue-50 border border-blue-200 rounded p-3 text-center">
                  <Latex math="\mathbf{U}(\boldsymbol{\beta}) = \mathbf{X}^\top \mathbf{W} \mathbf{G} (\mathbf{y} - \boldsymbol{\mu})" display={true} />
                </div>
    
                <div className="mt-3 text-xs text-gray-500 space-y-1">
                  <p><Latex math="\mathbf{W} = \text{diag}(w_i)" /> where <Latex math="w_i = \frac{1}{\phi V(\mu_i) [g'(\mu_i)]^2}" /></p>
                  <p><Latex math="\mathbf{G} = \text{diag}(g'(\mu_i))" /></p>
                </div>
              </div>
            </div>
    
            {/* Right: Canonical score */}
            <div className="flex flex-col">
              <h3 className="font-bold text-teal-700 mb-2">Canonical Link</h3>
              
              <div className="bg-gradient-to-b from-teal-50 to-emerald-50 border-2 border-teal-300 rounded-xl p-3 flex-1">
                <p className="text-sm text-teal-700 mb-2">When <Latex math="\eta = \theta" />:</p>
                
                <div className="bg-white rounded p-3 text-center mb-3 border border-teal-200">
                  <Latex math="\mathbf{U}(\boldsymbol{\beta}) = \frac{1}{\phi}\mathbf{X}^\top(\mathbf{y} - \boldsymbol{\mu})" display={true} />
                </div>
                
                <p className="text-sm text-teal-700 mb-2">Score equations:</p>
                <div className="bg-teal-100 border border-teal-300 rounded p-3 text-center">
                  <Latex math="\mathbf{X}^\top(\mathbf{y} - \boldsymbol{\mu}) = \mathbf{0}" display={true} />
                </div>
    
                <div className="mt-3 bg-white rounded p-2 text-sm text-teal-800">
                  <strong>Interpretation:</strong> Residuals orthogonal to column space of X - just like OLS!
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom: Key point */}
          <div className="flex-shrink-0 mt-3">
            <div className="bg-amber-100 border border-amber-300 rounded-xl p-3">
              <p className="text-center text-amber-900">
                <strong>Problem:</strong> These equations are nonlinear in <Latex math="\boldsymbol{\beta}" /> because <Latex math="\boldsymbol{\mu}" /> depends on <Latex math="\boldsymbol{\beta}" />.
                No closed-form solution - we need iterative methods.
              </p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                      SLIDE 104: FISHER INFORMATION
// ═══════════════════════════════════════════════════════════════════════

function Slide104_FisherInformation() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-indigo-800">Fisher Information</h1>
            <p className="text-gray-600">Foundation for standard errors and IRLS</p>
          </div>
    
          {/* Main formula */}
          <div className="bg-indigo-50 border-2 border-indigo-300 rounded-xl p-4 mb-4">
            <p className="text-sm text-indigo-700 text-center mb-2">Expected negative Hessian:</p>
            <div className="text-center">
              <Latex math="\mathbf{I}(\boldsymbol{\beta}) = \mathbb{E}\left[-\frac{\partial^2 \ell}{\partial \boldsymbol{\beta} \partial \boldsymbol{\beta}^\top}\right] = \mathbf{X}^\top \mathbf{W} \mathbf{X}" display={true} />
            </div>
          </div>
    
          {/* Two column: Weight matrix and asymptotic results */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Left: Weight matrix */}
            <div className="bg-white border-2 border-gray-200 rounded-xl p-4">
              <h3 className="font-bold text-gray-800 mb-3">Weight Matrix</h3>
              
              <div className="bg-gray-50 rounded-lg p-3 text-center mb-3">
                <Latex math="\mathbf{W} = \text{diag}(w_1, \ldots, w_n)" display={true} />
              </div>
    
              <div className="space-y-2 text-sm">
                <div className="bg-blue-50 rounded p-2">
                  <p className="font-semibold text-blue-800">General link:</p>
                  <Latex math="w_i = \frac{1}{\phi \cdot V(\mu_i) \cdot [g'(\mu_i)]^2}" />
                </div>
                <div className="bg-teal-50 rounded p-2">
                  <p className="font-semibold text-teal-800">Canonical link:</p>
                  <Latex math="w_i = \frac{V(\mu_i)}{\phi}" />
                </div>
              </div>
    
              <div className="mt-3 text-xs text-gray-600">
                Weights depend on fitted values - this is why we iterate!
              </div>
            </div>
    
            {/* Right: Asymptotic results */}
            <div className="bg-gradient-to-b from-indigo-50 to-violet-50 border-2 border-indigo-300 rounded-xl p-4">
              <h3 className="font-bold text-indigo-800 mb-3">Asymptotic Distribution</h3>
              
              <div className="bg-white rounded-lg p-3 text-center mb-3 border border-indigo-200">
                <Latex math="\hat{\boldsymbol{\beta}} \xrightarrow{d} \mathcal{N}\left(\boldsymbol{\beta}, \mathbf{I}(\boldsymbol{\beta})^{-1}\right)" display={true} />
              </div>
    
              <p className="text-sm text-indigo-800 mb-3">Estimated covariance matrix:</p>
              <div className="bg-indigo-100 rounded-lg p-3 text-center">
                <Latex math="\widehat{\text{Var}}(\hat{\boldsymbol{\beta}}) = (\mathbf{X}^\top \hat{\mathbf{W}} \mathbf{X})^{-1}" display={true} />
              </div>
    
              <div className="mt-3 text-sm text-indigo-700">
                <strong>Standard errors:</strong> Square roots of diagonal elements
              </div>
            </div>
          </div>
    
          {/* Bottom: Connection to OLS */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-gradient-to-r from-gray-100 to-indigo-100 rounded-xl p-3 border border-gray-300">
              <div className="grid grid-cols-2 gap-4 text-center text-sm">
                <div>
                  <p className="font-semibold text-gray-700">OLS (Normal, Identity)</p>
                  <Latex math="\text{Var}(\hat{\boldsymbol{\beta}}) = \sigma^2(\mathbf{X}^\top\mathbf{X})^{-1}" />
                </div>
                <div>
                  <p className="font-semibold text-indigo-700">GLM (General)</p>
                  <Latex math="\text{Var}(\hat{\boldsymbol{\beta}}) = (\mathbf{X}^\top\mathbf{W}\mathbf{X})^{-1}" />
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                        SLIDE 105: IRLS ALGORITHM
// ═══════════════════════════════════════════════════════════════════════

function Slide105_IRLSAlgorithm() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-cyan-800">IRLS Algorithm</h1>
            <p className="text-gray-600">Iteratively Reweighted Least Squares</p>
          </div>
    
          {/* Key formulas */}
          <div className="grid grid-cols-2 gap-3 mb-3">
            <div className="bg-cyan-50 border border-cyan-200 rounded-lg p-3">
              <p className="text-xs text-cyan-700 font-semibold mb-1">Working Response:</p>
              <div className="text-center">
                <Latex math="z_i^{(t)} = \eta_i^{(t)} + (y_i - \mu_i^{(t)}) \cdot g'(\mu_i^{(t)})" />
              </div>
            </div>
            <div className="bg-cyan-50 border border-cyan-200 rounded-lg p-3">
              <p className="text-xs text-cyan-700 font-semibold mb-1">IRLS Update:</p>
              <div className="text-center">
                <Latex math="\boldsymbol{\beta}^{(t+1)} = (\mathbf{X}^\top\mathbf{W}^{(t)}\mathbf{X})^{-1}\mathbf{X}^\top\mathbf{W}^{(t)}\mathbf{z}^{(t)}" />
              </div>
            </div>
          </div>
    
          {/* Algorithm box */}
          <div className="flex-1 bg-gray-900 text-gray-100 rounded-xl p-4 font-mono text-sm overflow-auto">
            <div className="text-cyan-400 font-bold mb-2">Algorithm: IRLS for GLMs</div>
            <div className="space-y-1 text-xs">
              <p><span className="text-yellow-400">Input:</span> X (n x p), y, link g, variance V, dispersion phi, tol, max_iter</p>
              <p><span className="text-yellow-400">Output:</span> beta_hat, fitted mu, converged flag</p>
              <p className="text-gray-500">---</p>
              <p><span className="text-green-400">1.</span> Initialize: beta^(0) from OLS on transformed y</p>
              <p className="text-gray-500">---</p>
              <p><span className="text-green-400">2.</span> <span className="text-purple-400">for</span> t = 0, 1, 2, ... <span className="text-purple-400">until</span> convergence:</p>
              <p className="pl-6"><span className="text-cyan-300">a.</span> eta^(t) = X @ beta^(t)          <span className="text-gray-500"># linear predictor</span></p>
              <p className="pl-6"><span className="text-cyan-300">b.</span> mu^(t) = g_inv(eta^(t))         <span className="text-gray-500"># fitted means</span></p>
              <p className="pl-6"><span className="text-cyan-300">c.</span> W^(t) = diag(1 / [phi * V(mu) * g'(mu)^2])</p>
              <p className="pl-6"><span className="text-cyan-300">d.</span> z^(t) = eta^(t) + (y - mu^(t)) * g'(mu^(t))</p>
              <p className="pl-6"><span className="text-cyan-300">e.</span> beta^(t+1) = solve_WLS(X, z^(t), W^(t))</p>
              <p className="pl-6"><span className="text-cyan-300">f.</span> <span className="text-purple-400">if</span> ||beta^(t+1) - beta^(t)|| / ||beta^(t)|| {"<"} tol: <span className="text-purple-400">break</span></p>
              <p className="text-gray-500">---</p>
              <p><span className="text-green-400">3.</span> <span className="text-purple-400">return</span> beta^(t+1), g_inv(X @ beta^(t+1)), converged</p>
            </div>
          </div>
    
          {/* Bottom: Key insight */}
          <div className="flex-shrink-0 mt-3">
            <div className="bg-gradient-to-r from-cyan-100 to-teal-100 rounded-xl p-3 border border-cyan-200">
              <div className="grid grid-cols-3 gap-2 text-center text-sm">
                <div>
                  <p className="font-bold text-cyan-800">Complexity</p>
                  <p className="text-cyan-700"><Latex math="O(T \cdot np^2)" /></p>
                </div>
                <div>
                  <p className="font-bold text-cyan-800">Iterations</p>
                  <p className="text-cyan-700">Typically 3-8</p>
                </div>
                <div>
                  <p className="font-bold text-cyan-800">Each Step</p>
                  <p className="text-cyan-700">One WLS solve</p>
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                       SLIDE 106: IRLS CONVERGENCE
// ═══════════════════════════════════════════════════════════════════════

function Slide106_IRLSConvergence() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-emerald-800">IRLS Convergence</h1>
            <p className="text-gray-600">Fast and reliable for canonical links</p>
          </div>
    
          {/* Figure */}
          <div className="flex-1 flex flex-col items-center justify-center">
            <img 
              src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/PartII/Chapter3/ch3_5_fig02_irls_convergence.png"
              alt="IRLS convergence showing deviance decrease and quadratic convergence rate"
              className="max-h-88 object-contain rounded-lg shadow-lg mb-4"
            />
            <p className="text-sm text-gray-600 text-center max-w-2xl">
              <strong>Figure 3.5.2:</strong> (a) Deviance decreases monotonically toward minimum.
              (b) Log-error shows quadratic convergence - slope doubles each iteration.
            </p>
          </div>
    
          {/* Properties grid */}
          <div className="grid grid-cols-3 gap-3 mb-3">
            <div className="bg-emerald-50 border border-emerald-200 rounded-lg p-3 text-center">
              <p className="font-bold text-emerald-800 text-sm">Quadratic Rate</p>
              <p className="text-xs text-emerald-700">Correct digits double each iteration</p>
            </div>
            <div className="bg-blue-50 border border-blue-200 rounded-lg p-3 text-center">
              <p className="font-bold text-blue-800 text-sm">Global Convergence</p>
              <p className="text-xs text-blue-700">Canonical links: any starting point works</p>
            </div>
            <div className="bg-purple-50 border border-purple-200 rounded-lg p-3 text-center">
              <p className="font-bold text-purple-800 text-sm">3-8 Iterations</p>
              <p className="text-xs text-purple-700">Typical for well-behaved problems</p>
            </div>
          </div>
    
          {/* Stability considerations */}
          <div className="flex-shrink-0">
            <div className="bg-amber-50 border border-amber-200 rounded-xl p-3">
              <p className="font-semibold text-amber-800 mb-2 text-sm">Numerical Stability Considerations</p>
              <div className="grid grid-cols-2 gap-3 text-xs">
                <div>
                  <p className="font-semibold text-amber-700">Potential Issues:</p>
                  <ul className="text-gray-700 space-y-0.5 mt-1">
                    <li>{"•"} Extreme weights (separation)</li>
                    <li>{"•"} Ill-conditioned <Latex math="\mathbf{X}^\top\mathbf{W}\mathbf{X}" /></li>
                    <li>{"•"} Boundary parameters</li>
                  </ul>
                </div>
                <div>
                  <p className="font-semibold text-amber-700">Remedies:</p>
                  <ul className="text-gray-700 space-y-0.5 mt-1">
                    <li>{"•"} Step-halving if deviance increases</li>
                    <li>{"•"} QR decomposition (not normal eq.)</li>
                    <li>{"•"} Bound predictions: <Latex math="[\epsilon, 1-\epsilon]" /></li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                        SLIDE 107: LOGISTIC SETUP
// ═══════════════════════════════════════════════════════════════════════

function Slide107_LogisticSetup() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-red-800">Logistic Regression</h1>
            <p className="text-gray-600">GLM for binary outcomes</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-6">
            {/* Left: Model specification */}
            <div className="flex flex-col space-y-4">
              {/* Random component */}
              <div className="bg-red-50 border-2 border-red-200 rounded-xl p-4">
                <h3 className="font-bold text-red-800 mb-2">Random Component</h3>
                <div className="bg-white rounded-lg p-3 text-center">
                  <Latex math="Y_i \sim \text{Bernoulli}(\pi_i)" display={true} />
                </div>
                <p className="text-sm text-red-700 mt-2">
                  <Latex math="Y_i \in \{0, 1\}" />, <Latex math="\pi_i = P(Y_i = 1 | \mathbf{x}_i)" />
                </p>
              </div>
    
              {/* Link function */}
              <div className="bg-purple-50 border-2 border-purple-200 rounded-xl p-4">
                <h3 className="font-bold text-purple-800 mb-2">Link Function (Logit)</h3>
                <div className="bg-white rounded-lg p-3 text-center">
                  <Latex math="\text{logit}(\pi_i) = \log\left(\frac{\pi_i}{1-\pi_i}\right) = \mathbf{x}_i^\top\boldsymbol{\beta}" display={true} />
                </div>
                <p className="text-sm text-purple-700 mt-2">
                  Log-odds equals linear predictor
                </p>
              </div>
    
              {/* Variance */}
              <div className="bg-blue-50 border-2 border-blue-200 rounded-xl p-4">
                <h3 className="font-bold text-blue-800 mb-2">Variance Function</h3>
                <div className="bg-white rounded-lg p-3 text-center">
                  <Latex math="V(\pi) = \pi(1-\pi), \quad \phi = 1 \text{ (fixed)}" display={true} />
                </div>
              </div>
            </div>
    
            {/* Right: Inverse link */}
            <div className="flex flex-col">
              <div className="bg-gradient-to-b from-rose-50 to-red-50 border-2 border-rose-300 rounded-xl p-4 flex-1">
                <h3 className="font-bold text-rose-800 mb-3">Inverse Link (Logistic Function)</h3>
                
                <div className="bg-white rounded-lg p-4 text-center mb-4 border border-rose-200">
                  <Latex math="\pi_i = \frac{1}{1 + e^{-\eta_i}} = \frac{e^{\mathbf{x}_i^\top\boldsymbol{\beta}}}{1 + e^{\mathbf{x}_i^\top\boldsymbol{\beta}}}" display={true} />
                </div>
    
                <div className="space-y-3 text-sm">
                  <div className="flex items-center gap-3">
                    <span className="bg-rose-200 text-rose-800 px-2 py-1 rounded text-xs font-bold">Domain</span>
                    <span className="text-gray-700"><Latex math="\eta \in (-\infty, +\infty)" /></span>
                  </div>
                  <div className="flex items-center gap-3">
                    <span className="bg-rose-200 text-rose-800 px-2 py-1 rounded text-xs font-bold">Range</span>
                    <span className="text-gray-700"><Latex math="\pi \in (0, 1)" /></span>
                  </div>
                  <div className="flex items-center gap-3">
                    <span className="bg-rose-200 text-rose-800 px-2 py-1 rounded text-xs font-bold">Shape</span>
                    <span className="text-gray-700">S-curve (sigmoid)</span>
                  </div>
                </div>
    
                <div className="mt-4 bg-rose-100 rounded-lg p-3 text-sm text-rose-800">
                  <strong>Key property:</strong> Maps unbounded linear predictor to valid probability
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom: Applications */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-gray-100 rounded-xl p-3">
              <p className="text-center text-gray-700 text-sm">
                <strong>Applications:</strong> Credit default, disease diagnosis, customer churn, spam detection, click-through prediction
              </p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                        SLIDE 108: LOGISTIC CURVE
// ═══════════════════════════════════════════════════════════════════════

function Slide108_LogisticCurve() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-rose-800">The Logistic Curve</h1>
            <p className="text-gray-600">Mapping linear predictor to probability</p>
          </div>
    
          {/* Main figure */}
          <div className="flex-1 flex flex-col items-center justify-center">
            <img 
              src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/PartII/Chapter3/ch3_5_fig03_logistic_curve.png"
              alt="Logistic regression S-curve with simulated binary data"
              className="max-h-88 object-contain rounded-lg shadow-lg"
            />
            <p className="text-sm text-gray-600 text-center mt-3 max-w-2xl">
              <strong>Figure 3.5.3:</strong> Binary outcomes (jittered) with fitted probability curve.
              The S-shape smoothly transitions from near 0 to near 1.
            </p>
          </div>
    
          {/* Key properties */}
          <div className="grid grid-cols-3 gap-4 mt-4">
            <div className="bg-rose-50 border border-rose-200 rounded-lg p-3">
              <p className="font-bold text-rose-800 text-sm mb-1">Inflection Point</p>
              <div className="text-center">
                <Latex math="\eta = 0 \Rightarrow \pi = 0.5" />
              </div>
              <p className="text-xs text-gray-600 mt-1">Decision boundary at <Latex math="x = -\beta_0/\beta_1" /></p>
            </div>
    
            <div className="bg-purple-50 border border-purple-200 rounded-lg p-3">
              <p className="font-bold text-purple-800 text-sm mb-1">Slope at Center</p>
              <div className="text-center">
                <Latex math="\frac{d\pi}{dx}\bigg|_{\pi=0.5} = \frac{\beta_1}{4}" />
              </div>
              <p className="text-xs text-gray-600 mt-1">Steepness of transition</p>
            </div>
    
            <div className="bg-blue-50 border border-blue-200 rounded-lg p-3">
              <p className="font-bold text-blue-800 text-sm mb-1">Asymptotes</p>
              <div className="text-center text-sm">
                <Latex math="\pi \to 0 \text{ as } \eta \to -\infty" />
                <br />
                <Latex math="\pi \to 1 \text{ as } \eta \to +\infty" />
              </div>
            </div>
          </div>
    
          {/* Bottom formula */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-gradient-to-r from-rose-100 to-pink-100 rounded-xl p-3 border border-rose-200 text-center">
              <Latex math="\pi(x) = \frac{1}{1 + \exp(-(\beta_0 + \beta_1 x))}" />
              <span className="text-rose-700 ml-4">{"- the sigmoid (logistic) function"}</span>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                         SLIDE 109: ODDS RATIOS
// ═══════════════════════════════════════════════════════════════════════

function Slide109_OddsRatios() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-amber-800">Odds Ratios</h1>
            <p className="text-gray-600">Interpreting logistic regression coefficients</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-6">
            {/* Left: Derivation */}
            <div className="flex flex-col space-y-3">
              <div className="bg-amber-50 border-2 border-amber-200 rounded-xl p-4">
                <h3 className="font-bold text-amber-800 mb-2">Definition of Odds</h3>
                <div className="bg-white rounded-lg p-3 text-center">
                  <Latex math="\text{odds} = \frac{\pi}{1-\pi}" display={true} />
                </div>
                <p className="text-sm text-amber-700 mt-2">
                  Ratio of success probability to failure probability
                </p>
              </div>
    
              <div className="bg-blue-50 border-2 border-blue-200 rounded-xl p-4 flex-1">
                <h3 className="font-bold text-blue-800 mb-2">Deriving the Odds Ratio</h3>
                <div className="space-y-2 text-sm">
                  <p>For single predictor:</p>
                  <div className="bg-white rounded p-2 text-center">
                    <Latex math="\log\left(\frac{\pi}{1-\pi}\right) = \beta_0 + \beta_1 x" />
                  </div>
                  <p>Compare <Latex math="x+1" /> to <Latex math="x" />:</p>
                  <div className="bg-white rounded p-2 text-center">
                    <Latex math="\log(\text{odds}_{x+1}) - \log(\text{odds}_x) = \beta_1" />
                  </div>
                  <p>Exponentiate:</p>
                  <div className="bg-blue-100 rounded p-2 text-center border border-blue-300">
                    <Latex math="\text{OR} = \frac{\text{odds}_{x+1}}{\text{odds}_x} = e^{\beta_1}" display={true} />
                  </div>
                </div>
              </div>
            </div>
    
            {/* Right: Interpretation */}
            <div className="flex flex-col">
              <div className="bg-gradient-to-b from-orange-50 to-amber-50 border-2 border-orange-300 rounded-xl p-4 flex-1">
                <h3 className="font-bold text-orange-800 mb-3">Interpretation Guide</h3>
                
                <div className="space-y-3">
                  <div className="bg-white rounded-lg p-3 border border-orange-200">
                    <div className="flex justify-between items-center">
                      <span className="font-semibold text-gray-700"><Latex math="e^{\beta} > 1" /></span>
                      <span className="text-green-600 font-bold">Odds increase</span>
                    </div>
                    <p className="text-xs text-gray-600 mt-1">
                      Example: <Latex math="e^{0.5} = 1.65" /> means 65% increase in odds per unit
                    </p>
                  </div>
    
                  <div className="bg-white rounded-lg p-3 border border-orange-200">
                    <div className="flex justify-between items-center">
                      <span className="font-semibold text-gray-700"><Latex math="e^{\beta} = 1" /></span>
                      <span className="text-gray-600 font-bold">No effect</span>
                    </div>
                    <p className="text-xs text-gray-600 mt-1">
                      <Latex math="\beta = 0" /> means predictor has no association
                    </p>
                  </div>
    
                  <div className="bg-white rounded-lg p-3 border border-orange-200">
                    <div className="flex justify-between items-center">
                      <span className="font-semibold text-gray-700"><Latex math="e^{\beta} < 1" /></span>
                      <span className="text-red-600 font-bold">Odds decrease</span>
                    </div>
                    <p className="text-xs text-gray-600 mt-1">
                      Example: <Latex math="e^{-0.3} = 0.74" /> means 26% decrease in odds per unit
                    </p>
                  </div>
                </div>
    
                <div className="mt-3 bg-orange-100 rounded p-2 text-sm text-orange-800">
                  <strong>Multiple regression:</strong> <Latex math="e^{\beta_j}" /> is adjusted OR, holding other variables constant
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom: Example */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-gray-100 rounded-xl p-3 border border-gray-300">
              <p className="text-sm text-gray-700">
                <strong>Example:</strong> If <Latex math="\hat{\beta}_{\text{age}} = 0.04" /> in a disease model, then{" "}
                <Latex math="e^{0.04} = 1.041" /> - each additional year of age increases odds of disease by 4.1%.
              </p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                      SLIDE 10: POISSON CONVERSION
// ═══════════════════════════════════════════════════════════════════════

function Slide10_PoissonConversion() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">Poisson <Latex math="\rightarrow" /> Exponential Form</h1>
          <p className="text-gray-600 mb-3">The canonical link is the log function</p>
    
          {/* Starting point */}
          <div className="bg-green-50 rounded-xl p-3 mb-3 border border-green-200">
            <div className="font-semibold text-green-800 mb-2">Starting Point: Standard Poisson PMF</div>
            <div className="bg-white rounded-lg p-3 text-center">
              <Latex math="P(X = k) = \frac{e^{-\lambda}\lambda^k}{k!} \quad \text{for } k \in \{0, 1, 2, \ldots\}" display={true} />
            </div>
          </div>
    
          {/* Transformation steps */}
          <div className="bg-gradient-to-br from-blue-50 to-cyan-50 rounded-xl p-4 mb-3 border border-blue-200 flex-1">
            <div className="font-semibold text-blue-800 mb-2">Step-by-Step Conversion</div>
            <div className="space-y-2">
              <div className="flex items-center gap-3">
                <div className="bg-blue-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">1</div>
                <div className="bg-white rounded-lg p-2 flex-1 text-sm">
                  <span className="text-gray-500">Rewrite <Latex math="\lambda^k" />: </span>
                  <Latex math="\frac{e^{-\lambda}\lambda^k}{k!} = \frac{1}{k!} \cdot \exp\{-\lambda + k\log\lambda\}" />
                </div>
              </div>
              <div className="flex items-center gap-3">
                <div className="bg-blue-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">2</div>
                <div className="bg-white rounded-lg p-2 flex-1 text-sm">
                  <span className="text-gray-500">Define <Latex math="\eta" />: </span>
                  <Latex math="\eta = \log\lambda \quad \Leftrightarrow \quad \lambda = e^\eta" />
                </div>
              </div>
              <div className="flex items-center gap-3">
                <div className="bg-blue-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">3</div>
                <div className="bg-white rounded-lg p-2 flex-1 text-sm">
                  <span className="text-gray-500">Final form: </span>
                  <Latex math="= \frac{1}{k!} \cdot \exp\left\{ k \cdot \eta - e^\eta \right\}" />
                </div>
              </div>
            </div>
          </div>
    
          {/* Components identified */}
          <div className="grid grid-cols-4 gap-2 mb-3">
            <div className="bg-blue-100 rounded-lg p-2 text-center">
              <div className="text-xs text-blue-600 mb-1">Sufficient Stat</div>
              <div className="font-mono text-blue-800"><Latex math="T(k) = k" /></div>
            </div>
            <div className="bg-purple-100 rounded-lg p-2 text-center">
              <div className="text-xs text-purple-600 mb-1">Natural Param</div>
              <div className="font-mono text-purple-800"><Latex math="\eta = \log\lambda" /></div>
            </div>
            <div className="bg-green-100 rounded-lg p-2 text-center">
              <div className="text-xs text-green-600 mb-1">Log-Partition</div>
              <div className="font-mono text-green-800"><Latex math="A(\eta) = e^\eta" /></div>
            </div>
            <div className="bg-amber-100 rounded-lg p-2 text-center">
              <div className="text-xs text-amber-600 mb-1">Carrier</div>
              <div className="font-mono text-amber-800"><Latex math="h(k) = \frac{1}{k!}" /></div>
            </div>
          </div>
    
          {/* Verification + Mean-Variance */}
          <div className="grid grid-cols-2 gap-3">
            <div className="bg-teal-50 rounded-xl p-3 border border-teal-200">
              <div className="font-semibold text-teal-800 mb-2">Verify: Moments</div>
              <div className="space-y-1 text-sm">
                <div className="bg-white rounded-lg p-2">
                  <Latex math="A'(\eta) = e^\eta = \lambda = \mathbb{E}[X]" /> <span className="text-teal-600">✓</span>
                </div>
                <div className="bg-white rounded-lg p-2">
                  <Latex math="A''(\eta) = e^\eta = \lambda = \text{Var}(X)" /> <span className="text-teal-600">✓</span>
                </div>
              </div>
            </div>
    
            <div className="bg-amber-50 rounded-xl p-3 border border-amber-200">
              <div className="font-semibold text-amber-800 mb-2">Mean = Variance</div>
              <div className="text-sm text-amber-700">
                Since <Latex math="A' = A'' = e^\eta" />:
              </div>
              <div className="bg-white rounded-lg p-2 text-center mt-1">
                <Latex math="\text{Var}(X) = \mathbb{E}[X] = \lambda" />
              </div>
              <div className="text-xs text-amber-600 mt-1">
                Overdispersion: when <Latex math="\text{Var} > \lambda" /> in real data
              </div>
            </div>
          </div>
    
          {/* GLM connection */}
          <div className="mt-2 bg-pink-50 rounded-lg p-2 text-center text-sm border border-pink-200">
            <span className="text-pink-800">
              <strong>GLM Connection:</strong> The log link <Latex math="\eta = \log\lambda" /> is canonical for Poisson regression!
            </span>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                          SLIDE 110: SEPARATION
// ═══════════════════════════════════════════════════════════════════════

function Slide110_Separation() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-red-800">The Separation Problem</h1>
            <p className="text-gray-600">When MLE does not exist</p>
          </div>
    
          {/* Figure */}
          <div className="flex-1 flex flex-col items-center justify-center">
            <img 
              src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/PartII/Chapter3/ch3_5_fig04_separation_illustration.png"
              alt="Complete separation in logistic regression showing diverging coefficients"
              className="max-h-88 object-contain rounded-lg shadow-lg"
            />
            <p className="text-xs text-gray-600 text-center mt-2 max-w-2xl">
              <strong>Figure 3.5.4:</strong> (a) Separable data - all Y=1 have x{">"}5, all Y=0 have x{"<"}5.
              (b) Coefficient diverges across iterations. (c) Firth's method yields finite estimates.
            </p>
          </div>
    
          {/* Types and symptoms */}
          <div className="grid grid-cols-2 gap-4 mt-3">
            {/* Types */}
            <div className="bg-red-50 border border-red-200 rounded-xl p-3">
              <h3 className="font-bold text-red-800 mb-2 text-sm">Types of Separation</h3>
              <div className="space-y-2 text-xs">
                <div className="bg-white rounded p-2">
                  <p className="font-semibold text-red-700">Complete separation:</p>
                  <p className="text-gray-600">Perfect classification by some <Latex math="\mathbf{x}^\top\boldsymbol{\beta}" /></p>
                </div>
                <div className="bg-white rounded p-2">
                  <p className="font-semibold text-red-700">Quasi-complete separation:</p>
                  <p className="text-gray-600">Some observations on the boundary</p>
                </div>
              </div>
            </div>
    
            {/* Symptoms */}
            <div className="bg-amber-50 border border-amber-200 rounded-xl p-3">
              <h3 className="font-bold text-amber-800 mb-2 text-sm">Warning Signs</h3>
              <ul className="text-xs text-gray-700 space-y-1">
                <li>{"•"} <Latex math="|\hat{\beta}| > 10" /> (very large coefficients)</li>
                <li>{"•"} Standard errors extremely large or infinite</li>
                <li>{"•"} Convergence warnings from software</li>
                <li>{"•"} Fitted probabilities exactly 0 or 1</li>
                <li>{"•"} Algorithm reaches iteration limit</li>
              </ul>
            </div>
          </div>
    
          {/* Bottom: Why it happens */}
          <div className="flex-shrink-0 mt-3">
            <div className="bg-gray-100 rounded-xl p-3 border border-gray-300">
              <p className="text-sm text-gray-700">
                <strong>Why?</strong> Scaling <Latex math="\boldsymbol{\beta} \to c\boldsymbol{\beta}" /> with{" "}
                <Latex math="c \to \infty" /> pushes all predicted probabilities toward their observed values (0 or 1),
                and the log-likelihood keeps increasing toward 0. No finite maximum exists.
              </p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                         SLIDE 111: FIRTH METHOD
// ═══════════════════════════════════════════════════════════════════════

function Slide111_FirthMethod() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-purple-800">Firth's Penalized Likelihood</h1>
            <p className="text-gray-600">Solving the separation problem</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-6">
            {/* Left: The method */}
            <div className="flex flex-col space-y-4">
              <div className="bg-purple-50 border-2 border-purple-200 rounded-xl p-4">
                <h3 className="font-bold text-purple-800 mb-2">Penalized Log-Likelihood</h3>
                <div className="bg-white rounded-lg p-3 text-center">
                  <Latex math="\ell^*(\boldsymbol{\beta}) = \ell(\boldsymbol{\beta}) + \frac{1}{2}\log|\mathbf{I}(\boldsymbol{\beta})|" display={true} />
                </div>
                <p className="text-sm text-purple-700 mt-2">
                  Original likelihood plus Jeffreys prior penalty
                </p>
              </div>
    
              <div className="bg-indigo-50 border-2 border-indigo-200 rounded-xl p-4">
                <h3 className="font-bold text-indigo-800 mb-2">Modified Score</h3>
                <div className="bg-white rounded-lg p-3 text-center text-sm">
                  <Latex math="U_j^*(\boldsymbol{\beta}) = \sum_{i=1}^n \left(y_i - \pi_i + h_{ii}\left(\tfrac{1}{2} - \pi_i\right)\right) x_{ij}" display={true} />
                </div>
                <p className="text-sm text-indigo-700 mt-2">
                  <Latex math="h_{ii}" /> = leverage (hat matrix diagonal)
                </p>
              </div>
    
              <div className="bg-blue-50 border-2 border-blue-200 rounded-xl p-4">
                <h3 className="font-bold text-blue-800 mb-2">Key Properties</h3>
                <ul className="text-sm text-blue-700 space-y-1">
                  <li>{"•"} Always produces finite estimates</li>
                  <li>{"•"} Reduces small-sample bias</li>
                  <li>{"•"} Equivalent to Jeffreys prior</li>
                </ul>
              </div>
            </div>
    
            {/* Right: Implementation */}
            <div className="flex flex-col">
              <div className="bg-gradient-to-b from-gray-50 to-gray-100 border-2 border-gray-300 rounded-xl p-4 flex-1">
                <h3 className="font-bold text-gray-800 mb-3">Python Options</h3>
                
                <div className="space-y-3">
                  <div className="bg-white rounded-lg p-3 border border-gray-200">
                    <p className="font-semibold text-gray-700 text-sm mb-1">1. firthlogist package</p>
                    <div className="bg-gray-900 text-gray-100 rounded p-2 text-xs font-mono">
                      <p className="text-green-400"># pip install firthlogist</p>
                      <p>from firthlogist import FirthLogisticRegression</p>
                      <p>model = FirthLogisticRegression()</p>
                      <p>model.fit(X, y)</p>
                    </div>
                  </div>
    
                  <div className="bg-white rounded-lg p-3 border border-gray-200">
                    <p className="font-semibold text-gray-700 text-sm mb-1">2. L2 regularization (approximation)</p>
                    <div className="bg-gray-900 text-gray-100 rounded p-2 text-xs font-mono">
                      <p>from sklearn.linear_model import LogisticRegression</p>
                      <p>model = LogisticRegression(penalty='l2', C=10)</p>
                      <p>model.fit(X, y)</p>
                    </div>
                  </div>
    
                  <div className="bg-amber-50 rounded-lg p-2 text-xs text-amber-800">
                    <strong>Note:</strong> statsmodels.GLM does not have built-in Firth option
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom: When to use */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-green-50 border border-green-200 rounded-xl p-3">
              <p className="text-sm text-green-800">
                <strong>Use Firth when:</strong> Small samples, rare events ({"<"}10% or {">"}90%),
                separation symptoms observed, or as default for better small-sample properties
              </p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                       SLIDE 112: LOGISTIC PYTHON
// ═══════════════════════════════════════════════════════════════════════

function Slide112_LogisticPython() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-rose-800">Logistic Regression in Python</h1>
            <p className="text-gray-600">Using statsmodels GLM</p>
          </div>
    
          {/* Code example */}
          <div className="flex-1 bg-gray-900 text-gray-100 rounded-xl p-4 font-mono text-sm overflow-auto">
            <pre className="text-xs leading-relaxed">
    {`import numpy as np
    import statsmodels.api as sm
    
    # Generate example data
    rng = np.random.default_rng(42)
    n = 200
    x = rng.uniform(0, 10, n)
    eta_true = -3.0 + 0.6 * x
    p_true = 1 / (1 + np.exp(-eta_true))
    y = rng.binomial(1, p_true)
    
    # Fit logistic regression
    X = sm.add_constant(x)  # Add intercept column
    model = sm.GLM(y, X, family=sm.families.Binomial())
    result = model.fit()
    
    # Key outputs
    print(f"Coefficients: {result.params}")       # [beta_0, beta_1]
    print(f"Std Errors:   {result.bse}")          # SE(beta_0), SE(beta_1)
    print(f"Odds Ratio:   {np.exp(result.params[1]):.3f}")  # exp(beta_1)
    
    # Confidence interval for odds ratio
    ci = result.conf_int()
    print(f"95% CI for OR: ({np.exp(ci[1,0]):.3f}, {np.exp(ci[1,1]):.3f})")
    
    # Predict probabilities for new data
    x_new = np.array([2, 5, 8])
    X_new = sm.add_constant(x_new)
    probs = result.predict(X_new)  # Returns probabilities directly`}
            </pre>
          </div>
    
          {/* Key outputs */}
          <div className="grid grid-cols-3 gap-3 mt-3">
            <div className="bg-rose-50 border border-rose-200 rounded-lg p-2">
              <p className="font-bold text-rose-800 text-xs">Coefficients</p>
              <p className="text-xs text-gray-700 font-mono">result.params</p>
              <p className="text-xs text-gray-500">Log-odds scale</p>
            </div>
            <div className="bg-amber-50 border border-amber-200 rounded-lg p-2">
              <p className="font-bold text-amber-800 text-xs">Odds Ratios</p>
              <p className="text-xs text-gray-700 font-mono">np.exp(result.params)</p>
              <p className="text-xs text-gray-500">Interpretable scale</p>
            </div>
            <div className="bg-blue-50 border border-blue-200 rounded-lg p-2">
              <p className="font-bold text-blue-800 text-xs">Predictions</p>
              <p className="text-xs text-gray-700 font-mono">result.predict(X)</p>
              <p className="text-xs text-gray-500">Returns probabilities</p>
            </div>
          </div>
    
          {/* Bottom note */}
          <div className="flex-shrink-0 mt-3">
            <div className="bg-gray-100 rounded-lg p-2 text-xs text-gray-700">
              <strong>Also available:</strong> result.deviance, result.aic, result.summary() for full output
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                        SLIDE 113: POISSON SETUP
// ═══════════════════════════════════════════════════════════════════════

function Slide113_PoissonSetup() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-amber-800">Poisson Regression</h1>
            <p className="text-gray-600">GLM for count data</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-6">
            {/* Left: Model specification */}
            <div className="flex flex-col space-y-4">
              {/* Random component */}
              <div className="bg-amber-50 border-2 border-amber-200 rounded-xl p-4">
                <h3 className="font-bold text-amber-800 mb-2">Random Component</h3>
                <div className="bg-white rounded-lg p-3 text-center">
                  <Latex math="Y_i \sim \text{Poisson}(\mu_i)" display={true} />
                </div>
                <p className="text-sm text-amber-700 mt-2">
                  <Latex math="Y_i \in \{0, 1, 2, \ldots\}" />, <Latex math="\mu_i = \mathbb{E}[Y_i]" />
                </p>
              </div>
    
              {/* Link function */}
              <div className="bg-emerald-50 border-2 border-emerald-200 rounded-xl p-4">
                <h3 className="font-bold text-emerald-800 mb-2">Link Function (Log)</h3>
                <div className="bg-white rounded-lg p-3 text-center">
                  <Latex math="\log(\mu_i) = \mathbf{x}_i^\top\boldsymbol{\beta}" display={true} />
                </div>
                <p className="text-sm text-emerald-700 mt-2">
                  Log of expected count equals linear predictor
                </p>
              </div>
    
              {/* Variance */}
              <div className="bg-blue-50 border-2 border-blue-200 rounded-xl p-4">
                <h3 className="font-bold text-blue-800 mb-2">Variance Function</h3>
                <div className="bg-white rounded-lg p-3 text-center">
                  <Latex math="V(\mu) = \mu, \quad \phi = 1 \text{ (fixed)}" display={true} />
                </div>
                <p className="text-sm text-blue-700 mt-1">
                  Variance equals mean (equidispersion)
                </p>
              </div>
            </div>
    
            {/* Right: Inverse link and key properties */}
            <div className="flex flex-col">
              <div className="bg-gradient-to-b from-yellow-50 to-amber-50 border-2 border-amber-300 rounded-xl p-4 flex-1">
                <h3 className="font-bold text-amber-800 mb-3">Inverse Link (Exponential)</h3>
                
                <div className="bg-white rounded-lg p-4 text-center mb-4 border border-amber-200">
                  <Latex math="\mu_i = \exp(\mathbf{x}_i^\top\boldsymbol{\beta}) = e^{\beta_0} \cdot e^{\beta_1 x_1} \cdots" display={true} />
                </div>
    
                <div className="space-y-3 text-sm">
                  <div className="flex items-center gap-3">
                    <span className="bg-amber-200 text-amber-800 px-2 py-1 rounded text-xs font-bold">Domain</span>
                    <span className="text-gray-700"><Latex math="\eta \in (-\infty, +\infty)" /></span>
                  </div>
                  <div className="flex items-center gap-3">
                    <span className="bg-amber-200 text-amber-800 px-2 py-1 rounded text-xs font-bold">Range</span>
                    <span className="text-gray-700"><Latex math="\mu \in (0, +\infty)" /></span>
                  </div>
                  <div className="flex items-center gap-3">
                    <span className="bg-amber-200 text-amber-800 px-2 py-1 rounded text-xs font-bold">Effect</span>
                    <span className="text-gray-700">Multiplicative</span>
                  </div>
                </div>
    
                <div className="mt-4 bg-amber-100 rounded-lg p-3 text-sm text-amber-800">
                  <strong>Key property:</strong> Coefficients act multiplicatively on expected counts
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom: Applications */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-gray-100 rounded-xl p-3">
              <p className="text-center text-gray-700 text-sm">
                <strong>Applications:</strong> Insurance claims, website visits, disease incidence, manufacturing defects, traffic accidents
              </p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                         SLIDE 114: RATE RATIOS
// ═══════════════════════════════════════════════════════════════════════

function Slide114_RateRatios() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-orange-800">Rate Ratios</h1>
            <p className="text-gray-600">Interpreting Poisson regression coefficients</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-6">
            {/* Left: Derivation */}
            <div className="flex flex-col space-y-3">
              <div className="bg-orange-50 border-2 border-orange-200 rounded-xl p-4">
                <h3 className="font-bold text-orange-800 mb-2">The Log Link Model</h3>
                <div className="bg-white rounded-lg p-3 text-center">
                  <Latex math="\log(\mu_i) = \beta_0 + \beta_1 x_i" display={true} />
                </div>
                <p className="text-sm text-orange-700 mt-2">
                  Equivalently: <Latex math="\mu_i = e^{\beta_0} \cdot e^{\beta_1 x_i}" />
                </p>
              </div>
    
              <div className="bg-amber-50 border-2 border-amber-200 rounded-xl p-4 flex-1">
                <h3 className="font-bold text-amber-800 mb-2">Deriving the Rate Ratio</h3>
                <div className="space-y-2 text-sm">
                  <p>Compare expected counts at <Latex math="x+1" /> vs <Latex math="x" />:</p>
                  <div className="bg-white rounded p-2 text-center">
                    <Latex math="\frac{\mu_{x+1}}{\mu_x} = \frac{e^{\beta_0 + \beta_1(x+1)}}{e^{\beta_0 + \beta_1 x}}" />
                  </div>
                  <p>Simplify:</p>
                  <div className="bg-amber-100 rounded p-3 text-center border border-amber-300">
                    <Latex math="\text{RR} = \frac{\mu_{x+1}}{\mu_x} = e^{\beta_1}" display={true} />
                  </div>
                </div>
              </div>
            </div>
    
            {/* Right: Interpretation */}
            <div className="flex flex-col">
              <div className="bg-gradient-to-b from-yellow-50 to-orange-50 border-2 border-orange-300 rounded-xl p-4 flex-1">
                <h3 className="font-bold text-orange-800 mb-3">Interpretation Guide</h3>
                
                <div className="space-y-3">
                  <div className="bg-white rounded-lg p-3 border border-orange-200">
                    <div className="flex justify-between items-center">
                      <span className="font-semibold text-gray-700"><Latex math="e^{\beta} > 1" /></span>
                      <span className="text-green-600 font-bold">Rate increases</span>
                    </div>
                    <p className="text-xs text-gray-600 mt-1">
                      Example: <Latex math="e^{0.3} = 1.35" /> means 35% more events per unit increase
                    </p>
                  </div>
    
                  <div className="bg-white rounded-lg p-3 border border-orange-200">
                    <div className="flex justify-between items-center">
                      <span className="font-semibold text-gray-700"><Latex math="e^{\beta} = 1" /></span>
                      <span className="text-gray-600 font-bold">No effect</span>
                    </div>
                    <p className="text-xs text-gray-600 mt-1">
                      <Latex math="\beta = 0" /> means predictor has no association with count
                    </p>
                  </div>
    
                  <div className="bg-white rounded-lg p-3 border border-orange-200">
                    <div className="flex justify-between items-center">
                      <span className="font-semibold text-gray-700"><Latex math="e^{\beta} < 1" /></span>
                      <span className="text-red-600 font-bold">Rate decreases</span>
                    </div>
                    <p className="text-xs text-gray-600 mt-1">
                      Example: <Latex math="e^{-0.2} = 0.82" /> means 18% fewer events per unit
                    </p>
                  </div>
                </div>
    
                <div className="mt-3 bg-orange-100 rounded p-2 text-sm text-orange-800">
                  <strong>Key:</strong> Effects are <em>multiplicative</em>, not additive
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom: Example */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-gray-100 rounded-xl p-3 border border-gray-300">
              <p className="text-sm text-gray-700">
                <strong>Example:</strong> Modeling insurance claims, if <Latex math="\hat{\beta}_{\text{age}} = 0.02" />,
                then <Latex math="e^{0.02} = 1.020" /> - each additional year increases expected claims by 2%.
                Over 20 years: <Latex math="e^{0.4} = 1.49" />, a 49% increase.
              </p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                           SLIDE 115: OFFSETS
// ═══════════════════════════════════════════════════════════════════════

function Slide115_Offsets() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-teal-800">Offsets and Exposure</h1>
            <p className="text-gray-600">Handling varying observation periods or populations</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-5">
            {/* Left: The problem and solution */}
            <div className="flex flex-col space-y-3">
              <div className="bg-red-50 border-2 border-red-200 rounded-xl p-4">
                <h3 className="font-bold text-red-800 mb-2">The Problem</h3>
                <p className="text-sm text-gray-700 mb-2">
                  Observations have different exposure times or population sizes:
                </p>
                <ul className="text-xs text-gray-600 space-y-1">
                  <li>{"•"} City A observed 5 years, City B observed 1 year</li>
                  <li>{"•"} Hospital A has 1000 beds, Hospital B has 100 beds</li>
                  <li>{"•"} Region A has 1M people, Region B has 100K people</li>
                </ul>
                <p className="text-sm text-red-700 mt-2 font-semibold">
                  Raw counts are not comparable!
                </p>
              </div>
    
              <div className="bg-teal-50 border-2 border-teal-200 rounded-xl p-4 flex-1">
                <h3 className="font-bold text-teal-800 mb-2">The Solution: Offset</h3>
                <p className="text-sm text-gray-700 mb-2">Model the <em>rate</em> instead of the count:</p>
                <div className="bg-white rounded-lg p-3 text-center border border-teal-200">
                  <Latex math="\log(\mu_i) = \log(t_i) + \mathbf{x}_i^\top\boldsymbol{\beta}" display={true} />
                </div>
                <p className="text-sm text-teal-700 mt-2">
                  Equivalently:
                </p>
                <div className="bg-white rounded-lg p-2 text-center mt-1">
                  <Latex math="\mu_i = t_i \cdot \exp(\mathbf{x}_i^\top\boldsymbol{\beta})" />
                </div>
                <p className="text-xs text-gray-600 mt-2">
                  <Latex math="t_i" /> = exposure (time, population, area)
                </p>
              </div>
            </div>
    
            {/* Right: Implementation */}
            <div className="flex flex-col space-y-3">
              <div className="bg-gray-900 text-gray-100 rounded-xl p-4 font-mono text-xs flex-1">
                <p className="text-teal-400 font-bold mb-2"># Python with statsmodels</p>
                <pre className="leading-relaxed">
    {`import numpy as np
    import statsmodels.api as sm
    
    # Data with varying exposure
    y = np.array([15, 45, 8, 22])  # counts
    exposure = np.array([1, 3, 1, 2])  # years
    x = np.array([1.2, 1.5, 0.8, 1.1])  # predictor
    
    X = sm.add_constant(x)
    
    # Include log(exposure) as offset
    model = sm.GLM(
        y, X,
        family=sm.families.Poisson(),
        offset=np.log(exposure)  # <- key line!
    )
    result = model.fit()
    
    # Coefficients model rate per unit time
    print(result.params)`}
                </pre>
              </div>
    
              <div className="bg-blue-50 border border-blue-200 rounded-lg p-3">
                <h3 className="font-semibold text-blue-800 mb-2 text-sm">Offset Properties</h3>
                <ul className="text-xs text-gray-700 space-y-1">
                  <li>{"•"} Coefficient fixed at 1 (not estimated)</li>
                  <li>{"•"} Must use <Latex math="\log(t_i)" />, not <Latex math="t_i" /></li>
                  <li>{"•"} Coefficients now represent effects on <em>rate</em></li>
                </ul>
              </div>
            </div>
          </div>
    
          {/* Bottom: Key formula */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-gradient-to-r from-teal-100 to-cyan-100 rounded-xl p-3 border border-teal-200">
              <div className="text-center">
                <span className="text-teal-800 font-semibold">Rate model: </span>
                <Latex math="\mathbb{E}\left[\frac{Y_i}{t_i}\right] = \exp(\mathbf{x}_i^\top\boldsymbol{\beta})" />
                <span className="text-gray-600 ml-4">- expected events per unit exposure</span>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                        SLIDE 116: OVERDISPERSION
// ═══════════════════════════════════════════════════════════════════════

function Slide116_Overdispersion() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-red-800">Overdispersion</h1>
            <p className="text-gray-600">When variance exceeds the mean</p>
          </div>
    
          {/* Main content: Figure + explanation */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Left: Figure */}
            <div className="flex flex-col">
              <div className="flex-1 flex items-center justify-center">
                <img 
                  src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/PartII/Chapter3/ch3_5_fig05_poisson_overdispersion.png"
                  alt="Comparison of Poisson vs overdispersed count data"
                  className="max-h-118 object-contain rounded-lg shadow-lg"
                />
              </div>
              <p className="text-xs text-gray-600 text-center mt-2">
                <strong>Figure 3.5.5:</strong> Overdispersed data shows more spread than Poisson predicts
              </p>
            </div>
    
            {/* Right: Detection and solutions */}
            <div className="flex flex-col space-y-3">
              <div className="bg-red-50 border-2 border-red-200 rounded-xl p-3">
                <h3 className="font-bold text-red-800 mb-2 text-sm">Detection</h3>
                <div className="bg-white rounded p-2 text-center text-sm">
                  <Latex math="\hat{\phi} = \frac{\chi^2_P}{n-p} = \frac{\sum \frac{(y_i - \hat{\mu}_i)^2}{\hat{\mu}_i}}{n-p}" display={true} />
                </div>
                <p className="text-xs text-red-700 mt-2">
                  If <Latex math="\hat{\phi} \gg 1" />, overdispersion is present
                </p>
              </div>
    
              <div className="bg-amber-50 border-2 border-amber-200 rounded-xl p-3 flex-1">
                <h3 className="font-bold text-amber-800 mb-2 text-sm">Solutions</h3>
                <div className="space-y-2 text-xs">
                  <div className="bg-white rounded p-2">
                    <span className="font-semibold text-amber-700">1. Quasi-Poisson:</span>
                    <p className="text-gray-600"><Latex math="\text{Var}(Y) = \phi \cdot \mu" />, estimate <Latex math="\phi" /></p>
                  </div>
                  <div className="bg-white rounded p-2">
                    <span className="font-semibold text-amber-700">2. Negative Binomial:</span>
                    <p className="text-gray-600"><Latex math="\text{Var}(Y) = \mu + \mu^2/\theta" />, extra parameter</p>
                  </div>
                  <div className="bg-white rounded p-2">
                    <span className="font-semibold text-amber-700">3. Zero-Inflated:</span>
                    <p className="text-gray-600">Mixture model for excess zeros</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom: Consequences and Python */}
          <div className="grid grid-cols-2 gap-3 mt-3">
            <div className="bg-gray-100 rounded-lg p-3">
              <h4 className="font-semibold text-gray-700 text-sm mb-1">Consequences of Ignoring</h4>
              <ul className="text-xs text-gray-600 space-y-0.5">
                <li>{"•"} Standard errors too small</li>
                <li>{"•"} p-values too small (false positives)</li>
                <li>{"•"} Confidence intervals too narrow</li>
              </ul>
            </div>
            <div className="bg-gray-900 text-gray-100 rounded-lg p-3 font-mono text-xs">
              <p className="text-green-400"># Quasi-Poisson in statsmodels</p>
              <p>model = sm.GLM(y, X, family=Poisson())</p>
              <p>result = model.fit(scale='X2')  <span className="text-gray-500"># estimate phi</span></p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                       SLIDE 117: GAMMA REGRESSION
// ═══════════════════════════════════════════════════════════════════════

function Slide117_GammaRegression() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-green-800">Gamma Regression</h1>
            <p className="text-gray-600">GLM for positive continuous data</p>
          </div>
    
          {/* Main content: Figure + Model spec */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Left: Figure */}
            <div className="flex flex-col">
              <div className="flex-1 flex items-center justify-center">
                <img 
                  src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/PartII/Chapter3/ch3_5_fig06_gamma_regression.png"
                  alt="Gamma regression showing positive skewed data with increasing variance"
                  className="max-h-114 object-contain rounded-lg shadow-lg"
                />
              </div>
              <p className="text-xs text-gray-600 text-center mt-2">
                <strong>Figure 3.5.6:</strong> Gamma data - positive, right-skewed, variance increasing with mean
              </p>
            </div>
    
            {/* Right: Model specification */}
            <div className="flex flex-col space-y-3">
              <div className="bg-green-50 border-2 border-green-200 rounded-xl p-3">
                <h3 className="font-bold text-green-800 mb-2 text-sm">Random Component</h3>
                <div className="bg-white rounded-lg p-2 text-center">
                  <Latex math="Y_i \sim \text{Gamma}(\alpha, \beta_i)" display={true} />
                </div>
                <p className="text-xs text-green-700 mt-1">
                  <Latex math="Y_i > 0" />, right-skewed, flexible shape
                </p>
              </div>
    
              <div className="bg-teal-50 border-2 border-teal-200 rounded-xl p-3">
                <h3 className="font-bold text-teal-800 mb-2 text-sm">Variance Function</h3>
                <div className="bg-white rounded-lg p-2 text-center">
                  <Latex math="V(\mu) = \mu^2, \quad \text{Var}(Y_i) = \phi \mu_i^2" display={true} />
                </div>
                <p className="text-xs text-teal-700 mt-1">
                  Constant CV: <Latex math="\text{CV} = \sigma/\mu = \sqrt{\phi}" />
                </p>
              </div>
    
              <div className="bg-blue-50 border-2 border-blue-200 rounded-xl p-3">
                <h3 className="font-bold text-blue-800 mb-2 text-sm">Link Functions</h3>
                <div className="grid grid-cols-2 gap-2 text-xs">
                  <div className="bg-white rounded p-2">
                    <span className="text-gray-500">Canonical:</span>
                    <p className="font-mono"><Latex math="g(\mu) = -1/\mu" /></p>
                    <span className="text-red-600">(rarely used)</span>
                  </div>
                  <div className="bg-white rounded p-2 border-2 border-green-300">
                    <span className="text-gray-500">Practical:</span>
                    <p className="font-mono"><Latex math="g(\mu) = \log(\mu)" /></p>
                    <span className="text-green-600 font-semibold">(preferred!)</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom: Key property and Python */}
          <div className="grid grid-cols-2 gap-3 mt-3">
            <div className="bg-gradient-to-r from-green-100 to-teal-100 rounded-lg p-3 border border-green-200">
              <p className="font-semibold text-green-800 text-sm mb-1">Constant CV Property</p>
              <p className="text-xs text-gray-700">
                If <Latex math="\text{SD}(Y)/\mathbb{E}[Y] \approx \text{constant}" /> across your data,
                Gamma is appropriate. Common in costs, claims, durations.
              </p>
            </div>
            <div className="bg-gray-900 text-gray-100 rounded-lg p-3 font-mono text-xs">
              <p className="text-green-400"># Gamma with log link</p>
              <p>model = sm.GLM(y, X,</p>
              <p>    family=sm.families.Gamma(</p>
              <p>        link=sm.families.links.Log()))</p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                      SLIDE 118: GAMMA APPLICATIONS
// ═══════════════════════════════════════════════════════════════════════

function Slide118_GammaApplications() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-emerald-800">Gamma Applications</h1>
            <p className="text-gray-600">Where Gamma regression excels</p>
          </div>
    
          {/* Main content: Application cards */}
          <div className="flex-1 grid grid-cols-3 gap-4">
            {/* Insurance */}
            <div className="bg-gradient-to-b from-blue-50 to-blue-100 border-2 border-blue-300 rounded-xl p-4">
              <div className="text-center mb-3">
                <span className="text-4xl">{"🏥"}</span>
              </div>
              <h3 className="font-bold text-blue-800 text-center mb-2">Insurance Claims</h3>
              <ul className="text-xs text-gray-700 space-y-1">
                <li>{"•"} Claim amounts given claim occurred</li>
                <li>{"•"} Right-skewed, positive</li>
                <li>{"•"} Larger claims more variable</li>
              </ul>
              <div className="mt-3 bg-white rounded p-2 text-xs text-center">
                <span className="text-blue-700">Two-part model:</span>
                <br />
                Logistic + Gamma
              </div>
            </div>
    
            {/* Medical Costs */}
            <div className="bg-gradient-to-b from-green-50 to-green-100 border-2 border-green-300 rounded-xl p-4">
              <div className="text-center mb-3">
                <span className="text-4xl">{"💰"}</span>
              </div>
              <h3 className="font-bold text-green-800 text-center mb-2">Medical Costs</h3>
              <ul className="text-xs text-gray-700 space-y-1">
                <li>{"•"} Hospital charges</li>
                <li>{"•"} Drug costs</li>
                <li>{"•"} Treatment expenses</li>
              </ul>
              <div className="mt-3 bg-white rounded p-2 text-xs text-center">
                <span className="text-green-700">CV often 0.5-1.5</span>
                <br />
                across patient groups
              </div>
            </div>
    
            {/* Duration/Survival */}
            <div className="bg-gradient-to-b from-purple-50 to-purple-100 border-2 border-purple-300 rounded-xl p-4">
              <div className="text-center mb-3">
                <span className="text-4xl">{"⏱️"}</span>
              </div>
              <h3 className="font-bold text-purple-800 text-center mb-2">Durations</h3>
              <ul className="text-xs text-gray-700 space-y-1">
                <li>{"•"} Waiting times</li>
                <li>{"•"} Time to failure</li>
                <li>{"•"} Service times</li>
              </ul>
              <div className="mt-3 bg-white rounded p-2 text-xs text-center">
                <span className="text-purple-700">Positive, often skewed</span>
                <br />
                variability scales with mean
              </div>
            </div>
          </div>
    
          {/* Interpretation */}
          <div className="bg-emerald-50 border border-emerald-200 rounded-xl p-4 mt-4">
            <h3 className="font-semibold text-emerald-800 mb-2">Interpretation with Log Link</h3>
            <div className="grid grid-cols-2 gap-4">
              <div className="text-sm">
                <p className="text-gray-700 mb-2">
                  With log link: <Latex math="\mu_i = \exp(\mathbf{x}_i^\top\boldsymbol{\beta})" />
                </p>
                <p className="text-gray-700">
                  <Latex math="e^{\beta_j}" /> = multiplicative effect on expected value
                </p>
              </div>
              <div className="bg-white rounded p-3 text-sm">
                <p className="text-gray-600 mb-1"><strong>Example:</strong></p>
                <p className="text-gray-700">
                  If <Latex math="\hat{\beta}_{\text{age}} = 0.03" />, then{" "}
                  <Latex math="e^{0.03} = 1.03" />
                  <br />
                  Each year increases expected cost by 3%
                </p>
              </div>
            </div>
          </div>
    
          {/* Bottom: Pattern summary */}
          <div className="flex-shrink-0 mt-3">
            <div className="bg-gray-100 rounded-lg p-3 border border-gray-300">
              <p className="text-sm text-gray-700 text-center">
                <strong>Pattern:</strong> Poisson (counts) + log link and Gamma (positive continuous) + log link
                both give multiplicative interpretations with <Latex math="e^{\beta}" />
              </p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                         SLIDE 119: THREE TESTS
// ═══════════════════════════════════════════════════════════════════════

function Slide119_ThreeTests() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-indigo-800">Three Test Statistics</h1>
            <p className="text-gray-600">Testing hypotheses in GLMs</p>
          </div>
    
          {/* Hypothesis */}
          <div className="bg-gray-100 rounded-lg p-3 mb-3 text-center">
            <span className="text-gray-700">Testing: </span>
            <Latex math="H_0: \beta_j = 0 \quad \text{vs} \quad H_1: \beta_j \neq 0" />
          </div>
    
          {/* Three tests */}
          <div className="flex-1 grid grid-cols-3 gap-3">
            {/* Wald */}
            <div className="bg-gradient-to-b from-blue-50 to-blue-100 border-2 border-blue-300 rounded-xl p-3">
              <h3 className="font-bold text-blue-800 text-center mb-2">Wald Test</h3>
              <div className="bg-white rounded-lg p-2 text-center mb-2">
                <Latex math="W = \frac{\hat{\beta}_j^2}{\widehat{\text{Var}}(\hat{\beta}_j)}" display={true} />
              </div>
              <p className="text-xs text-blue-700 text-center mb-2">
                <Latex math="W \sim \chi^2_1" /> under <Latex math="H_0" />
              </p>
              <div className="bg-blue-200 rounded p-2 text-xs">
                <p className="font-semibold text-blue-800">How it works:</p>
                <p className="text-blue-700">Fit full model. Is <Latex math="\hat{\beta}" /> far from 0 relative to its SE?</p>
              </div>
              <div className="mt-2 text-center">
                <span className="bg-blue-600 text-white px-2 py-1 rounded text-xs">At MLE</span>
              </div>
            </div>
    
            {/* Likelihood Ratio */}
            <div className="bg-gradient-to-b from-purple-50 to-purple-100 border-2 border-purple-300 rounded-xl p-3">
              <h3 className="font-bold text-purple-800 text-center mb-2">Likelihood Ratio</h3>
              <div className="bg-white rounded-lg p-2 text-center mb-2">
                <Latex math="\Lambda = 2[\ell(\hat{\boldsymbol{\beta}}) - \ell(\hat{\boldsymbol{\beta}}_0)]" display={true} />
              </div>
              <p className="text-xs text-purple-700 text-center mb-2">
                <Latex math="\Lambda \sim \chi^2_q" /> under <Latex math="H_0" />
              </p>
              <div className="bg-purple-200 rounded p-2 text-xs">
                <p className="font-semibold text-purple-800">How it works:</p>
                <p className="text-purple-700">Fit both models. How much better does full fit?</p>
              </div>
              <div className="mt-2 text-center">
                <span className="bg-purple-600 text-white px-2 py-1 rounded text-xs">Compares both</span>
              </div>
            </div>
    
            {/* Score */}
            <div className="bg-gradient-to-b from-emerald-50 to-emerald-100 border-2 border-emerald-300 rounded-xl p-3">
              <h3 className="font-bold text-emerald-800 text-center mb-2">Score Test</h3>
              <div className="bg-white rounded-lg p-2 text-center mb-2">
                <Latex math="S = \mathbf{U}_0^\top \mathbf{I}_0^{-1} \mathbf{U}_0" display={true} />
              </div>
              <p className="text-xs text-emerald-700 text-center mb-2">
                <Latex math="S \sim \chi^2_q" /> under <Latex math="H_0" />
              </p>
              <div className="bg-emerald-200 rounded p-2 text-xs">
                <p className="font-semibold text-emerald-800">How it works:</p>
                <p className="text-emerald-700">Fit null only. Is gradient at null far from 0?</p>
              </div>
              <div className="mt-2 text-center">
                <span className="bg-emerald-600 text-white px-2 py-1 rounded text-xs">At null</span>
              </div>
            </div>
          </div>
    
          {/* Bottom: Asymptotic equivalence */}
          <div className="flex-shrink-0 mt-3">
            <div className="bg-gradient-to-r from-indigo-100 to-purple-100 rounded-xl p-3 border border-indigo-200">
              <p className="text-center text-indigo-900">
                <strong>Asymptotic equivalence:</strong> As <Latex math="n \to \infty" />,
                all three give the same result. In finite samples, they can disagree -
                especially near boundaries or with sparse data.
              </p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                       SLIDE 11: NORMAL CONVERSION
// ═══════════════════════════════════════════════════════════════════════

function Slide11_NormalConversion() {
  return (
    <div className="flex flex-col h-full p-3">
          <h1 className="text-2xl font-bold text-gray-900 mb-1">Normal <Latex math="\rightarrow" /> Exponential Form</h1>
          <p className="text-gray-600 text-sm mb-2">Case 1: Known variance <Latex math="\sigma^2" /></p>
    
          {/* Starting point */}
          <div className="bg-blue-50 rounded-xl p-2 mb-2 border border-blue-200">
            <div className="font-semibold text-blue-800 text-sm mb-1">Starting Point: Normal PDF</div>
            <div className="bg-white rounded-lg p-2 text-center">
              <Latex math="f(x) = \frac{1}{\sqrt{2\pi\sigma^2}} \exp\left\{-\frac{(x-\mu)^2}{2\sigma^2}\right\}" display={true} />
            </div>
          </div>
    
          {/* Transformation steps */}
          <div className="bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-3 mb-2 border border-purple-200 flex-1">
            <div className="font-semibold text-purple-800 text-sm mb-2">Step-by-Step Conversion</div>
            <div className="space-y-2">
              <div className="flex items-center gap-3">
                <div className="bg-purple-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">1</div>
                <div className="bg-white rounded-lg p-2 flex-1 text-sm">
                  <span className="text-gray-500">Expand: </span>
                  <Latex math="-\frac{(x-\mu)^2}{2\sigma^2} = -\frac{x^2}{2\sigma^2} + \frac{\mu x}{\sigma^2} - \frac{\mu^2}{2\sigma^2}" />
                </div>
              </div>
              <div className="flex items-center gap-3">
                <div className="bg-purple-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">2</div>
                <div className="bg-white rounded-lg p-2 flex-1 text-sm">
                  <span className="text-gray-500">Identify <Latex math="\eta" />: </span>
                  <Latex math="\eta = \frac{\mu}{\sigma^2} \quad \Leftrightarrow \quad \mu = \sigma^2\eta" />
                </div>
              </div>
              <div className="flex items-center gap-3">
                <div className="bg-purple-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">3</div>
                <div className="bg-white rounded-lg p-2 flex-1 text-sm">
                  <span className="text-gray-500">Final: </span>
                  <Latex math="f(x) = \underbrace{\frac{e^{-x^2/(2\sigma^2)}}{\sqrt{2\pi\sigma^2}}}_{h(x)} \exp\left\{ x \cdot \eta - \frac{\sigma^2\eta^2}{2} \right\}" />
                </div>
              </div>
            </div>
          </div>
    
          {/* Components identified */}
          <div className="grid grid-cols-4 gap-2 mb-2">
            <div className="bg-blue-100 rounded-lg p-2 text-center">
              <div className="text-xs text-blue-600 mb-1">Sufficient Stat</div>
              <div className="font-mono text-blue-800"><Latex math="T(x) = x" /></div>
            </div>
            <div className="bg-purple-100 rounded-lg p-2 text-center">
              <div className="text-xs text-purple-600 mb-1">Natural Param</div>
              <div className="font-mono text-purple-800"><Latex math="\eta = \frac{\mu}{\sigma^2}" /></div>
            </div>
            <div className="bg-green-100 rounded-lg p-2 text-center">
              <div className="text-xs text-green-600 mb-1">Log-Partition</div>
              <div className="font-mono text-green-800"><Latex math="A(\eta) = \frac{\sigma^2\eta^2}{2}" /></div>
            </div>
            <div className="bg-amber-100 rounded-lg p-2 text-center">
              <div className="text-xs text-amber-600 mb-1">Carrier</div>
              <div className="font-mono text-amber-800 text-xs"><Latex math="\frac{e^{-x^2/(2\sigma^2)}}{\sqrt{2\pi\sigma^2}}" /></div>
            </div>
          </div>
    
          {/* Verification */}
          <div className="grid grid-cols-2 gap-2">
            <div className="bg-green-50 rounded-xl p-2 border border-green-200">
              <div className="font-semibold text-green-800 text-sm mb-1">Verify: Moments</div>
              <div className="space-y-1 text-sm">
                <div className="bg-white rounded p-1">
                  <Latex math="A'(\eta) = \sigma^2\eta = \mu" /> <span className="text-green-600">✓</span>
                </div>
                <div className="bg-white rounded p-1">
                  <Latex math="A''(\eta) = \sigma^2 = \text{Var}(X)" /> <span className="text-green-600">✓</span>
                </div>
              </div>
            </div>
    
            <div className="bg-pink-50 rounded-xl p-2 border border-pink-200">
              <div className="font-semibold text-pink-800 text-sm mb-1">GLM Connection</div>
              <div className="text-sm text-pink-700">
                Identity link is canonical:
                <div className="bg-white rounded p-1 mt-1 text-center">
                  <Latex math="\eta = \mu = \mathbf{x}^T\boldsymbol{\beta}" />
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                         SLIDE 120: TEST CHOICE
// ═══════════════════════════════════════════════════════════════════════

function Slide120_TestChoice() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-cyan-800">When to Use Which Test</h1>
            <p className="text-gray-600">Choosing among Wald, LR, and Score</p>
          </div>
    
          {/* Decision guide */}
          <div className="flex-1 grid grid-cols-3 gap-4">
            {/* LR - Recommended */}
            <div className="bg-gradient-to-b from-purple-100 to-purple-200 border-2 border-purple-400 rounded-xl p-4">
              <div className="text-center mb-2">
                <span className="bg-purple-600 text-white px-3 py-1 rounded-full text-sm font-bold">LR Test</span>
              </div>
              <div className="bg-white rounded-lg p-3 mb-3">
                <p className="font-bold text-purple-800 text-center text-sm">DEFAULT CHOICE</p>
              </div>
              <ul className="text-xs text-gray-700 space-y-1 mb-3">
                <li>{"•"} Most reliable in finite samples</li>
                <li>{"•"} Better behaved near boundaries</li>
                <li>{"•"} Invariant to parameterization</li>
                <li>{"•"} Gold standard for nested models</li>
              </ul>
              <div className="bg-purple-100 rounded p-2 text-xs text-purple-800">
                <strong>Downside:</strong> Must fit both models
              </div>
            </div>
    
            {/* Wald */}
            <div className="bg-gradient-to-b from-blue-50 to-blue-100 border-2 border-blue-300 rounded-xl p-4">
              <div className="text-center mb-2">
                <span className="bg-blue-600 text-white px-3 py-1 rounded-full text-sm font-bold">Wald Test</span>
              </div>
              <div className="bg-white rounded-lg p-3 mb-3">
                <p className="font-bold text-blue-800 text-center text-sm">QUICK & EASY</p>
              </div>
              <ul className="text-xs text-gray-700 space-y-1 mb-3">
                <li>{"•"} Already computed in summary()</li>
                <li>{"•"} Fast - just one model fit</li>
                <li>{"•"} Good with large samples</li>
                <li>{"•"} Standard output from glm()</li>
              </ul>
              <div className="bg-red-100 rounded p-2 text-xs text-red-800">
                <strong>Caution:</strong> Unreliable near boundaries, separation, small samples
              </div>
            </div>
    
            {/* Score */}
            <div className="bg-gradient-to-b from-emerald-50 to-emerald-100 border-2 border-emerald-300 rounded-xl p-4">
              <div className="text-center mb-2">
                <span className="bg-emerald-600 text-white px-3 py-1 rounded-full text-sm font-bold">Score Test</span>
              </div>
              <div className="bg-white rounded-lg p-3 mb-3">
                <p className="font-bold text-emerald-800 text-center text-sm">SPECIAL CASES</p>
              </div>
              <ul className="text-xs text-gray-700 space-y-1 mb-3">
                <li>{"•"} Only fit null model</li>
                <li>{"•"} Useful when full model hard to fit</li>
                <li>{"•"} Good for screening many variables</li>
                <li>{"•"} GWAS, high-dimensional settings</li>
              </ul>
              <div className="bg-emerald-100 rounded p-2 text-xs text-emerald-800">
                <strong>Use case:</strong> Testing 1000s of variants in genomics
              </div>
            </div>
          </div>
    
          {/* Summary table */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-gray-100 rounded-xl p-3">
              <table className="w-full text-sm">
                <thead>
                  <tr className="text-gray-600">
                    <th className="text-left p-1">Situation</th>
                    <th className="text-center p-1">Recommendation</th>
                  </tr>
                </thead>
                <tbody className="text-gray-700">
                  <tr className="border-t border-gray-300">
                    <td className="p-1">General purpose, nested model comparison</td>
                    <td className="text-center p-1 font-semibold text-purple-700">LR</td>
                  </tr>
                  <tr className="border-t border-gray-300">
                    <td className="p-1">Quick look, large sample, well-behaved data</td>
                    <td className="text-center p-1 font-semibold text-blue-700">Wald</td>
                  </tr>
                  <tr className="border-t border-gray-300">
                    <td className="p-1">Full model unstable or expensive to fit</td>
                    <td className="text-center p-1 font-semibold text-emerald-700">Score</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                     SLIDE 121: CONFIDENCE INTERVALS
// ═══════════════════════════════════════════════════════════════════════

function Slide121_ConfidenceIntervals() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-rose-800">Confidence Intervals</h1>
            <p className="text-gray-600">Wald and profile likelihood intervals</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-5">
            {/* Left: Wald CI */}
            <div className="flex flex-col space-y-3">
              <div className="bg-blue-50 border-2 border-blue-200 rounded-xl p-4 flex-1">
                <h3 className="font-bold text-blue-800 mb-2">Wald Confidence Interval</h3>
                <div className="bg-white rounded-lg p-3 text-center mb-3">
                  <Latex math="\hat{\beta}_j \pm z_{\alpha/2} \cdot \text{SE}(\hat{\beta}_j)" display={true} />
                </div>
                <ul className="text-xs text-gray-700 space-y-1">
                  <li>{"•"} Symmetric around <Latex math="\hat{\beta}" /></li>
                  <li>{"•"} Easy to compute (from summary)</li>
                  <li>{"•"} Based on normal approximation</li>
                  <li>{"•"} Can be poor near boundaries</li>
                </ul>
                <div className="mt-3 bg-blue-100 rounded p-2 text-xs">
                  <p className="font-mono text-blue-800">result.conf_int()</p>
                </div>
              </div>
            </div>
    
            {/* Right: Profile CI */}
            <div className="flex flex-col space-y-3">
              <div className="bg-purple-50 border-2 border-purple-200 rounded-xl p-4 flex-1">
                <h3 className="font-bold text-purple-800 mb-2">Profile Likelihood CI</h3>
                <div className="bg-white rounded-lg p-3 text-center mb-3">
                  <Latex math="\left\{\beta_j : 2[\ell(\hat{\boldsymbol{\beta}}) - \ell_p(\beta_j)] \leq \chi^2_{1,\alpha}\right\}" display={true} />
                </div>
                <ul className="text-xs text-gray-700 space-y-1">
                  <li>{"•"} Can be asymmetric</li>
                  <li>{"•"} Inverts LR test</li>
                  <li>{"•"} Better for small samples</li>
                  <li>{"•"} More computation required</li>
                </ul>
                <div className="mt-3 bg-purple-100 rounded p-2 text-xs text-purple-800">
                  Not built into statsmodels GLM
                </div>
              </div>
            </div>
          </div>
    
          {/* Back-transformation */}
          <div className="bg-gradient-to-r from-rose-100 to-pink-100 border-2 border-rose-300 rounded-xl p-4 mt-4">
            <h3 className="font-bold text-rose-800 mb-2">Back-transformation for Odds/Rate Ratios</h3>
            <div className="grid grid-cols-2 gap-4">
              <div>
                <p className="text-sm text-gray-700 mb-2">CI for <Latex math="\beta" /> (log scale):</p>
                <div className="bg-white rounded p-2 text-center">
                  <Latex math="(\hat{\beta}_L, \hat{\beta}_U)" />
                </div>
              </div>
              <div>
                <p className="text-sm text-gray-700 mb-2">CI for OR/RR (original scale):</p>
                <div className="bg-white rounded p-2 text-center">
                  <Latex math="(e^{\hat{\beta}_L}, e^{\hat{\beta}_U})" />
                </div>
              </div>
            </div>
            <p className="text-xs text-rose-700 mt-2">
              <strong>Note:</strong> Exponentiate the endpoints, not the midpoint. Works because exp() is monotonic.
            </p>
          </div>
    
          {/* Bottom: Python example */}
          <div className="flex-shrink-0 mt-3">
            <div className="bg-gray-900 text-gray-100 rounded-lg p-3 font-mono text-xs">
              <span className="text-green-400"># Confidence interval for odds ratio</span>
              <br />
              ci = result.conf_int().iloc[1]  <span className="text-gray-500"># CI for beta_1</span>
              <br />
              print(f"95% CI for OR: ({"{"}np.exp(ci[0]):.2f{"}"}, {"{"}np.exp(ci[1]):.2f{"}"})")
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                           SLIDE 122: DEVIANCE
// ═══════════════════════════════════════════════════════════════════════

function Slide122_Deviance() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-violet-800">Deviance</h1>
            <p className="text-gray-600">Measuring goodness of fit</p>
          </div>
    
          {/* Main definition */}
          <div className="bg-violet-50 border-2 border-violet-300 rounded-xl p-4 mb-4">
            <div className="text-center">
              <Latex math="D = 2\phi\left[\ell(\text{saturated}) - \ell(\hat{\boldsymbol{\beta}})\right] = 2\sum_{i=1}^n d_i" display={true} />
            </div>
            <p className="text-sm text-violet-700 text-center mt-2">
              Twice the log-likelihood difference between saturated and fitted models
            </p>
          </div>
    
          {/* Two columns */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Left: Specific formulas */}
            <div className="flex flex-col space-y-3">
              <div className="bg-white border border-gray-200 rounded-xl p-3">
                <h3 className="font-bold text-gray-800 mb-2 text-sm">Deviance by Family</h3>
                <div className="space-y-2 text-xs">
                  <div className="bg-gray-50 rounded p-2">
                    <span className="font-semibold text-gray-700">Normal:</span>
                    <div className="text-center mt-1">
                      <Latex math="D = \sum(y_i - \hat{\mu}_i)^2 = \text{RSS}" />
                    </div>
                  </div>
                  <div className="bg-gray-50 rounded p-2">
                    <span className="font-semibold text-gray-700">Poisson:</span>
                    <div className="text-center mt-1">
                      <Latex math="D = 2\sum\left[y_i\log\frac{y_i}{\hat{\mu}_i} - (y_i - \hat{\mu}_i)\right]" />
                    </div>
                  </div>
                  <div className="bg-gray-50 rounded p-2">
                    <span className="font-semibold text-gray-700">Binomial:</span>
                    <div className="text-center mt-1">
                      <Latex math="D = 2\sum\left[y_i\log\frac{y_i}{\hat{\mu}_i} + (n_i-y_i)\log\frac{n_i-y_i}{n_i-\hat{\mu}_i}\right]" />
                    </div>
                  </div>
                </div>
              </div>
    
              <div className="bg-amber-50 border border-amber-200 rounded-lg p-3">
                <h4 className="font-semibold text-amber-800 text-sm mb-1">Goodness of Fit Test</h4>
                <p className="text-xs text-gray-700">
                  Under <Latex math="H_0" />: model is adequate,
                </p>
                <div className="text-center my-1">
                  <Latex math="D \stackrel{\text{approx}}{\sim} \chi^2_{n-p}" />
                </div>
                <p className="text-xs text-amber-700">
                  <strong>Caution:</strong> Only reliable for grouped data or large counts per cell
                </p>
              </div>
            </div>
    
            {/* Right: Model comparison */}
            <div className="flex flex-col">
              <div className="bg-gradient-to-b from-purple-50 to-violet-50 border-2 border-purple-300 rounded-xl p-4 flex-1">
                <h3 className="font-bold text-purple-800 mb-3">Model Comparison</h3>
                
                <div className="bg-white rounded-lg p-3 mb-3">
                  <p className="text-sm text-gray-700 mb-2">For nested models:</p>
                  <div className="text-center">
                    <Latex math="\Delta D = D_{\text{reduced}} - D_{\text{full}}" display={true} />
                  </div>
                  <div className="text-center mt-2">
                    <Latex math="\Delta D \sim \chi^2_q" />
                  </div>
                  <p className="text-xs text-gray-600 mt-1">
                    where <Latex math="q" /> = number of parameters dropped
                  </p>
                </div>
    
                <div className="bg-purple-100 rounded p-3 text-sm">
                  <p className="font-semibold text-purple-800 mb-1">This IS the LR test!</p>
                  <p className="text-purple-700 text-xs">
                    Deviance difference = 2 times log-likelihood ratio
                  </p>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom: Python */}
          <div className="flex-shrink-0 mt-3">
            <div className="bg-gray-900 text-gray-100 rounded-lg p-3 font-mono text-xs">
              <span className="text-gray-500"># In statsmodels</span>
              <br />
              result.deviance  <span className="text-gray-500"># deviance of fitted model</span>
              <br />
              result.null_deviance  <span className="text-gray-500"># deviance of null model (intercept only)</span>
              <br />
              result.df_resid  <span className="text-gray-500"># residual degrees of freedom (n - p)</span>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                        SLIDE 123: RESIDUAL TYPES
// ═══════════════════════════════════════════════════════════════════════

function Slide123_ResidualTypes() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-teal-800">Residual Types</h1>
            <p className="text-gray-600">Standardizing residuals for GLM diagnostics</p>
          </div>
    
          {/* Residual types grid */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Response residuals */}
            <div className="bg-gray-50 border border-gray-200 rounded-xl p-4">
              <h3 className="font-bold text-gray-800 mb-2">Response (Raw)</h3>
              <div className="bg-white rounded-lg p-3 text-center mb-2">
                <Latex math="e_i^R = y_i - \hat{\mu}_i" display={true} />
              </div>
              <ul className="text-xs text-gray-600 space-y-1">
                <li>{"•"} Simple difference</li>
                <li>{"•"} Has non-constant variance</li>
                <li>{"•"} Rarely used for diagnostics</li>
              </ul>
            </div>
    
            {/* Pearson residuals */}
            <div className="bg-blue-50 border-2 border-blue-300 rounded-xl p-4">
              <h3 className="font-bold text-blue-800 mb-2">Pearson</h3>
              <div className="bg-white rounded-lg p-3 text-center mb-2">
                <Latex math="e_i^P = \frac{y_i - \hat{\mu}_i}{\sqrt{V(\hat{\mu}_i)}}" display={true} />
              </div>
              <ul className="text-xs text-blue-700 space-y-1">
                <li>{"•"} Standardized by variance function</li>
                <li>{"•"} <Latex math="\sum (e_i^P)^2 = \chi^2_P" /></li>
                <li>{"•"} Used for overdispersion test</li>
              </ul>
            </div>
    
            {/* Deviance residuals */}
            <div className="bg-purple-50 border-2 border-purple-300 rounded-xl p-4">
              <h3 className="font-bold text-purple-800 mb-2">Deviance</h3>
              <div className="bg-white rounded-lg p-3 text-center mb-2">
                <Latex math="e_i^D = \text{sign}(y_i - \hat{\mu}_i) \sqrt{d_i}" display={true} />
              </div>
              <ul className="text-xs text-purple-700 space-y-1">
                <li>{"•"} Signed sqrt of deviance contribution</li>
                <li>{"•"} <Latex math="\sum (e_i^D)^2 = D" /></li>
                <li>{"•"} Often more symmetric than Pearson</li>
              </ul>
            </div>
    
            {/* Standardized deviance */}
            <div className="bg-gradient-to-b from-emerald-50 to-teal-50 border-2 border-emerald-400 rounded-xl p-4">
              <h3 className="font-bold text-emerald-800 mb-2">Standardized Deviance</h3>
              <div className="bg-white rounded-lg p-3 text-center mb-2">
                <Latex math="r_i^D = \frac{e_i^D}{\sqrt{\hat{\phi}(1-h_{ii})}}" display={true} />
              </div>
              <ul className="text-xs text-emerald-700 space-y-1">
                <li>{"•"} Accounts for leverage</li>
                <li>{"•"} <strong>Best for diagnostic plots</strong></li>
                <li>{"•"} Should be approximately N(0,1)</li>
              </ul>
            </div>
          </div>
    
          {/* Bottom: Practical guidance */}
          <div className="flex-shrink-0 mt-3">
            <div className="bg-gray-100 rounded-xl p-3">
              <div className="grid grid-cols-3 gap-3 text-center text-sm">
                <div>
                  <p className="font-semibold text-gray-700">statsmodels</p>
                  <p className="text-xs text-gray-600 font-mono">result.resid_deviance</p>
                </div>
                <div>
                  <p className="font-semibold text-gray-700">Pearson</p>
                  <p className="text-xs text-gray-600 font-mono">result.resid_pearson</p>
                </div>
                <div>
                  <p className="font-semibold text-gray-700">Recommendation</p>
                  <p className="text-xs text-emerald-700">Use deviance for plots</p>
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                       SLIDE 124: DIAGNOSTIC PLOTS
// ═══════════════════════════════════════════════════════════════════════

function Slide124_DiagnosticPlots() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-teal-800">Diagnostic Plots</h1>
            <p className="text-gray-600">Visual model assessment for GLMs</p>
          </div>
    
          {/* Figure */}
          <div className="flex-1 flex flex-col items-center justify-center">
            <img 
              src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/PartII/Chapter3/ch3_5_fig07_glm_diagnostics.png"
              alt="GLM diagnostic plots showing residuals vs fitted and Q-Q plot"
              className="max-h-52 object-contain rounded-lg shadow-lg"
            />
            <p className="text-xs text-gray-600 text-center mt-2 max-w-2xl">
              <strong>Figure 3.5.7:</strong> (a) Deviance residuals vs. fitted values - check for patterns.
              (b) Q-Q plot - check for approximate normality of deviance residuals.
            </p>
          </div>
    
          {/* Diagnostic checklist */}
          <div className="grid grid-cols-3 gap-3 mt-3">
            <div className="bg-teal-50 border border-teal-200 rounded-lg p-3">
              <p className="font-bold text-teal-800 text-sm mb-1">Residuals vs Fitted</p>
              <ul className="text-xs text-gray-700 space-y-0.5">
                <li>{"•"} Random scatter = good</li>
                <li>{"•"} Curve = wrong link/missing terms</li>
                <li>{"•"} Fan shape = heteroscedasticity</li>
              </ul>
            </div>
    
            <div className="bg-blue-50 border border-blue-200 rounded-lg p-3">
              <p className="font-bold text-blue-800 text-sm mb-1">Q-Q Plot</p>
              <ul className="text-xs text-gray-700 space-y-0.5">
                <li>{"•"} Straight line = good fit</li>
                <li>{"•"} S-curve = wrong family</li>
                <li>{"•"} Outliers = influential points</li>
              </ul>
            </div>
    
            <div className="bg-purple-50 border border-purple-200 rounded-lg p-3">
              <p className="font-bold text-purple-800 text-sm mb-1">For Logistic</p>
              <ul className="text-xs text-gray-700 space-y-0.5">
                <li>{"•"} Use binned residuals</li>
                <li>{"•"} Group by predicted probability</li>
                <li>{"•"} Check calibration</li>
              </ul>
            </div>
          </div>
    
          {/* Bottom: Python code */}
          <div className="flex-shrink-0 mt-3">
            <div className="bg-gray-900 text-gray-100 rounded-lg p-2 font-mono text-xs">
              <span className="text-green-400"># After fitting: result = model.fit()</span>
              <br />
              <span className="text-blue-300">import</span> statsmodels.api <span className="text-blue-300">as</span> sm
              <br />
              sm.graphics.plot_regress_exog(result, <span className="text-yellow-300">'x1'</span>)  <span className="text-green-400"># Multiple diagnostics</span>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                       SLIDE 125: MODEL SELECTION
// ═══════════════════════════════════════════════════════════════════════

function Slide125_ModelSelection() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-indigo-800">Model Selection</h1>
            <p className="text-gray-600">AIC, BIC, and model comparison</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-6">
            {/* Left: AIC */}
            <div className="bg-gradient-to-b from-blue-50 to-indigo-50 border-2 border-blue-300 rounded-xl p-4">
              <h3 className="font-bold text-blue-800 mb-3">Akaike Information Criterion</h3>
              
              <div className="bg-white rounded-lg p-3 text-center mb-3 border border-blue-200">
                <Latex math="\text{AIC} = -2\ell(\hat{\boldsymbol{\beta}}) + 2p" display={true} />
              </div>
    
              <div className="space-y-2 text-sm">
                <div className="flex items-center gap-2">
                  <span className="bg-blue-200 text-blue-800 px-2 py-0.5 rounded text-xs">Penalty</span>
                  <span className="text-gray-700">2 per parameter</span>
                </div>
                <div className="flex items-center gap-2">
                  <span className="bg-blue-200 text-blue-800 px-2 py-0.5 rounded text-xs">Goal</span>
                  <span className="text-gray-700">Prediction accuracy</span>
                </div>
                <div className="flex items-center gap-2">
                  <span className="bg-blue-200 text-blue-800 px-2 py-0.5 rounded text-xs">Tends to</span>
                  <span className="text-gray-700">Larger models</span>
                </div>
              </div>
    
              <div className="mt-3 bg-blue-100 rounded p-2 text-xs text-blue-800">
                Based on Kullback-Leibler divergence minimization
              </div>
            </div>
    
            {/* Right: BIC */}
            <div className="bg-gradient-to-b from-purple-50 to-violet-50 border-2 border-purple-300 rounded-xl p-4">
              <h3 className="font-bold text-purple-800 mb-3">Bayesian Information Criterion</h3>
              
              <div className="bg-white rounded-lg p-3 text-center mb-3 border border-purple-200">
                <Latex math="\text{BIC} = -2\ell(\hat{\boldsymbol{\beta}}) + p\log(n)" display={true} />
              </div>
    
              <div className="space-y-2 text-sm">
                <div className="flex items-center gap-2">
                  <span className="bg-purple-200 text-purple-800 px-2 py-0.5 rounded text-xs">Penalty</span>
                  <span className="text-gray-700"><Latex math="\log(n)" /> per parameter</span>
                </div>
                <div className="flex items-center gap-2">
                  <span className="bg-purple-200 text-purple-800 px-2 py-0.5 rounded text-xs">Goal</span>
                  <span className="text-gray-700">Identify true model</span>
                </div>
                <div className="flex items-center gap-2">
                  <span className="bg-purple-200 text-purple-800 px-2 py-0.5 rounded text-xs">Tends to</span>
                  <span className="text-gray-700">Simpler models</span>
                </div>
              </div>
    
              <div className="mt-3 bg-purple-100 rounded p-2 text-xs text-purple-800">
                Asymptotically consistent for model selection
              </div>
            </div>
          </div>
    
          {/* Delta rule */}
          <div className="mt-4">
            <div className="bg-amber-50 border border-amber-200 rounded-xl p-4">
              <h3 className="font-bold text-amber-800 mb-2">The Delta-2 Rule for Interpretation</h3>
              <div className="grid grid-cols-3 gap-3 text-center text-sm">
                <div className="bg-white rounded p-2">
                  <p className="font-semibold text-gray-700"><Latex math="\Delta < 2" /></p>
                  <p className="text-xs text-gray-500">Essentially equivalent</p>
                </div>
                <div className="bg-white rounded p-2">
                  <p className="font-semibold text-gray-700"><Latex math="4 \leq \Delta \leq 7" /></p>
                  <p className="text-xs text-gray-500">Moderate evidence</p>
                </div>
                <div className="bg-white rounded p-2">
                  <p className="font-semibold text-gray-700"><Latex math="\Delta > 10" /></p>
                  <p className="text-xs text-gray-500">Strong evidence</p>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom: Python */}
          <div className="flex-shrink-0 mt-3">
            <div className="bg-gray-100 rounded-lg p-2 text-xs font-mono text-gray-700">
              result.aic  <span className="text-gray-500"># AIC</span> | result.bic  <span className="text-gray-500"># BIC</span> | result.deviance  <span className="text-gray-500"># Deviance</span>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                        SLIDE 126: GLM FLOWCHART
// ═══════════════════════════════════════════════════════════════════════

function Slide126_GLMFlowchart() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-violet-800">GLM Decision Flowchart</h1>
            <p className="text-gray-600">Choosing the right model for your data</p>
          </div>
    
          {/* Flowchart */}
          <div className="flex-1 flex flex-col items-center justify-center">
            {/* Start */}
            <div className="bg-violet-600 text-white px-6 py-2 rounded-full font-bold mb-3">
              What is your response type?
            </div>
    
            {/* Branches */}
            <div className="grid grid-cols-4 gap-4 w-full max-w-4xl">
              {/* Binary */}
              <div className="flex flex-col items-center">
                <div className="w-0.5 h-6 bg-violet-400"></div>
                <div className="bg-red-100 border-2 border-red-300 rounded-xl p-3 text-center w-full">
                  <p className="font-bold text-red-800">Binary</p>
                  <p className="text-xs text-red-600">0/1, Yes/No</p>
                </div>
                <div className="w-0.5 h-4 bg-red-400"></div>
                <div className="bg-red-50 border border-red-200 rounded-lg p-2 text-center w-full">
                  <p className="text-sm font-semibold">Bernoulli</p>
                  <p className="text-xs text-gray-600">Logit link</p>
                </div>
                <div className="w-0.5 h-4 bg-red-400"></div>
                <div className="bg-white border border-gray-300 rounded p-1 text-xs text-center">
                  <Latex math="e^{\beta}" /> = odds ratio
                </div>
              </div>
    
              {/* Counts */}
              <div className="flex flex-col items-center">
                <div className="w-0.5 h-6 bg-violet-400"></div>
                <div className="bg-amber-100 border-2 border-amber-300 rounded-xl p-3 text-center w-full">
                  <p className="font-bold text-amber-800">Counts</p>
                  <p className="text-xs text-amber-600">0, 1, 2, ...</p>
                </div>
                <div className="w-0.5 h-4 bg-amber-400"></div>
                <div className="bg-amber-50 border border-amber-200 rounded-lg p-2 text-center w-full">
                  <p className="text-sm font-semibold">Poisson</p>
                  <p className="text-xs text-gray-600">Log link</p>
                </div>
                <div className="w-0.5 h-4 bg-amber-400"></div>
                <div className="bg-white border border-gray-300 rounded p-1 text-xs text-center">
                  <Latex math="e^{\beta}" /> = rate ratio
                </div>
              </div>
    
              {/* Positive */}
              <div className="flex flex-col items-center">
                <div className="w-0.5 h-6 bg-violet-400"></div>
                <div className="bg-green-100 border-2 border-green-300 rounded-xl p-3 text-center w-full">
                  <p className="font-bold text-green-800">Positive</p>
                  <p className="text-xs text-green-600">{"> 0, continuous"}</p>
                </div>
                <div className="w-0.5 h-4 bg-green-400"></div>
                <div className="bg-green-50 border border-green-200 rounded-lg p-2 text-center w-full">
                  <p className="text-sm font-semibold">Gamma</p>
                  <p className="text-xs text-gray-600">Log link (usually)</p>
                </div>
                <div className="w-0.5 h-4 bg-green-400"></div>
                <div className="bg-white border border-gray-300 rounded p-1 text-xs text-center">
                  Constant CV
                </div>
              </div>
    
              {/* Unbounded */}
              <div className="flex flex-col items-center">
                <div className="w-0.5 h-6 bg-violet-400"></div>
                <div className="bg-blue-100 border-2 border-blue-300 rounded-xl p-3 text-center w-full">
                  <p className="font-bold text-blue-800">Unbounded</p>
                  <p className="text-xs text-blue-600">Any real value</p>
                </div>
                <div className="w-0.5 h-4 bg-blue-400"></div>
                <div className="bg-blue-50 border border-blue-200 rounded-lg p-2 text-center w-full">
                  <p className="text-sm font-semibold">Normal</p>
                  <p className="text-xs text-gray-600">Identity link</p>
                </div>
                <div className="w-0.5 h-4 bg-blue-400"></div>
                <div className="bg-white border border-gray-300 rounded p-1 text-xs text-center">
                  = OLS!
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom: Special cases */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-gray-100 rounded-xl p-3">
              <div className="grid grid-cols-2 gap-4 text-sm">
                <div>
                  <p className="font-semibold text-gray-700">Overdispersed counts?</p>
                  <p className="text-xs text-gray-600">Use quasi-Poisson or Negative Binomial</p>
                </div>
                <div>
                  <p className="font-semibold text-gray-700">Rare events / separation?</p>
                  <p className="text-xs text-gray-600">Use Firth's penalized likelihood</p>
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                         SLIDE 127: GLM SUMMARY
// ═══════════════════════════════════════════════════════════════════════

function Slide127_GLMSummary() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-violet-800">Section 3.5 Summary</h1>
            <p className="text-gray-600">Generalized Linear Models</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-6">
            {/* Left: Key concepts */}
            <div className="space-y-3">
              <div className="bg-violet-50 border-l-4 border-violet-500 rounded-r-lg p-3">
                <h3 className="font-bold text-violet-800 mb-1">Three Components</h3>
                <div className="text-sm text-gray-700">
                  <p><strong>Random:</strong> <Latex math="Y_i \sim \text{ExpFamily}(\mu_i)" /></p>
                  <p><strong>Systematic:</strong> <Latex math="\eta_i = \mathbf{x}_i^\top\boldsymbol{\beta}" /></p>
                  <p><strong>Link:</strong> <Latex math="g(\mu_i) = \eta_i" /></p>
                </div>
              </div>
    
              <div className="bg-blue-50 border-l-4 border-blue-500 rounded-r-lg p-3">
                <h3 className="font-bold text-blue-800 mb-1">IRLS Algorithm</h3>
                <p className="text-sm text-gray-700">
                  Fisher scoring = Iteratively Reweighted Least Squares.
                  Each step solves WLS. Quadratic convergence for canonical links.
                </p>
              </div>
    
              <div className="bg-emerald-50 border-l-4 border-emerald-500 rounded-r-lg p-3">
                <h3 className="font-bold text-emerald-800 mb-1">Canonical Links</h3>
                <p className="text-sm text-gray-700">
                  Set <Latex math="\eta = \theta" />. Concave likelihood, simplified score,
                  observed = expected information. But not always optimal!
                </p>
              </div>
            </div>
    
            {/* Right: Applications table */}
            <div className="bg-white border-2 border-gray-200 rounded-xl p-4">
              <h3 className="font-bold text-gray-800 mb-3 text-center">GLM Quick Reference</h3>
              <table className="w-full text-xs">
                <thead>
                  <tr className="bg-gray-100">
                    <th className="p-1.5 text-left">Response</th>
                    <th className="p-1.5">Family</th>
                    <th className="p-1.5">Link</th>
                    <th className="p-1.5 text-left"><Latex math="e^{\beta}" /></th>
                  </tr>
                </thead>
                <tbody>
                  <tr className="border-b border-gray-100">
                    <td className="p-1.5">Binary</td>
                    <td className="p-1.5 text-center">Bernoulli</td>
                    <td className="p-1.5 text-center">Logit</td>
                    <td className="p-1.5">Odds ratio</td>
                  </tr>
                  <tr className="border-b border-gray-100">
                    <td className="p-1.5">Counts</td>
                    <td className="p-1.5 text-center">Poisson</td>
                    <td className="p-1.5 text-center">Log</td>
                    <td className="p-1.5">Rate ratio</td>
                  </tr>
                  <tr className="border-b border-gray-100">
                    <td className="p-1.5">Positive</td>
                    <td className="p-1.5 text-center">Gamma</td>
                    <td className="p-1.5 text-center">Log</td>
                    <td className="p-1.5">Multiplicative</td>
                  </tr>
                  <tr>
                    <td className="p-1.5">Continuous</td>
                    <td className="p-1.5 text-center">Normal</td>
                    <td className="p-1.5 text-center">Identity</td>
                    <td className="p-1.5">N/A (additive)</td>
                  </tr>
                </tbody>
              </table>
    
              <div className="mt-3 pt-3 border-t border-gray-200 text-xs text-gray-600">
                <p><strong>Diagnostics:</strong> Deviance residuals, AIC/BIC</p>
                <p><strong>Watch for:</strong> Separation, overdispersion</p>
              </div>
            </div>
          </div>
    
          {/* Bottom: Connection forward */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-gradient-to-r from-violet-100 to-purple-100 rounded-xl p-3 border border-violet-200">
              <p className="text-center text-violet-900 text-sm">
                <strong>Looking ahead:</strong> Chapter 4 (Bootstrap) extends inference for GLMs when asymptotics are unreliable.
                Chapter 5 (Bayesian) replaces MLE with posterior distributions for GLM parameters.
              </p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                      SLIDE 128: INFERENCE PIPELINE
// ═══════════════════════════════════════════════════════════════════════

function Slide128_InferencePipeline() {
  return (
    <div className="h-full flex flex-col bg-gradient-to-br from-slate-800 via-slate-700 to-slate-900 text-white p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4 text-center">
            <div className="inline-block bg-white/10 backdrop-blur rounded-full px-4 py-1 mb-2">
              <span className="text-slate-200 font-mono text-sm">Chapter 3 Summary</span>
            </div>
            <h1 className="text-4xl font-bold mb-2">The Parametric Inference Pipeline</h1>
            <p className="text-xl text-slate-300">From model to inference</p>
          </div>
    
          {/* Pipeline flowchart */}
          <div className="flex-1 flex items-center justify-center">
            <div className="flex items-center gap-3 w-full max-w-4xl">
              {/* Step 1: Model */}
              <div className="flex-1 bg-blue-500/20 backdrop-blur rounded-xl p-4 border border-blue-400/30">
                <div className="text-center">
                  <div className="text-3xl mb-2">{"📐"}</div>
                  <h3 className="font-bold text-blue-200 mb-1">Model</h3>
                  <p className="text-xs text-blue-100 mb-2">Section 3.1</p>
                  <div className="bg-white/10 rounded p-2 text-xs">
                    <Latex math="f(y|\theta)" />
                    <p className="text-blue-200 mt-1">Exponential Family</p>
                  </div>
                </div>
              </div>
    
              <div className="text-2xl text-slate-400">{"→"}</div>
    
              {/* Step 2: Estimate */}
              <div className="flex-1 bg-emerald-500/20 backdrop-blur rounded-xl p-4 border border-emerald-400/30">
                <div className="text-center">
                  <div className="text-3xl mb-2">{"📈"}</div>
                  <h3 className="font-bold text-emerald-200 mb-1">Estimate</h3>
                  <p className="text-xs text-emerald-100 mb-2">Section 3.2</p>
                  <div className="bg-white/10 rounded p-2 text-xs">
                    <Latex math="\hat{\theta}_{MLE}" />
                    <p className="text-emerald-200 mt-1">Maximum Likelihood</p>
                  </div>
                </div>
              </div>
    
              <div className="text-2xl text-slate-400">{"→"}</div>
    
              {/* Step 3: Uncertainty */}
              <div className="flex-1 bg-purple-500/20 backdrop-blur rounded-xl p-4 border border-purple-400/30">
                <div className="text-center">
                  <div className="text-3xl mb-2">{"📊"}</div>
                  <h3 className="font-bold text-purple-200 mb-1">Uncertainty</h3>
                  <p className="text-xs text-purple-100 mb-2">Section 3.3</p>
                  <div className="bg-white/10 rounded p-2 text-xs">
                    <Latex math="\text{SE}(\hat{\theta})" />
                    <p className="text-purple-200 mt-1">Fisher Info, Delta</p>
                  </div>
                </div>
              </div>
    
              <div className="text-2xl text-slate-400">{"→"}</div>
    
              {/* Step 4: Inference */}
              <div className="flex-1 bg-amber-500/20 backdrop-blur rounded-xl p-4 border border-amber-400/30">
                <div className="text-center">
                  <div className="text-3xl mb-2">{"🎯"}</div>
                  <h3 className="font-bold text-amber-200 mb-1">Inference</h3>
                  <p className="text-xs text-amber-100 mb-2">Sections 3.4-3.5</p>
                  <div className="bg-white/10 rounded p-2 text-xs">
                    <Latex math="\text{CI}, \text{Tests}" />
                    <p className="text-amber-200 mt-1">Linear & GLMs</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom: Five pillars */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-white/10 backdrop-blur rounded-xl p-4">
              <h3 className="font-bold text-center text-slate-200 mb-3">Five Pillars of Chapter 3</h3>
              <div className="grid grid-cols-5 gap-2 text-center text-xs">
                <div className="bg-blue-500/30 rounded-lg p-2">
                  <p className="font-semibold">3.1</p>
                  <p className="text-slate-300">Exp Families</p>
                </div>
                <div className="bg-emerald-500/30 rounded-lg p-2">
                  <p className="font-semibold">3.2</p>
                  <p className="text-slate-300">MLE</p>
                </div>
                <div className="bg-purple-500/30 rounded-lg p-2">
                  <p className="font-semibold">3.3</p>
                  <p className="text-slate-300">Variability</p>
                </div>
                <div className="bg-teal-500/30 rounded-lg p-2">
                  <p className="font-semibold">3.4</p>
                  <p className="text-slate-300">Linear</p>
                </div>
                <div className="bg-violet-500/30 rounded-lg p-2">
                  <p className="font-semibold">3.5</p>
                  <p className="text-slate-300">GLMs</p>
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                        SLIDE 129: CORE FORMULAS
// ═══════════════════════════════════════════════════════════════════════

function Slide129_CoreFormulas() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-slate-800">Core Formulas Reference</h1>
            <p className="text-gray-600">Essential equations from Chapter 3</p>
          </div>
    
          {/* Formulas grid */}
          <div className="flex-1 grid grid-cols-2 gap-3">
            {/* Exponential Family */}
            <div className="bg-blue-50 border border-blue-200 rounded-xl p-3">
              <h3 className="font-bold text-blue-800 text-sm mb-2">3.1: Exponential Family</h3>
              <div className="bg-white rounded p-2 text-center text-sm">
                <Latex math="f(y|\theta) = \exp\left\{\frac{y\theta - b(\theta)}{\phi} + c(y,\phi)\right\}" />
              </div>
              <div className="mt-2 text-xs text-blue-700">
                <Latex math="\mathbb{E}[Y] = b'(\theta)" />, <Latex math="\text{Var}(Y) = \phi \cdot b''(\theta)" />
              </div>
            </div>
    
            {/* Score and Fisher */}
            <div className="bg-emerald-50 border border-emerald-200 rounded-xl p-3">
              <h3 className="font-bold text-emerald-800 text-sm mb-2">3.2: Score & Fisher Info</h3>
              <div className="bg-white rounded p-2 text-center text-sm space-y-1">
                <Latex math="U(\theta) = \frac{\partial \ell}{\partial \theta}, \quad \mathbb{E}[U] = 0" />
                <br />
                <Latex math="I(\theta) = -\mathbb{E}\left[\frac{\partial^2 \ell}{\partial \theta^2}\right] = \text{Var}(U)" />
              </div>
            </div>
    
            {/* Asymptotic Distribution */}
            <div className="bg-purple-50 border border-purple-200 rounded-xl p-3">
              <h3 className="font-bold text-purple-800 text-sm mb-2">3.2-3.3: Asymptotic Result</h3>
              <div className="bg-white rounded p-2 text-center text-sm">
                <Latex math="\sqrt{n}(\hat{\theta} - \theta) \xrightarrow{d} \mathcal{N}(0, I(\theta)^{-1})" />
              </div>
              <div className="mt-2 text-xs text-purple-700">
                <strong>Delta:</strong> <Latex math="\text{Var}(g(\hat{\theta})) \approx [g'(\theta)]^2 \cdot \text{Var}(\hat{\theta})" />
              </div>
            </div>
    
            {/* OLS Estimator */}
            <div className="bg-teal-50 border border-teal-200 rounded-xl p-3">
              <h3 className="font-bold text-teal-800 text-sm mb-2">3.4: OLS Estimator</h3>
              <div className="bg-white rounded p-2 text-center text-sm">
                <Latex math="\hat{\boldsymbol{\beta}} = (\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{X}^\top\mathbf{y}" />
              </div>
              <div className="mt-2 text-xs text-teal-700">
                <Latex math="\text{Var}(\hat{\boldsymbol{\beta}}) = \sigma^2(\mathbf{X}^\top\mathbf{X})^{-1}" /> (under Gauss-Markov)
              </div>
            </div>
    
            {/* GLM */}
            <div className="bg-violet-50 border border-violet-200 rounded-xl p-3">
              <h3 className="font-bold text-violet-800 text-sm mb-2">3.5: GLM Structure</h3>
              <div className="bg-white rounded p-2 text-center text-sm">
                <Latex math="g(\mu_i) = \mathbf{x}_i^\top\boldsymbol{\beta}" />
              </div>
              <div className="mt-2 text-xs text-violet-700">
                Random: ExpFamily | Systematic: <Latex math="\eta = \mathbf{X}\boldsymbol{\beta}" /> | Link: <Latex math="g(\cdot)" />
              </div>
            </div>
    
            {/* IRLS */}
            <div className="bg-amber-50 border border-amber-200 rounded-xl p-3">
              <h3 className="font-bold text-amber-800 text-sm mb-2">3.5: IRLS Update</h3>
              <div className="bg-white rounded p-2 text-center text-sm">
                <Latex math="\boldsymbol{\beta}^{(t+1)} = (\mathbf{X}^\top\mathbf{W}^{(t)}\mathbf{X})^{-1}\mathbf{X}^\top\mathbf{W}^{(t)}\mathbf{z}^{(t)}" />
              </div>
              <div className="mt-2 text-xs text-amber-700">
                <Latex math="\text{Var}(\hat{\boldsymbol{\beta}}) = (\mathbf{X}^\top\mathbf{W}\mathbf{X})^{-1}" />
              </div>
            </div>
          </div>
    
          {/* Bottom: Three tests */}
          <div className="flex-shrink-0 mt-3">
            <div className="bg-gray-100 rounded-xl p-3">
              <h4 className="font-bold text-gray-700 text-sm mb-2 text-center">Three Likelihood-Based Tests</h4>
              <div className="grid grid-cols-3 gap-3 text-center text-xs">
                <div>
                  <p className="font-semibold">Wald</p>
                  <Latex math="W = \frac{(\hat{\theta}-\theta_0)^2}{I(\hat{\theta})^{-1}}" />
                </div>
                <div>
                  <p className="font-semibold">LR</p>
                  <Latex math="\Lambda = 2[\ell(\hat{\theta}) - \ell(\theta_0)]" />
                </div>
                <div>
                  <p className="font-semibold">Score</p>
                  <Latex math="S = U(\theta_0)^2 / I(\theta_0)" />
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                       SLIDE 12: NORMAL TWO PARAM
// ═══════════════════════════════════════════════════════════════════════

function Slide12_NormalTwoParam() {
  return (
    <div className="flex flex-col h-full p-3">
          <h1 className="text-2xl font-bold text-gray-900 mb-1">Normal: Two-Parameter Case</h1>
          <p className="text-gray-600 text-sm mb-2">Both <Latex math="\mu" /> and <Latex math="\sigma^2" /> unknown</p>
    
          {/* Starting point and key insight */}
          <div className="grid grid-cols-2 gap-2 mb-2">
            <div className="bg-blue-50 rounded-xl p-2 border border-blue-200">
              <div className="font-semibold text-blue-800 text-sm mb-1">Two Parameters Need Two Statistics</div>
              <div className="text-sm text-blue-700">
                To estimate both <Latex math="\mu" /> and <Latex math="\sigma^2" />, we need:
                <div className="bg-white rounded p-2 mt-1 text-center">
                  <Latex math="T(x) = (x, x^2)" display={true} />
                </div>
              </div>
            </div>
            
            <div className="bg-purple-50 rounded-xl p-2 border border-purple-200">
              <div className="font-semibold text-purple-800 text-sm mb-1">Natural Parameters</div>
              <div className="bg-white rounded p-2 text-center">
                <Latex math="\eta = \begin{pmatrix} \eta_1 \\ \eta_2 \end{pmatrix} = \begin{pmatrix} \mu/\sigma^2 \\ -1/(2\sigma^2) \end{pmatrix}" display={true} />
              </div>
            </div>
          </div>
    
          {/* The exponential family form */}
          <div className="bg-gradient-to-r from-indigo-500 to-purple-500 rounded-xl p-3 mb-2 text-white">
            <div className="text-indigo-100 text-xs font-semibold mb-1 text-center">CANONICAL FORM</div>
            <div className="bg-white/95 rounded-lg p-2 text-gray-900 text-center">
              <Latex math="f(x) = \frac{1}{\sqrt{2\pi}} \exp\left\{ \eta_1 x + \eta_2 x^2 - A(\eta) \right\}" display={true} />
            </div>
          </div>
    
          {/* Components */}
          <div className="grid grid-cols-2 gap-2 mb-2">
            <div className="bg-green-50 rounded-xl p-2 border border-green-200">
              <div className="font-semibold text-green-800 text-sm mb-1">Inner Product Structure</div>
              <div className="bg-white rounded p-2 text-center text-sm">
                <Latex math="\eta^T T(x) = \eta_1 \cdot x + \eta_2 \cdot x^2" display={true} />
              </div>
              <div className="text-xs text-green-700 mt-1">
                Linear in both <Latex math="\eta" /> and <Latex math="T(x)" />
              </div>
            </div>
    
            <div className="bg-amber-50 rounded-xl p-2 border border-amber-200">
              <div className="font-semibold text-amber-800 text-sm mb-1">Log-Partition Function</div>
              <div className="bg-white rounded p-2 text-center text-sm">
                <Latex math="A(\eta) = -\frac{\eta_1^2}{4\eta_2} - \frac{1}{2}\log(-2\eta_2)" display={true} />
              </div>
              <div className="text-xs text-amber-700 mt-1">
                (Plus constant <Latex math="\frac{1}{2}\log 2\pi" />)
              </div>
            </div>
          </div>
    
          {/* Natural parameter space */}
          <div className="grid grid-cols-2 gap-2 mb-2">
            <div className="bg-slate-50 rounded-xl p-2 border border-slate-200">
              <div className="font-semibold text-slate-800 text-sm mb-1">Parameter Space <Latex math="\Xi" /></div>
              <div className="flex items-center gap-3">
                <div className="bg-white rounded p-2 flex-1">
                  <Latex math="\Xi = \mathbb{R} \times (-\infty, 0)" display={true} />
                </div>
                <div className="text-xs text-slate-600">
                  Half-plane<br/>(still convex!)
                </div>
              </div>
            </div>
    
            <div className="bg-teal-50 rounded-xl p-2 border border-teal-200">
              <div className="font-semibold text-teal-800 text-sm mb-1">Recover Original Params</div>
              <div className="text-sm text-teal-700 space-y-1">
                <div><Latex math="\sigma^2 = -\frac{1}{2\eta_2}" /></div>
                <div><Latex math="\mu = -\frac{\eta_1}{2\eta_2}" /></div>
              </div>
            </div>
          </div>
    
          {/* For n observations */}
          <div className="bg-pink-50 rounded-lg p-2 border border-pink-200">
            <div className="flex items-center gap-4">
              <div className="font-semibold text-pink-800 text-sm">For n iid observations:</div>
              <div className="text-sm text-pink-700">
                Sufficient statistics are <Latex math="\sum_{i=1}^n x_i" /> and <Latex math="\sum_{i=1}^n x_i^2" /> — exactly what we need for <Latex math="\bar{x}" /> and <Latex math="s^2" />!
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                        SLIDE 130: KEY TAKEAWAYS
// ═══════════════════════════════════════════════════════════════════════

function Slide130_KeyTakeaways() {
  return (
    <div className="h-full flex flex-col bg-gradient-to-br from-indigo-900 via-purple-800 to-violet-900 text-white p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4 text-center">
            <h1 className="text-4xl font-bold mb-2">Chapter 3: Key Takeaways</h1>
            <p className="text-xl text-purple-200">Parametric Inference and Likelihood Methods</p>
          </div>
    
          {/* Five takeaways */}
          <div className="flex-1 grid grid-cols-1 gap-3 max-w-3xl mx-auto w-full">
            <div className="bg-white/10 backdrop-blur rounded-xl p-3 flex items-center gap-4">
              <div className="bg-blue-500 text-white w-10 h-10 rounded-full flex items-center justify-center font-bold text-lg flex-shrink-0">1</div>
              <div>
                <p className="font-bold text-blue-200">Exponential families unify statistical modeling</p>
                <p className="text-sm text-purple-200">Normal, Bernoulli, Poisson, Gamma - all share common structure</p>
              </div>
            </div>
    
            <div className="bg-white/10 backdrop-blur rounded-xl p-3 flex items-center gap-4">
              <div className="bg-emerald-500 text-white w-10 h-10 rounded-full flex items-center justify-center font-bold text-lg flex-shrink-0">2</div>
              <div>
                <p className="font-bold text-emerald-200">MLE is asymptotically optimal under regularity</p>
                <p className="text-sm text-purple-200">Consistent, efficient, asymptotically normal - but check assumptions!</p>
              </div>
            </div>
    
            <div className="bg-white/10 backdrop-blur rounded-xl p-3 flex items-center gap-4">
              <div className="bg-purple-500 text-white w-10 h-10 rounded-full flex items-center justify-center font-bold text-lg flex-shrink-0">3</div>
              <div>
                <p className="font-bold text-purple-200">Uncertainty quantification matters as much as estimation</p>
                <p className="text-sm text-purple-200">Fisher info, delta method, sandwich estimator for robust inference</p>
              </div>
            </div>
    
            <div className="bg-white/10 backdrop-blur rounded-xl p-3 flex items-center gap-4">
              <div className="bg-teal-500 text-white w-10 h-10 rounded-full flex items-center justify-center font-bold text-lg flex-shrink-0">4</div>
              <div>
                <p className="font-bold text-teal-200">Linear models are the foundation of regression</p>
                <p className="text-sm text-purple-200">OLS, Gauss-Markov, geometric interpretation - everything builds on this</p>
              </div>
            </div>
    
            <div className="bg-white/10 backdrop-blur rounded-xl p-3 flex items-center gap-4">
              <div className="bg-violet-500 text-white w-10 h-10 rounded-full flex items-center justify-center font-bold text-lg flex-shrink-0">5</div>
              <div>
                <p className="font-bold text-violet-200">GLMs extend to any response type via link functions</p>
                <p className="text-sm text-purple-200">Binary, counts, positive - match the model to your data</p>
              </div>
            </div>
          </div>
    
          {/* Looking ahead */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-white/10 backdrop-blur rounded-xl p-4">
              <h3 className="font-bold text-center text-purple-200 mb-3">Looking Ahead</h3>
              <div className="grid grid-cols-3 gap-4 text-center text-sm">
                <div className="bg-white/10 rounded-lg p-2">
                  <p className="font-semibold text-amber-300">Chapter 4</p>
                  <p className="text-purple-200">Bootstrap & Resampling</p>
                  <p className="text-xs text-purple-300">When asymptotics fail</p>
                </div>
                <div className="bg-white/10 rounded-lg p-2">
                  <p className="font-semibold text-cyan-300">Chapter 5</p>
                  <p className="text-purple-200">Bayesian Inference</p>
                  <p className="text-xs text-purple-300">Posteriors over parameters</p>
                </div>
                <div className="bg-white/10 rounded-lg p-2">
                  <p className="font-semibold text-pink-300">Chapters 13-15</p>
                  <p className="text-purple-200">ML & LLMs</p>
                  <p className="text-xs text-purple-300">Modern methods</p>
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                    SLIDE 13: EXPONENTIAL CONVERSION
// ═══════════════════════════════════════════════════════════════════════

function Slide13_ExponentialConversion() {
  return (
    <div className="flex flex-col h-full p-3">
          <h1 className="text-2xl font-bold text-gray-900 mb-1">Exponential <Latex math="\rightarrow" /> Exponential Form</h1>
          <p className="text-gray-600 text-sm mb-2">Natural parameter is negative rate</p>
    
          <div className="grid grid-cols-2 gap-2 mb-2">
            {/* Left: Conversion steps */}
            <div className="space-y-2">
              {/* Starting point */}
              <div className="bg-orange-50 rounded-xl p-2 border border-orange-200">
                <div className="font-semibold text-orange-800 text-sm mb-1">Starting Point</div>
                <div className="bg-white rounded-lg p-2 text-center text-sm">
                  <Latex math="f(x) = \lambda e^{-\lambda x} \quad (x \geq 0)" display={true} />
                </div>
              </div>
    
              {/* Components identified */}
              <div className="grid grid-cols-2 gap-1">
                <div className="bg-blue-100 rounded-lg p-1 text-center">
                  <div className="text-xs text-blue-600">Sufficient Stat</div>
                  <div className="font-mono text-blue-800 text-sm"><Latex math="T(x) = x" /></div>
                </div>
                <div className="bg-purple-100 rounded-lg p-1 text-center">
                  <div className="text-xs text-purple-600">Natural Param</div>
                  <div className="font-mono text-purple-800 text-sm"><Latex math="\eta = -\lambda" /></div>
                </div>
                <div className="bg-green-100 rounded-lg p-1 text-center">
                  <div className="text-xs text-green-600">Log-Partition</div>
                  <div className="font-mono text-green-800 text-sm"><Latex math="A(\eta) = -\log(-\eta)" /></div>
                </div>
                <div className="bg-amber-100 rounded-lg p-1 text-center">
                  <div className="text-xs text-amber-600">Carrier</div>
                  <div className="font-mono text-amber-800 text-sm"><Latex math="h(x) = \mathbf{1}_{x \geq 0}" /></div>
                </div>
              </div>
    
              {/* Verification */}
              <div className="bg-green-50 rounded-xl p-2 border border-green-200">
                <div className="font-semibold text-green-800 text-sm mb-1">Verify: Moments</div>
                <div className="space-y-1 text-sm">
                  <div className="bg-white rounded p-1">
                    <Latex math="A'(\eta) = \frac{-1}{\eta} = \frac{1}{\lambda} = \mathbb{E}[X]" /> <span className="text-green-600">OK</span>
                  </div>
                  <div className="bg-white rounded p-1">
                    <Latex math="A''(\eta) = \frac{1}{\eta^2} = \frac{1}{\lambda^2} = \text{Var}(X)" /> <span className="text-green-600">OK</span>
                  </div>
                </div>
              </div>
            </div>
    
            {/* Right: Figure showing log-partition visualization */}
            <div className="flex flex-col">
              <img 
                src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/PartII/Chapter3/ch3_1_fig02b_log_partition_exponential.png"
                alt="Log-partition function for Exponential distribution showing mean and variance from derivatives"
                className="w-full h-full object-contain rounded-lg border border-gray-200"
              />
            </div>
          </div>
    
          {/* Parameter space note */}
          <div className="bg-red-50 rounded-lg p-2 border border-red-200">
            <div className="flex items-center gap-3">
              <div className="font-semibold text-red-800 text-sm">Parameter Space:</div>
              <Latex math="\Xi = (-\infty, 0)" />
              <div className="text-xs text-red-700">Restricted to negative values (since rate <Latex math="\lambda > 0" />)</div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                       SLIDE 14: GAMMA CONVERSION
// ═══════════════════════════════════════════════════════════════════════

function Slide14_GammaConversion() {
  return (
    <div className="flex flex-col h-full p-3">
          <h1 className="text-2xl font-bold text-gray-900 mb-1">Gamma <Latex math="\rightarrow" /> Exponential Form</h1>
          <p className="text-gray-600 text-sm mb-2">Shape <Latex math="\alpha" /> known, rate <Latex math="\beta" /> unknown</p>
    
          {/* Starting point */}
          <div className="bg-amber-50 rounded-xl p-2 mb-2 border border-amber-200">
            <div className="font-semibold text-amber-800 text-sm mb-1">Starting Point: Gamma PDF</div>
            <div className="bg-white rounded-lg p-2 text-center">
              <Latex math="f(x) = \frac{\beta^\alpha}{\Gamma(\alpha)} x^{\alpha-1} e^{-\beta x} \quad \text{for } x > 0" display={true} />
            </div>
          </div>
    
          {/* Transformation */}
          <div className="bg-gradient-to-br from-orange-50 to-yellow-50 rounded-xl p-3 mb-2 border border-orange-200 flex-1">
            <div className="font-semibold text-orange-800 text-sm mb-2">Conversion</div>
            <div className="space-y-2">
              <div className="flex items-center gap-3">
                <div className="bg-orange-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">1</div>
                <div className="bg-white rounded-lg p-2 flex-1 text-sm">
                  <span className="text-gray-500">Rewrite: </span>
                  <Latex math="= \frac{x^{\alpha-1}}{\Gamma(\alpha)} \exp\{-\beta x + \alpha\log\beta\}" />
                </div>
              </div>
              <div className="flex items-center gap-3">
                <div className="bg-orange-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">2</div>
                <div className="bg-white rounded-lg p-2 flex-1 text-sm">
                  <span className="text-gray-500">Define <Latex math="\eta" />: </span>
                  <Latex math="\eta = -\beta \quad \Leftrightarrow \quad \beta = -\eta" />
                  <span className="text-gray-400 text-xs ml-2">(<Latex math="\eta < 0" />)</span>
                </div>
              </div>
              <div className="flex items-center gap-3">
                <div className="bg-orange-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">3</div>
                <div className="bg-white rounded-lg p-2 flex-1 text-sm">
                  <span className="text-gray-500">Final: </span>
                  <Latex math="f(x) = \frac{x^{\alpha-1}}{\Gamma(\alpha)} \exp\left\{ \eta x - \alpha\log(-\eta) \right\} \cdot \mathbf{1}_{x>0}" />
                </div>
              </div>
            </div>
          </div>
    
          {/* Components identified */}
          <div className="grid grid-cols-4 gap-2 mb-2">
            <div className="bg-blue-100 rounded-lg p-2 text-center">
              <div className="text-xs text-blue-600 mb-1">Sufficient Stat</div>
              <div className="font-mono text-blue-800"><Latex math="T(x) = x" /></div>
            </div>
            <div className="bg-purple-100 rounded-lg p-2 text-center">
              <div className="text-xs text-purple-600 mb-1">Natural Param</div>
              <div className="font-mono text-purple-800"><Latex math="\eta = -\beta" /></div>
            </div>
            <div className="bg-green-100 rounded-lg p-2 text-center">
              <div className="text-xs text-green-600 mb-1">Log-Partition</div>
              <div className="font-mono text-green-800 text-sm"><Latex math="A(\eta) = -\alpha\log(-\eta)" /></div>
            </div>
            <div className="bg-amber-100 rounded-lg p-2 text-center">
              <div className="text-xs text-amber-600 mb-1">Carrier</div>
              <div className="font-mono text-amber-800 text-sm"><Latex math="\frac{x^{\alpha-1}}{\Gamma(\alpha)}" /></div>
            </div>
          </div>
    
          {/* Verification */}
          <div className="grid grid-cols-2 gap-2">
            <div className="bg-green-50 rounded-xl p-2 border border-green-200">
              <div className="font-semibold text-green-800 text-sm mb-1">Verify: Moments</div>
              <div className="space-y-1 text-sm">
                <div className="bg-white rounded p-1">
                  <Latex math="A'(\eta) = \frac{-\alpha}{\eta} = \frac{\alpha}{\beta} = \mathbb{E}[X]" /> <span className="text-green-600">✓</span>
                </div>
                <div className="bg-white rounded p-1">
                  <Latex math="A''(\eta) = \frac{\alpha}{\eta^2} = \frac{\alpha}{\beta^2} = \text{Var}(X)" /> <span className="text-green-600">✓</span>
                </div>
              </div>
            </div>
    
            <div className="bg-teal-50 rounded-xl p-2 border border-teal-200">
              <div className="font-semibold text-teal-800 text-sm mb-1">Special Cases</div>
              <div className="text-sm text-teal-700 space-y-1">
                <div><Latex math="\alpha = 1" />: Exponential</div>
                <div><Latex math="\alpha = n/2, \beta = 1/2" />: Chi-squared</div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                         SLIDE 15: SUMMARY TABLE
// ═══════════════════════════════════════════════════════════════════════

function Slide15_SummaryTable() {
  return (
    <div className="flex flex-col h-full p-3">
          <h1 className="text-2xl font-bold text-gray-900 mb-2">Exponential Family Reference Table</h1>
    
          {/* Table */}
          <div className="flex-1 overflow-auto">
            <table className="w-full text-xs border-collapse">
              <thead>
                <tr className="bg-slate-700 text-white">
                  <th className="p-2 text-left border border-slate-600">Distribution</th>
                  <th className="p-2 text-left border border-slate-600"><Latex math="\eta" /> (Natural)</th>
                  <th className="p-2 text-left border border-slate-600"><Latex math="T(x)" /></th>
                  <th className="p-2 text-left border border-slate-600"><Latex math="A(\eta)" /></th>
                  <th className="p-2 text-left border border-slate-600"><Latex math="h(x)" /></th>
                </tr>
              </thead>
              <tbody>
                <tr className="bg-blue-50">
                  <td className="p-2 border border-slate-300 font-semibold text-blue-800">Bernoulli(<Latex math="p" />)</td>
                  <td className="p-2 border border-slate-300"><Latex math="\log\frac{p}{1-p}" /></td>
                  <td className="p-2 border border-slate-300"><Latex math="x" /></td>
                  <td className="p-2 border border-slate-300"><Latex math="\log(1+e^\eta)" /></td>
                  <td className="p-2 border border-slate-300"><Latex math="1" /></td>
                </tr>
                <tr className="bg-white">
                  <td className="p-2 border border-slate-300 font-semibold text-blue-800">Binomial(<Latex math="n,p" />)</td>
                  <td className="p-2 border border-slate-300"><Latex math="\log\frac{p}{1-p}" /></td>
                  <td className="p-2 border border-slate-300"><Latex math="x" /></td>
                  <td className="p-2 border border-slate-300"><Latex math="n\log(1+e^\eta)" /></td>
                  <td className="p-2 border border-slate-300"><Latex math="\binom{n}{x}" /></td>
                </tr>
                <tr className="bg-green-50">
                  <td className="p-2 border border-slate-300 font-semibold text-green-800">Poisson(<Latex math="\lambda" />)</td>
                  <td className="p-2 border border-slate-300"><Latex math="\log\lambda" /></td>
                  <td className="p-2 border border-slate-300"><Latex math="x" /></td>
                  <td className="p-2 border border-slate-300"><Latex math="e^\eta" /></td>
                  <td className="p-2 border border-slate-300"><Latex math="1/x!" /></td>
                </tr>
                <tr className="bg-white">
                  <td className="p-2 border border-slate-300 font-semibold text-purple-800">Normal(<Latex math="\mu, \sigma^2" /> known)</td>
                  <td className="p-2 border border-slate-300"><Latex math="\mu/\sigma^2" /></td>
                  <td className="p-2 border border-slate-300"><Latex math="x" /></td>
                  <td className="p-2 border border-slate-300"><Latex math="\sigma^2\eta^2/2" /></td>
                  <td className="p-2 border border-slate-300"><Latex math="\frac{e^{-x^2/(2\sigma^2)}}{\sqrt{2\pi\sigma^2}}" /></td>
                </tr>
                <tr className="bg-purple-50">
                  <td className="p-2 border border-slate-300 font-semibold text-purple-800">Normal (both unknown)</td>
                  <td className="p-2 border border-slate-300"><Latex math="(\frac{\mu}{\sigma^2}, \frac{-1}{2\sigma^2})" /></td>
                  <td className="p-2 border border-slate-300"><Latex math="(x, x^2)" /></td>
                  <td className="p-2 border border-slate-300"><Latex math="-\frac{\eta_1^2}{4\eta_2} - \frac{1}{2}\log(-2\eta_2)" /></td>
                  <td className="p-2 border border-slate-300"><Latex math="1/\sqrt{2\pi}" /></td>
                </tr>
                <tr className="bg-white">
                  <td className="p-2 border border-slate-300 font-semibold text-orange-800">Exponential(<Latex math="\lambda" />)</td>
                  <td className="p-2 border border-slate-300"><Latex math="-\lambda" /></td>
                  <td className="p-2 border border-slate-300"><Latex math="x" /></td>
                  <td className="p-2 border border-slate-300"><Latex math="-\log(-\eta)" /></td>
                  <td className="p-2 border border-slate-300"><Latex math="\mathbf{1}_{x \geq 0}" /></td>
                </tr>
                <tr className="bg-amber-50">
                  <td className="p-2 border border-slate-300 font-semibold text-amber-800">Gamma(<Latex math="\alpha" /> known, <Latex math="\beta" />)</td>
                  <td className="p-2 border border-slate-300"><Latex math="-\beta" /></td>
                  <td className="p-2 border border-slate-300"><Latex math="x" /></td>
                  <td className="p-2 border border-slate-300"><Latex math="-\alpha\log(-\eta)" /></td>
                  <td className="p-2 border border-slate-300"><Latex math="\frac{x^{\alpha-1}}{\Gamma(\alpha)}" /></td>
                </tr>
                <tr className="bg-white">
                  <td className="p-2 border border-slate-300 font-semibold text-teal-800">Beta(<Latex math="\alpha, \beta" />)</td>
                  <td className="p-2 border border-slate-300"><Latex math="(\alpha-1, \beta-1)" /></td>
                  <td className="p-2 border border-slate-300"><Latex math="(\log x, \log(1-x))" /></td>
                  <td className="p-2 border border-slate-300"><Latex math="\log B(\eta_1+1, \eta_2+1)" /></td>
                  <td className="p-2 border border-slate-300"><Latex math="1" /></td>
                </tr>
              </tbody>
            </table>
          </div>
    
          {/* Key patterns */}
          <div className="mt-2 grid grid-cols-3 gap-2">
            <div className="bg-blue-50 rounded-lg p-2 border border-blue-200">
              <div className="font-semibold text-blue-800 text-xs mb-1">Discrete Pattern</div>
              <div className="text-xs text-blue-700"><Latex math="\eta = \log(\cdot)" /> transform</div>
            </div>
            <div className="bg-orange-50 rounded-lg p-2 border border-orange-200">
              <div className="font-semibold text-orange-800 text-xs mb-1">Positive Reals</div>
              <div className="text-xs text-orange-700"><Latex math="\eta < 0" /> (negative rate)</div>
            </div>
            <div className="bg-purple-50 rounded-lg p-2 border border-purple-200">
              <div className="font-semibold text-purple-800 text-xs mb-1">Multi-param</div>
              <div className="text-xs text-purple-700"><Latex math="T(x)" /> is a vector</div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                     SLIDE 16: MEAN PARAMETERIZATION
// ═══════════════════════════════════════════════════════════════════════

function Slide16_MeanParameterization() {
  return (
    <div className="flex flex-col h-full p-3">
          <h1 className="text-2xl font-bold text-gray-900 mb-1">Mean Parameterization</h1>
          <p className="text-gray-600 text-sm mb-2">From mathematical <Latex math="\eta" /> to interpretable <Latex math="\mu" /></p>
    
          {/* The two parameterizations */}
          <div className="grid grid-cols-2 gap-3 mb-3">
            <div className="bg-purple-50 rounded-xl p-3 border-2 border-purple-300">
              <div className="font-semibold text-purple-800 mb-2 text-center">Natural Parameter</div>
              <div className="bg-white rounded-lg p-2 text-center mb-2">
                <Latex math="\eta \in \Xi" display={true} />
              </div>
              <div className="text-sm text-purple-700 text-center">
                Mathematical convenience<br/>
                <span className="text-xs">(makes likelihood linear)</span>
              </div>
            </div>
    
            <div className="bg-green-50 rounded-xl p-3 border-2 border-green-300">
              <div className="font-semibold text-green-800 mb-2 text-center">Mean Parameter</div>
              <div className="bg-white rounded-lg p-2 text-center mb-2">
                <Latex math="\mu = \mathbb{E}_\eta[T(X)] \in \mathcal{M}" display={true} />
              </div>
              <div className="text-sm text-green-700 text-center">
                Interpretable meaning<br/>
                <span className="text-xs">(expected sufficient statistic)</span>
              </div>
            </div>
          </div>
    
          {/* The bijection */}
          <div className="bg-gradient-to-r from-indigo-500 to-purple-500 rounded-xl p-3 mb-3 text-white">
            <div className="text-indigo-100 text-xs font-semibold mb-1 text-center">THE BIJECTION</div>
            <div className="grid grid-cols-3 gap-2 items-center">
              <div className="bg-white/95 rounded-lg p-2 text-gray-900 text-center">
                <div className="text-xs text-purple-600 mb-1">Forward</div>
                <Latex math="\mu = \nabla A(\eta)" />
              </div>
              <div className="text-center text-2xl"><Latex math="\longleftrightarrow" /></div>
              <div className="bg-white/95 rounded-lg p-2 text-gray-900 text-center">
                <div className="text-xs text-green-600 mb-1">Inverse</div>
                <Latex math="\eta = (\nabla A)^{-1}(\mu)" />
              </div>
            </div>
          </div>
    
          {/* Examples */}
          <div className="bg-amber-50 rounded-xl p-3 mb-2 border border-amber-200 flex-1">
            <div className="font-semibold text-amber-800 text-sm mb-2">Concrete Examples</div>
            <div className="grid grid-cols-3 gap-2 text-sm">
              <div className="bg-white rounded-lg p-2">
                <div className="font-semibold text-amber-700 text-xs mb-1">Bernoulli</div>
                <div className="space-y-1 text-xs">
                  <div><Latex math="\mu = p" /></div>
                  <div><Latex math="\eta = \log\frac{p}{1-p}" /></div>
                  <div className="text-gray-500"><Latex math="p = \frac{e^\eta}{1+e^\eta}" /></div>
                </div>
              </div>
              <div className="bg-white rounded-lg p-2">
                <div className="font-semibold text-amber-700 text-xs mb-1">Poisson</div>
                <div className="space-y-1 text-xs">
                  <div><Latex math="\mu = \lambda" /></div>
                  <div><Latex math="\eta = \log\lambda" /></div>
                  <div className="text-gray-500"><Latex math="\lambda = e^\eta" /></div>
                </div>
              </div>
              <div className="bg-white rounded-lg p-2">
                <div className="font-semibold text-amber-700 text-xs mb-1">Normal</div>
                <div className="space-y-1 text-xs">
                  <div><Latex math="\mu = \mu" /></div>
                  <div><Latex math="\eta = \mu/\sigma^2" /></div>
                  <div className="text-gray-500"><Latex math="\mu = \sigma^2\eta" /></div>
                </div>
              </div>
            </div>
          </div>
    
          {/* MLE result */}
          <div className="bg-green-100 rounded-lg p-2 border-2 border-green-400">
            <div className="flex items-center gap-3">
              <div className="font-semibold text-green-800 text-sm">Key Result:</div>
              <div className="text-sm text-green-700">
                MLE of mean parameter: <Latex math="\hat{\mu} = \frac{1}{n}\sum_{i=1}^n T(x_i)" /> — just the sample average!
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                      SLIDE 17: FULL RANK VS CURVED
// ═══════════════════════════════════════════════════════════════════════

function Slide17_FullRankVsCurved() {
  return (
    <div className="flex flex-col h-full p-3">
          <h1 className="text-2xl font-bold text-gray-900 mb-1">Full-Rank vs Curved Families</h1>
          <p className="text-gray-600 text-sm mb-2">When does the standard theory apply?</p>
    
          <div className="grid grid-cols-2 gap-3 flex-1">
            {/* Full-rank */}
            <div className="bg-green-50 rounded-xl p-3 border-2 border-green-400">
              <div className="flex items-center gap-2 mb-2">
                <div className="w-3 h-3 bg-green-500 rounded-full"></div>
                <div className="font-semibold text-green-800">Full-Rank (Regular)</div>
              </div>
              
              <div className="space-y-2">
                <div className="bg-white rounded-lg p-2">
                  <div className="text-sm font-semibold text-green-700 mb-1">Definition</div>
                  <div className="text-xs text-green-600">
                    <Latex math="\eta" /> varies freely over open set in <Latex math="\mathbb{R}^s" /><br/>
                    <Latex math="T(x)" /> components linearly independent
                  </div>
                </div>
    
                <div className="bg-white rounded-lg p-2">
                  <div className="text-sm font-semibold text-green-700 mb-1">Examples</div>
                  <div className="text-xs text-green-600">
                    Bernoulli, Poisson, Normal, Gamma, Beta, Multinomial
                  </div>
                </div>
    
                <div className="bg-green-100 rounded-lg p-2">
                  <div className="text-sm font-semibold text-green-700 mb-1">Properties ✓</div>
                  <ul className="text-xs text-green-600 space-y-1">
                    <li>• Unique MLE (when it exists)</li>
                    <li>• One-to-one <Latex math="\eta \leftrightarrow \mu" /></li>
                    <li>• Standard asymptotics apply</li>
                    <li>• Convex optimization</li>
                  </ul>
                </div>
              </div>
            </div>
    
            {/* Curved */}
            <div className="bg-amber-50 rounded-xl p-3 border-2 border-amber-400">
              <div className="flex items-center gap-2 mb-2">
                <div className="w-3 h-3 bg-amber-500 rounded-full"></div>
                <div className="font-semibold text-amber-800">Curved (Non-Full-Rank)</div>
              </div>
              
              <div className="space-y-2">
                <div className="bg-white rounded-lg p-2">
                  <div className="text-sm font-semibold text-amber-700 mb-1">Definition</div>
                  <div className="text-xs text-amber-600">
                    Parameters constrained to lower-dimensional manifold within <Latex math="\Xi" />
                  </div>
                </div>
    
                <div className="bg-white rounded-lg p-2">
                  <div className="text-sm font-semibold text-amber-700 mb-1">Examples</div>
                  <div className="text-xs text-amber-600">
                    Normal with <Latex math="\sigma^2 = \mu^2" /><br/>
                    Gamma with <Latex math="\alpha = \beta" /><br/>
                    <Latex math="N(\mu, \mu)" /> (mean = variance)
                  </div>
                </div>
    
                <div className="bg-amber-100 rounded-lg p-2">
                  <div className="text-sm font-semibold text-amber-700 mb-1">Complications ⚠️</div>
                  <ul className="text-xs text-amber-600 space-y-1">
                    <li>• MLE may not exist</li>
                    <li>• Non-standard asymptotics</li>
                    <li>• Different convergence rates</li>
                    <li>• More complex inference</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
    
          {/* Visual */}
          <div className="mt-3 bg-slate-50 rounded-xl p-3 border border-slate-200">
            <div className="flex items-center gap-4">
              <div className="flex-1">
                <svg viewBox="0 0 200 80" className="w-full h-16">
                  {/* Full-rank: filled region */}
                  <ellipse cx="50" cy="40" rx="40" ry="30" fill="#BBF7D0" stroke="#22C55E" strokeWidth="2"/>
                  <text x="50" y="44" fontSize="10" textAnchor="middle" fill="#166534">Full-rank</text>
                  
                  {/* Curved: just a line through it */}
                  <ellipse cx="150" cy="40" rx="40" ry="30" fill="#FEF3C7" stroke="#F59E0B" strokeWidth="2"/>
                  <path d="M 115 55 Q 150 25 185 55" fill="none" stroke="#B45309" strokeWidth="3"/>
                  <text x="150" y="44" fontSize="10" textAnchor="middle" fill="#92400E">Curved</text>
                </svg>
              </div>
              <div className="text-sm text-slate-600">
                <strong>Full-rank:</strong> Parameters fill the space<br/>
                <strong>Curved:</strong> Parameters lie on a manifold
              </div>
            </div>
          </div>
    
          {/* Bottom note */}
          <div className="mt-2 bg-blue-100 rounded-lg p-2 text-center text-sm border border-blue-300">
            <span className="text-blue-800">
              <strong>Course Focus:</strong> We assume full-rank families unless stated otherwise
            </span>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                          SLIDE 18: IID SAMPLES
// ═══════════════════════════════════════════════════════════════════════

function Slide18_IIDSamples() {
  return (
    <div className="flex flex-col h-full p-3">
          <h1 className="text-2xl font-bold text-gray-900 mb-1">IID Samples: Fixed-Dimension Sufficiency</h1>
          <p className="text-gray-600 text-sm mb-2">The sum captures everything about <Latex math="\eta" /></p>
    
          {/* Main result */}
          <div className="bg-gradient-to-r from-green-500 to-teal-500 rounded-xl p-2 mb-2 text-white">
            <div className="text-green-100 text-xs font-semibold mb-1 text-center">SUFFICIENT STATISTIC FOR n OBSERVATIONS</div>
            <div className="bg-white/95 rounded-lg p-2 text-gray-900 text-center">
              <Latex math="T^{(n)}(\mathbf{x}) = \sum_{i=1}^n T(x_i)" display={true} />
              <div className="text-sm text-green-700">Same dimension regardless of n!</div>
            </div>
          </div>
    
          {/* Figure: Sufficient statistics visualization */}
          <div className="flex-1 mb-2">
            <img 
              src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/PartII/Chapter3/ch3_1_fig03_sufficient_statistics.png"
              alt="Two datasets with same sufficient statistic yield identical inference"
              className="w-4/5 mx-auto rounded-lg shadow-md"
            />
          </div>
    
          {/* Caption and implications */}
          <div className="grid grid-cols-2 gap-2">
            <div className="bg-blue-50 rounded-lg p-2 border border-blue-200">
              <div className="font-semibold text-blue-800 text-xs mb-1">Data Reduction Power</div>
              <div className="text-xs text-blue-700">
                Two very different datasets (varied vs uniform) with same <Latex math="\sum x_i = 40" /> yield <strong>identical</strong> likelihood and MLE <Latex math="\hat{\lambda} = 5" />.
              </div>
            </div>
            <div className="bg-teal-50 rounded-lg p-2 border border-teal-200">
              <div className="font-semibold text-teal-800 text-xs mb-1">Koopman-Pitman-Darmois</div>
              <div className="text-xs text-teal-700">
                <strong>Only</strong> exponential families have fixed-dimension sufficient statistics. This is why they dominate statistical practice!
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                         SLIDE 19: SCORE FISHER
// ═══════════════════════════════════════════════════════════════════════

function Slide19_ScoreFisher() {
  return (
    <div className="flex flex-col h-full p-3">
          <h1 className="text-2xl font-bold text-gray-900 mb-1">Score Function & Fisher Information</h1>
          <p className="text-gray-600 text-sm mb-2">The derivatives that govern MLE</p>
    
          {/* Score function */}
          <div className="bg-blue-50 rounded-xl p-3 mb-2 border-2 border-blue-300">
            <div className="font-semibold text-blue-800 mb-2">Score Function</div>
            <div className="grid grid-cols-2 gap-3">
              <div className="bg-white rounded-lg p-2">
                <div className="text-xs text-blue-600 mb-1">Definition</div>
                <Latex math="S(\eta) = \nabla_\eta \log p_\eta(x)" display={true} />
              </div>
              <div className="bg-white rounded-lg p-2">
                <div className="text-xs text-blue-600 mb-1">For Exponential Families</div>
                <Latex math="S(\eta) = T(x) - \nabla A(\eta)" display={true} />
              </div>
            </div>
            <div className="mt-2 bg-blue-100 rounded p-2 text-sm text-blue-700">
              <strong>Key:</strong> <Latex math="\mathbb{E}[S(\eta)] = 0" /> and MLE solves <Latex math="\bar{T} = \nabla A(\hat{\eta})" />
            </div>
          </div>
    
          {/* Fisher information */}
          <div className="bg-green-50 rounded-xl p-3 mb-2 border-2 border-green-300">
            <div className="font-semibold text-green-800 mb-2">Fisher Information</div>
            <div className="grid grid-cols-2 gap-3">
              <div className="bg-white rounded-lg p-2">
                <div className="text-xs text-green-600 mb-1">Definition</div>
                <Latex math="I(\eta) = \text{Var}[S(\eta)]" display={true} />
              </div>
              <div className="bg-white rounded-lg p-2">
                <div className="text-xs text-green-600 mb-1">For Exponential Families</div>
                <Latex math="I(\eta) = \nabla^2 A(\eta) = \text{Cov}[T(X)]" display={true} />
              </div>
            </div>
            <div className="mt-2 bg-green-100 rounded p-2 text-sm text-green-700">
              <strong>Key:</strong> Same as Hessian of log-partition! Measures estimation precision.
            </div>
          </div>
    
          {/* The beautiful connection */}
          <div className="bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl p-3 mb-2 text-white flex-1">
            <div className="text-purple-100 text-xs font-semibold mb-2 text-center">THE EXPONENTIAL FAMILY ELEGANCE</div>
            <div className="grid grid-cols-3 gap-2">
              <div className="bg-white/95 rounded-lg p-2 text-gray-900 text-center">
                <div className="text-xs text-purple-600 mb-1">Mean</div>
                <Latex math="\nabla A(\eta)" />
                <div className="text-xs text-gray-500 mt-1">1st derivative</div>
              </div>
              <div className="bg-white/95 rounded-lg p-2 text-gray-900 text-center">
                <div className="text-xs text-purple-600 mb-1">Variance</div>
                <Latex math="\nabla^2 A(\eta)" />
                <div className="text-xs text-gray-500 mt-1">2nd derivative</div>
              </div>
              <div className="bg-white/95 rounded-lg p-2 text-gray-900 text-center">
                <div className="text-xs text-purple-600 mb-1">Fisher Info</div>
                <Latex math="\nabla^2 A(\eta)" />
                <div className="text-xs text-gray-500 mt-1">Same!</div>
              </div>
            </div>
          </div>
    
          {/* Asymptotic result */}
          <div className="bg-amber-100 rounded-lg p-2 border-2 border-amber-400">
            <div className="flex items-center gap-2">
              <div className="font-semibold text-amber-800 text-sm">MLE Asymptotics:</div>
              <div className="text-sm text-amber-700">
                <Latex math="\sqrt{n}(\hat{\eta} - \eta) \xrightarrow{d} N(0, I(\eta)^{-1})" />
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                        SLIDE 20: SECTION SUMMARY
// ═══════════════════════════════════════════════════════════════════════

function Slide20_SectionSummary() {
  return (
    <div className="flex flex-col h-full p-3">
          <h1 className="text-2xl font-bold text-gray-900 mb-2">Section 3.1 Summary: Exponential Families</h1>
    
          {/* The canonical form reminder */}
          <div className="bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl p-3 mb-3 text-white">
            <div className="text-indigo-200 text-xs font-semibold mb-1 text-center">THE MASTER EQUATION</div>
            <div className="bg-white/95 rounded-lg p-2 text-gray-900 text-center">
              <Latex math="p_\eta(x) = h(x) \exp\left\{ \eta^T T(x) - A(\eta) \right\}" display={true} />
            </div>
          </div>
    
          {/* Key results grid */}
          <div className="grid grid-cols-2 gap-2 mb-3 flex-1">
            <div className="bg-blue-50 rounded-xl p-2 border border-blue-200">
              <div className="font-semibold text-blue-800 text-sm mb-1">Log-Partition Magic</div>
              <div className="space-y-1 text-sm">
                <div className="bg-white rounded p-1"><Latex math="\nabla A(\eta) = \mathbb{E}[T(X)]" /></div>
                <div className="bg-white rounded p-1"><Latex math="\nabla^2 A(\eta) = \text{Var}[T(X)]" /></div>
                <div className="bg-white rounded p-1"><Latex math="I(\eta) = \nabla^2 A(\eta)" /></div>
              </div>
            </div>
    
            <div className="bg-green-50 rounded-xl p-2 border border-green-200">
              <div className="font-semibold text-green-800 text-sm mb-1">Key Properties</div>
              <ul className="text-xs text-green-700 space-y-1">
                <li>✓ <Latex math="\Xi" /> is convex</li>
                <li>✓ <Latex math="A(\eta)" /> is convex</li>
                <li>✓ Fixed-dim sufficient stats</li>
                <li>✓ One-to-one <Latex math="\eta \leftrightarrow \mu" /></li>
              </ul>
            </div>
    
            <div className="bg-purple-50 rounded-xl p-2 border border-purple-200">
              <div className="font-semibold text-purple-800 text-sm mb-1">Common Members</div>
              <div className="text-xs text-purple-700">
                Bernoulli, Binomial, Poisson, Normal, Exponential, Gamma, Beta, Multinomial
              </div>
              <div className="text-xs text-purple-600 mt-1">
                <strong>Not:</strong> Cauchy, Uniform(0,<Latex math="\theta" />), mixtures
              </div>
            </div>
    
            <div className="bg-amber-50 rounded-xl p-2 border border-amber-200">
              <div className="font-semibold text-amber-800 text-sm mb-1">GLM Links</div>
              <div className="text-xs text-amber-700 space-y-1">
                <div>Bernoulli: logit</div>
                <div>Poisson: log</div>
                <div>Normal: identity</div>
                <div>Gamma: reciprocal</div>
              </div>
            </div>
          </div>
    
          {/* IID sample result */}
          <div className="bg-teal-100 rounded-lg p-2 mb-2 border border-teal-300">
            <div className="flex items-center gap-3">
              <div className="font-semibold text-teal-800 text-sm">For n IID obs:</div>
              <div className="text-sm text-teal-700">
                <Latex math="T^{(n)} = \sum_{i=1}^n T(x_i)" /> is sufficient (dimension independent of n)
              </div>
            </div>
          </div>
    
          {/* Looking ahead */}
          <div className="bg-slate-100 rounded-lg p-2 border border-slate-300">
            <div className="font-semibold text-slate-800 text-sm mb-1">Coming Up</div>
            <div className="grid grid-cols-3 gap-2 text-xs">
              <div className="bg-white rounded p-1 text-center">
                <div className="font-semibold text-slate-700">§3.2</div>
                <div className="text-slate-600">MLE Theory</div>
              </div>
              <div className="bg-white rounded p-1 text-center">
                <div className="font-semibold text-slate-700">§3.3</div>
                <div className="text-slate-600">Sampling Variability</div>
              </div>
              <div className="bg-white rounded p-1 text-center">
                <div className="font-semibold text-slate-700">§3.4-5</div>
                <div className="text-slate-600">Linear Models & GLMs</div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                  SLIDE 21: LIKELIHOOD NOT PROBABILITY
// ═══════════════════════════════════════════════════════════════════════

function Slide21_LikelihoodNotProbability() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">Likelihood is NOT a Probability Density</h1>
          <p className="text-gray-600 mb-3">A critical conceptual distinction</p>
    
          {/* Warning banner */}
          <div className="bg-red-100 border-2 border-red-400 rounded-xl p-3 mb-3">
            <div className="flex items-center gap-3">
              <div className="text-4xl">⚠️</div>
              <div>
                <div className="font-bold text-red-800 text-lg mb-1">Common Misconception</div>
                <div className="text-red-700">
                  While <Latex math="L(\theta)" /> is built from probability densities, it is <strong>NOT</strong> a probability density over <Latex math="\theta" />
                </div>
              </div>
            </div>
          </div>
    
          <div className="grid grid-cols-2 gap-3 flex-1">
            {/* Left: The problem */}
            <div className="space-y-3">
              {/* Key fact */}
              <div className="bg-amber-50 rounded-xl p-3 border border-amber-200">
                <div className="font-semibold text-amber-800 mb-2">The Key Fact</div>
                <div className="bg-white rounded-lg p-3 text-center mb-2">
                  <Latex math="\int L(\theta) \, d\theta \neq 1 \quad \text{in general}" display={true} />
                </div>
                <div className="text-sm text-amber-700">
                  This integral may equal some data-dependent constant, or it may <strong>diverge to infinity!</strong>
                </div>
              </div>
    
              {/* Counterexample */}
              <div className="bg-red-50 rounded-xl p-3 border border-red-200 flex-1">
                <div className="font-semibold text-red-800 mb-2">Counterexample: Normal Mean</div>
                <div className="text-sm text-red-700 space-y-2">
                  <div>For <Latex math="X_i \sim N(\mu, \sigma^2)" /> with known <Latex math="\sigma^2" />:</div>
                  <div className="bg-white rounded p-2 text-center">
                    <Latex math="L(\mu) \propto \exp\left\{-\frac{n(\bar{x} - \mu)^2}{2\sigma^2}\right\}" />
                  </div>
                  <div>Integrating over all <Latex math="\mu \in \mathbb{R}" />:</div>
                  <div className="bg-white rounded p-2 text-center">
                    <Latex math="\int_{-\infty}^{\infty} L(\mu) \, d\mu = \infty" />
                  </div>
                  <div className="text-red-600 font-semibold">The integral diverges!</div>
                </div>
              </div>
            </div>
    
            {/* Right: What it means */}
            <div className="space-y-3">
              {/* What likelihood measures */}
              <div className="bg-green-50 rounded-xl p-3 border border-green-200">
                <div className="font-semibold text-green-800 mb-2">What Likelihood DOES Measure</div>
                <div className="space-y-2 text-sm text-green-700">
                  <div className="flex items-start gap-2">
                    <span className="text-green-500 font-bold">✓</span>
                    <div><strong>Relative support:</strong> How much the data favor one <Latex math="\theta" /> vs another</div>
                  </div>
                  <div className="flex items-start gap-2">
                    <span className="text-green-500 font-bold">✓</span>
                    <div><strong>Likelihood ratios:</strong> <Latex math="L(\theta_1)/L(\theta_2)" /> is meaningful</div>
                  </div>
                  <div className="flex items-start gap-2">
                    <span className="text-green-500 font-bold">✓</span>
                    <div><strong>Data probability:</strong> "If <Latex math="\theta" /> is true, how probable is this data?"</div>
                  </div>
                </div>
              </div>
    
              {/* What likelihood doesn't measure */}
              <div className="bg-slate-100 rounded-xl p-3 border border-slate-300">
                <div className="font-semibold text-slate-800 mb-2">What Likelihood Does NOT Answer</div>
                <div className="space-y-2 text-sm text-slate-700">
                  <div className="flex items-start gap-2">
                    <span className="text-red-500 font-bold">✗</span>
                    <div>"What's the probability <Latex math="\theta" /> is the true value?"</div>
                  </div>
                  <div className="flex items-start gap-2">
                    <span className="text-red-500 font-bold">✗</span>
                    <div>Absolute probability statements about parameters</div>
                  </div>
                  <div className="bg-white rounded p-2 mt-2 text-xs">
                    <strong>For probability statements about <Latex math="\theta" />:</strong> Need Bayesian methods with a prior (Chapter 5)
                  </div>
                </div>
              </div>
    
              {/* Correct interpretation */}
              <div className="bg-blue-50 rounded-xl p-3 border border-blue-200">
                <div className="font-semibold text-blue-800 mb-2">Correct Interpretation</div>
                <div className="bg-white rounded-lg p-2 text-sm text-center">
                  <div className="mb-1">If <Latex math="L(\theta_1) = 10 \cdot L(\theta_2)" /></div>
                  <div className="text-blue-700 font-semibold">
                    "The data support <Latex math="\theta_1" /> ten times more than <Latex math="\theta_2" />"
                  </div>
                  <div className="text-blue-600 text-xs mt-1">(NOT "10x more probable")</div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom takeaway */}
          <div className="mt-3 bg-gradient-to-r from-purple-100 to-pink-100 rounded-lg p-2 text-center">
            <span className="font-semibold text-purple-800">Key Insight:</span>
            <span className="text-purple-700 ml-2">
              Likelihood measures <strong>relative support</strong> from data, not probability of parameters
            </span>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                           SLIDE 21: MLE HERO
// ═══════════════════════════════════════════════════════════════════════

function Slide21_MLEHero() {
  return (
    <div className="flex flex-col h-full bg-gradient-to-br from-blue-900 via-blue-800 to-indigo-900 text-white p-6">
          {/* Section identifier */}
          <div className="text-blue-300 text-sm font-semibold tracking-wider mb-2">
            SECTION 3.2
          </div>
          
          {/* Main title */}
          <h1 className="text-4xl font-bold mb-2">Maximum Likelihood Estimation</h1>
          <p className="text-xl text-blue-200 mb-6">Learning from Data: Fisher's Revolution</p>
    
          {/* Fisher quote */}
          <div className="bg-white/10 backdrop-blur rounded-xl p-4 mb-6 border border-white/20">
            <p className="text-lg italic text-blue-100 mb-2">
              "Choose the parameter value that makes the observed data most probable."
            </p>
            <p className="text-blue-300 text-sm">— R.A. Fisher's insight (1912-1925)</p>
          </div>
    
          {/* Central equation */}
          <div className="bg-white rounded-xl p-4 mb-6 text-center">
            <div className="text-gray-600 text-sm mb-2">The Maximum Likelihood Estimator</div>
            <div className="text-gray-900">
              <Latex math="\hat{\theta}_{\text{MLE}} = \arg\max_{\theta \in \Theta} L(\theta; x_1, \ldots, x_n)" display={true} />
            </div>
          </div>
    
          {/* Four pillars */}
          <div className="grid grid-cols-4 gap-3 flex-1">
            <div className="bg-white/10 backdrop-blur rounded-xl p-3 border border-white/20">
              <div className="text-3xl mb-2">📊</div>
              <div className="font-semibold text-blue-100 mb-1">Likelihood</div>
              <div className="text-xs text-blue-200">
                Function of <Latex math="\theta" /> measuring data support
              </div>
            </div>
            
            <div className="bg-white/10 backdrop-blur rounded-xl p-3 border border-white/20">
              <div className="text-3xl mb-2">📈</div>
              <div className="font-semibold text-blue-100 mb-1">Score & Information</div>
              <div className="text-xs text-blue-200">
                Gradient and curvature of log-likelihood
              </div>
            </div>
            
            <div className="bg-white/10 backdrop-blur rounded-xl p-3 border border-white/20">
              <div className="text-3xl mb-2">⚙️</div>
              <div className="font-semibold text-blue-100 mb-1">Computation</div>
              <div className="text-xs text-blue-200">
                Analytical, Newton-Raphson, Fisher scoring
              </div>
            </div>
            
            <div className="bg-white/10 backdrop-blur rounded-xl p-3 border border-white/20">
              <div className="text-3xl mb-2">🔮</div>
              <div className="font-semibold text-blue-100 mb-1">Asymptotics</div>
              <div className="text-xs text-blue-200">
                Consistency, normality, efficiency
              </div>
            </div>
          </div>
    
          {/* Connection to previous section */}
          <div className="mt-4 bg-gradient-to-r from-purple-500/30 to-pink-500/30 rounded-lg p-3 border border-purple-300/30">
            <div className="text-center text-sm">
              <span className="font-semibold text-purple-200">Connection:</span>
              <span className="text-purple-100 ml-2">
                For exponential families, MLE reduces to moment matching: <Latex math="\nabla A(\hat{\eta}) = \bar{T}" />
              </span>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                      SLIDE 22: LIKELIHOOD FUNCTION
// ═══════════════════════════════════════════════════════════════════════

function Slide22_LikelihoodFunction() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">The Likelihood Function</h1>
          <p className="text-gray-600 mb-3">A function of <Latex math="\theta" />, not a probability of data</p>
    
          {/* Definition box */}
          <div className="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-4 border-2 border-blue-300 mb-4">
            <div className="text-center mb-3">
              <div className="text-sm font-semibold text-blue-700 mb-2">For iid observations <Latex math="X_1, \ldots, X_n" /> with density <Latex math="f(x|\theta)" /></div>
              <Latex math="L(\theta) = L(\theta; x_1, \ldots, x_n) = \prod_{i=1}^n f(x_i | \theta)" display={true} />
            </div>
            <div className="bg-white rounded-lg p-2 text-center">
              <span className="text-blue-800 font-semibold">The Conceptual Shift:</span>
              <span className="text-blue-700 ml-2">Data <Latex math="x_1, \ldots, x_n" /> are <strong>FIXED</strong>; parameter <Latex math="\theta" /> <strong>VARIES</strong></span>
            </div>
          </div>
    
          {/* Three-panel visualization concept */}
          <div className="grid grid-cols-3 gap-3 flex-1 mb-3">
            {/* Panel 1: Data */}
            <div className="bg-slate-100 rounded-xl p-3 border border-slate-300">
              <div className="text-center mb-2">
                <div className="bg-slate-700 text-white text-xs font-semibold px-2 py-1 rounded inline-block">1. OBSERVE DATA</div>
              </div>
              <div className="bg-white rounded-lg p-2 h-24 flex items-center justify-center">
                <div className="text-center">
                  <div className="text-4xl mb-1">📊</div>
                  <div className="text-xs text-slate-600">Histogram of <Latex math="x_1, \ldots, x_n" /></div>
                </div>
              </div>
              <div className="text-xs text-slate-600 mt-2 text-center">
                Data are <strong>fixed</strong>—we observed them
              </div>
            </div>
    
            {/* Panel 2: Likelihood curve */}
            <div className="bg-blue-50 rounded-xl p-3 border border-blue-300">
              <div className="text-center mb-2">
                <div className="bg-blue-600 text-white text-xs font-semibold px-2 py-1 rounded inline-block">2. COMPUTE <Latex math="L(\theta)" /></div>
              </div>
              <div className="bg-white rounded-lg p-2 h-24 flex items-center justify-center">
                <div className="text-center">
                  <div className="text-4xl mb-1">📈</div>
                  <div className="text-xs text-blue-600">Likelihood curve over <Latex math="\Theta" /></div>
                </div>
              </div>
              <div className="text-xs text-blue-600 mt-2 text-center">
                For each <Latex math="\theta" />, compute the product
              </div>
            </div>
    
            {/* Panel 3: argmax */}
            <div className="bg-green-50 rounded-xl p-3 border border-green-300">
              <div className="text-center mb-2">
                <div className="bg-green-600 text-white text-xs font-semibold px-2 py-1 rounded inline-block">3. FIND MAXIMUM</div>
              </div>
              <div className="bg-white rounded-lg p-2 h-24 flex items-center justify-center">
                <div className="text-center">
                  <div className="text-4xl mb-1">🎯</div>
                  <div className="text-xs text-green-600"><Latex math="\hat{\theta} = \arg\max L(\theta)" /></div>
                </div>
              </div>
              <div className="text-xs text-green-600 mt-2 text-center">
                MLE is where the curve peaks
              </div>
            </div>
          </div>
    
          {/* Example */}
          <div className="bg-amber-50 rounded-xl p-3 border border-amber-200">
            <div className="flex items-start gap-3">
              <div className="text-2xl">💡</div>
              <div className="flex-1">
                <div className="font-semibold text-amber-800 mb-1">Example: Poisson Likelihood</div>
                <div className="grid grid-cols-2 gap-3 text-sm">
                  <div>
                    <div className="text-amber-700">Model: <Latex math="X_i \sim \text{Poisson}(\lambda)" /></div>
                    <div className="text-amber-600 text-xs mt-1">PMF: <Latex math="P(X=x|\lambda) = \frac{e^{-\lambda}\lambda^x}{x!}" /></div>
                  </div>
                  <div>
                    <div className="text-amber-700">Likelihood:</div>
                    <div className="bg-white rounded p-1 text-xs">
                      <Latex math="L(\lambda) = \frac{e^{-n\lambda} \lambda^{\sum x_i}}{\prod x_i!}" />
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom key insight */}
          <div className="mt-3 bg-gradient-to-r from-purple-100 to-pink-100 rounded-lg p-2 text-center">
            <span className="font-semibold text-purple-800">Key Insight:</span>
            <span className="text-purple-700 ml-2">
              Same formula as joint density, but now we view it as a function of <Latex math="\theta" /> for fixed data
            </span>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                        SLIDE 22: LOG LIKELIHOOD
// ═══════════════════════════════════════════════════════════════════════

function Slide22_LogLikelihood() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">The Log-Likelihood</h1>
          <p className="text-gray-600 mb-3">Why we always take logarithms</p>
    
          {/* Definition box */}
          <div className="bg-blue-50 rounded-xl p-3 border-2 border-blue-300 mb-3">
            <div className="grid grid-cols-2 gap-4">
              <div className="text-center">
                <div className="text-sm font-semibold text-blue-700 mb-1">Likelihood (product)</div>
                <Latex math="L(\theta) = \prod_{i=1}^n f(x_i|\theta)" display={true} />
              </div>
              <div className="text-center">
                <div className="text-sm font-semibold text-blue-700 mb-1">Log-likelihood (sum)</div>
                <Latex math="\ell(\theta) = \sum_{i=1}^n \log f(x_i|\theta)" display={true} />
              </div>
            </div>
            <div className="text-center text-sm text-blue-600 mt-2">
              Same maximizer: <Latex math="\arg\max L(\theta) = \arg\max \ell(\theta)" /> since <Latex math="\log" /> is monotonic
            </div>
          </div>
    
          {/* Three reasons */}
          <div className="grid grid-cols-3 gap-3 flex-1">
            {/* Reason 1: Numerical Stability */}
            <div className="bg-gradient-to-br from-red-50 to-red-100 rounded-xl p-3 border border-red-200">
              <div className="flex items-center gap-2 mb-2">
                <div className="bg-red-500 text-white rounded-full w-7 h-7 flex items-center justify-center font-bold text-sm">1</div>
                <div className="font-semibold text-red-800">Numerical Stability</div>
              </div>
              
              <div className="space-y-2 text-sm">
                <div className="bg-white rounded-lg p-2">
                  <div className="text-red-700 font-semibold text-xs mb-1">The Problem:</div>
                  <div className="text-red-600 text-xs">
                    Product of many small numbers <Latex math="\rightarrow" /> underflow
                  </div>
                </div>
                
                <div className="bg-white rounded-lg p-2">
                  <div className="text-red-700 font-semibold text-xs mb-1">Example (<Latex math="n=1000" />):</div>
                  <div className="text-xs text-red-600">
                    <div><Latex math="L(\theta) \approx 10^{-1000}" /></div>
                    <div className="text-red-500 mt-1">Float64 min: <Latex math="\approx 10^{-308}" /></div>
                  </div>
                </div>
                
                <div className="bg-green-100 rounded-lg p-2 border border-green-300">
                  <div className="text-green-700 font-semibold text-xs mb-1">Solution:</div>
                  <div className="text-xs text-green-600">
                    <Latex math="\ell(\theta) \approx -2300" />
                    <div className="text-green-500">Perfectly representable!</div>
                  </div>
                </div>
              </div>
            </div>
    
            {/* Reason 2: Computational Convenience */}
            <div className="bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-3 border border-green-200">
              <div className="flex items-center gap-2 mb-2">
                <div className="bg-green-500 text-white rounded-full w-7 h-7 flex items-center justify-center font-bold text-sm">2</div>
                <div className="font-semibold text-green-800">Easy Derivatives</div>
              </div>
              
              <div className="space-y-2 text-sm">
                <div className="bg-white rounded-lg p-2">
                  <div className="text-green-700 font-semibold text-xs mb-1">Products are hard:</div>
                  <div className="text-xs text-green-600">
                    Product rule with <Latex math="n" /> terms is messy
                  </div>
                </div>
                
                <div className="bg-white rounded-lg p-2">
                  <div className="text-green-700 font-semibold text-xs mb-1">Sums are easy:</div>
                  <div className="text-xs text-green-600">
                    <Latex math="\frac{d}{d\theta}\sum g_i = \sum \frac{dg_i}{d\theta}" />
                  </div>
                </div>
                
                <div className="bg-white rounded-lg p-2">
                  <div className="text-green-700 font-semibold text-xs mb-1">Score function:</div>
                  <div className="text-xs text-green-600">
                    <Latex math="U(\theta) = \sum_i \frac{\partial}{\partial\theta}\log f(x_i|\theta)" />
                  </div>
                </div>
                
                <div className="text-xs text-green-600 mt-1">
                  Enables Newton-Raphson, Fisher scoring
                </div>
              </div>
            </div>
    
            {/* Reason 3: Theoretical Elegance */}
            <div className="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-3 border border-purple-200">
              <div className="flex items-center gap-2 mb-2">
                <div className="bg-purple-500 text-white rounded-full w-7 h-7 flex items-center justify-center font-bold text-sm">3</div>
                <div className="font-semibold text-purple-800">Asymptotic Theory</div>
              </div>
              
              <div className="space-y-2 text-sm">
                <div className="bg-white rounded-lg p-2">
                  <div className="text-purple-700 font-semibold text-xs mb-1">Additivity:</div>
                  <div className="text-xs text-purple-600">
                    <Latex math="\ell(\theta) = \sum_{i=1}^n \ell_i(\theta)" />
                  </div>
                </div>
                
                <div className="bg-white rounded-lg p-2">
                  <div className="text-purple-700 font-semibold text-xs mb-1">LLN applies:</div>
                  <div className="text-xs text-purple-600">
                    <Latex math="\frac{1}{n}\ell \to \mathbb{E}[\log f]" />
                  </div>
                </div>
                
                <div className="bg-white rounded-lg p-2">
                  <div className="text-purple-700 font-semibold text-xs mb-1">CLT applies:</div>
                  <div className="text-xs text-purple-600">
                    <Latex math="\frac{U(\theta_0)}{\sqrt{n}} \to N(0, I_1)" />
                  </div>
                </div>
                
                <div className="bg-white rounded-lg p-2">
                  <div className="text-purple-700 font-semibold text-xs mb-1">Info additivity:</div>
                  <div className="text-xs text-purple-600">
                    <Latex math="I_n(\theta) = n \cdot I_1(\theta)" />
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom insight */}
          <div className="mt-3 bg-gradient-to-r from-amber-100 to-orange-100 rounded-lg p-2">
            <div className="text-center">
              <span className="font-semibold text-amber-800">Key Insight:</span>
              <span className="text-amber-700 ml-2">
                The logarithm converts products <Latex math="\rightarrow" /> sums, enabling stable computation and clean theory
              </span>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                  SLIDE 23: LIKELIHOOD NOT PROBABILITY
// ═══════════════════════════════════════════════════════════════════════

function Slide23_LikelihoodNotProbability() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">Likelihood is NOT a Probability Density</h1>
          <p className="text-gray-600 mb-3">A critical conceptual distinction</p>
    
          {/* Warning banner */}
          <div className="bg-red-100 border-2 border-red-400 rounded-xl p-3 mb-3">
            <div className="flex items-center gap-3">
              <div className="text-4xl">⚠️</div>
              <div>
                <div className="font-bold text-red-800 text-lg mb-1">Common Misconception</div>
                <div className="text-red-700">
                  While <Latex math="L(\theta)" /> is built from probability densities, it is <strong>NOT</strong> a probability density over <Latex math="\theta" />
                </div>
              </div>
            </div>
          </div>
    
          <div className="grid grid-cols-2 gap-3 flex-1">
            {/* Left: The problem */}
            <div className="space-y-3">
              {/* Key fact */}
              <div className="bg-amber-50 rounded-xl p-3 border border-amber-200">
                <div className="font-semibold text-amber-800 mb-2">The Key Fact</div>
                <div className="bg-white rounded-lg p-3 text-center mb-2">
                  <Latex math="\int L(\theta) \, d\theta \neq 1 \quad \text{in general}" display={true} />
                </div>
                <div className="text-sm text-amber-700">
                  This integral may equal some data-dependent constant, or it may <strong>diverge to infinity!</strong>
                </div>
              </div>
    
              {/* Example */}
              <div className="bg-amber-50 rounded-xl p-3 border border-amber-200 flex-1">
                <div className="font-semibold text-amber-800 mb-2">Example: Poisson</div>
                <div className="text-sm text-amber-700 space-y-2">
                  <div>For <Latex math="X_i \sim \text{Poisson}(\lambda)" />:</div>
                  <div className="bg-white rounded p-2 text-center">
                    <Latex math="L(\lambda) = \frac{e^{-n\lambda} \lambda^{\sum x_i}}{\prod x_i!}" />
                  </div>
                  <div>Integrating over <Latex math="\lambda \in (0, \infty)" />:</div>
                  <div className="bg-white rounded p-2 text-center">
                    <Latex math="\int_0^\infty L(\lambda) \, d\lambda = \frac{\Gamma(\sum x_i + 1)}{n^{\sum x_i + 1} \prod x_i!}" />
                  </div>
                  <div className="text-amber-600 font-semibold">Finite, but data-dependent and ≠ 1</div>
                </div>
              </div>
            </div>
    
            {/* Right: What it means */}
            <div className="space-y-3">
              {/* What likelihood measures */}
              <div className="bg-green-50 rounded-xl p-3 border border-green-200">
                <div className="font-semibold text-green-800 mb-2">What Likelihood DOES Measure</div>
                <div className="space-y-2 text-sm text-green-700">
                  <div className="flex items-start gap-2">
                    <span className="text-green-500 font-bold">✓</span>
                    <div><strong>Relative support:</strong> <Latex math="L(\theta_1)/L(\theta_2)" /> tells how much data favor <Latex math="\theta_1" /> over <Latex math="\theta_2" /></div>
                  </div>
                  <div className="flex items-start gap-2">
                    <span className="text-green-500 font-bold">✓</span>
                    <div><strong>Function of <Latex math="\theta" />:</strong> Data fixed, parameter varies — opposite of a sampling distribution</div>
                  </div>
                </div>
              </div>
    
              {/* What likelihood doesn't measure */}
              <div className="bg-slate-100 rounded-xl p-3 border border-slate-300">
                <div className="font-semibold text-slate-800 mb-2">What Likelihood Does NOT Provide</div>
                <div className="space-y-2 text-sm text-slate-700">
                  <div className="flex items-start gap-2">
                    <span className="text-red-500 font-bold">✗</span>
                    <div><strong>Probability of parameter:</strong> <Latex math="P(\theta = \theta_0 | x)" /> is undefined without a prior</div>
                  </div>
                  <div className="flex items-start gap-2">
                    <span className="text-red-500 font-bold">✗</span>
                    <div><strong>Absolute scale:</strong> <Latex math="L(\theta) = 0.03" /> alone means nothing; only ratios matter</div>
                  </div>
                </div>
                <div className="bg-white rounded p-2 mt-2 text-xs">
                  <strong>Frequentist:</strong> <Latex math="\theta" /> is fixed, not random — probability statements are ill-formed<br/>
                  <strong>Bayesian:</strong> Probability reflects uncertainty — requires prior (Chapter 5)
                </div>
              </div>
    
              {/* Correct interpretation */}
              <div className="bg-blue-50 rounded-xl p-3 border border-blue-200">
                <div className="font-semibold text-blue-800 mb-2">Correct Interpretation</div>
                <div className="bg-white rounded-lg p-2 text-sm text-center">
                  <div className="mb-1">If <Latex math="L(\theta_1) = 10 \cdot L(\theta_2)" /></div>
                  <div className="text-blue-700 font-semibold">
                    "The data support <Latex math="\theta_1" /> ten times more than <Latex math="\theta_2" />"
                  </div>
                  <div className="text-blue-600 text-xs mt-1">(NOT "10x more probable")</div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom takeaway */}
          <div className="mt-3 bg-gradient-to-r from-purple-100 to-pink-100 rounded-lg p-2 text-center">
            <span className="font-semibold text-purple-800">Key Insight:</span>
            <span className="text-purple-700 ml-2">
              Likelihood measures <strong>relative support</strong> from data, not probability of parameters
            </span>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                     SLIDE 23: NORMAL LOG LIKELIHOOD
// ═══════════════════════════════════════════════════════════════════════

function Slide23_NormalLogLikelihood() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">Example: Normal Log-Likelihood</h1>
          <p className="text-gray-600 mb-2">Step-by-step derivation for <Latex math="N(\mu, \sigma^2)" /></p>
    
          <div className="flex-1 space-y-2">
            {/* Setup */}
            <div className="bg-blue-50 rounded-lg p-2 border border-blue-200">
              <div className="flex items-center gap-3">
                <div className="bg-blue-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-xs">1</div>
                <div className="text-sm">
                  <span className="font-semibold text-blue-800">Setup:</span>
                  <span className="text-blue-700 ml-2">
                    <Latex math="X_1, \ldots, X_n \stackrel{\text{iid}}{\sim} N(\mu, \sigma^2)" /> with density 
                    <Latex math="f(x|\mu,\sigma^2) = \frac{1}{\sqrt{2\pi\sigma^2}}\exp\left\{-\frac{(x-\mu)^2}{2\sigma^2}\right\}" />
                  </span>
                </div>
              </div>
            </div>
    
            {/* Likelihood */}
            <div className="bg-green-50 rounded-lg p-2 border border-green-200">
              <div className="flex items-center gap-3">
                <div className="bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-xs">2</div>
                <div className="text-sm">
                  <span className="font-semibold text-green-800">Likelihood:</span>
                  <span className="text-green-700 ml-2">
                    <Latex math="L(\mu, \sigma^2) = (2\pi\sigma^2)^{-n/2} \exp\left\{-\frac{1}{2\sigma^2}\sum_{i=1}^n(x_i-\mu)^2\right\}" />
                  </span>
                </div>
              </div>
            </div>
    
            {/* Log-likelihood */}
            <div className="bg-amber-50 rounded-lg p-2 border border-amber-200">
              <div className="flex items-center gap-3">
                <div className="bg-amber-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-xs">3</div>
                <div className="flex-1">
                  <span className="font-semibold text-amber-800 text-sm">Log-likelihood:</span>
                  <div className="bg-white rounded p-2 mt-1">
                    <Latex math="\ell(\mu, \sigma^2) = -\frac{n}{2}\log(2\pi) - \frac{n}{2}\log(\sigma^2) - \frac{1}{2\sigma^2}\sum_{i=1}^n(x_i-\mu)^2" display={true} />
                  </div>
                </div>
              </div>
            </div>
    
            {/* Key decomposition */}
            <div className="bg-purple-50 rounded-lg p-2 border border-purple-200">
              <div className="flex items-center gap-3">
                <div className="bg-purple-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-xs">4</div>
                <div className="flex-1">
                  <span className="font-semibold text-purple-800 text-sm">Key identity:</span>
                  <span className="text-purple-700 text-sm ml-2">
                    <Latex math="\sum(x_i - \mu)^2 = \sum(x_i - \bar{x})^2 + n(\bar{x} - \mu)^2" />
                  </span>
                </div>
              </div>
            </div>
    
            {/* Sufficient statistics */}
            <div className="bg-gradient-to-r from-teal-50 to-cyan-50 rounded-xl p-3 border-2 border-teal-300">
              <div className="flex items-start gap-3">
                <div className="bg-teal-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-xs flex-shrink-0">5</div>
                <div className="flex-1">
                  <div className="font-semibold text-teal-800 mb-2">Sufficient Statistics (The Magic!)</div>
                  <div className="grid grid-cols-2 gap-3">
                    <div className="bg-white rounded-lg p-2 text-center">
                      <div className="text-xs text-teal-600 mb-1">Log-likelihood depends on data only through:</div>
                      <div className="text-sm">
                        <Latex math="T(\mathbf{x}) = \left(\sum x_i, \sum x_i^2\right)" />
                      </div>
                    </div>
                    <div className="bg-white rounded-lg p-2 text-center">
                      <div className="text-xs text-teal-600 mb-1">Equivalently:</div>
                      <div className="text-sm">
                        <Latex math="\bar{x} \text{ and } \sum(x_i - \bar{x})^2" />
                      </div>
                    </div>
                  </div>
                  <div className="text-center text-xs text-teal-600 mt-2">
                    <strong>2 numbers</strong> capture ALL information from <strong>n observations</strong>!
                  </div>
                </div>
              </div>
            </div>
    
            {/* MLE preview */}
            <div className="bg-gradient-to-r from-pink-50 to-rose-50 rounded-xl p-3 border border-pink-200">
              <div className="flex items-start gap-3">
                <div className="bg-pink-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-xs flex-shrink-0">6</div>
                <div className="flex-1">
                  <div className="font-semibold text-pink-800 mb-2">MLE Preview (to be derived)</div>
                  <div className="grid grid-cols-2 gap-3">
                    <div className="bg-white rounded-lg p-2 text-center">
                      <div className="text-xs text-pink-600 mb-1">Mean:</div>
                      <Latex math="\hat{\mu} = \bar{x}" display={true} />
                    </div>
                    <div className="bg-white rounded-lg p-2 text-center">
                      <div className="text-xs text-pink-600 mb-1">Variance:</div>
                      <Latex math="\hat{\sigma}^2 = \frac{1}{n}\sum(x_i - \bar{x})^2" display={true} />
                    </div>
                  </div>
                  <div className="text-center text-xs text-pink-600 mt-2 bg-pink-100 rounded p-1">
                    <strong>Note:</strong> MLE divides by <Latex math="n" />, not <Latex math="n-1" /> — this is <strong>biased</strong>!
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom connection */}
          <div className="mt-2 bg-slate-100 rounded-lg p-2 text-center text-sm">
            <span className="font-semibold text-slate-700">Connection:</span>
            <span className="text-slate-600 ml-2">
              Matches exponential family form with <Latex math="T(x) = (x, x^2)" /> from Section 3.1
            </span>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                        SLIDE 24: LOG LIKELIHOOD
// ═══════════════════════════════════════════════════════════════════════

function Slide24_LogLikelihood() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">The Log-Likelihood</h1>
          <p className="text-gray-600 mb-3">Why we always take logarithms</p>
    
          {/* Definition box */}
          <div className="bg-blue-50 rounded-xl p-3 border-2 border-blue-300 mb-3">
            <div className="grid grid-cols-2 gap-4">
              <div className="text-center">
                <div className="text-sm font-semibold text-blue-700 mb-1">Likelihood (product)</div>
                <Latex math="L(\theta) = \prod_{i=1}^n f(x_i|\theta)" display={true} />
              </div>
              <div className="text-center">
                <div className="text-sm font-semibold text-blue-700 mb-1">Log-likelihood (sum)</div>
                <Latex math="\ell(\theta) = \sum_{i=1}^n \log f(x_i|\theta)" display={true} />
              </div>
            </div>
            <div className="text-center text-sm text-blue-600 mt-2">
              Same maximizer: <Latex math="\arg\max L(\theta) = \arg\max \ell(\theta)" /> since <Latex math="\log" /> is monotonic
            </div>
          </div>
    
          {/* Three reasons */}
          <div className="grid grid-cols-3 gap-3 flex-1">
            {/* Reason 1: Numerical Stability */}
            <div className="bg-gradient-to-br from-red-50 to-red-100 rounded-xl p-3 border border-red-200">
              <div className="flex items-center gap-2 mb-2">
                <div className="bg-red-500 text-white rounded-full w-7 h-7 flex items-center justify-center font-bold text-sm">1</div>
                <div className="font-semibold text-red-800">Numerical Stability</div>
              </div>
              
              <div className="space-y-2 text-sm">
                <div className="bg-white rounded-lg p-2">
                  <div className="text-red-700 font-semibold text-xs mb-1">The Problem:</div>
                  <div className="text-red-600 text-xs">
                    Product of many small numbers <Latex math="\rightarrow" /> underflow
                  </div>
                </div>
                
                <div className="bg-white rounded-lg p-2">
                  <div className="text-red-700 font-semibold text-xs mb-1">Example (<Latex math="n=1000" />):</div>
                  <div className="text-xs text-red-600">
                    <div><Latex math="L(\theta) \approx 10^{-1000}" /></div>
                    <div className="text-red-500 mt-1">Float64 min: <Latex math="\approx 10^{-308}" /></div>
                  </div>
                </div>
                
                <div className="bg-green-100 rounded-lg p-2 border border-green-300">
                  <div className="text-green-700 font-semibold text-xs mb-1">Solution:</div>
                  <div className="text-xs text-green-600">
                    <Latex math="\ell(\theta) \approx -2300" />
                    <div className="text-green-500">Perfectly representable!</div>
                  </div>
                </div>
              </div>
            </div>
    
            {/* Reason 2: Computational Convenience */}
            <div className="bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-3 border border-green-200">
              <div className="flex items-center gap-2 mb-2">
                <div className="bg-green-500 text-white rounded-full w-7 h-7 flex items-center justify-center font-bold text-sm">2</div>
                <div className="font-semibold text-green-800">Easy Derivatives</div>
              </div>
              
              <div className="space-y-2 text-sm">
                <div className="bg-white rounded-lg p-2">
                  <div className="text-green-700 font-semibold text-xs mb-1">Products are hard:</div>
                  <div className="text-xs text-green-600">
                    Product rule with <Latex math="n" /> terms is messy
                  </div>
                </div>
                
                <div className="bg-white rounded-lg p-2">
                  <div className="text-green-700 font-semibold text-xs mb-1">Sums are easy:</div>
                  <div className="text-xs text-green-600">
                    <Latex math="\frac{d}{d\theta}\sum g_i = \sum \frac{dg_i}{d\theta}" />
                  </div>
                </div>
                
                <div className="bg-white rounded-lg p-2">
                  <div className="text-green-700 font-semibold text-xs mb-1">Score function:</div>
                  <div className="text-xs text-green-600">
                    <Latex math="U(\theta) = \sum_i \frac{\partial}{\partial\theta}\log f(x_i|\theta)" />
                  </div>
                </div>
                
                <div className="text-xs text-green-600 mt-1">
                  Enables Newton-Raphson, Fisher scoring
                </div>
              </div>
            </div>
    
            {/* Reason 3: Theoretical Elegance */}
            <div className="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-3 border border-purple-200">
              <div className="flex items-center gap-2 mb-2">
                <div className="bg-purple-500 text-white rounded-full w-7 h-7 flex items-center justify-center font-bold text-sm">3</div>
                <div className="font-semibold text-purple-800">Asymptotic Theory</div>
              </div>
              
              <div className="space-y-2 text-sm">
                <div className="bg-white rounded-lg p-2">
                  <div className="text-purple-700 font-semibold text-xs mb-1">Additivity:</div>
                  <div className="text-xs text-purple-600">
                    <Latex math="\ell(\theta) = \sum_{i=1}^n \ell_i(\theta)" />
                  </div>
                </div>
                
                <div className="bg-white rounded-lg p-2">
                  <div className="text-purple-700 font-semibold text-xs mb-1">LLN applies:</div>
                  <div className="text-xs text-purple-600">
                    <Latex math="\frac{1}{n}\ell \to \mathbb{E}[\log f]" />
                  </div>
                </div>
                
                <div className="bg-white rounded-lg p-2">
                  <div className="text-purple-700 font-semibold text-xs mb-1">CLT applies:</div>
                  <div className="text-xs text-purple-600">
                    <Latex math="\frac{U(\theta_0)}{\sqrt{n}} \to N(0, I_1)" />
                  </div>
                </div>
                
                <div className="bg-white rounded-lg p-2">
                  <div className="text-purple-700 font-semibold text-xs mb-1">Info additivity:</div>
                  <div className="text-xs text-purple-600">
                    <Latex math="I_n(\theta) = n \cdot I_1(\theta)" />
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom insight */}
          <div className="mt-3 bg-gradient-to-r from-amber-100 to-orange-100 rounded-lg p-2">
            <div className="text-center">
              <span className="font-semibold text-amber-800">Key Insight:</span>
              <span className="text-amber-700 ml-2">
                The logarithm converts products <Latex math="\rightarrow" /> sums, enabling stable computation and clean theory
              </span>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                     SLIDE 25: NORMAL LOG LIKELIHOOD
// ═══════════════════════════════════════════════════════════════════════

function Slide25_NormalLogLikelihood() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">Example: Normal Log-Likelihood</h1>
          <p className="text-gray-600 mb-2">Step-by-step derivation for <Latex math="N(\mu, \sigma^2)" /></p>
    
          <div className="flex-1 space-y-2">
            {/* Setup */}
            <div className="bg-blue-50 rounded-lg p-2 border border-blue-200">
              <div className="flex items-center gap-3">
                <div className="bg-blue-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-xs">1</div>
                <div className="text-sm">
                  <span className="font-semibold text-blue-800">Setup:</span>
                  <span className="text-blue-700 ml-2">
                    <Latex math="X_1, \ldots, X_n \stackrel{\text{iid}}{\sim} N(\mu, \sigma^2)" /> with density 
                    <Latex math="f(x|\mu,\sigma^2) = \frac{1}{\sqrt{2\pi\sigma^2}}\exp\left\{-\frac{(x-\mu)^2}{2\sigma^2}\right\}" />
                  </span>
                </div>
              </div>
            </div>
    
            {/* Likelihood */}
            <div className="bg-green-50 rounded-lg p-2 border border-green-200">
              <div className="flex items-center gap-3">
                <div className="bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-xs">2</div>
                <div className="text-sm">
                  <span className="font-semibold text-green-800">Likelihood:</span>
                  <span className="text-green-700 ml-2">
                    <Latex math="L(\mu, \sigma^2) = (2\pi\sigma^2)^{-n/2} \exp\left\{-\frac{1}{2\sigma^2}\sum_{i=1}^n(x_i-\mu)^2\right\}" />
                  </span>
                </div>
              </div>
            </div>
    
            {/* Log-likelihood */}
            <div className="bg-amber-50 rounded-lg p-2 border border-amber-200">
              <div className="flex items-center gap-3">
                <div className="bg-amber-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-xs">3</div>
                <div className="flex-1">
                  <span className="font-semibold text-amber-800 text-sm">Log-likelihood:</span>
                  <div className="bg-white rounded p-2 mt-1">
                    <Latex math="\ell(\mu, \sigma^2) = -\frac{n}{2}\log(2\pi) - \frac{n}{2}\log(\sigma^2) - \frac{1}{2\sigma^2}\sum_{i=1}^n(x_i-\mu)^2" display={true} />
                  </div>
                </div>
              </div>
            </div>
    
            {/* Key decomposition */}
            <div className="bg-purple-50 rounded-lg p-2 border border-purple-200">
              <div className="flex items-center gap-3">
                <div className="bg-purple-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-xs">4</div>
                <div className="flex-1">
                  <span className="font-semibold text-purple-800 text-sm">Key identity:</span>
                  <span className="text-purple-700 text-sm ml-2">
                    <Latex math="\sum(x_i - \mu)^2 = \sum(x_i - \bar{x})^2 + n(\bar{x} - \mu)^2" />
                  </span>
                </div>
              </div>
            </div>
    
            {/* Sufficient statistics */}
            <div className="bg-gradient-to-r from-teal-50 to-cyan-50 rounded-xl p-3 border-2 border-teal-300">
              <div className="flex items-start gap-3">
                <div className="bg-teal-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-xs flex-shrink-0">5</div>
                <div className="flex-1">
                  <div className="font-semibold text-teal-800 mb-2">Sufficient Statistics (The Magic!)</div>
                  <div className="grid grid-cols-2 gap-3">
                    <div className="bg-white rounded-lg p-2 text-center">
                      <div className="text-xs text-teal-600 mb-1">Log-likelihood depends on data only through:</div>
                      <div className="text-sm">
                        <Latex math="T(\mathbf{x}) = \left(\sum x_i, \sum x_i^2\right)" />
                      </div>
                    </div>
                    <div className="bg-white rounded-lg p-2 text-center">
                      <div className="text-xs text-teal-600 mb-1">Equivalently:</div>
                      <div className="text-sm">
                        <Latex math="\bar{x} \text{ and } \sum(x_i - \bar{x})^2" />
                      </div>
                    </div>
                  </div>
                  <div className="text-center text-xs text-teal-600 mt-2">
                    <strong>2 numbers</strong> capture ALL information from <strong>n observations</strong>!
                  </div>
                </div>
              </div>
            </div>
    
            {/* MLE preview */}
            <div className="bg-gradient-to-r from-pink-50 to-rose-50 rounded-xl p-3 border border-pink-200">
              <div className="flex items-start gap-3">
                <div className="bg-pink-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-xs flex-shrink-0">6</div>
                <div className="flex-1">
                  <div className="font-semibold text-pink-800 mb-2">MLE Preview (to be derived)</div>
                  <div className="grid grid-cols-2 gap-3">
                    <div className="bg-white rounded-lg p-2 text-center">
                      <div className="text-xs text-pink-600 mb-1">Mean:</div>
                      <Latex math="\hat{\mu} = \bar{x}" display={true} />
                    </div>
                    <div className="bg-white rounded-lg p-2 text-center">
                      <div className="text-xs text-pink-600 mb-1">Variance:</div>
                      <Latex math="\hat{\sigma}^2 = \frac{1}{n}\sum(x_i - \bar{x})^2" display={true} />
                    </div>
                  </div>
                  <div className="text-center text-xs text-pink-600 mt-2 bg-pink-100 rounded p-1">
                    <strong>Note:</strong> MLE divides by <Latex math="n" />, not <Latex math="n-1" /> — this is <strong>biased</strong>!
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom connection */}
          <div className="mt-2 bg-slate-100 rounded-lg p-2 text-center text-sm">
            <span className="font-semibold text-slate-700">Connection:</span>
            <span className="text-slate-600 ml-2">
              Matches exponential family form with <Latex math="T(x) = (x, x^2)" /> from Section 3.1
            </span>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                        SLIDE 26: SCORE FUNCTION
// ═══════════════════════════════════════════════════════════════════════

function Slide26_ScoreFunction() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">The Score Function</h1>
          <p className="text-gray-600 mb-3">Gradient of the log-likelihood</p>
    
          {/* Main definition */}
          <div className="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-4 border-2 border-blue-300 mb-4">
            <div className="grid grid-cols-2 gap-4">
              <div>
                <div className="text-sm font-semibold text-blue-700 mb-2">Scalar parameter</div>
                <div className="bg-white rounded-lg p-3 text-center">
                  <Latex math="U(\theta) = \frac{\partial \ell(\theta)}{\partial \theta}" display={true} />
                </div>
              </div>
              <div>
                <div className="text-sm font-semibold text-blue-700 mb-2">Vector parameter</div>
                <div className="bg-white rounded-lg p-3 text-center">
                  <Latex math="\mathbf{U}(\boldsymbol{\theta}) = \nabla \ell(\boldsymbol{\theta})" display={true} />
                </div>
              </div>
            </div>
          </div>
    
          <div className="grid grid-cols-2 gap-4 flex-1">
            {/* Left: Geometric interpretation */}
            <div className="space-y-3">
              <div className="bg-slate-100 rounded-xl p-3 border border-slate-300 h-36">
                <div className="font-semibold text-slate-800 mb-2">Geometric Interpretation</div>
                <div className="bg-white rounded-lg p-2 h-20 flex items-center justify-center">
                  <div className="text-center text-sm text-slate-600">
                    <div className="text-3xl mb-1">📈</div>
                    <div>Score = slope of tangent to <Latex math="\ell(\theta)" /></div>
                  </div>
                </div>
              </div>
    
              {/* MLE condition */}
              <div className="bg-green-50 rounded-xl p-3 border border-green-200">
                <div className="font-semibold text-green-800 mb-2">MLE Condition</div>
                <div className="bg-white rounded-lg p-2 text-center">
                  <Latex math="U(\hat{\theta}) = 0" display={true} />
                </div>
                <div className="text-xs text-green-600 mt-2 text-center">
                  At the maximum, the gradient vanishes
                </div>
              </div>
            </div>
    
            {/* Right: Score interpretation and example */}
            <div className="space-y-3">
              {/* Score tells direction */}
              <div className="bg-amber-50 rounded-xl p-3 border border-amber-200">
                <div className="font-semibold text-amber-800 mb-2">Score Tells You Which Way to Move</div>
                <div className="grid grid-cols-2 gap-2 text-sm">
                  <div className="bg-white rounded p-2 text-center">
                    <div className="text-green-600 font-semibold"><Latex math="U(\theta) > 0" /></div>
                    <div className="text-xs text-amber-600">Increase <Latex math="\theta" /></div>
                  </div>
                  <div className="bg-white rounded p-2 text-center">
                    <div className="text-red-600 font-semibold"><Latex math="U(\theta) < 0" /></div>
                    <div className="text-xs text-amber-600">Decrease <Latex math="\theta" /></div>
                  </div>
                </div>
              </div>
    
              {/* Poisson example */}
              <div className="bg-purple-50 rounded-xl p-3 border border-purple-200">
                <div className="font-semibold text-purple-800 mb-2">Example: Poisson</div>
                <div className="space-y-1 text-sm">
                  <div className="bg-white rounded p-1 text-center text-purple-700">
                    <Latex math="U(\lambda) = \frac{n\bar{x}}{\lambda} - n" />
                  </div>
                  <div className="bg-white rounded p-1 text-center text-purple-700">
                    <Latex math="U(\hat{\lambda}) = 0 \implies \hat{\lambda} = \bar{x}" />
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom: Exponential family connection */}
          <div className="mt-3 bg-gradient-to-r from-teal-100 to-cyan-100 rounded-lg p-3 border border-teal-300">
            <div className="font-semibold text-teal-800 mb-1">Exponential Family Connection</div>
            <div className="grid grid-cols-2 gap-3 text-sm">
              <div className="bg-white rounded p-2 text-center">
                <div className="text-teal-700">Score: <Latex math="U(\eta) = \sum T(x_i) - n\nabla A(\eta)" /></div>
              </div>
              <div className="bg-white rounded p-2 text-center">
                <div className="text-teal-700">MLE: <Latex math="\nabla A(\hat{\eta}) = \bar{T}" /> (moment matching!)</div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                       SLIDE 27: SCORE PROPERTIES
// ═══════════════════════════════════════════════════════════════════════

function Slide27_ScoreProperties() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">Score Properties</h1>
          <p className="text-gray-600 mb-3">Two fundamental results that underpin likelihood theory</p>
    
          <div className="grid grid-cols-2 gap-4 flex-1">
            {/* Property 1: Mean Zero */}
            <div className="bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-4 border-2 border-blue-300">
              <div className="flex items-center gap-2 mb-3">
                <div className="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold">1</div>
                <div className="font-semibold text-blue-800">Score Has Mean Zero</div>
              </div>
              
              <div className="bg-white rounded-lg p-3 text-center mb-3">
                <Latex math="\mathbb{E}_{\theta_0}[U(\theta_0)] = 0" display={true} />
              </div>
              
              <div className="space-y-2 text-sm">
                <div className="bg-blue-50 rounded p-2">
                  <div className="font-semibold text-blue-700 mb-1">Proof Sketch:</div>
                  <div className="text-xs text-blue-600 space-y-1">
                    <div><Latex math="\mathbb{E}\left[\frac{\partial \log f}{\partial \theta}\right] = \int \frac{\partial f}{\partial \theta} dx" /></div>
                    <div><Latex math="= \frac{\partial}{\partial \theta} \int f \, dx = \frac{\partial}{\partial \theta}(1) = 0" /></div>
                  </div>
                </div>
                <div className="text-xs text-blue-700">
                  <strong>Intuition:</strong> At truth, equally likely to be pushed up or down
                </div>
              </div>
            </div>
    
            {/* Property 2: Variance = Fisher Info */}
            <div className="bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-4 border-2 border-green-300">
              <div className="flex items-center gap-2 mb-3">
                <div className="bg-green-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold">2</div>
                <div className="font-semibold text-green-800">Variance = Fisher Information</div>
              </div>
              
              <div className="bg-white rounded-lg p-3 text-center mb-3">
                <Latex math="\text{Var}_{\theta}[U(\theta)] = I(\theta)" display={true} />
              </div>
              
              <div className="space-y-2 text-sm">
                <div className="bg-green-50 rounded p-2">
                  <div className="font-semibold text-green-700 mb-1">Since <Latex math="\mathbb{E}[U] = 0" />:</div>
                  <div className="text-xs text-green-600">
                    <Latex math="\text{Var}[U] = \mathbb{E}[U^2] = I(\theta)" />
                  </div>
                </div>
                <div className="text-xs text-green-700">
                  <strong>Interpretation:</strong> High score variance = high information
                </div>
              </div>
            </div>
          </div>
    
          {/* Information Equality */}
          <div className="mt-4 bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl p-4 border border-amber-300">
            <div className="font-semibold text-amber-800 mb-2">The Information Equality: Two Ways to Compute <Latex math="I(\theta)" /></div>
            <div className="grid grid-cols-2 gap-4">
              <div className="bg-white rounded-lg p-3 text-center">
                <div className="text-xs text-amber-600 mb-1">Form 1: Variance of Score</div>
                <Latex math="I(\theta) = \mathbb{E}\left[\left(\frac{\partial \log f}{\partial \theta}\right)^2\right]" display={true} />
              </div>
              <div className="bg-white rounded-lg p-3 text-center">
                <div className="text-xs text-amber-600 mb-1">Form 2: Negative Expected Hessian</div>
                <Latex math="I(\theta) = -\mathbb{E}\left[\frac{\partial^2 \log f}{\partial \theta^2}\right]" display={true} />
              </div>
            </div>
            <div className="text-center text-sm text-amber-700 mt-2">
              Use whichever form is easier to compute!
            </div>
          </div>
    
          {/* Bottom: Why it matters */}
          <div className="mt-3 bg-slate-100 rounded-lg p-2 text-center text-sm">
            <span className="font-semibold text-slate-700">Key Implication:</span>
            <span className="text-slate-600 ml-2">
              CLT for score: <Latex math="\frac{U(\theta_0)}{\sqrt{nI_1(\theta_0)}} \to N(0,1)" /> - foundation for asymptotic inference
            </span>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                    SLIDE 28: FISHER INFORMATION DEF
// ═══════════════════════════════════════════════════════════════════════

function Slide28_FisherInformationDef() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">Fisher Information</h1>
          <p className="text-gray-600 mb-3">Measuring how much data tell us about parameters</p>
    
          {/* Two definitions */}
          <div className="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-4 border-2 border-blue-300 mb-3">
            <div className="grid grid-cols-2 gap-4">
              <div>
                <div className="text-sm font-semibold text-blue-700 mb-2">Definition 1: Score Variance</div>
                <div className="bg-white rounded-lg p-3 text-center">
                  <Latex math="I(\theta) = \mathbb{E}\left[\left(\frac{\partial \log f}{\partial \theta}\right)^2\right]" display={true} />
                </div>
              </div>
              <div>
                <div className="text-sm font-semibold text-blue-700 mb-2">Definition 2: Curvature</div>
                <div className="bg-white rounded-lg p-3 text-center">
                  <Latex math="I(\theta) = -\mathbb{E}\left[\frac{\partial^2 \log f}{\partial \theta^2}\right]" display={true} />
                </div>
              </div>
            </div>
          </div>
    
          <div className="grid grid-cols-2 gap-3 flex-1">
            {/* Curvature interpretation */}
            <div className="bg-green-50 rounded-xl p-3 border border-green-200">
              <div className="font-semibold text-green-800 mb-2">Curvature Interpretation</div>
              <div className="grid grid-cols-2 gap-2 mb-2">
                <div className="bg-white rounded-lg p-2 text-center">
                  <div className="text-2xl mb-1">📈</div>
                  <div className="text-xs font-semibold text-green-700">High <Latex math="I(\theta)" /></div>
                  <div className="text-xs text-green-600">Sharp peak</div>
                  <div className="text-xs text-green-600">Precise estimate</div>
                </div>
                <div className="bg-white rounded-lg p-2 text-center">
                  <div className="text-2xl mb-1">📉</div>
                  <div className="text-xs font-semibold text-green-700">Low <Latex math="I(\theta)" /></div>
                  <div className="text-xs text-green-600">Broad peak</div>
                  <div className="text-xs text-green-600">Uncertain estimate</div>
                </div>
              </div>
              <div className="text-xs text-green-700 text-center">
                Sharper likelihood = more information about <Latex math="\theta" />
              </div>
            </div>
    
            {/* Additivity */}
            <div className="bg-amber-50 rounded-xl p-3 border border-amber-200">
              <div className="font-semibold text-amber-800 mb-2">Additivity for IID</div>
              <div className="bg-white rounded-lg p-2 text-center mb-2">
                <Latex math="I_n(\theta) = n \cdot I_1(\theta)" display={true} />
              </div>
              <div className="space-y-1 text-xs text-amber-700">
                <div><strong>Implication:</strong> More data = more information</div>
                <div><strong>Standard error:</strong></div>
                <div className="bg-white rounded p-1 text-center">
                  <Latex math="\text{SE}(\hat{\theta}) \approx \frac{1}{\sqrt{n I_1(\theta)}}" />
                </div>
              </div>
            </div>
          </div>
    
          {/* Examples */}
          <div className="mt-3 bg-purple-50 rounded-xl p-3 border border-purple-200">
            <div className="font-semibold text-purple-800 mb-2">Examples of <Latex math="I_1(\theta)" /></div>
            <div className="grid grid-cols-4 gap-2">
              <div className="bg-white rounded-lg p-2 text-center">
                <div className="text-xs font-semibold text-purple-700">Bernoulli</div>
                <div className="text-sm"><Latex math="\frac{1}{p(1-p)}" /></div>
              </div>
              <div className="bg-white rounded-lg p-2 text-center">
                <div className="text-xs font-semibold text-purple-700">Poisson</div>
                <div className="text-sm"><Latex math="\frac{1}{\lambda}" /></div>
              </div>
              <div className="bg-white rounded-lg p-2 text-center">
                <div className="text-xs font-semibold text-purple-700">Normal (mean)</div>
                <div className="text-sm"><Latex math="\frac{1}{\sigma^2}" /></div>
              </div>
              <div className="bg-white rounded-lg p-2 text-center">
                <div className="text-xs font-semibold text-purple-700">Exponential</div>
                <div className="text-sm"><Latex math="\frac{1}{\lambda^2}" /></div>
              </div>
            </div>
          </div>
    
          {/* Connection to exp family */}
          <div className="mt-3 bg-gradient-to-r from-teal-100 to-cyan-100 rounded-lg p-2 text-center">
            <span className="font-semibold text-teal-800">Exponential Family:</span>
            <span className="text-teal-700 ml-2">
              <Latex math="I(\eta) = \nabla^2 A(\eta) = \text{Var}[T(X)]" /> - curvature of log-partition = variance of sufficient stat
            </span>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                      SLIDE 29: INFORMATION MATRIX
// ═══════════════════════════════════════════════════════════════════════

function Slide29_InformationMatrix() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">Information Matrix</h1>
          <p className="text-gray-600 mb-3">Fisher information for vector parameters</p>
    
          {/* Main definition */}
          <div className="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-3 border-2 border-blue-300 mb-3">
            <div className="grid grid-cols-2 gap-4">
              <div>
                <div className="text-sm font-semibold text-blue-700 mb-2">Score Covariance Form</div>
                <div className="bg-white rounded-lg p-2 text-center">
                  <Latex math="\mathbf{I}(\boldsymbol{\theta}) = \mathbb{E}[\mathbf{U}\mathbf{U}^T]" display={true} />
                </div>
              </div>
              <div>
                <div className="text-sm font-semibold text-blue-700 mb-2">Negative Expected Hessian</div>
                <div className="bg-white rounded-lg p-2 text-center">
                  <Latex math="\mathbf{I}(\boldsymbol{\theta}) = -\mathbb{E}[\nabla^2 \ell]" display={true} />
                </div>
              </div>
            </div>
          </div>
    
          <div className="grid grid-cols-2 gap-3 flex-1">
            {/* Matrix structure */}
            <div className="bg-purple-50 rounded-xl p-3 border border-purple-200">
              <div className="font-semibold text-purple-800 mb-2">Matrix Structure</div>
              <div className="bg-white rounded-lg p-2 text-center mb-2">
                <Latex math="I_{jk} = \mathbb{E}\left[\frac{\partial \ell}{\partial \theta_j} \cdot \frac{\partial \ell}{\partial \theta_k}\right]" display={true} />
              </div>
              <div className="space-y-1 text-xs">
                <div className="flex items-center gap-2">
                  <span className="bg-purple-200 px-2 py-0.5 rounded">Diagonal</span>
                  <span className="text-purple-700">Info about each <Latex math="\theta_j" /></span>
                </div>
                <div className="flex items-center gap-2">
                  <span className="bg-purple-200 px-2 py-0.5 rounded">Off-diagonal</span>
                  <span className="text-purple-700">Coupling between parameters</span>
                </div>
              </div>
            </div>
    
            {/* Properties */}
            <div className="bg-green-50 rounded-xl p-3 border border-green-200">
              <div className="font-semibold text-green-800 mb-2">Key Properties</div>
              <div className="space-y-1 text-sm text-green-700">
                <div className="flex items-center gap-2">
                  <span className="text-green-500 font-bold">✓</span>
                  <span>Symmetric: <Latex math="I_{jk} = I_{kj}" /></span>
                </div>
                <div className="flex items-center gap-2">
                  <span className="text-green-500 font-bold">✓</span>
                  <span>Positive semi-definite</span>
                </div>
                <div className="flex items-center gap-2">
                  <span className="text-green-500 font-bold">✓</span>
                  <span>Additive: <Latex math="\mathbf{I}_n = n\mathbf{I}_1" /></span>
                </div>
              </div>
            </div>
          </div>
    
          {/* Normal example */}
          <div className="mt-3 bg-amber-50 rounded-xl p-3 border border-amber-200">
            <div className="font-semibold text-amber-800 mb-2">Example: Normal(<Latex math="\mu, \sigma^2" />)</div>
            <div className="grid grid-cols-2 gap-4">
              <div className="bg-white rounded-lg p-2 text-center">
                <Latex math="\mathbf{I}_1 = \begin{pmatrix} 1/\sigma^2 & 0 \\ 0 & 1/(2\sigma^4) \end{pmatrix}" display={true} />
              </div>
              <div className="flex items-center">
                <div className="text-sm text-amber-700">
                  <strong>Off-diagonal = 0:</strong> <Latex math="\mu" /> and <Latex math="\sigma^2" /> are <em>orthogonal</em> - can estimate independently!
                </div>
              </div>
            </div>
          </div>
    
          {/* Asymptotic covariance */}
          <div className="mt-3 bg-gradient-to-r from-teal-100 to-cyan-100 rounded-lg p-2">
            <div className="text-center">
              <span className="font-semibold text-teal-800">Asymptotic Distribution:</span>
              <span className="text-teal-700 ml-2">
                <Latex math="\sqrt{n}(\hat{\boldsymbol{\theta}} - \boldsymbol{\theta}_0) \to N(\mathbf{0}, \mathbf{I}_1^{-1})" />
              </span>
              <span className="text-teal-600 ml-2 text-sm">(<Latex math="\mathbf{I}^{-1}" /> = asymptotic covariance)</span>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                     SLIDE 30: OBSERVED VS EXPECTED
// ═══════════════════════════════════════════════════════════════════════

function Slide30_ObservedVsExpected() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">Observed vs Expected Information</h1>
          <p className="text-gray-600 mb-3">Two ways to measure likelihood curvature</p>
    
          {/* Side by side definitions */}
          <div className="grid grid-cols-2 gap-4 mb-4">
            {/* Expected */}
            <div className="bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-4 border-2 border-blue-300">
              <div className="font-semibold text-blue-800 mb-2">Expected (Fisher) Information</div>
              <div className="bg-white rounded-lg p-3 text-center mb-2">
                <Latex math="I(\theta) = -\mathbb{E}\left[\frac{\partial^2 \ell}{\partial \theta^2}\right]" display={true} />
              </div>
              <div className="space-y-1 text-sm text-blue-700">
                <div>• Theoretical average curvature</div>
                <div>• Over all possible datasets</div>
                <div>• Often has closed form</div>
              </div>
            </div>
    
            {/* Observed */}
            <div className="bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-4 border-2 border-green-300">
              <div className="font-semibold text-green-800 mb-2">Observed Information</div>
              <div className="bg-white rounded-lg p-3 text-center mb-2">
                <Latex math="J(\hat{\theta}) = -\frac{\partial^2 \ell}{\partial \theta^2}\bigg|_{\hat{\theta}}" display={true} />
              </div>
              <div className="space-y-1 text-sm text-green-700">
                <div>• Actual curvature of this dataset</div>
                <div>• Computed at the MLE</div>
                <div>• No expectation needed</div>
              </div>
            </div>
          </div>
    
          {/* Relationship */}
          <div className="bg-amber-50 rounded-xl p-3 border border-amber-200 mb-3">
            <div className="font-semibold text-amber-800 mb-2">Relationship</div>
            <div className="bg-white rounded-lg p-2 text-center">
              <Latex math="\mathbb{E}[J(\theta_0)] = I(\theta_0)" display={true} />
            </div>
            <div className="text-center text-sm text-amber-700 mt-1">
              Observed averages to expected; both converge as <Latex math="n \to \infty" />
            </div>
          </div>
    
          {/* When to use which */}
          <div className="grid grid-cols-2 gap-3 flex-1">
            <div className="bg-blue-50 rounded-xl p-3 border border-blue-200">
              <div className="font-semibold text-blue-800 mb-2">Use Expected <Latex math="I(\hat{\theta})" /></div>
              <div className="space-y-1 text-sm text-blue-700">
                <div>• Exponential families</div>
                <div>• GLMs with canonical link</div>
                <div>• Theoretical analysis</div>
                <div>• Fisher scoring algorithm</div>
              </div>
            </div>
            
            <div className="bg-green-50 rounded-xl p-3 border border-green-200">
              <div className="font-semibold text-green-800 mb-2">Use Observed <Latex math="J(\hat{\theta})" /></div>
              <div className="space-y-1 text-sm text-green-700">
                <div>• Non-canonical links</div>
                <div>• Model may be misspecified</div>
                <div>• Better finite-sample accuracy</div>
                <div>• Newton-Raphson algorithm</div>
              </div>
            </div>
          </div>
    
          {/* Bottom warning */}
          <div className="mt-3 bg-red-50 rounded-lg p-2 border border-red-200">
            <div className="text-center text-sm">
              <span className="font-semibold text-red-700">Warning:</span>
              <span className="text-red-600 ml-2">
                If <Latex math="J(\hat{\theta})" /> and <Latex math="I(\hat{\theta})" /> differ substantially, consider model misspecification!
              </span>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                       SLIDE 31: ANALYTICAL ML ES
// ═══════════════════════════════════════════════════════════════════════

function Slide31_AnalyticalMLEs() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">Analytical MLEs: Exponential Families</h1>
          <p className="text-gray-600 mb-3">Score equation becomes moment matching</p>
    
          {/* Main result */}
          <div className="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-4 border-2 border-blue-300 mb-3">
            <div className="font-semibold text-blue-800 mb-2 text-center">The MLE for Exponential Families</div>
            <div className="bg-white rounded-lg p-3 text-center mb-2">
              <Latex math="\nabla A(\hat{\eta}) = \frac{1}{n}\sum_{i=1}^n T(x_i) = \bar{T}" display={true} />
            </div>
            <div className="text-center text-sm text-blue-700">
              <strong>Set expected sufficient statistic = observed average</strong>
            </div>
          </div>
    
          {/* Why it works */}
          <div className="grid grid-cols-2 gap-3 mb-3">
            <div className="bg-green-50 rounded-xl p-3 border border-green-200">
              <div className="font-semibold text-green-800 mb-2">Why Moment Matching?</div>
              <div className="space-y-2 text-sm text-green-700">
                <div className="bg-white rounded p-2">
                  <div className="text-xs text-green-600 mb-1">Recall from Section 3.1:</div>
                  <Latex math="\nabla A(\eta) = \mathbb{E}_\eta[T(X)]" />
                </div>
                <div className="text-xs">
                  MLE: Choose <Latex math="\eta" /> so model mean = sample mean
                </div>
              </div>
            </div>
    
            <div className="bg-purple-50 rounded-xl p-3 border border-purple-200">
              <div className="font-semibold text-purple-800 mb-2">Converting Parameters</div>
              <div className="space-y-2 text-sm text-purple-700">
                <div>1. Solve for <Latex math="\hat{\eta}" /></div>
                <div>2. Convert: <Latex math="\hat{\theta} = g(\hat{\eta})" /></div>
                <div className="text-xs bg-white rounded p-1">
                  Invariance: MLE of <Latex math="g(\theta)" /> is <Latex math="g(\hat{\theta})" />
                </div>
              </div>
            </div>
          </div>
    
          {/* Examples table */}
          <div className="bg-amber-50 rounded-xl p-3 border border-amber-200 flex-1">
            <div className="font-semibold text-amber-800 mb-2">Examples</div>
            <div className="overflow-x-auto">
              <table className="w-full text-sm">
                <thead>
                  <tr className="text-amber-700">
                    <th className="text-left p-1">Distribution</th>
                    <th className="text-center p-1"><Latex math="T(x)" /></th>
                    <th className="text-center p-1"><Latex math="\bar{T}" /></th>
                    <th className="text-center p-1">MLE</th>
                  </tr>
                </thead>
                <tbody className="text-amber-600">
                  <tr className="bg-white">
                    <td className="p-1">Bernoulli(<Latex math="p" />)</td>
                    <td className="text-center p-1"><Latex math="x" /></td>
                    <td className="text-center p-1"><Latex math="\bar{x}" /></td>
                    <td className="text-center p-1"><Latex math="\hat{p} = \bar{x}" /></td>
                  </tr>
                  <tr>
                    <td className="p-1">Poisson(<Latex math="\lambda" />)</td>
                    <td className="text-center p-1"><Latex math="x" /></td>
                    <td className="text-center p-1"><Latex math="\bar{x}" /></td>
                    <td className="text-center p-1"><Latex math="\hat{\lambda} = \bar{x}" /></td>
                  </tr>
                  <tr className="bg-white">
                    <td className="p-1">Normal(<Latex math="\mu" />, known <Latex math="\sigma^2" />)</td>
                    <td className="text-center p-1"><Latex math="x" /></td>
                    <td className="text-center p-1"><Latex math="\bar{x}" /></td>
                    <td className="text-center p-1"><Latex math="\hat{\mu} = \bar{x}" /></td>
                  </tr>
                  <tr>
                    <td className="p-1">Exponential(<Latex math="\lambda" />)</td>
                    <td className="text-center p-1"><Latex math="x" /></td>
                    <td className="text-center p-1"><Latex math="\bar{x}" /></td>
                    <td className="text-center p-1"><Latex math="\hat{\lambda} = 1/\bar{x}" /></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
    
          {/* Bottom insight */}
          <div className="mt-3 bg-gradient-to-r from-teal-100 to-cyan-100 rounded-lg p-2 text-center">
            <span className="font-semibold text-teal-800">Key Insight:</span>
            <span className="text-teal-700 ml-2">
              One formula handles all exponential families - just compute <Latex math="\bar{T}" />!
            </span>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                         SLIDE 32: BERNOULLI MLE
// ═══════════════════════════════════════════════════════════════════════

function Slide32_BernoulliMLE() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">Example: Bernoulli MLE</h1>
          <p className="text-gray-600 mb-2">Step-by-step derivation</p>
    
          {/* Setup */}
          <div className="bg-blue-50 rounded-lg p-2 border border-blue-200 mb-2">
            <span className="font-semibold text-blue-800">Setup:</span>
            <span className="text-blue-700 ml-2">
              <Latex math="X_1, \ldots, X_n \stackrel{\text{iid}}{\sim} \text{Bernoulli}(p)" />, observe <Latex math="k = \sum x_i" /> successes
            </span>
          </div>
    
          {/* Derivation steps */}
          <div className="space-y-2 flex-1">
            {/* Step 1: Likelihood */}
            <div className="bg-green-50 rounded-lg p-2 border border-green-200">
              <div className="flex items-center gap-2">
                <div className="bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-xs">1</div>
                <span className="font-semibold text-green-800 text-sm">Likelihood:</span>
                <span className="text-green-700 text-sm ml-2">
                  <Latex math="L(p) = p^k(1-p)^{n-k}" />
                </span>
              </div>
            </div>
    
            {/* Step 2: Log-likelihood */}
            <div className="bg-amber-50 rounded-lg p-2 border border-amber-200">
              <div className="flex items-center gap-2">
                <div className="bg-amber-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-xs">2</div>
                <span className="font-semibold text-amber-800 text-sm">Log-likelihood:</span>
                <span className="text-amber-700 text-sm ml-2">
                  <Latex math="\ell(p) = k\log p + (n-k)\log(1-p)" />
                </span>
              </div>
            </div>
    
            {/* Step 3: Score */}
            <div className="bg-purple-50 rounded-lg p-2 border border-purple-200">
              <div className="flex items-center gap-2">
                <div className="bg-purple-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-xs">3</div>
                <span className="font-semibold text-purple-800 text-sm">Score:</span>
                <span className="text-purple-700 text-sm ml-2">
                  <Latex math="U(p) = \frac{k}{p} - \frac{n-k}{1-p} = \frac{k - np}{p(1-p)}" />
                </span>
              </div>
            </div>
    
            {/* Step 4: Solve */}
            <div className="bg-teal-50 rounded-lg p-2 border border-teal-200">
              <div className="flex items-center gap-2">
                <div className="bg-teal-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-xs">4</div>
                <span className="font-semibold text-teal-800 text-sm">Solve <Latex math="U(\hat{p}) = 0" />:</span>
                <span className="text-teal-700 text-sm ml-2">
                  <Latex math="k - n\hat{p} = 0 \implies \hat{p} = k/n" />
                </span>
              </div>
            </div>
    
            {/* Step 5: Verify */}
            <div className="bg-pink-50 rounded-lg p-2 border border-pink-200">
              <div className="flex items-center gap-2">
                <div className="bg-pink-500 text-white rounded-full w-6 h-6 flex items-center justify-center font-bold text-xs">5</div>
                <span className="font-semibold text-pink-800 text-sm">Verify maximum:</span>
                <span className="text-pink-700 text-sm ml-2">
                  <Latex math="\frac{\partial^2 \ell}{\partial p^2} = -\frac{k}{p^2} - \frac{n-k}{(1-p)^2} < 0" /> ✓
                </span>
              </div>
            </div>
          </div>
    
          {/* Result box */}
          <div className="mt-3 bg-gradient-to-r from-blue-100 to-indigo-100 rounded-xl p-4 border-2 border-blue-300">
            <div className="text-center">
              <div className="text-sm text-blue-600 mb-1">Maximum Likelihood Estimator</div>
              <Latex math="\hat{p}_{\text{MLE}} = \frac{k}{n} = \frac{\sum_{i=1}^n x_i}{n} = \bar{x}" display={true} />
              <div className="text-sm text-blue-700 mt-2">
                <strong>Interpretation:</strong> Sample proportion = MLE of population proportion
              </div>
            </div>
          </div>
    
          {/* Moment matching verification */}
          <div className="mt-2 bg-gray-100 rounded-lg p-2 text-center text-sm">
            <span className="font-semibold text-gray-700">Moment Matching Check:</span>
            <span className="text-gray-600 ml-2">
              <Latex math="\mathbb{E}[X] = p" />, set equal to <Latex math="\bar{x}" /> gives <Latex math="\hat{p} = \bar{x}" /> ✓
            </span>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                          SLIDE 33: NORMAL MLE
// ═══════════════════════════════════════════════════════════════════════

function Slide33_NormalMLE() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">Example: Normal MLE</h1>
          <p className="text-gray-600 mb-2">Both <Latex math="\mu" /> and <Latex math="\sigma^2" /> unknown</p>
    
          {/* Setup */}
          <div className="bg-blue-50 rounded-lg p-2 border border-blue-200 mb-2">
            <span className="font-semibold text-blue-800">Log-likelihood:</span>
            <span className="text-blue-700 text-sm ml-2">
              <Latex math="\ell(\mu, \sigma^2) = -\frac{n}{2}\log(2\pi\sigma^2) - \frac{1}{2\sigma^2}\sum(x_i - \mu)^2" />
            </span>
          </div>
    
          <div className="grid grid-cols-2 gap-3 mb-3">
            {/* MLE for mu */}
            <div className="bg-green-50 rounded-xl p-3 border border-green-200">
              <div className="font-semibold text-green-800 mb-2">MLE for <Latex math="\mu" /></div>
              <div className="space-y-2 text-sm">
                <div className="bg-white rounded p-2">
                  <Latex math="\frac{\partial \ell}{\partial \mu} = \frac{\sum(x_i - \mu)}{\sigma^2}" />
                </div>
                <div className="text-green-700 text-center">Set to 0:</div>
                <div className="bg-white rounded p-2 text-center">
                  <Latex math="\hat{\mu} = \bar{x}" display={true} />
                </div>
              </div>
            </div>
    
            {/* MLE for sigma^2 */}
            <div className="bg-amber-50 rounded-xl p-3 border border-amber-200">
              <div className="font-semibold text-amber-800 mb-2">MLE for <Latex math="\sigma^2" /></div>
              <div className="space-y-2 text-sm">
                <div className="bg-white rounded p-2">
                  <Latex math="\frac{\partial \ell}{\partial \sigma^2} = -\frac{n}{2\sigma^2} + \frac{\sum(x_i-\mu)^2}{2(\sigma^2)^2}" />
                </div>
                <div className="text-amber-700 text-center">Set to 0:</div>
                <div className="bg-white rounded p-2 text-center">
                  <Latex math="\hat{\sigma}^2 = \frac{1}{n}\sum(x_i - \bar{x})^2" display={true} />
                </div>
              </div>
            </div>
          </div>
    
          {/* Bias warning */}
          <div className="bg-red-50 rounded-xl p-4 border-2 border-red-300 mb-3">
            <div className="flex items-start gap-3">
              <div className="text-3xl">⚠️</div>
              <div className="flex-1">
                <div className="font-semibold text-red-800 mb-2">Important: MLE of <Latex math="\sigma^2" /> is BIASED!</div>
                <div className="grid grid-cols-2 gap-3">
                  <div className="bg-white rounded p-2">
                    <div className="text-xs text-red-600 mb-1">MLE (divides by n):</div>
                    <div className="text-sm"><Latex math="\hat{\sigma}^2_{\text{MLE}} = \frac{1}{n}\sum(x_i - \bar{x})^2" /></div>
                    <div className="text-xs text-red-500 mt-1"><Latex math="\mathbb{E}[\hat{\sigma}^2] = \frac{n-1}{n}\sigma^2 < \sigma^2" /></div>
                  </div>
                  <div className="bg-white rounded p-2">
                    <div className="text-xs text-green-600 mb-1">Unbiased (divides by n-1):</div>
                    <div className="text-sm"><Latex math="s^2 = \frac{1}{n-1}\sum(x_i - \bar{x})^2" /></div>
                    <div className="text-xs text-green-500 mt-1"><Latex math="\mathbb{E}[s^2] = \sigma^2" /></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Result summary */}
          <div className="bg-gradient-to-r from-purple-100 to-pink-100 rounded-lg p-3 border border-purple-300">
            <div className="text-center">
              <span className="font-semibold text-purple-800">Summary:</span>
              <span className="text-purple-700 ml-2">
                <Latex math="\hat{\mu} = \bar{x}" /> (unbiased), 
                <Latex math="\hat{\sigma}^2 = \frac{1}{n}\sum(x_i-\bar{x})^2" /> (biased by factor <Latex math="\frac{n-1}{n}" />)
              </span>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                     SLIDE 34: WHEN ANALYTICAL FAILS
// ═══════════════════════════════════════════════════════════════════════

function Slide34_WhenAnalyticalFails() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">When Analytical Solutions Fail</h1>
          <p className="text-gray-600 mb-3">Many important models require numerical optimization</p>
    
          <div className="grid grid-cols-3 gap-3 flex-1">
            {/* Gamma */}
            <div className="bg-purple-50 rounded-xl p-3 border border-purple-200">
              <div className="font-semibold text-purple-800 mb-2">Gamma Distribution</div>
              <div className="bg-white rounded p-2 text-sm mb-2">
                <Latex math="X \sim \text{Gamma}(\alpha, \beta)" />
              </div>
              <div className="text-xs text-purple-700 space-y-1">
                <div><strong>Score for <Latex math="\alpha" />:</strong></div>
                <div className="bg-purple-100 rounded p-1">
                  Involves <Latex math="\psi(\alpha)" /> (digamma)
                </div>
                <div className="text-purple-600 mt-2">
                  <strong>Problem:</strong> No closed-form inverse of digamma
                </div>
              </div>
            </div>
    
            {/* Logistic */}
            <div className="bg-green-50 rounded-xl p-3 border border-green-200">
              <div className="font-semibold text-green-800 mb-2">Logistic Regression</div>
              <div className="bg-white rounded p-2 text-sm mb-2">
                <Latex math="P(Y=1|x) = \sigma(x^T\beta)" />
              </div>
              <div className="text-xs text-green-700 space-y-1">
                <div><strong>Score:</strong></div>
                <div className="bg-green-100 rounded p-1">
                  <Latex math="U = \sum(y_i - p_i)x_i" />
                </div>
                <div className="text-green-600 mt-2">
                  <strong>Problem:</strong> <Latex math="p_i" /> depends nonlinearly on <Latex math="\beta" />
                </div>
              </div>
            </div>
    
            {/* Mixtures */}
            <div className="bg-amber-50 rounded-xl p-3 border border-amber-200">
              <div className="font-semibold text-amber-800 mb-2">Mixture Models</div>
              <div className="bg-white rounded p-2 text-sm mb-2">
                <Latex math="f = \pi f_1 + (1-\pi)f_2" />
              </div>
              <div className="text-xs text-amber-700 space-y-1">
                <div><strong>Log-likelihood:</strong></div>
                <div className="bg-amber-100 rounded p-1">
                  <Latex math="\sum\log(\pi f_1 + ...)" />
                </div>
                <div className="text-amber-600 mt-2">
                  <strong>Problem:</strong> Log of a sum
                </div>
              </div>
            </div>
          </div>
    
          {/* Why hard */}
          <div className="mt-3 bg-red-50 rounded-xl p-3 border border-red-200">
            <div className="font-semibold text-red-800 mb-2">Why These Are Hard</div>
            <div className="grid grid-cols-4 gap-2 text-xs">
              <div className="bg-white rounded p-2 text-center text-red-700">
                <div className="font-semibold mb-1">Transcendental</div>
                <div>Special functions</div>
              </div>
              <div className="bg-white rounded p-2 text-center text-red-700">
                <div className="font-semibold mb-1">Implicit</div>
                <div>Nonlinear dependencies</div>
              </div>
              <div className="bg-white rounded p-2 text-center text-red-700">
                <div className="font-semibold mb-1">Coupled</div>
                <div>Multiple equations</div>
              </div>
              <div className="bg-white rounded p-2 text-center text-red-700">
                <div className="font-semibold mb-1">Log-sum</div>
                <div>Mixture structure</div>
              </div>
            </div>
          </div>
    
          {/* Good news */}
          <div className="mt-3 bg-gradient-to-r from-teal-100 to-cyan-100 rounded-lg p-3 border border-teal-300">
            <div className="text-center">
              <span className="font-semibold text-teal-800">Good News:</span>
              <span className="text-teal-700 ml-2">
                Numerical methods work well! Concave log-likelihood (exp families) guarantees global optimum.
              </span>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                        SLIDE 35: NEWTON RAPHSON
// ═══════════════════════════════════════════════════════════════════════

function Slide35_NewtonRaphson() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">Newton-Raphson Algorithm</h1>
          <p className="text-gray-600 mb-3">Quadratic approximation for finding MLEs</p>
    
          {/* Main update rule */}
          <div className="bg-slate-800 rounded-xl p-4 mb-3 text-white">
            <div className="text-slate-300 text-sm mb-2">Newton-Raphson Update</div>
            <div className="bg-slate-900 rounded-lg p-3 text-center mb-2">
              <Latex math="\theta^{(t+1)} = \theta^{(t)} - \left[\frac{\partial^2 \ell}{\partial \theta^2}\right]^{-1} \frac{\partial \ell}{\partial \theta}\bigg|_{\theta^{(t)}}" display={true} />
            </div>
            <div className="text-center text-sm text-slate-400">
              Vector form: <Latex math="\boldsymbol{\theta}^{(t+1)} = \boldsymbol{\theta}^{(t)} + J(\boldsymbol{\theta}^{(t)})^{-1} U(\boldsymbol{\theta}^{(t)})" />
            </div>
          </div>
    
          <div className="grid grid-cols-2 gap-3 flex-1">
            {/* Idea */}
            <div className="bg-blue-50 rounded-xl p-3 border border-blue-200">
              <div className="font-semibold text-blue-800 mb-2">The Idea</div>
              <div className="space-y-2 text-sm text-blue-700">
                <div className="bg-white rounded p-2">
                  <div className="font-semibold text-xs mb-1">1. Taylor expand score:</div>
                  <Latex math="U(\theta) \approx U(\theta^{(t)}) + U'(\theta^{(t)})(\theta - \theta^{(t)})" />
                </div>
                <div className="bg-white rounded p-2">
                  <div className="font-semibold text-xs mb-1">2. Set to zero, solve:</div>
                  <Latex math="\theta^{(t+1)} = \theta^{(t)} - U/U'" />
                </div>
              </div>
            </div>
    
            {/* Convergence */}
            <div className="bg-green-50 rounded-xl p-3 border border-green-200">
              <div className="font-semibold text-green-800 mb-2">Convergence</div>
              <div className="space-y-2 text-sm text-green-700">
                <div className="bg-white rounded p-2">
                  <div className="font-semibold">Quadratic convergence!</div>
                  <div className="text-xs">Error squares each iteration</div>
                </div>
                <div className="bg-white rounded p-2 text-xs">
                  <div>If error = 0.01</div>
                  <div>Next: <Latex math="\approx 0.0001" /></div>
                  <div>Then: <Latex math="\approx 10^{-8}" /></div>
                </div>
                <div className="text-xs">Typically 5-10 iterations to convergence</div>
              </div>
            </div>
          </div>
    
          {/* Algorithm box */}
          <div className="mt-3 bg-amber-50 rounded-xl p-3 border border-amber-200">
            <div className="font-semibold text-amber-800 mb-2">Algorithm</div>
            <div className="grid grid-cols-5 gap-1 text-xs text-amber-700">
              <div className="bg-white rounded p-2 text-center">
                <div className="font-bold">1</div>
                <div>Initialize <Latex math="\theta^{(0)}" /></div>
              </div>
              <div className="bg-white rounded p-2 text-center">
                <div className="font-bold">2</div>
                <div>Compute <Latex math="U, \nabla^2\ell" /></div>
              </div>
              <div className="bg-white rounded p-2 text-center">
                <div className="font-bold">3</div>
                <div>Update <Latex math="\theta" /></div>
              </div>
              <div className="bg-white rounded p-2 text-center">
                <div className="font-bold">4</div>
                <div>Check convergence</div>
              </div>
              <div className="bg-white rounded p-2 text-center">
                <div className="font-bold">5</div>
                <div>Repeat 2-4</div>
              </div>
            </div>
          </div>
    
          {/* Caveats */}
          <div className="mt-3 bg-red-50 rounded-lg p-2 border border-red-200">
            <div className="text-center text-sm">
              <span className="font-semibold text-red-700">Caveats:</span>
              <span className="text-red-600 ml-2">
                Needs good starting value; Hessian must be negative definite; may step outside parameter space
              </span>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                        SLIDE 36: FISHER SCORING
// ═══════════════════════════════════════════════════════════════════════

function Slide36_FisherScoring() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">Fisher Scoring</h1>
          <p className="text-gray-600 mb-3">Newton-Raphson with expected information</p>
    
          {/* Main comparison */}
          <div className="grid grid-cols-2 gap-4 mb-4">
            {/* Newton-Raphson */}
            <div className="bg-slate-100 rounded-xl p-3 border border-slate-300">
              <div className="font-semibold text-slate-800 mb-2">Newton-Raphson</div>
              <div className="bg-white rounded-lg p-3 text-center">
                <Latex math="\theta^{(t+1)} = \theta^{(t)} + J^{-1} U" display={true} />
              </div>
              <div className="text-sm text-slate-600 mt-2 text-center">
                Uses <strong>observed</strong> info <Latex math="J = -\nabla^2\ell" />
              </div>
            </div>
    
            {/* Fisher Scoring */}
            <div className="bg-blue-50 rounded-xl p-3 border-2 border-blue-300">
              <div className="font-semibold text-blue-800 mb-2">Fisher Scoring</div>
              <div className="bg-white rounded-lg p-3 text-center">
                <Latex math="\theta^{(t+1)} = \theta^{(t)} + I^{-1} U" display={true} />
              </div>
              <div className="text-sm text-blue-600 mt-2 text-center">
                Uses <strong>expected</strong> info <Latex math="I = -\mathbb{E}[\nabla^2\ell]" />
              </div>
            </div>
          </div>
    
          {/* Why Fisher is better */}
          <div className="bg-green-50 rounded-xl p-3 border border-green-200 mb-3">
            <div className="font-semibold text-green-800 mb-2">Why Fisher Scoring is Often Better</div>
            <div className="grid grid-cols-4 gap-2">
              <div className="bg-white rounded p-2 text-center text-sm">
                <div className="text-green-600 font-semibold">Stable</div>
                <div className="text-xs text-green-500"><Latex math="I > 0" /> always</div>
              </div>
              <div className="bg-white rounded p-2 text-center text-sm">
                <div className="text-green-600 font-semibold">Smooth</div>
                <div className="text-xs text-green-500">No data fluctuations</div>
              </div>
              <div className="bg-white rounded p-2 text-center text-sm">
                <div className="text-green-600 font-semibold">Analytical</div>
                <div className="text-xs text-green-500">Clean for exp families</div>
              </div>
              <div className="bg-white rounded p-2 text-center text-sm">
                <div className="text-green-600 font-semibold">IRLS</div>
                <div className="text-xs text-green-500">= GLM algorithm!</div>
              </div>
            </div>
          </div>
    
          {/* Exponential family form */}
          <div className="bg-purple-50 rounded-xl p-3 border border-purple-200 flex-1">
            <div className="font-semibold text-purple-800 mb-2">For Exponential Families</div>
            <div className="grid grid-cols-2 gap-3">
              <div className="bg-white rounded p-2">
                <div className="text-xs text-purple-600 mb-1">Score:</div>
                <Latex math="U(\eta) = \sum T(x_i) - n\nabla A(\eta)" />
              </div>
              <div className="bg-white rounded p-2">
                <div className="text-xs text-purple-600 mb-1">Fisher info:</div>
                <Latex math="I(\eta) = n\nabla^2 A(\eta)" />
              </div>
            </div>
            <div className="bg-white rounded-lg p-2 mt-2 text-center">
              <div className="text-xs text-purple-600 mb-1">Update rule:</div>
              <Latex math="\eta^{(t+1)} = \eta^{(t)} + [\nabla^2 A]^{-1}[\bar{T} - \nabla A(\eta^{(t)})]" />
            </div>
            <div className="text-center text-sm text-purple-700 mt-2">
              <strong>Interpretation:</strong> Move toward matching moments!
            </div>
          </div>
    
          {/* Bottom note */}
          <div className="mt-3 bg-gradient-to-r from-amber-100 to-orange-100 rounded-lg p-2 text-center text-sm">
            <span className="font-semibold text-amber-800">Key Point:</span>
            <span className="text-amber-700 ml-2">
              Same fixed point <Latex math="\hat{\theta}" />, different path to get there
            </span>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                        SLIDE 37: SCIPY OPTIMIZE
// ═══════════════════════════════════════════════════════════════════════

function Slide37_ScipyOptimize() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">Practical Optimization: scipy.optimize</h1>
          <p className="text-gray-600 mb-3">Production-ready MLE computation</p>
    
          {/* Key insight */}
          <div className="bg-blue-50 rounded-xl p-3 border-2 border-blue-300 mb-3">
            <div className="text-center">
              <span className="font-semibold text-blue-800">Key Insight:</span>
              <span className="text-blue-700 ml-2">
                Minimize <Latex math="-\ell(\theta)" /> since scipy minimizes (doesn't maximize)
              </span>
            </div>
          </div>
    
          {/* Code example */}
          <div className="bg-slate-800 rounded-xl p-3 mb-3 text-white">
            <div className="text-slate-300 text-sm mb-2">Basic Pattern</div>
            <pre className="text-xs text-green-400 overflow-x-auto">
    {`from scipy.optimize import minimize
    
    def neg_log_lik(theta, data):
        return -log_likelihood(theta, data)
    
    result = minimize(neg_log_lik, x0=theta_init, 
                      args=(data,), method='BFGS')
    theta_mle = result.x`}
            </pre>
          </div>
    
          <div className="grid grid-cols-2 gap-3 flex-1">
            {/* Left: Options */}
            <div className="space-y-3">
              <div className="bg-green-50 rounded-xl p-3 border border-green-200">
                <div className="font-semibold text-green-800 mb-2">Provide Gradients!</div>
                <pre className="text-xs bg-white p-2 rounded text-green-700 overflow-x-auto">
    {`minimize(neg_ll, x0,
             jac=neg_score,  # gradient
             method='BFGS')`}
                </pre>
                <div className="text-xs text-green-600 mt-1">
                  Much faster and more reliable
                </div>
              </div>
    
              <div className="bg-amber-50 rounded-xl p-3 border border-amber-200">
                <div className="font-semibold text-amber-800 mb-2">Handle Constraints</div>
                <div className="text-xs text-amber-700 space-y-1">
                  <div><strong>Box bounds:</strong></div>
                  <pre className="bg-white p-1 rounded text-amber-600 overflow-x-auto">
    {`bounds=[(0,1), (0,None)]`}
                  </pre>
                  <div>Or reparameterize (e.g., optimize <Latex math="\log\sigma" />)</div>
                </div>
              </div>
            </div>
    
            {/* Right: Tips */}
            <div className="bg-purple-50 rounded-xl p-3 border border-purple-200">
              <div className="font-semibold text-purple-800 mb-2">Practical Tips</div>
              <div className="space-y-2 text-sm text-purple-700">
                <div className="flex items-start gap-2">
                  <span className="text-purple-500 font-bold">1.</span>
                  <div><strong>Multiple starts:</strong> Avoid local optima</div>
                </div>
                <div className="flex items-start gap-2">
                  <span className="text-purple-500 font-bold">2.</span>
                  <div><strong>Method of moments:</strong> Good initial <Latex math="\theta_0" /></div>
                </div>
                <div className="flex items-start gap-2">
                  <span className="text-purple-500 font-bold">3.</span>
                  <div><strong>Check:</strong> <code className="text-xs">result.success</code></div>
                </div>
                <div className="flex items-start gap-2">
                  <span className="text-purple-500 font-bold">4.</span>
                  <div><strong>SEs:</strong> <Latex math="\sqrt{\text{diag}(H^{-1})}" /></div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Methods overview */}
          <div className="mt-3 bg-slate-100 rounded-lg p-2">
            <div className="grid grid-cols-4 gap-2 text-xs text-center">
              <div className="bg-white rounded p-1">
                <div className="font-semibold">BFGS</div>
                <div className="text-slate-500">Quasi-Newton</div>
              </div>
              <div className="bg-white rounded p-1">
                <div className="font-semibold">L-BFGS-B</div>
                <div className="text-slate-500">+ bounds</div>
              </div>
              <div className="bg-white rounded p-1">
                <div className="font-semibold">Nelder-Mead</div>
                <div className="text-slate-500">No gradient</div>
              </div>
              <div className="bg-white rounded p-1">
                <div className="font-semibold">trust-constr</div>
                <div className="text-slate-500">Constraints</div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                      SLIDE 38: ASYMPTOTIC OVERVIEW
// ═══════════════════════════════════════════════════════════════════════

function Slide38_AsymptoticOverview() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">MLE Asymptotic Properties</h1>
          <p className="text-gray-600 mb-4">The "Big Four" that make MLE dominant</p>
    
          {/* Four quadrants */}
          <div className="grid grid-cols-2 gap-4 flex-1">
            {/* Consistency */}
            <div className="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-4 border-2 border-purple-300">
              <div className="flex items-center gap-2 mb-2">
                <div className="bg-purple-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold">1</div>
                <div className="font-semibold text-purple-800">Consistency</div>
              </div>
              <div className="bg-white rounded-lg p-2 text-center mb-2">
                <Latex math="\hat{\theta}_n \xrightarrow{P} \theta_0" display={true} />
              </div>
              <div className="text-sm text-purple-700">
                Converges to truth as <Latex math="n \to \infty" />
              </div>
            </div>
    
            {/* Asymptotic Normality */}
            <div className="bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-4 border-2 border-green-300">
              <div className="flex items-center gap-2 mb-2">
                <div className="bg-green-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold">2</div>
                <div className="font-semibold text-green-800">Asymptotic Normality</div>
              </div>
              <div className="bg-white rounded-lg p-2 text-center mb-2">
                <Latex math="\sqrt{n}(\hat{\theta} - \theta_0) \xrightarrow{d} N(0, I_1^{-1})" display={true} />
              </div>
              <div className="text-sm text-green-700">
                Enables CIs and hypothesis tests
              </div>
            </div>
    
            {/* Efficiency */}
            <div className="bg-gradient-to-br from-amber-50 to-amber-100 rounded-xl p-4 border-2 border-amber-300">
              <div className="flex items-center gap-2 mb-2">
                <div className="bg-amber-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold">3</div>
                <div className="font-semibold text-amber-800">Efficiency</div>
              </div>
              <div className="bg-white rounded-lg p-2 text-center mb-2">
                <Latex math="\text{Var}(\hat{\theta}) \to \frac{1}{nI(\theta_0)}" display={true} />
              </div>
              <div className="text-sm text-amber-700">
                Achieves Cramér-Rao bound
              </div>
            </div>
    
            {/* Invariance */}
            <div className="bg-gradient-to-br from-teal-50 to-teal-100 rounded-xl p-4 border-2 border-teal-300">
              <div className="flex items-center gap-2 mb-2">
                <div className="bg-teal-500 text-white rounded-full w-8 h-8 flex items-center justify-center font-bold">4</div>
                <div className="font-semibold text-teal-800">Invariance</div>
              </div>
              <div className="bg-white rounded-lg p-2 text-center mb-2">
                <Latex math="\widehat{g(\theta)} = g(\hat{\theta})" display={true} />
              </div>
              <div className="text-sm text-teal-700">
                Reparameterization is free
              </div>
            </div>
          </div>
    
          {/* Bottom note */}
          <div className="mt-4 bg-slate-100 rounded-lg p-3 text-center">
            <span className="font-semibold text-slate-700">Under Regularity Conditions:</span>
            <span className="text-slate-600 ml-2 text-sm">
              Identifiability, interior parameter, smooth likelihood, positive Fisher information
            </span>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                          SLIDE 39: CONSISTENCY
// ═══════════════════════════════════════════════════════════════════════

function Slide39_Consistency() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">Consistency</h1>
          <p className="text-gray-600 mb-3">MLE converges to the truth</p>
    
          {/* Main statement */}
          <div className="bg-gradient-to-r from-purple-50 to-indigo-50 rounded-xl p-4 border-2 border-purple-300 mb-4">
            <div className="text-center">
              <div className="text-sm text-purple-600 mb-2">As sample size grows</div>
              <Latex math="\hat{\theta}_n \xrightarrow{P} \theta_0 \quad \text{as } n \to \infty" display={true} />
              <div className="text-sm text-purple-700 mt-2">
                For any <Latex math="\epsilon > 0" />: <Latex math="P(|\hat{\theta}_n - \theta_0| > \epsilon) \to 0" />
              </div>
            </div>
          </div>
    
          <div className="grid grid-cols-2 gap-4 flex-1">
            {/* Why it works */}
            <div className="bg-green-50 rounded-xl p-3 border border-green-200">
              <div className="font-semibold text-green-800 mb-2">Why MLE is Consistent</div>
              <div className="space-y-2 text-sm text-green-700">
                <div className="bg-white rounded p-2">
                  <div className="font-semibold text-xs mb-1">1. LLN applies:</div>
                  <Latex math="\frac{1}{n}\ell(\theta) \to \mathbb{E}_{\theta_0}[\log f(X|\theta)]" />
                </div>
                <div className="bg-white rounded p-2">
                  <div className="font-semibold text-xs mb-1">2. Info inequality:</div>
                  <Latex math="\mathbb{E}_{\theta_0}[\log f(X|\theta)]" /> maximized at <Latex math="\theta_0" />
                </div>
                <div className="bg-white rounded p-2">
                  <div className="font-semibold text-xs mb-1">3. Therefore:</div>
                  <div className="text-xs">Maximizer of average <Latex math="\to" /> maximizer of expectation</div>
                </div>
              </div>
            </div>
    
            {/* Conditions */}
            <div className="bg-amber-50 rounded-xl p-3 border border-amber-200">
              <div className="font-semibold text-amber-800 mb-2">Required Conditions</div>
              <div className="space-y-2 text-sm text-amber-700">
                <div className="flex items-center gap-2">
                  <span className="text-amber-500 font-bold">✓</span>
                  <span><strong>Identifiability:</strong> Different <Latex math="\theta" /> give different distributions</span>
                </div>
                <div className="flex items-center gap-2">
                  <span className="text-amber-500 font-bold">✓</span>
                  <span><strong>Compactness:</strong> Bounded parameter space</span>
                </div>
                <div className="flex items-center gap-2">
                  <span className="text-amber-500 font-bold">✓</span>
                  <span><strong>Continuity:</strong> Smooth likelihood</span>
                </div>
                <div className="flex items-center gap-2">
                  <span className="text-amber-500 font-bold">✓</span>
                  <span><strong>Dominance:</strong> Integrability condition</span>
                </div>
              </div>
            </div>
          </div>
    
          {/* KL interpretation */}
          <div className="mt-3 bg-teal-50 rounded-xl p-3 border border-teal-200">
            <div className="font-semibold text-teal-800 mb-1">Information-Theoretic View</div>
            <div className="bg-white rounded-lg p-2 text-center">
              <Latex math="D_{KL}(\theta_0 \| \theta) = \mathbb{E}_{\theta_0}\left[\log\frac{f(X|\theta_0)}{f(X|\theta)}\right] \geq 0 \text{ with equality iff } \theta = \theta_0" />
            </div>
            <div className="text-sm text-teal-700 mt-1 text-center">
              MLE minimizes KL divergence to true distribution
            </div>
          </div>
    
          {/* Failure modes */}
          <div className="mt-3 bg-red-50 rounded-lg p-2 border border-red-200">
            <div className="text-center text-sm">
              <span className="font-semibold text-red-700">Can Fail:</span>
              <span className="text-red-600 ml-2">
                Non-identifiable models, boundary issues, model misspecification, irregular families
              </span>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                     SLIDE 40: ASYMPTOTIC NORMALITY
// ═══════════════════════════════════════════════════════════════════════

function Slide40_AsymptoticNormality() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">Asymptotic Normality</h1>
          <p className="text-gray-600 mb-3">Foundation for inference: CIs and hypothesis tests</p>
    
          {/* Main result */}
          <div className="bg-gradient-to-r from-green-50 to-teal-50 rounded-xl p-4 border-2 border-green-300 mb-4">
            <div className="text-center">
              <div className="text-sm text-green-600 mb-2">The Central Result of MLE Theory</div>
              <Latex math="\sqrt{n}(\hat{\theta}_n - \theta_0) \xrightarrow{d} N\left(0, I_1(\theta_0)^{-1}\right)" display={true} />
              <div className="mt-3 bg-white rounded-lg p-2 inline-block">
                <span className="text-green-700">Standard Error: </span>
                <Latex math="\text{SE}(\hat{\theta}) \approx \frac{1}{\sqrt{n I_1(\theta_0)}}" />
              </div>
            </div>
          </div>
    
          <div className="grid grid-cols-2 gap-4 flex-1">
            {/* Proof sketch */}
            <div className="bg-blue-50 rounded-xl p-3 border border-blue-200">
              <div className="font-semibold text-blue-800 mb-2">Proof Sketch</div>
              <div className="space-y-2 text-sm text-blue-700">
                <div className="bg-white rounded p-2">
                  <div className="font-semibold text-xs">1. Taylor expand score:</div>
                  <div className="text-xs"><Latex math="0 = U(\hat{\theta}) \approx U(\theta_0) + U'(\theta_0)(\hat{\theta}-\theta_0)" /></div>
                </div>
                <div className="bg-white rounded p-2">
                  <div className="font-semibold text-xs">2. Apply CLT to numerator:</div>
                  <div className="text-xs"><Latex math="\frac{U(\theta_0)}{\sqrt{n}} \to N(0, I_1)" /></div>
                </div>
                <div className="bg-white rounded p-2">
                  <div className="font-semibold text-xs">3. Apply LLN to denominator:</div>
                  <div className="text-xs"><Latex math="\frac{U'(\theta_0)}{n} \to -I_1" /></div>
                </div>
              </div>
            </div>
    
            {/* Practical use */}
            <div className="bg-amber-50 rounded-xl p-3 border border-amber-200">
              <div className="font-semibold text-amber-800 mb-2">Practical Applications</div>
              <div className="space-y-2 text-sm text-amber-700">
                <div className="bg-white rounded p-2">
                  <div className="font-semibold text-xs">Confidence Interval:</div>
                  <Latex math="\hat{\theta} \pm z_{\alpha/2} \cdot \text{SE}(\hat{\theta})" />
                </div>
                <div className="bg-white rounded p-2">
                  <div className="font-semibold text-xs">Wald Test Statistic:</div>
                  <Latex math="z = \frac{\hat{\theta} - \theta_0}{\text{SE}(\hat{\theta})} \sim N(0,1)" />
                </div>
                <div className="bg-white rounded p-2">
                  <div className="font-semibold text-xs">95% CI Example:</div>
                  <Latex math="\hat{\theta} \pm \frac{1.96}{\sqrt{nI_1(\hat{\theta})}}" />
                </div>
              </div>
            </div>
          </div>
    
          {/* sqrt(n) rate */}
          <div className="mt-3 bg-purple-50 rounded-xl p-3 border border-purple-200">
            <div className="font-semibold text-purple-800 mb-2">The <Latex math="\sqrt{n}" /> Rate</div>
            <div className="grid grid-cols-3 gap-3 text-center">
              <div className="bg-white rounded p-2">
                <div className="text-purple-700 font-semibold"><Latex math="\text{SE} \propto 1/\sqrt{n}" /></div>
              </div>
              <div className="bg-white rounded p-2">
                <div className="text-sm text-purple-600">To halve SE:</div>
                <div className="text-purple-700 font-semibold">4x data</div>
              </div>
              <div className="bg-white rounded p-2">
                <div className="text-sm text-purple-600">10x precision:</div>
                <div className="text-purple-700 font-semibold">100x data</div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                          SLIDE 41: CRAMER RAO
// ═══════════════════════════════════════════════════════════════════════

function Slide41_CramerRao() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">Cramér-Rao Lower Bound</h1>
          <p className="text-gray-600 mb-3">The fundamental limit on estimation precision</p>
    
          {/* Main bound */}
          <div className="bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl p-4 border-2 border-amber-300 mb-4">
            <div className="text-center">
              <div className="text-sm text-amber-600 mb-2">For any unbiased estimator <Latex math="T" /> of <Latex math="\theta" /></div>
              <Latex math="\text{Var}(T) \geq \frac{1}{nI_1(\theta)}" display={true} />
              <div className="mt-2 text-sm text-amber-700">
                Fisher information sets the <strong>floor</strong> on achievable precision
              </div>
            </div>
          </div>
    
          <div className="grid grid-cols-2 gap-4 flex-1">
            {/* MLE achieves it */}
            <div className="bg-green-50 rounded-xl p-3 border border-green-200">
              <div className="font-semibold text-green-800 mb-2">MLE Achieves the Bound!</div>
              <div className="bg-white rounded-lg p-3 text-center mb-2">
                <div className="text-sm text-green-600 mb-1">Asymptotic variance of MLE:</div>
                <Latex math="\text{Var}(\hat{\theta}) \approx \frac{1}{nI_1(\theta_0)}" display={true} />
              </div>
              <div className="text-sm text-green-700 text-center">
                <strong>Equals the bound!</strong> MLE is efficient.
              </div>
              <div className="text-xs text-green-600 mt-2 text-center">
                No consistent estimator can do better asymptotically
              </div>
            </div>
    
            {/* Proof sketch */}
            <div className="bg-blue-50 rounded-xl p-3 border border-blue-200">
              <div className="font-semibold text-blue-800 mb-2">Proof Sketch</div>
              <div className="space-y-1 text-sm text-blue-700">
                <div className="bg-white rounded p-1">
                  <span className="font-semibold">1.</span> For unbiased <Latex math="T" />: <Latex math="\frac{d}{d\theta}\mathbb{E}[T] = 1" />
                </div>
                <div className="bg-white rounded p-1">
                  <span className="font-semibold">2.</span> <Latex math="1 = \mathbb{E}[T \cdot U]" /> (interchange)
                </div>
                <div className="bg-white rounded p-1">
                  <span className="font-semibold">3.</span> Cauchy-Schwarz: <Latex math="1 \leq \text{Var}(T) \cdot I(\theta)" />
                </div>
                <div className="bg-white rounded p-1">
                  <span className="font-semibold">4.</span> Rearrange: <Latex math="\text{Var}(T) \geq 1/I(\theta)" />
                </div>
              </div>
            </div>
          </div>
    
          {/* Efficiency definition */}
          <div className="mt-3 bg-purple-50 rounded-xl p-3 border border-purple-200">
            <div className="font-semibold text-purple-800 mb-2">Efficiency</div>
            <div className="grid grid-cols-2 gap-3">
              <div className="bg-white rounded p-2 text-center">
                <div className="text-sm text-purple-600 mb-1">Absolute Efficiency:</div>
                <Latex math="e(T) = \frac{1/(nI_1)}{\text{Var}(T)} \leq 1" />
              </div>
              <div className="bg-white rounded p-2 text-center">
                <div className="text-sm text-purple-600 mb-1">MLE Property:</div>
                <Latex math="e(\hat{\theta}_{\text{MLE}}) \to 1 \text{ as } n \to \infty" />
              </div>
            </div>
          </div>
    
          {/* Bottom note */}
          <div className="mt-3 bg-teal-100 rounded-lg p-2 text-center text-sm">
            <span className="font-semibold text-teal-800">For Exponential Families:</span>
            <span className="text-teal-700 ml-2">
              MLE achieves CRLB <em>exactly</em>, not just asymptotically!
            </span>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                          SLIDE 42: INVARIANCE
// ═══════════════════════════════════════════════════════════════════════

function Slide42_Invariance() {
  return (
    <div className="flex flex-col h-full p-4">
          <h1 className="text-3xl font-bold text-gray-900 mb-1">Invariance Property</h1>
          <p className="text-gray-600 mb-3">MLE of a function = function of the MLE</p>
    
          {/* Main statement */}
          <div className="bg-gradient-to-r from-teal-50 to-cyan-50 rounded-xl p-4 border-2 border-teal-300 mb-4">
            <div className="text-center">
              <div className="text-sm text-teal-600 mb-2">If <Latex math="\hat{\theta}" /> is MLE of <Latex math="\theta" /> and <Latex math="g" /> is any function</div>
              <Latex math="\widehat{g(\theta)} = g(\hat{\theta})" display={true} />
              <div className="mt-2 text-sm text-teal-700">
                <strong>Reparameterization is free!</strong> No new derivation needed.
              </div>
            </div>
          </div>
    
          {/* Example */}
          <div className="bg-amber-50 rounded-xl p-4 border border-amber-200 mb-3">
            <div className="font-semibold text-amber-800 mb-2">Example: Exponential Rate vs Mean</div>
            <div className="grid grid-cols-3 gap-3">
              <div className="bg-white rounded p-2 text-center">
                <div className="text-xs text-amber-600 mb-1">Rate MLE:</div>
                <Latex math="\hat{\lambda} = 1/\bar{x}" />
              </div>
              <div className="bg-white rounded p-2 text-center flex items-center justify-center">
                <div className="text-2xl text-amber-400">⟹</div>
              </div>
              <div className="bg-white rounded p-2 text-center">
                <div className="text-xs text-amber-600 mb-1">Mean MLE (<Latex math="\mu = 1/\lambda" />):</div>
                <Latex math="\hat{\mu} = \bar{x}" />
              </div>
            </div>
            <div className="text-center text-sm text-amber-700 mt-2">
              Just apply <Latex math="g(\lambda) = 1/\lambda" /> - no re-derivation!
            </div>
          </div>
    
          <div className="grid grid-cols-2 gap-3 flex-1">
            {/* More examples */}
            <div className="bg-purple-50 rounded-xl p-3 border border-purple-200">
              <div className="font-semibold text-purple-800 mb-2">More Examples</div>
              <div className="space-y-2 text-sm text-purple-700">
                <div className="bg-white rounded p-2">
                  <strong>Bernoulli:</strong> <Latex math="\widehat{\text{odds}} = \frac{\hat{p}}{1-\hat{p}}" />
                </div>
                <div className="bg-white rounded p-2">
                  <strong>Normal:</strong> <Latex math="\hat{\sigma} = \sqrt{\hat{\sigma}^2}" />
                </div>
                <div className="bg-white rounded p-2">
                  <strong>Poisson:</strong> <Latex math="\widehat{P(X=0)} = e^{-\hat{\lambda}}" />
                </div>
              </div>
            </div>
    
            {/* Contrast with MoM */}
            <div className="bg-red-50 rounded-xl p-3 border border-red-200">
              <div className="font-semibold text-red-800 mb-2">MoM Does NOT Have This!</div>
              <div className="space-y-2 text-sm text-red-700">
                <div className="bg-white rounded p-2">
                  Method of Moments for <Latex math="g(\theta)" /> requires new derivation
                </div>
                <div className="bg-white rounded p-2">
                  Generally: <Latex math="g(\tilde{\theta}) \neq" /> MoM of <Latex math="g(\theta)" />
                </div>
              </div>
              <div className="text-xs text-red-600 mt-2">
                This is a major advantage of MLE!
              </div>
            </div>
          </div>
    
          {/* Delta method caveat */}
          <div className="mt-3 bg-slate-100 rounded-lg p-2 text-center text-sm">
            <span className="font-semibold text-slate-700">For Standard Errors:</span>
            <span className="text-slate-600 ml-2">
              Use delta method: <Latex math="\text{SE}(g(\hat{\theta})) \approx |g'(\hat{\theta})| \cdot \text{SE}(\hat{\theta})" />
            </span>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                          SLIDE 43: THREE TESTS
// ═══════════════════════════════════════════════════════════════════════

function Slide43_ThreeTests() {
  return (
    <div className="h-full flex flex-col p-4">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-2xl font-bold text-indigo-800">Likelihood-Based Hypothesis Testing</h1>
            <p className="text-gray-600 text-sm">Three asymptotically equivalent tests from the likelihood function</p>
          </div>
    
          {/* Setup */}
          <div className="flex-shrink-0 bg-indigo-50 border-l-4 border-indigo-500 p-3 mb-3">
            <p className="text-gray-700">
              <strong>Testing:</strong> <Latex math="H_0: \theta = \theta_0" /> vs <Latex math="H_1: \theta \neq \theta_0" />
              <span className="text-gray-500 text-sm ml-4">All three statistics are asymptotically <Latex math="\chi^2_1" /> under <Latex math="H_0" /></span>
            </p>
          </div>
    
          {/* Three Tests Grid - Main content */}
          <div className="flex-1 grid grid-cols-3 gap-4 mb-3">
            {/* LRT */}
            <div className="bg-white border-2 border-blue-300 rounded-lg p-4 flex flex-col">
              <h3 className="font-bold text-blue-700 text-lg mb-3">Likelihood Ratio Test</h3>
              <div className="bg-blue-50 p-4 rounded text-center mb-4 flex-shrink-0">
                <div className="text-xl"><Latex math="D = 2[\ell(\hat{\theta}) - \ell(\theta_0)]" /></div>
              </div>
              <div className="flex-1 space-y-2 text-sm text-gray-600">
                <p><strong>Measures:</strong> Vertical drop in log-likelihood from MLE to null</p>
                <p><strong>Requires:</strong> Both restricted and unrestricted MLEs</p>
                <p><strong>Intuition:</strong> How much worse does the null explain the data?</p>
              </div>
            </div>
    
            {/* Wald */}
            <div className="bg-white border-2 border-green-300 rounded-lg p-4 flex flex-col">
              <h3 className="font-bold text-green-700 text-lg mb-3">Wald Test</h3>
              <div className="bg-green-50 p-4 rounded text-center mb-4 flex-shrink-0">
                <div className="text-xl"><Latex math="W = \frac{(\hat{\theta} - \theta_0)^2}{\widehat{\text{Var}}(\hat{\theta})}" /></div>
              </div>
              <div className="flex-1 space-y-2 text-sm text-gray-600">
                <p><strong>Measures:</strong> Standardized horizontal distance from null</p>
                <p><strong>Requires:</strong> Only unrestricted MLE + standard error</p>
                <p><strong>Intuition:</strong> How many SEs is the MLE from the null?</p>
              </div>
            </div>
    
            {/* Score */}
            <div className="bg-white border-2 border-purple-300 rounded-lg p-4 flex flex-col">
              <h3 className="font-bold text-purple-700 text-lg mb-3">Score (Rao) Test</h3>
              <div className="bg-purple-50 p-4 rounded text-center mb-4 flex-shrink-0">
                <div className="text-xl"><Latex math="S = \frac{U(\theta_0)^2}{I(\theta_0)}" /></div>
              </div>
              <div className="flex-1 space-y-2 text-sm text-gray-600">
                <p><strong>Measures:</strong> Standardized slope at null value</p>
                <p><strong>Requires:</strong> Only evaluation at <Latex math="\theta_0" /></p>
                <p><strong>Intuition:</strong> Is the likelihood flat at the null?</p>
              </div>
            </div>
          </div>
    
          {/* Bottom row */}
          <div className="flex-shrink-0 grid grid-cols-2 gap-4">
            {/* Wilks' Theorem */}
            <div className="bg-amber-50 border border-amber-200 rounded-lg p-3">
              <h3 className="font-semibold text-amber-800 mb-1">Wilks' Theorem (1938)</h3>
              <p className="text-gray-700 text-sm">
                Under <Latex math="H_0" /> and regularity conditions: <Latex math="D = -2 \log \Lambda \xrightarrow{d} \chi^2_r" /> where{' '}
                <Latex math="r = \dim(\Theta) - \dim(\Theta_0)" />
              </p>
            </div>
    
            {/* Computational Tradeoffs */}
            <div className="bg-gray-50 rounded-lg p-3">
              <h3 className="font-semibold text-gray-700 mb-1">Computational Tradeoffs</h3>
              <div className="flex gap-4 text-sm">
                <div className="flex items-center gap-1">
                  <ChevronRight className="w-4 h-4 text-blue-500 flex-shrink-0" />
                  <span><strong>LRT:</strong> Most work, best power</span>
                </div>
                <div className="flex items-center gap-1">
                  <ChevronRight className="w-4 h-4 text-green-500 flex-shrink-0" />
                  <span><strong>Wald:</strong> Easy with MLE+SE</span>
                </div>
                <div className="flex items-center gap-1">
                  <ChevronRight className="w-4 h-4 text-purple-500 flex-shrink-0" />
                  <span><strong>Score:</strong> No optimization</span>
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                        SLIDE 44: TEST COMPARISON
// ═══════════════════════════════════════════════════════════════════════

function Slide44_TestComparison() {
  return (
    <div className="h-full flex flex-col p-4">
          {/* Header */}
          <div className="flex-shrink-0 mb-2">
            <h1 className="text-2xl font-bold text-indigo-800">Comparing the Three Tests</h1>
            <p className="text-gray-600 text-sm">Asymptotically equivalent, but different in finite samples</p>
          </div>
    
          {/* Figure - takes most of the space */}
          <div className="flex-1 min-h-0 mb-2">
            <img 
              src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/PartII/Chapter3/ch3_2_three_tests_comparison.png"
              alt="Geometric interpretation of LRT, Wald, and Score tests showing vertical drop, horizontal distance, and tangent slope measurements, plus test statistic ordering as function of sample mean"
              className="w-full h-full object-contain rounded-lg"
            />
          </div>
    
          {/* Bottom row - compact info panels */}
          <div className="flex-shrink-0 grid grid-cols-3 gap-3">
            <div className="bg-amber-50 border border-amber-200 rounded-lg p-2">
              <h3 className="font-semibold text-amber-800 text-sm flex items-center gap-1">
                <AlertTriangle className="w-4 h-4" />
                Finite Sample
              </h3>
              <ul className="text-xs text-gray-700 mt-1 space-y-0.5">
                <li><strong>Wald:</strong> tends liberal</li>
                <li><strong>Score:</strong> best Type I control</li>
                <li><strong>LRT:</strong> balanced</li>
              </ul>
            </div>
    
            <div className="bg-green-50 border border-green-200 rounded-lg p-2">
              <h3 className="font-semibold text-green-800 text-sm flex items-center gap-1">
                <CheckCircle className="w-4 h-4" />
                Recommendations
              </h3>
              <ul className="text-xs text-gray-700 mt-1 space-y-0.5">
                <li><strong>Default:</strong> LRT</li>
                <li><strong>Quick:</strong> Wald if MLE+SE ready</li>
                <li><strong>Boundary:</strong> Avoid Wald</li>
              </ul>
            </div>
    
            <div className="bg-indigo-50 border border-indigo-200 rounded-lg p-2">
              <h3 className="font-semibold text-indigo-800 text-sm">Ordering Rule</h3>
              <p className="text-xs text-gray-700 mt-1">
                Test using info at more extreme point yields larger statistic.
                Poisson: <Latex math="S \geq D \geq W" /> when <Latex math="\hat{\lambda} > \lambda_0" />
              </p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                     SLIDE 45: CONFIDENCE INTERVALS
// ═══════════════════════════════════════════════════════════════════════

function Slide45_ConfidenceIntervals() {
  return (
    <div className="h-full flex flex-col p-4">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-2xl font-bold text-indigo-800">Confidence Intervals from Likelihood</h1>
            <p className="text-gray-600 text-sm">Three approaches with different properties</p>
          </div>
    
          {/* Three Methods - Main content */}
          <div className="flex-1 grid grid-cols-3 gap-4 mb-3">
            {/* Wald */}
            <div className="bg-white border-2 border-green-300 rounded-lg p-4 flex flex-col">
              <h3 className="font-bold text-green-700 text-lg mb-3">Wald Interval</h3>
              <div className="bg-green-50 p-4 rounded text-center mb-4 flex-shrink-0">
                <div className="text-xl"><Latex math="\hat{\theta} \pm z_{\alpha/2} \cdot \text{SE}(\hat{\theta})" /></div>
              </div>
              <div className="flex-1 space-y-2 text-sm">
                <p className="text-green-700">+ Simple, always available</p>
                <p className="text-green-700">+ Easy interpretation</p>
                <p className="text-red-600">- Not transformation invariant</p>
                <p className="text-red-600">- Fails at boundaries</p>
                <p className="text-red-600">- Can give invalid intervals</p>
              </div>
            </div>
    
            {/* Profile Likelihood */}
            <div className="bg-white border-2 border-blue-300 rounded-lg p-4 flex flex-col">
              <h3 className="font-bold text-blue-700 text-lg mb-3">Profile Likelihood</h3>
              <div className="bg-blue-50 p-4 rounded text-center mb-4 flex-shrink-0">
                <div className="text-lg"><Latex math="\{\theta : 2[\ell(\hat{\theta}) - \ell(\theta)] \leq \chi^2_{1,\alpha}\}" /></div>
              </div>
              <div className="flex-1 space-y-2 text-sm">
                <p className="text-green-700">+ Transformation invariant</p>
                <p className="text-green-700">+ Respects boundaries</p>
                <p className="text-green-700">+ Often best coverage</p>
                <p className="text-green-700">+ Gold standard</p>
                <p className="text-amber-600">~ Requires optimization</p>
              </div>
            </div>
    
            {/* Score/Wilson */}
            <div className="bg-white border-2 border-purple-300 rounded-lg p-4 flex flex-col">
              <h3 className="font-bold text-purple-700 text-lg mb-3">Score (Wilson)</h3>
              <div className="bg-purple-50 p-4 rounded text-center mb-4 flex-shrink-0">
                <div className="text-lg"><Latex math="\{\theta : U(\theta)^2/I(\theta) \leq \chi^2_{1,\alpha}\}" /></div>
              </div>
              <div className="flex-1 space-y-2 text-sm">
                <p className="text-green-700">+ Good boundary behavior</p>
                <p className="text-green-700">+ Often closed-form</p>
                <p className="text-green-700">+ Better than Wald for small n</p>
                <p className="text-green-700">+ Standard for proportions</p>
                <p className="text-amber-600">~ Less familiar notation</p>
              </div>
            </div>
          </div>
    
          {/* Binomial Example + Warning */}
          <div className="flex-shrink-0 grid grid-cols-5 gap-3">
            {/* Example header */}
            <div className="col-span-3 bg-gray-50 rounded-lg p-3">
              <h3 className="font-semibold text-gray-700 mb-2">
                Example: Binomial Proportion (<Latex math="x = 2, n = 20, \hat{p} = 0.10" />)
              </h3>
              <div className="grid grid-cols-3 gap-3 text-sm">
                <div className="text-center bg-green-100 rounded p-2">
                  <div className="text-green-700 font-semibold">Wald</div>
                  <div className="font-mono">[-0.03, 0.23]</div>
                  <div className="text-xs text-red-600 font-semibold">Invalid!</div>
                </div>
                <div className="text-center bg-purple-100 rounded p-2">
                  <div className="text-purple-700 font-semibold">Wilson</div>
                  <div className="font-mono">[0.028, 0.30]</div>
                  <div className="text-xs text-green-600">Valid</div>
                </div>
                <div className="text-center bg-blue-100 rounded p-2">
                  <div className="text-blue-700 font-semibold">Profile</div>
                  <div className="font-mono">[0.024, 0.29]</div>
                  <div className="text-xs text-green-600">Gold standard</div>
                </div>
              </div>
            </div>
    
            {/* Warning */}
            <div className="col-span-2 bg-red-50 border-l-4 border-red-500 p-3">
              <div className="flex items-start gap-2">
                <AlertTriangle className="w-5 h-5 text-red-600 flex-shrink-0 mt-0.5" />
                <div>
                  <h4 className="font-semibold text-red-800 text-sm">Wald Fails at Boundaries</h4>
                  <p className="text-xs text-gray-700 mt-1">
                    When <Latex math="\hat{p} = 0" /> or <Latex math="\hat{p} = 1" />, Wald gives zero-width intervals.
                    For bounded parameters, use Wilson or profile.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                          SLIDE 46: MLE SUMMARY
// ═══════════════════════════════════════════════════════════════════════

function Slide46_MLESummary() {
  return (
    <div className="h-full flex flex-col p-4">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-2xl font-bold text-indigo-800">Section 3.2 Summary: Maximum Likelihood Estimation</h1>
            <p className="text-gray-600 text-sm">The workhorse of parametric inference</p>
          </div>
    
          {/* Main content - 2x2 grid */}
          <div className="flex-1 grid grid-cols-2 gap-4 mb-3">
            {/* Core Objects */}
            <div className="bg-blue-50 rounded-lg p-4 flex flex-col">
              <h3 className="font-bold text-blue-800 text-lg mb-3">Core Objects</h3>
              <div className="flex-1 space-y-3">
                <div className="bg-white rounded p-3">
                  <div className="flex justify-between items-center">
                    <span className="font-semibold text-gray-700">Likelihood:</span>
                    <span className="text-lg"><Latex math="L(\theta) = \prod_{i=1}^n f(x_i|\theta)" /></span>
                  </div>
                </div>
                <div className="bg-white rounded p-3">
                  <div className="flex justify-between items-center">
                    <span className="font-semibold text-gray-700">Score:</span>
                    <span className="text-lg"><Latex math="U(\theta) = \frac{\partial \ell}{\partial \theta}" /></span>
                  </div>
                </div>
                <div className="bg-white rounded p-3">
                  <div className="flex justify-between items-center">
                    <span className="font-semibold text-gray-700">Fisher Info:</span>
                    <span className="text-lg"><Latex math="I(\theta) = \text{Var}[U(\theta)] = -\mathbb{E}[\ell'']" /></span>
                  </div>
                </div>
              </div>
            </div>
    
            {/* Asymptotic Properties */}
            <div className="bg-green-50 rounded-lg p-4 flex flex-col">
              <h3 className="font-bold text-green-800 text-lg mb-3">Asymptotic Properties</h3>
              <div className="flex-1 space-y-3">
                <div className="bg-white rounded p-3 flex items-center gap-3">
                  <CheckCircle className="w-5 h-5 text-green-600 flex-shrink-0" />
                  <div>
                    <span className="font-semibold">Consistent:</span>
                    <span className="ml-2"><Latex math="\hat{\theta} \xrightarrow{p} \theta_0" /></span>
                  </div>
                </div>
                <div className="bg-white rounded p-3 flex items-center gap-3">
                  <CheckCircle className="w-5 h-5 text-green-600 flex-shrink-0" />
                  <div>
                    <span className="font-semibold">Asymp. Normal:</span>
                    <span className="ml-2"><Latex math="\sqrt{n}(\hat{\theta}-\theta_0) \xrightarrow{d} N(0, I^{-1})" /></span>
                  </div>
                </div>
                <div className="bg-white rounded p-3 flex items-center gap-3">
                  <CheckCircle className="w-5 h-5 text-green-600 flex-shrink-0" />
                  <div>
                    <span className="font-semibold">Efficient:</span>
                    <span className="ml-2">Achieves CRLB: <Latex math="\text{Var}(\hat{\theta}) \geq 1/[nI(\theta)]" /></span>
                  </div>
                </div>
                <div className="bg-white rounded p-3 flex items-center gap-3">
                  <CheckCircle className="w-5 h-5 text-green-600 flex-shrink-0" />
                  <div>
                    <span className="font-semibold">Invariant:</span>
                    <span className="ml-2">MLE of <Latex math="g(\theta)" /> is <Latex math="g(\hat{\theta})" /></span>
                  </div>
                </div>
              </div>
            </div>
    
            {/* The MLE Toolkit */}
            <div className="bg-gray-50 rounded-lg p-4">
              <h3 className="font-bold text-gray-800 text-lg mb-3">The MLE Toolkit</h3>
              <div className="grid grid-cols-3 gap-3 h-full">
                <div className="bg-white rounded p-3">
                  <h4 className="font-semibold text-gray-700 text-sm mb-2">Finding MLEs</h4>
                  <ul className="text-xs space-y-1 text-gray-600">
                    <li>Closed-form</li>
                    <li>Newton-Raphson</li>
                    <li>Fisher Scoring</li>
                    <li>scipy.optimize</li>
                  </ul>
                </div>
                <div className="bg-white rounded p-3">
                  <h4 className="font-semibold text-gray-700 text-sm mb-2">Hypothesis Tests</h4>
                  <ul className="text-xs space-y-1 text-gray-600">
                    <li>LRT (gold standard)</li>
                    <li>Wald (convenient)</li>
                    <li>Score (null-only)</li>
                    <li>All <Latex math="\to \chi^2" /></li>
                  </ul>
                </div>
                <div className="bg-white rounded p-3">
                  <h4 className="font-semibold text-gray-700 text-sm mb-2">Confidence Intervals</h4>
                  <ul className="text-xs space-y-1 text-gray-600">
                    <li>Wald (simple)</li>
                    <li>Profile (best)</li>
                    <li>Score/Wilson</li>
                  </ul>
                </div>
              </div>
            </div>
    
            {/* Key Takeaways */}
            <div className="bg-indigo-50 rounded-lg p-4">
              <h3 className="font-bold text-indigo-800 text-lg mb-3">Key Takeaways</h3>
              <div className="space-y-2">
                <div className="flex items-start gap-2 bg-white rounded p-2">
                  <span className="text-indigo-600 font-bold">1.</span>
                  <span className="text-sm">MLE maximizes the probability of observed data</span>
                </div>
                <div className="flex items-start gap-2 bg-white rounded p-2">
                  <span className="text-indigo-600 font-bold">2.</span>
                  <span className="text-sm">Fisher information = curvature of log-likelihood = precision</span>
                </div>
                <div className="flex items-start gap-2 bg-white rounded p-2">
                  <span className="text-indigo-600 font-bold">3.</span>
                  <span className="text-sm">CRLB bounds all unbiased estimators; MLE achieves it asymptotically</span>
                </div>
                <div className="flex items-start gap-2 bg-white rounded p-2">
                  <span className="text-indigo-600 font-bold">4.</span>
                  <span className="text-sm">One likelihood function gives estimation, testing, and intervals</span>
                </div>
              </div>
            </div>
          </div>
    
          {/* Footer */}
          <div className="flex-shrink-0 flex items-center justify-between bg-white border rounded-lg p-3">
            <div className="flex items-center gap-2">
              <BookOpen className="w-5 h-5 text-gray-400" />
              <span className="text-gray-600 text-sm">See textbook Section 3.2 for full proofs and exercises</span>
            </div>
            <div className="flex items-center gap-2 text-indigo-600">
              <span className="font-semibold">Next: Sampling Variability</span>
              <ArrowRight className="w-5 h-5" />
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                   SLIDE 47: SAMPLING VARIABILITY HERO
// ═══════════════════════════════════════════════════════════════════════

function Slide47_SamplingVariabilityHero() {
  return (
    <div className="h-full flex flex-col p-6 bg-gradient-to-br from-teal-50 to-cyan-100">
          {/* Header */}
          <div className="flex-shrink-0 mb-6">
            <div className="text-teal-600 font-semibold mb-1">Section 3.3</div>
            <h1 className="text-4xl font-bold text-gray-800 mb-2">Sampling Variability & Variance Estimation</h1>
            <p className="text-xl text-gray-600">From point estimates to uncertainty quantification</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-6">
            {/* Left: The Problem */}
            <div className="flex flex-col">
              <div className="bg-white rounded-xl shadow-lg p-5 mb-4 flex-1">
                <div className="flex items-center gap-2 mb-4">
                  <HelpCircle className="w-6 h-6 text-teal-600" />
                  <h2 className="text-xl font-bold text-gray-800">The Problem</h2>
                </div>
                
                <div className="bg-teal-50 rounded-lg p-4 mb-4">
                  <p className="text-lg text-gray-700 mb-2">A vaccine trial reports:</p>
                  <div className="text-center text-3xl font-bold text-teal-700 my-3">
                    <Latex math="\widehat{\text{VE}} = 95.1\%" />
                  </div>
                  <p className="text-xs text-gray-500 text-center mb-2">
                    Vaccine Efficacy: <Latex math="\text{VE} = 1 - p_{\text{vacc}}/p_{\text{placebo}}" /> (relative risk reduction)
                  </p>
                  <p className="text-gray-600 text-center">But how precise is this estimate?</p>
                </div>
    
                <div className="space-y-2 text-gray-700">
                  <p className="flex items-center gap-2">
                    <span className="text-red-500 font-bold">?</span>
                    What is <Latex math="\text{SE}(\widehat{\text{VE}})" />?
                  </p>
                  <p className="flex items-center gap-2">
                    <span className="text-red-500 font-bold">?</span>
                    Could the true VE be below 90%?
                  </p>
                  <p className="flex items-center gap-2">
                    <span className="text-red-500 font-bold">?</span>
                    VE is a ratio of proportions — how do we propagate uncertainty?
                  </p>
                </div>
              </div>
            </div>
    
            {/* Right: What We'll Learn */}
            <div className="flex flex-col">
              <div className="bg-white rounded-xl shadow-lg p-5 flex-1">
                <div className="flex items-center gap-2 mb-4">
                  <Target className="w-6 h-6 text-teal-600" />
                  <h2 className="text-xl font-bold text-gray-800">This Section</h2>
                </div>
    
                <div className="space-y-3">
                  <div className="flex items-start gap-3 p-3 bg-gray-50 rounded-lg">
                    <div className="w-8 h-8 bg-teal-100 rounded-full flex items-center justify-center text-teal-700 font-bold flex-shrink-0">1</div>
                    <div>
                      <h3 className="font-semibold text-gray-800">Estimator Properties</h3>
                      <p className="text-sm text-gray-600">Bias, variance, MSE, consistency</p>
                    </div>
                  </div>
    
                  <div className="flex items-start gap-3 p-3 bg-gray-50 rounded-lg">
                    <div className="w-8 h-8 bg-teal-100 rounded-full flex items-center justify-center text-teal-700 font-bold flex-shrink-0">2</div>
                    <div>
                      <h3 className="font-semibold text-gray-800">Sampling Distributions</h3>
                      <p className="text-sm text-gray-600">Exact vs asymptotic; when to use which</p>
                    </div>
                  </div>
    
                  <div className="flex items-start gap-3 p-3 bg-teal-50 rounded-lg border-2 border-teal-300">
                    <div className="w-8 h-8 bg-teal-600 rounded-full flex items-center justify-center text-white font-bold flex-shrink-0">3</div>
                    <div>
                      <h3 className="font-semibold text-teal-800">The Delta Method</h3>
                      <p className="text-sm text-teal-700">Propagate uncertainty through transformations</p>
                    </div>
                  </div>
    
                  <div className="flex items-start gap-3 p-3 bg-gray-50 rounded-lg">
                    <div className="w-8 h-8 bg-teal-100 rounded-full flex items-center justify-center text-teal-700 font-bold flex-shrink-0">4</div>
                    <div>
                      <h3 className="font-semibold text-gray-800">Variance Estimation</h3>
                      <p className="text-sm text-gray-600">Fisher, observed, and sandwich estimators</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom: Key insight */}
          <div className="flex-shrink-0 mt-4 bg-white rounded-xl shadow-lg p-4">
            <div className="flex items-center justify-between">
              <div className="flex items-center gap-3">
                <TrendingUp className="w-6 h-6 text-teal-600" />
                <span className="text-lg font-semibold text-gray-800">Core insight:</span>
                <span className="text-lg text-gray-700">Variance transforms like the <strong>square of the derivative</strong></span>
              </div>
              <div className="bg-teal-100 px-4 py-2 rounded-lg">
                <Latex math="\text{Var}(g(\hat{\theta})) \approx [g'(\theta)]^2 \cdot \text{Var}(\hat{\theta})" />
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                       SLIDE 48: WHAT IS ESTIMATOR
// ═══════════════════════════════════════════════════════════════════════

function Slide48_WhatIsEstimator() {
  return (
    <div className="h-full flex flex-col p-4">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-2xl font-bold text-teal-800">What Is an Estimator?</h1>
            <p className="text-gray-600 text-sm">A function of data that approximates an unknown parameter</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Left: Definition */}
            <div className="flex flex-col gap-3">
              {/* Definition box */}
              <div className="bg-teal-50 border-l-4 border-teal-500 p-4 rounded-r-lg">
                <h3 className="font-bold text-teal-800 mb-2">Definition</h3>
                <p className="text-gray-700 mb-2">
                  Let <Latex math="X_1, \ldots, X_n" /> be a random sample from <Latex math="F_\theta" />. An <strong>estimator</strong> is:
                </p>
                <div className="text-center text-xl my-3">
                  <Latex math="\hat{\theta} = T(X_1, \ldots, X_n)" />
                </div>
              </div>
    
              {/* Key distinction */}
              <div className="bg-white border-2 border-gray-200 rounded-lg p-4 flex-1">
                <h3 className="font-semibold text-gray-800 mb-3">Critical Distinction</h3>
                
                <div className="space-y-3">
                  <div className="flex items-center gap-3 p-3 bg-blue-50 rounded-lg">
                    <div className="w-16 text-right font-mono text-blue-700"><Latex math="\hat{\theta}" /></div>
                    <ArrowRight className="w-4 h-4 text-gray-400" />
                    <div>
                      <span className="font-semibold text-blue-800">Random variable</span>
                      <span className="text-gray-600 text-sm ml-2">(before observing data)</span>
                    </div>
                  </div>
    
                  <div className="flex items-center gap-3 p-3 bg-green-50 rounded-lg">
                    <div className="w-16 text-right font-mono text-green-700"><Latex math="\hat{\theta} = 2.3" /></div>
                    <ArrowRight className="w-4 h-4 text-gray-400" />
                    <div>
                      <span className="font-semibold text-green-800">Number</span>
                      <span className="text-gray-600 text-sm ml-2">(after observing data)</span>
                    </div>
                  </div>
                </div>
    
                <div className="mt-4 p-3 bg-amber-50 rounded-lg">
                  <p className="text-sm text-amber-800">
                    <strong>Key insight:</strong> Different samples yield different estimates — this variability is <em>sampling variability</em>.
                  </p>
                </div>
              </div>
            </div>
    
            {/* Right: Table of common estimators */}
            <div className="bg-white border rounded-lg overflow-hidden flex flex-col">
              <div className="bg-gray-100 px-4 py-2 border-b">
                <h3 className="font-semibold text-gray-800">Common Estimators</h3>
              </div>
              
              <div className="flex-1 overflow-auto">
                <table className="w-full text-sm">
                  <thead className="bg-gray-50 sticky top-0">
                    <tr>
                      <th className="px-3 py-2 text-left text-gray-700">Parameter</th>
                      <th className="px-3 py-2 text-left text-gray-700">Estimator</th>
                      <th className="px-3 py-2 text-left text-gray-700">Formula</th>
                    </tr>
                  </thead>
                  <tbody className="divide-y">
                    <tr className="hover:bg-gray-50">
                      <td className="px-3 py-2">Mean <Latex math="\mu" /></td>
                      <td className="px-3 py-2 font-mono text-blue-700"><Latex math="\bar{X}" /></td>
                      <td className="px-3 py-2"><Latex math="\frac{1}{n}\sum_{i=1}^n X_i" /></td>
                    </tr>
                    <tr className="hover:bg-gray-50">
                      <td className="px-3 py-2">Variance <Latex math="\sigma^2" /></td>
                      <td className="px-3 py-2 font-mono text-blue-700"><Latex math="S^2" /></td>
                      <td className="px-3 py-2"><Latex math="\frac{1}{n-1}\sum(X_i - \bar{X})^2" /></td>
                    </tr>
                    <tr className="hover:bg-gray-50">
                      <td className="px-3 py-2">Proportion <Latex math="p" /></td>
                      <td className="px-3 py-2 font-mono text-blue-700"><Latex math="\hat{p}" /></td>
                      <td className="px-3 py-2"><Latex math="\frac{1}{n}\sum X_i" /> for <Latex math="X_i \in \{0,1\}" /></td>
                    </tr>
                    <tr className="hover:bg-gray-50">
                      <td className="px-3 py-2">Rate <Latex math="\lambda" /></td>
                      <td className="px-3 py-2 font-mono text-blue-700"><Latex math="\hat{\lambda}" /></td>
                      <td className="px-3 py-2"><Latex math="1/\bar{X}" /> (Exponential)</td>
                    </tr>
                    <tr className="hover:bg-gray-50">
                      <td className="px-3 py-2">Median <Latex math="\tilde{\mu}" /></td>
                      <td className="px-3 py-2 font-mono text-blue-700"><Latex math="\tilde{X}" /></td>
                      <td className="px-3 py-2 text-xs">Middle order statistic(s)</td>
                    </tr>
                  </tbody>
                </table>
              </div>
    
              <div className="p-3 bg-gray-50 border-t">
                <p className="text-sm text-gray-600">
                  <strong>Note:</strong> Multiple estimators can target the same parameter. Which is "best"?
                </p>
              </div>
            </div>
          </div>
    
          {/* Bottom insight */}
          <div className="flex-shrink-0 mt-3 bg-teal-50 rounded-lg p-3">
            <p className="text-center text-teal-800">
              Because <Latex math="\hat{\theta}" /> is a random variable, it has a <strong>sampling distribution</strong> with expectation, variance, and shape we can analyze.
            </p>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                       SLIDE 49: BIAS VARIANCE MSE
// ═══════════════════════════════════════════════════════════════════════

function Slide49_BiasVarianceMSE() {
  return (
    <div className="h-full flex flex-col p-4">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-2xl font-bold text-teal-800">Bias, Variance, and Mean Squared Error</h1>
            <p className="text-gray-600 text-sm">Three properties that characterize estimator quality</p>
          </div>
    
          {/* Main grid: 3 columns for properties + visual */}
          <div className="flex-1 grid grid-cols-4 gap-3">
            {/* Bias */}
            <div className="bg-blue-50 rounded-lg p-3 flex flex-col">
              <h3 className="font-bold text-blue-800 mb-2">Bias</h3>
              <div className="bg-white rounded p-2 text-center mb-2">
                <Latex math="\text{Bias}(\hat{\theta}) = \mathbb{E}[\hat{\theta}] - \theta" />
              </div>
              <p className="text-sm text-gray-700 mb-2">Systematic error: over/underestimate on average</p>
              <div className="mt-auto">
                <div className="text-xs bg-blue-100 rounded p-2">
                  <strong>Unbiased:</strong> <Latex math="\mathbb{E}[\hat{\theta}] = \theta" />
                </div>
              </div>
            </div>
    
            {/* Variance */}
            <div className="bg-green-50 rounded-lg p-3 flex flex-col">
              <h3 className="font-bold text-green-800 mb-2">Variance</h3>
              <div className="bg-white rounded p-2 text-center mb-2">
                <Latex math="\text{Var}(\hat{\theta}) = \mathbb{E}[(\hat{\theta} - \mathbb{E}[\hat{\theta}])^2]" />
              </div>
              <p className="text-sm text-gray-700 mb-2">Precision: how much estimates fluctuate</p>
              <div className="mt-auto">
                <div className="text-xs bg-green-100 rounded p-2">
                  <strong>SE:</strong> <Latex math="\text{SE}(\hat{\theta}) = \sqrt{\text{Var}(\hat{\theta})}" />
                </div>
              </div>
            </div>
    
            {/* MSE */}
            <div className="bg-purple-50 rounded-lg p-3 flex flex-col">
              <h3 className="font-bold text-purple-800 mb-2">MSE</h3>
              <div className="bg-white rounded p-2 text-center mb-2">
                <Latex math="\text{MSE}(\hat{\theta}) = \mathbb{E}[(\hat{\theta} - \theta)^2]" />
              </div>
              <p className="text-sm text-gray-700 mb-2">Overall error: combines both sources</p>
              <div className="mt-auto">
                <div className="text-xs bg-purple-100 rounded p-2">
                  Average squared distance from truth
                </div>
              </div>
            </div>
    
            {/* Visual: Dartboard analogy */}
            <div className="bg-gray-50 rounded-lg p-3 flex flex-col">
              <h3 className="font-bold text-gray-800 mb-2 text-center">Dartboard Analogy</h3>
              <div className="flex-1 flex items-center justify-center">
                <svg viewBox="0 0 120 120" className="w-full h-32">
                  {/* Target rings */}
                  <circle cx="60" cy="60" r="50" fill="none" stroke="#ddd" strokeWidth="2"/>
                  <circle cx="60" cy="60" r="35" fill="none" stroke="#ddd" strokeWidth="1"/>
                  <circle cx="60" cy="60" r="20" fill="none" stroke="#ddd" strokeWidth="1"/>
                  <circle cx="60" cy="60" r="5" fill="#ef4444"/>
                  
                  {/* Shots: High bias, low variance (top right cluster) */}
                  <circle cx="85" cy="35" r="3" fill="#3b82f6"/>
                  <circle cx="88" cy="38" r="3" fill="#3b82f6"/>
                  <circle cx="83" cy="40" r="3" fill="#3b82f6"/>
                  <circle cx="87" cy="33" r="3" fill="#3b82f6"/>
                  
                  {/* Shots: Low bias, high variance (scattered around center) */}
                  <circle cx="45" cy="75" r="3" fill="#22c55e"/>
                  <circle cx="70" cy="50" r="3" fill="#22c55e"/>
                  <circle cx="55" cy="85" r="3" fill="#22c55e"/>
                  <circle cx="40" cy="55" r="3" fill="#22c55e"/>
                </svg>
              </div>
              <div className="text-xs space-y-1 mt-2">
                <div className="flex items-center gap-2">
                  <div className="w-3 h-3 rounded-full bg-blue-500"></div>
                  <span>High bias, low variance</span>
                </div>
                <div className="flex items-center gap-2">
                  <div className="w-3 h-3 rounded-full bg-green-500"></div>
                  <span>Low bias, high variance</span>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bias-Variance Decomposition */}
          <div className="flex-shrink-0 mt-3 bg-amber-50 border-2 border-amber-300 rounded-lg p-4">
            <div className="flex items-center justify-between">
              <div>
                <h3 className="font-bold text-amber-800 mb-1">Bias-Variance Decomposition</h3>
                <p className="text-sm text-gray-700">The fundamental tradeoff in estimation</p>
              </div>
              <div className="bg-white rounded-lg px-6 py-3 shadow">
                <div className="text-xl">
                  <Latex math="\text{MSE}(\hat{\theta}) = \text{Bias}(\hat{\theta})^2 + \text{Var}(\hat{\theta})" />
                </div>
              </div>
            </div>
          </div>
    
          {/* Examples and Warning */}
          <div className="flex-shrink-0 mt-3 grid grid-cols-2 gap-3">
            {/* Examples */}
            <div className="bg-gray-50 rounded-lg p-3">
              <h3 className="font-semibold text-gray-700 mb-2">Examples</h3>
              <div className="text-sm space-y-1">
                <p><Latex math="\bar{X}" /> for <Latex math="\mu" />: <span className="text-green-600 font-semibold">Unbiased</span></p>
                <p><Latex math="S^2" /> (divide by n-1) for <Latex math="\sigma^2" />: <span className="text-green-600 font-semibold">Unbiased</span></p>
                <p><Latex math="\hat{\sigma}^2_{\text{MLE}}" /> (divide by n): <span className="text-amber-600 font-semibold">Biased</span> by <Latex math="-\sigma^2/n" /></p>
              </div>
            </div>
    
            {/* Warning */}
            <div className="bg-red-50 border-l-4 border-red-400 rounded-r-lg p-3">
              <div className="flex items-start gap-2">
                <AlertTriangle className="w-5 h-5 text-red-500 flex-shrink-0 mt-0.5" />
                <div>
                  <h4 className="font-semibold text-red-800 text-sm">Unbiasedness Is Not Everything</h4>
                  <p className="text-xs text-gray-700 mt-1">
                    A biased estimator with small variance can have <strong>lower MSE</strong> than an unbiased one with large variance. This motivates shrinkage and regularization.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                          SLIDE 50: CONSISTENCY
// ═══════════════════════════════════════════════════════════════════════

function Slide50_Consistency() {
  return (
    <div className="h-full flex flex-col p-4">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-2xl font-bold text-teal-800">Consistency</h1>
            <p className="text-gray-600 text-sm">Estimators that converge to the truth as sample size grows</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Left: Definition and formulation */}
            <div className="flex flex-col gap-3">
              {/* Definition */}
              <div className="bg-teal-50 border-l-4 border-teal-500 p-4 rounded-r-lg">
                <h3 className="font-bold text-teal-800 mb-2">Definition (Weak Consistency)</h3>
                <p className="text-gray-700 mb-3">
                  An estimator <Latex math="\hat{\theta}_n" /> is <strong>consistent</strong> for <Latex math="\theta" /> if:
                </p>
                <div className="bg-white rounded-lg p-3 text-center">
                  <div className="text-xl">
                    <Latex math="\hat{\theta}_n \xrightarrow{p} \theta \quad \text{as } n \to \infty" />
                  </div>
                </div>
                <p className="text-sm text-gray-600 mt-3">
                  For any <Latex math="\varepsilon > 0" />: <Latex math="\lim_{n \to \infty} P(|\hat{\theta}_n - \theta| > \varepsilon) = 0" />
                </p>
                <p className="text-xs text-teal-700 mt-2">
                  <strong>Strong consistency</strong> (<Latex math="\xrightarrow{a.s.}" />) is stronger and implies weak.
                </p>
              </div>
    
              {/* Sufficient conditions */}
              <div className="bg-white border rounded-lg p-4 flex-1">
                <h3 className="font-semibold text-gray-800 mb-3">Sufficient Conditions (Weak)</h3>
                <div className="space-y-3">
                  <div className="flex items-start gap-2 p-2 bg-green-50 rounded">
                    <CheckCircle className="w-5 h-5 text-green-600 flex-shrink-0 mt-0.5" />
                    <div className="text-sm">
                      <strong>Unbiased + Var to 0:</strong>
                      <p className="text-gray-600">If <Latex math="\mathbb{E}[\hat{\theta}_n] = \theta" /> and <Latex math="\text{Var}(\hat{\theta}_n) \to 0" /></p>
                    </div>
                  </div>
    
                  <div className="flex items-start gap-2 p-2 bg-green-50 rounded">
                    <CheckCircle className="w-5 h-5 text-green-600 flex-shrink-0 mt-0.5" />
                    <div className="text-sm">
                      <strong>MSE to 0:</strong>
                      <p className="text-gray-600">If <Latex math="\text{MSE}(\hat{\theta}_n) \to 0" /> as <Latex math="n \to \infty" /></p>
                    </div>
                  </div>
    
                  <div className="flex items-start gap-2 p-2 bg-amber-50 rounded">
                    <CheckCircle className="w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5" />
                    <div className="text-sm">
                      <strong>Biased but asymptotically unbiased:</strong>
                      <p className="text-gray-600">If <Latex math="\text{Bias} \to 0" /> and <Latex math="\text{Var} \to 0" /></p>
                    </div>
                  </div>
                </div>
                <p className="text-xs text-gray-500 mt-3">
                  <strong>Strong consistency</strong> requires <Latex math="\sum \text{Var}(\hat{\theta}_n) < \infty" /> (summability).
                </p>
              </div>
            </div>
    
            {/* Right: Examples and visualization */}
            <div className="flex flex-col gap-3">
              {/* Sample mean example */}
              <div className="bg-blue-50 rounded-lg p-4">
                <h3 className="font-semibold text-blue-800 mb-2">Example: Sample Mean</h3>
                <p className="text-sm text-gray-700 mb-2">
                  <Latex math="\bar{X}_n" /> is consistent for <Latex math="\mu" /> (assuming <Latex math="\sigma^2 < \infty" />):
                </p>
                <div className="grid grid-cols-2 gap-2 text-sm">
                  <div className="bg-white rounded p-2">
                    <span className="text-blue-600">Unbiased:</span>
                    <div><Latex math="\mathbb{E}[\bar{X}_n] = \mu" /></div>
                  </div>
                  <div className="bg-white rounded p-2">
                    <span className="text-blue-600">Variance:</span>
                    <div><Latex math="\text{Var}(\bar{X}_n) = \frac{\sigma^2}{n}" /></div>
                  </div>
                </div>
                <div className="bg-white rounded p-2 mt-2 text-sm">
                  <span className="text-blue-600">Chebyshev:</span>
                  <Latex math="P(|\bar{X}_n - \mu| > \varepsilon) \leq \frac{\sigma^2}{n\varepsilon^2} \to 0" />
                </div>
              </div>
    
              {/* Biased but consistent example */}
              <div className="bg-amber-50 rounded-lg p-4 flex-1">
                <h3 className="font-semibold text-amber-800 mb-2">Example: Biased but Consistent</h3>
                <p className="text-sm text-gray-700 mb-2">
                  MLE of variance: <Latex math="\hat{\sigma}^2_n = \frac{1}{n}\sum(X_i - \bar{X})^2" />
                </p>
                
                <div className="bg-white rounded-lg p-3 mb-3">
                  <div className="text-center">
                    <Latex math="\mathbb{E}[\hat{\sigma}^2_n] = \frac{n-1}{n}\sigma^2" />
                  </div>
                </div>
    
                <div className="space-y-2 text-sm">
                  <div className="flex items-center gap-2">
                    <TrendingDown className="w-4 h-4 text-amber-600" />
                    <span>Bias <Latex math="= -\sigma^2/n \to 0" /></span>
                  </div>
                  <div className="flex items-center gap-2">
                    <TrendingDown className="w-4 h-4 text-amber-600" />
                    <span><Latex math="\text{Var}(\hat{\sigma}^2_n) = O(1/n)" /> (requires <Latex math="\mu_4 < \infty" />)</span>
                  </div>
                </div>
    
                <div className="mt-3 p-2 bg-amber-100 rounded text-sm">
                  <strong>Key insight:</strong> For large n, the bias becomes negligible, so biased MLEs are still useful!
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom: Visual representation */}
          <div className="flex-shrink-0 mt-3 bg-gray-50 rounded-lg p-3">
            <div className="flex items-center justify-between">
              <div className="text-gray-700">
                <strong>Convergence in probability:</strong> The distribution of <Latex math="\hat{\theta}_n" /> concentrates around <Latex math="\theta" />
              </div>
              <div className="flex items-center gap-2">
                <div className="flex items-center gap-1">
                  <div className="w-16 h-6 bg-gradient-to-r from-blue-200 via-blue-400 to-blue-200 rounded opacity-70"></div>
                  <span className="text-xs text-gray-500">n small</span>
                </div>
                <ArrowRight className="w-4 h-4 text-gray-400" />
                <div className="flex items-center gap-1">
                  <div className="w-8 h-6 bg-blue-600 rounded"></div>
                  <span className="text-xs text-gray-500">n large</span>
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                 SLIDE 51: EXACT SAMPLING DISTRIBUTIONS
// ═══════════════════════════════════════════════════════════════════════

function Slide51_ExactSamplingDistributions() {
  return (
    <div className="h-full flex flex-col p-4">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-2xl font-bold text-teal-800">Exact Sampling Distributions</h1>
            <p className="text-gray-600 text-sm">Known distributions that hold for any sample size (under specific assumptions)</p>
          </div>
    
          {/* Main content - three exact results */}
          <div className="flex-1 grid grid-cols-3 gap-4 mb-3">
            {/* Sample Mean */}
            <div className="bg-blue-50 rounded-lg p-4 flex flex-col">
              <h3 className="font-bold text-blue-800 mb-2">Sample Mean from Normal</h3>
              <div className="bg-white rounded-lg p-3 text-center mb-3">
                <p className="text-sm text-gray-600 mb-2">If <Latex math="X_1, \ldots, X_n \stackrel{\text{iid}}{\sim} \mathcal{N}(\mu, \sigma^2)" /></p>
                <div className="text-xl my-2">
                  <Latex math="\bar{X} \sim \mathcal{N}\left(\mu, \frac{\sigma^2}{n}\right)" />
                </div>
              </div>
              <div className="flex-1 text-sm text-gray-700">
                <p className="flex items-start gap-2 mb-1">
                  <CheckCircle className="w-4 h-4 text-blue-500 flex-shrink-0 mt-0.5" />
                  Exact for any n
                </p>
                <p className="flex items-start gap-2">
                  <CheckCircle className="w-4 h-4 text-blue-500 flex-shrink-0 mt-0.5" />
                  Requires Normal data
                </p>
              </div>
              <div className="mt-auto pt-2 border-t text-xs text-blue-600">
                Use: z-test when <Latex math="\sigma" /> known
              </div>
            </div>
    
            {/* Sample Variance */}
            <div className="bg-green-50 rounded-lg p-4 flex flex-col">
              <h3 className="font-bold text-green-800 mb-2">Sample Variance from Normal</h3>
              <div className="bg-white rounded-lg p-3 text-center mb-3">
                <p className="text-sm text-gray-600 mb-2">If <Latex math="X_1, \ldots, X_n \stackrel{\text{iid}}{\sim} \mathcal{N}(\mu, \sigma^2)" /></p>
                <div className="text-xl my-2">
                  <Latex math="\frac{(n-1)S^2}{\sigma^2} \sim \chi^2_{n-1}" />
                </div>
              </div>
              <div className="flex-1 text-sm text-gray-700">
                <p className="flex items-start gap-2 mb-1">
                  <CheckCircle className="w-4 h-4 text-green-500 flex-shrink-0 mt-0.5" />
                  Exact for any n
                </p>
                <p className="flex items-start gap-2">
                  <CheckCircle className="w-4 h-4 text-green-500 flex-shrink-0 mt-0.5" />
                  <Latex math="\bar{X}" /> and <Latex math="S^2" /> independent!
                </p>
              </div>
              <div className="mt-auto pt-2 border-t text-xs text-green-600">
                Use: <Latex math="\chi^2" />-tests for variance
              </div>
            </div>
    
            {/* t-statistic */}
            <div className="bg-purple-50 rounded-lg p-4 flex flex-col">
              <h3 className="font-bold text-purple-800 mb-2">t-Statistic</h3>
              <div className="bg-white rounded-lg p-3 text-center mb-3">
                <p className="text-sm text-gray-600 mb-2">Using independence of <Latex math="\bar{X}" /> and <Latex math="S^2" />:</p>
                <div className="text-xl my-2">
                  <Latex math="T = \frac{\bar{X} - \mu}{S/\sqrt{n}} \sim t_{n-1}" />
                </div>
              </div>
              <div className="flex-1 text-sm text-gray-700">
                <p className="flex items-start gap-2 mb-1">
                  <CheckCircle className="w-4 h-4 text-purple-500 flex-shrink-0 mt-0.5" />
                  Exact for any n
                </p>
                <p className="flex items-start gap-2">
                  <CheckCircle className="w-4 h-4 text-purple-500 flex-shrink-0 mt-0.5" />
                  Doesn't require knowing <Latex math="\sigma" />
                </p>
              </div>
              <div className="mt-auto pt-2 border-t text-xs text-purple-600">
                Use: t-test when <Latex math="\sigma" /> unknown
              </div>
            </div>
          </div>
    
          {/* Key Properties */}
          <div className="flex-shrink-0 grid grid-cols-2 gap-4">
            <div className="bg-amber-50 border border-amber-200 rounded-lg p-3">
              <h4 className="font-semibold text-amber-800 mb-2">Why "Exact" Matters</h4>
              <ul className="text-sm text-gray-700 space-y-1">
                <li>• Valid for <strong>any</strong> sample size n</li>
                <li>• No "large n" approximation needed</li>
                <li>• Confidence intervals have exactly stated coverage</li>
                <li>• p-values are exactly calibrated</li>
              </ul>
            </div>
    
            <div className="bg-gray-50 border border-gray-200 rounded-lg p-3">
              <h4 className="font-semibold text-gray-800 mb-2">The Catch: Assumptions Required</h4>
              <ul className="text-sm text-gray-700 space-y-1">
                <li>• Data must be <strong>exactly Normal</strong></li>
                <li>• <strong>IID</strong> (independent, identically distributed)</li>
                <li>• If assumptions violated, exactness is lost</li>
                <li>• For non-Normal data → use asymptotic results or bootstrap</li>
              </ul>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                      SLIDE 52: EXACT VS ASYMPTOTIC
// ═══════════════════════════════════════════════════════════════════════

function Slide52_ExactVsAsymptotic() {
  return (
    <div className="h-full flex flex-col p-4">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-2xl font-bold text-teal-800">Exact vs Asymptotic Sampling Distributions</h1>
            <p className="text-gray-600 text-sm">When to use which — and why it matters</p>
          </div>
    
          {/* Comparison Table */}
          <div className="flex-1 flex flex-col gap-3">
            <div className="bg-white rounded-lg border overflow-hidden flex-1">
              <table className="w-full h-full text-sm">
                <thead className="bg-gray-100">
                  <tr>
                    <th className="px-3 py-2 text-left text-gray-700 w-1/4">Situation</th>
                    <th className="px-3 py-2 text-left text-gray-700 w-1/3">Exact Distribution</th>
                    <th className="px-3 py-2 text-left text-gray-700 w-1/3">Asymptotic Approximation</th>
                  </tr>
                </thead>
                <tbody className="divide-y">
                  <tr className="hover:bg-gray-50">
                    <td className="px-3 py-2 font-medium">Normal data, <Latex math="\sigma" /> known</td>
                    <td className="px-3 py-2 text-blue-700"><Latex math="\bar{X} \sim N(\mu, \sigma^2/n)" /> → z-test</td>
                    <td className="px-3 py-2 text-gray-500">Not needed</td>
                  </tr>
                  <tr className="hover:bg-gray-50">
                    <td className="px-3 py-2 font-medium">Normal data, <Latex math="\sigma" /> unknown</td>
                    <td className="px-3 py-2 text-blue-700"><Latex math="t = (\bar{X}-\mu)/(S/\sqrt{n}) \sim t_{n-1}" /></td>
                    <td className="px-3 py-2 text-gray-600">For large n: <Latex math="t \approx z" /></td>
                  </tr>
                  <tr className="hover:bg-gray-50">
                    <td className="px-3 py-2 font-medium">Non-normal data, large n</td>
                    <td className="px-3 py-2 text-gray-500">Usually unavailable</td>
                    <td className="px-3 py-2 text-green-700">CLT: <Latex math="\bar{X} \approx N(\mu, \sigma^2/n)" /></td>
                  </tr>
                  <tr className="hover:bg-gray-50">
                    <td className="px-3 py-2 font-medium">MLEs generally</td>
                    <td className="px-3 py-2 text-gray-500">Rarely available</td>
                    <td className="px-3 py-2 text-green-700"><Latex math="\hat{\theta} \approx N(\theta, I(\theta)^{-1}/n)" /></td>
                  </tr>
                  <tr className="hover:bg-gray-50">
                    <td className="px-3 py-2 font-medium">Small n, non-normal</td>
                    <td className="px-3 py-2 text-amber-700">May need permutation/bootstrap</td>
                    <td className="px-3 py-2 text-red-600">Approximation may be poor!</td>
                  </tr>
                </tbody>
              </table>
            </div>
    
            {/* Convergence visualization */}
            <div className="bg-amber-50 border border-amber-200 rounded-lg p-3">
              <h3 className="font-semibold text-amber-800 mb-2 flex items-center gap-2">
                <AlertTriangle className="w-5 h-5" />
                t-Distribution Converges to Normal (Slowly!)
              </h3>
              <div className="grid grid-cols-4 gap-3">
                <div className="bg-white rounded p-2 text-center">
                  <p className="text-xs text-gray-500 mb-1">n = 5</p>
                  <p className="font-mono text-sm"><Latex math="t_4" /> crit: <span className="text-red-600 font-bold">2.78</span></p>
                  <p className="font-mono text-sm">z crit: 1.96</p>
                  <p className="text-xs text-red-600 mt-1">29% error!</p>
                </div>
                <div className="bg-white rounded p-2 text-center">
                  <p className="text-xs text-gray-500 mb-1">n = 15</p>
                  <p className="font-mono text-sm"><Latex math="t_{14}" /> crit: <span className="text-amber-600 font-bold">2.14</span></p>
                  <p className="font-mono text-sm">z crit: 1.96</p>
                  <p className="text-xs text-amber-600 mt-1">9% error</p>
                </div>
                <div className="bg-white rounded p-2 text-center">
                  <p className="text-xs text-gray-500 mb-1">n = 30</p>
                  <p className="font-mono text-sm"><Latex math="t_{29}" /> crit: <span className="text-green-600 font-bold">2.05</span></p>
                  <p className="font-mono text-sm">z crit: 1.96</p>
                  <p className="text-xs text-green-600 mt-1">4% error</p>
                </div>
                <div className="bg-white rounded p-2 text-center">
                  <p className="text-xs text-gray-500 mb-1">n = 100</p>
                  <p className="font-mono text-sm"><Latex math="t_{99}" /> crit: <span className="text-green-600 font-bold">1.98</span></p>
                  <p className="font-mono text-sm">z crit: 1.96</p>
                  <p className="text-xs text-green-600 mt-1">1% error</p>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom guidance */}
          <div className="flex-shrink-0 mt-3 grid grid-cols-2 gap-4">
            <div className="bg-green-50 border-l-4 border-green-500 p-3 rounded-r-lg">
              <h4 className="font-semibold text-green-800">Best Practice</h4>
              <p className="text-sm text-gray-700">Always use <strong>exact distributions</strong> when available. They're valid for any sample size.</p>
            </div>
            <div className="bg-red-50 border-l-4 border-red-500 p-3 rounded-r-lg">
              <h4 className="font-semibold text-red-800">Warning</h4>
              <p className="text-sm text-gray-700">Using Normal instead of t for small n gives CIs that are <strong>too narrow</strong> and p-values that are <strong>too small</strong>.</p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                         SLIDE 53: WHY TRANSFORM
// ═══════════════════════════════════════════════════════════════════════

function Slide53_WhyTransform() {
  return (
    <div className="h-full flex flex-col p-4">
          {/* Header */}
          <div className="flex-shrink-0 mb-2">
            <h1 className="text-2xl font-bold text-teal-800">Why Transform Parameters?</h1>
            <p className="text-gray-600 text-sm">Four reasons transformations arise in practice</p>
          </div>
    
          {/* Lead-in */}
          <div className="flex-shrink-0 mb-3 bg-gray-50 border-l-4 border-gray-400 p-3 rounded-r-lg">
            <p className="text-sm text-gray-700">
              We have sampling distributions for basic estimators like <Latex math="\bar{X}" /> and <Latex math="S^2" />. 
              But inference often requires <strong>functions</strong> of parameters — and we need their standard errors too.
            </p>
          </div>
    
          {/* Main content - 2x2 grid */}
          <div className="flex-1 grid grid-cols-2 gap-4 mb-3">
            {/* Interpretability */}
            <div className="bg-blue-50 rounded-lg p-4 flex flex-col">
              <div className="flex items-center gap-2 mb-2">
                <div className="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold">1</div>
                <h3 className="font-bold text-blue-800">Interpretability</h3>
              </div>
              <p className="text-sm text-gray-700 mb-3">Some quantities are more meaningful than raw parameters.</p>
              <div className="flex-1 space-y-2">
                <div className="bg-white rounded p-2">
                  <p className="text-sm"><strong>Odds ratio:</strong> <Latex math="\psi = \frac{p}{1-p}" /></p>
                  <p className="text-xs text-gray-500">More interpretable than probability in case-control studies</p>
                </div>
                <div className="bg-white rounded p-2">
                  <p className="text-sm"><strong>Hazard ratio:</strong> <Latex math="e^\beta" /></p>
                  <p className="text-xs text-gray-500">Exponential of Cox regression coefficient</p>
                </div>
              </div>
            </div>
    
            {/* Boundedness */}
            <div className="bg-green-50 rounded-lg p-4 flex flex-col">
              <div className="flex items-center gap-2 mb-2">
                <div className="w-8 h-8 bg-green-600 rounded-full flex items-center justify-center text-white font-bold">2</div>
                <h3 className="font-bold text-green-800">Boundedness</h3>
              </div>
              <p className="text-sm text-gray-700 mb-3">Transformations enable unconstrained inference.</p>
              <div className="flex-1 space-y-2">
                <div className="bg-white rounded p-2">
                  <p className="text-sm"><strong>Logit:</strong> <Latex math="\log\frac{p}{1-p}" /> maps <Latex math="(0,1) \to \mathbb{R}" /></p>
                  <p className="text-xs text-gray-500">CIs can't go outside [0,1] when back-transformed</p>
                </div>
                <div className="bg-white rounded p-2">
                  <p className="text-sm"><strong>Log:</strong> <Latex math="\log(\sigma^2)" /> maps <Latex math="(0,\infty) \to \mathbb{R}" /></p>
                  <p className="text-xs text-gray-500">Variances are always positive</p>
                </div>
              </div>
            </div>
    
            {/* Variance Stabilization */}
            <div className="bg-purple-50 rounded-lg p-4 flex flex-col">
              <div className="flex items-center gap-2 mb-2">
                <div className="w-8 h-8 bg-purple-600 rounded-full flex items-center justify-center text-white font-bold">3</div>
                <h3 className="font-bold text-purple-800">Variance Stabilization</h3>
              </div>
              <p className="text-sm text-gray-700 mb-3">Make variance constant across parameter values.</p>
              <div className="flex-1 space-y-2">
                <div className="bg-white rounded p-2">
                  <p className="text-sm"><strong>Poisson:</strong> <Latex math="\sqrt{X}" /> has <Latex math="\text{Var} \approx 1/4" /></p>
                  <p className="text-xs text-gray-500">Raw: <Latex math="\text{Var}(X) = \lambda" /> depends on mean</p>
                </div>
                <div className="bg-white rounded p-2">
                  <p className="text-sm"><strong>Proportions:</strong> <Latex math="\arcsin\sqrt{p}" /></p>
                  <p className="text-xs text-gray-500">Stabilizes <Latex math="\text{Var}(\hat{p}) = p(1-p)/n" /></p>
                </div>
              </div>
            </div>
    
            {/* Scientific Parameters */}
            <div className="bg-amber-50 rounded-lg p-4 flex flex-col">
              <div className="flex items-center gap-2 mb-2">
                <div className="w-8 h-8 bg-amber-600 rounded-full flex items-center justify-center text-white font-bold">4</div>
                <h3 className="font-bold text-amber-800">Scientific Parameters</h3>
              </div>
              <p className="text-sm text-gray-700 mb-3">Physical quantities are nonlinear functions.</p>
              <div className="flex-1 space-y-2">
                <div className="bg-white rounded p-2">
                  <p className="text-sm"><strong>Vaccine efficacy:</strong> <Latex math="\text{VE} = 1 - \frac{p_v}{p_p}" /></p>
                  <p className="text-xs text-gray-500">Ratio of two estimated proportions</p>
                </div>
                <div className="bg-white rounded p-2">
                  <p className="text-sm"><strong>Half-life:</strong> <Latex math="t_{1/2} = \ln(2)/\hat{\lambda}" /></p>
                  <p className="text-xs text-gray-500">Reciprocal of estimated decay rate</p>
                </div>
              </div>
            </div>
          </div>
    
          {/* Homework callback */}
          <div className="flex-shrink-0 mb-3 bg-amber-50 border-l-4 border-amber-500 p-3 rounded-r-lg">
            <p className="text-sm text-amber-900">
              <strong>Remember HW2?</strong> For the normalizing constant <Latex math="k = 1/(2\hat{I})" />, I gave you <Latex math="\text{SE}(\hat{k}) = \text{SE}(\hat{I})/(2\hat{I}^2)" />.
              <span className="italic"> Now we derive it!</span>
            </p>
          </div>
    
          {/* Bottom - The Question */}
          <div className="flex-shrink-0 bg-teal-100 border-2 border-teal-400 rounded-lg p-4">
            <div className="flex items-center justify-between">
              <div className="flex items-center gap-3">
                <Lightbulb className="w-8 h-8 text-teal-600" />
                <div>
                  <p className="font-semibold text-teal-800">The Key Question</p>
                  <p className="text-gray-700">Given <Latex math="\text{SE}(\hat{\theta})" />, what is <Latex math="\text{SE}(g(\hat{\theta}))" />?</p>
                </div>
              </div>
              <ArrowRight className="w-8 h-8 text-teal-600" />
              <div className="text-right">
                <p className="font-bold text-teal-800 text-lg">The Delta Method</p>
                <p className="text-sm text-teal-600">Next slide</p>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                       SLIDE 54: DELTA METHOD CORE
// ═══════════════════════════════════════════════════════════════════════

function Slide54_DeltaMethodCore() {
  return (
    <div className="h-full flex flex-col p-4">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-2xl font-bold text-teal-800">The Delta Method</h1>
            <p className="text-gray-600 text-sm">Propagating uncertainty through nonlinear transformations</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Left: Theorem */}
            <div className="flex flex-col gap-3">
              {/* Theorem statement */}
              <div className="bg-teal-50 border-2 border-teal-400 rounded-lg p-4 flex-1">
                <h3 className="font-bold text-teal-800 mb-3">Theorem (Univariate Delta Method)</h3>
                
                <div className="bg-white rounded-lg p-3 mb-3">
                  <p className="text-sm text-gray-600 mb-2">If <Latex math="\sqrt{n}(T_n - \theta) \xrightarrow{d} \mathcal{N}(0, \sigma^2)" /> and <Latex math="g'(\theta) \neq 0" />, then:</p>
                  <div className="text-center text-xl my-3">
                    <Latex math="\sqrt{n}(g(T_n) - g(\theta)) \xrightarrow{d} \mathcal{N}(0, [g'(\theta)]^2 \sigma^2)" />
                  </div>
                </div>
    
                <div className="bg-teal-100 rounded-lg p-3">
                  <p className="font-semibold text-teal-800 mb-2">Practical Form</p>
                  <div className="text-center text-lg">
                    <Latex math="\text{Var}(g(\hat{\theta})) \approx [g'(\theta)]^2 \cdot \text{Var}(\hat{\theta})" />
                  </div>
                  <p className="text-sm text-gray-600 mt-2 text-center">
                    Standard error: <Latex math="\text{SE}(g(\hat{\theta})) = |g'(\hat{\theta})| \cdot \text{SE}(\hat{\theta})" />
                  </p>
                </div>
              </div>
    
              {/* Proof sketch */}
              <div className="bg-gray-50 rounded-lg p-3">
                <h4 className="font-semibold text-gray-700 mb-2">Proof Sketch</h4>
                <div className="text-sm space-y-1">
                  <p>1. Taylor expand: <Latex math="g(T_n) \approx g(\theta) + g'(\theta)(T_n - \theta)" /></p>
                  <p>2. Rearrange: <Latex math="\sqrt{n}(g(T_n) - g(\theta)) \approx g'(\theta) \cdot \sqrt{n}(T_n - \theta)" /></p>
                  <p>3. By Slutsky: RHS <Latex math="\xrightarrow{d} g'(\theta) \cdot \mathcal{N}(0, \sigma^2)" /></p>
                </div>
                <div className="mt-2 p-2 bg-white rounded border border-gray-200 text-xs">
                  <p className="font-semibold text-gray-600">Slutsky's Theorem:</p>
                  <p className="text-gray-600">If <Latex math="X_n \xrightarrow{d} X" /> and <Latex math="Y_n \xrightarrow{p} c" />, then <Latex math="X_n Y_n \xrightarrow{d} cX" /></p>
                </div>
              </div>
            </div>
    
            {/* Right: Geometric interpretation + Figure */}
            <div className="flex flex-col gap-3">
              {/* Figure */}
              <div className="flex-1 bg-white rounded-lg border overflow-hidden">
                <img 
                  src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/PartII/Chapter3/ch3_3_fig01_delta_method_geometry.png"
                  alt="Delta method linearization showing input distribution, tangent approximation, and output distribution"
                  className="w-full h-full object-contain"
                />
              </div>
    
              {/* Key insight box */}
              <div className="bg-purple-100 border-2 border-purple-400 rounded-lg p-3">
                <div className="flex items-start gap-3">
                  <Zap className="w-6 h-6 text-purple-600 flex-shrink-0" />
                  <div>
                    <h4 className="font-bold text-purple-800">Geometric Intuition</h4>
                    <p className="text-sm text-gray-700 mt-1">
                      If <Latex math="g'(\theta) = 2" />, small changes in <Latex math="\hat{\theta}" /> produce changes <strong>twice as large</strong> in <Latex math="g(\hat{\theta})" />.
                    </p>
                    <p className="text-sm text-gray-700 mt-1">
                      So SD doubles, <strong>variance quadruples</strong> (factor of 4 = 2 squared).
                    </p>
                    <p className="text-sm text-purple-700 mt-2 font-semibold">
                      Near <Latex math="\theta" />, the function g behaves like its tangent line with slope <Latex math="g'(\theta)" />.
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom - The Key Formula */}
          <div className="flex-shrink-0 mt-3 bg-teal-800 text-white rounded-lg p-4">
            <div className="flex items-center justify-center gap-6">
              <span className="text-lg font-semibold">The Key Formula:</span>
              <div className="bg-white/20 rounded-lg px-6 py-2">
                <span className="text-xl"><Latex math="\boxed{\text{Var}(g(\hat{\theta})) \approx [g'(\theta)]^2 \cdot \text{Var}(\hat{\theta})}" /></span>
              </div>
              <span className="text-teal-200">Variance scales as (derivative) squared</span>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                    SLIDE 55: VARIANCE AMPLIFICATION
// ═══════════════════════════════════════════════════════════════════════

function Slide55_VarianceAmplification() {
  return (
    <div className="h-full flex flex-col p-4">
          {/* Header */}
          <div className="flex-shrink-0 mb-2">
            <h1 className="text-2xl font-bold text-teal-800">Variance Amplification: Common Transformations</h1>
            <p className="text-gray-600 text-sm">How variance scales with different <Latex math="g'(\theta)" /> values</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-3">
            {/* Left: Table */}
            <div className="bg-white rounded-lg border overflow-hidden flex flex-col">
              <div className="bg-gray-100 px-3 py-2 border-b">
                <h3 className="font-semibold text-gray-800">Delta Method for Common Transformations</h3>
              </div>
              <div className="flex-1 overflow-auto">
                <table className="w-full text-sm">
                  <thead className="bg-gray-50 sticky top-0">
                    <tr>
                      <th className="px-2 py-1.5 text-left">Transform</th>
                      <th className="px-2 py-1.5 text-left"><Latex math="g(\theta)" /></th>
                      <th className="px-2 py-1.5 text-left"><Latex math="g'(\theta)" /></th>
                      <th className="px-2 py-1.5 text-left"><Latex math="\text{Var}(g(\hat{\theta}))" /></th>
                    </tr>
                  </thead>
                  <tbody className="divide-y">
                    <tr className="hover:bg-blue-50">
                      <td className="px-2 py-1.5 font-medium">Log</td>
                      <td className="px-2 py-1.5"><Latex math="\log(\theta)" /></td>
                      <td className="px-2 py-1.5"><Latex math="1/\theta" /></td>
                      <td className="px-2 py-1.5"><Latex math="\text{Var}/\theta^2" /></td>
                    </tr>
                    <tr className="hover:bg-green-50">
                      <td className="px-2 py-1.5 font-medium">Exp</td>
                      <td className="px-2 py-1.5"><Latex math="e^\theta" /></td>
                      <td className="px-2 py-1.5"><Latex math="e^\theta" /></td>
                      <td className="px-2 py-1.5"><Latex math="e^{2\theta} \cdot \text{Var}" /></td>
                    </tr>
                    <tr className="hover:bg-purple-50">
                      <td className="px-2 py-1.5 font-medium">Sqrt</td>
                      <td className="px-2 py-1.5"><Latex math="\sqrt{\theta}" /></td>
                      <td className="px-2 py-1.5"><Latex math="\frac{1}{2\sqrt{\theta}}" /></td>
                      <td className="px-2 py-1.5"><Latex math="\text{Var}/(4\theta)" /></td>
                    </tr>
                    <tr className="hover:bg-amber-50">
                      <td className="px-2 py-1.5 font-medium">Square</td>
                      <td className="px-2 py-1.5"><Latex math="\theta^2" /></td>
                      <td className="px-2 py-1.5"><Latex math="2\theta" /></td>
                      <td className="px-2 py-1.5"><Latex math="4\theta^2 \cdot \text{Var}" /></td>
                    </tr>
                    <tr className="hover:bg-red-50">
                      <td className="px-2 py-1.5 font-medium">Reciprocal</td>
                      <td className="px-2 py-1.5"><Latex math="1/\theta" /></td>
                      <td className="px-2 py-1.5"><Latex math="-1/\theta^2" /></td>
                      <td className="px-2 py-1.5"><Latex math="\text{Var}/\theta^4" /></td>
                    </tr>
                    <tr className="hover:bg-teal-50">
                      <td className="px-2 py-1.5 font-medium">Logit</td>
                      <td className="px-2 py-1.5"><Latex math="\log\frac{\theta}{1-\theta}" /></td>
                      <td className="px-2 py-1.5"><Latex math="\frac{1}{\theta(1-\theta)}" /></td>
                      <td className="px-2 py-1.5"><Latex math="\frac{\text{Var}}{\theta^2(1-\theta)^2}" /></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
    
            {/* Right: Figure */}
            <div className="flex flex-col gap-3">
              <div className="bg-white rounded-lg border overflow-hidden" style={{maxHeight: '55%'}}>
                <img 
                  src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/PartII/Chapter3/ch3_3_fig02_variance_amplification.png"
                  alt="Variance scaling by square of derivative for different transformations"
                  className="w-full h-full object-contain"
                />
              </div>
    
              {/* Key observations */}
              <div className="flex-1 bg-gray-50 rounded-lg p-3">
                <h4 className="font-semibold text-gray-700 mb-2">Key Observations</h4>
                <div className="grid grid-cols-2 gap-2 text-sm">
                  <div className="bg-green-100 rounded p-2">
                    <p className="font-semibold text-green-800"><Latex math="|g'| < 1" /></p>
                    <p className="text-gray-600">Variance shrinks</p>
                    <p className="text-xs text-gray-500">e.g., sqrt, log (large <Latex math="\theta" />)</p>
                  </div>
                  <div className="bg-red-100 rounded p-2">
                    <p className="font-semibold text-red-800"><Latex math="|g'| > 1" /></p>
                    <p className="text-gray-600">Variance amplifies</p>
                    <p className="text-xs text-gray-500">e.g., exp, square</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom insight */}
          <div className="flex-shrink-0 mt-2 bg-teal-50 border border-teal-200 rounded-lg p-3">
            <div className="flex items-center justify-between">
              <div>
                <span className="font-semibold text-teal-800">Practical insight:</span>
                <span className="text-gray-700 ml-2">Log transformation often <strong>reduces</strong> uncertainty for positive quantities (<Latex math="g' = 1/\theta" /> shrinks at large <Latex math="\theta" />).</span>
              </div>
              <div className="bg-teal-100 px-3 py-1 rounded text-sm">
                <Latex math="\text{SE}(\log\hat{\theta}) = \text{SE}(\hat{\theta})/\hat{\theta}" />
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                      SLIDE 56: MULTIVARIATE DELTA
// ═══════════════════════════════════════════════════════════════════════

function Slide56_MultivariateDelta() {
  return (
    <div className="h-full flex flex-col p-4">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-2xl font-bold text-teal-800">The Multivariate Delta Method</h1>
            <p className="text-gray-600 text-sm">Functions of multiple parameters with correlated estimates</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Left: Theory */}
            <div className="flex flex-col gap-3">
              {/* Theorem */}
              <div className="bg-teal-50 border-2 border-teal-400 rounded-lg p-4">
                <h3 className="font-bold text-teal-800 mb-3">Theorem (Multivariate Delta Method)</h3>
                
                <div className="bg-white rounded-lg p-3 mb-3 text-sm">
                  <p className="text-gray-600 mb-2">
                    If <Latex math="\sqrt{n}(\hat{\boldsymbol{\theta}} - \boldsymbol{\theta}) \xrightarrow{d} \mathcal{N}(\mathbf{0}, \boldsymbol{\Sigma})" /> and <Latex math="g: \mathbb{R}^p \to \mathbb{R}" /> is differentiable, then:
                  </p>
                  <div className="text-center text-lg my-3">
                    <Latex math="\sqrt{n}(g(\hat{\boldsymbol{\theta}}) - g(\boldsymbol{\theta})) \xrightarrow{d} \mathcal{N}(0, (\nabla g)^\top \boldsymbol{\Sigma} (\nabla g))" />
                  </div>
                </div>
    
                <div className="bg-teal-100 rounded-lg p-3">
                  <p className="font-semibold text-teal-800 mb-2">Practical Form</p>
                  <div className="text-center text-lg">
                    <Latex math="\text{Var}(g(\hat{\boldsymbol{\theta}})) \approx (\nabla g)^\top \boldsymbol{\Sigma} (\nabla g)" />
                  </div>
                </div>
              </div>
    
              {/* Gradient definition */}
              <div className="bg-gray-50 rounded-lg p-3">
                <h4 className="font-semibold text-gray-700 mb-2">The Gradient Vector</h4>
                <div className="bg-white rounded p-2 text-center">
                  <Latex math="\nabla g = \begin{pmatrix} \partial g / \partial \theta_1 \\ \partial g / \partial \theta_2 \\ \vdots \\ \partial g / \partial \theta_p \end{pmatrix}" />
                </div>
                <p className="text-sm text-gray-600 mt-2">Evaluated at <Latex math="\hat{\boldsymbol{\theta}}" /> in practice.</p>
              </div>
    
              {/* Expanded formula */}
              <div className="bg-amber-50 rounded-lg p-3 flex-1">
                <h4 className="font-semibold text-amber-800 mb-2">Expanded (2 parameters)</h4>
                <div className="text-sm">
                  <Latex math="\text{Var}(g(\hat{\theta}_1, \hat{\theta}_2)) \approx" />
                </div>
                <div className="bg-white rounded p-2 mt-1 text-sm text-center">
                  <Latex math="\left(\frac{\partial g}{\partial \theta_1}\right)^2 \text{Var}(\hat{\theta}_1) + \left(\frac{\partial g}{\partial \theta_2}\right)^2 \text{Var}(\hat{\theta}_2) + 2 \frac{\partial g}{\partial \theta_1} \frac{\partial g}{\partial \theta_2} \text{Cov}(\hat{\theta}_1, \hat{\theta}_2)" />
                </div>
                <p className="text-xs text-amber-700 mt-2">⚠️ The covariance term can increase OR decrease variance!</p>
              </div>
            </div>
    
            {/* Right: Figure and example */}
            <div className="flex flex-col gap-3">
              {/* Figure */}
              <div className="flex-1 bg-white rounded-lg border overflow-hidden">
                <img 
                  src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/PartII/Chapter3/ch3_3_fig04_multivariate_delta.png"
                  alt="Multivariate delta method showing joint distribution, gradient, and resulting univariate distribution"
                  className="w-full h-full object-contain"
                />
              </div>
    
              {/* Comparison: univariate vs multivariate */}
              <div className="bg-white border rounded-lg p-3">
                <h4 className="font-semibold text-gray-700 mb-2">Univariate → Multivariate</h4>
                <div className="grid grid-cols-3 gap-2 text-sm text-center">
                  <div className="bg-blue-50 rounded p-2">
                    <p className="text-gray-500 text-xs">Univariate</p>
                    <p className="font-mono"><Latex math="g'(\theta)" /></p>
                  </div>
                  <div className="flex items-center justify-center">
                    <ArrowRight className="w-5 h-5 text-gray-400" />
                  </div>
                  <div className="bg-green-50 rounded p-2">
                    <p className="text-gray-500 text-xs">Multivariate</p>
                    <p className="font-mono"><Latex math="\nabla g" /></p>
                  </div>
                  <div className="bg-blue-50 rounded p-2">
                    <p className="font-mono"><Latex math="\sigma^2" /></p>
                  </div>
                  <div className="flex items-center justify-center">
                    <ArrowRight className="w-5 h-5 text-gray-400" />
                  </div>
                  <div className="bg-green-50 rounded p-2">
                    <p className="font-mono"><Latex math="\boldsymbol{\Sigma}" /></p>
                  </div>
                  <div className="bg-blue-50 rounded p-2">
                    <p className="font-mono"><Latex math="[g']^2 \sigma^2" /></p>
                  </div>
                  <div className="flex items-center justify-center">
                    <ArrowRight className="w-5 h-5 text-gray-400" />
                  </div>
                  <div className="bg-green-50 rounded p-2">
                    <p className="font-mono"><Latex math="(\nabla g)^\top \boldsymbol{\Sigma} (\nabla g)" /></p>
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom */}
          <div className="flex-shrink-0 mt-2 bg-purple-50 border border-purple-200 rounded-lg p-3">
            <p className="text-center text-gray-700">
              <strong>Key insight:</strong> The <span className="text-purple-700 font-semibold">covariance</span> between parameters affects the variance of transformations. 
              <span className="ml-2">Positive correlation can either <span className="text-green-600">help</span> (ratios) or <span className="text-red-600">hurt</span> (products).</span>
            </p>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                       SLIDE 57: VACCINE EFFICACY
// ═══════════════════════════════════════════════════════════════════════

function Slide57_VaccineEfficacy() {
  return (
    <div className="h-full flex flex-col p-4">
          {/* Header */}
          <div className="flex-shrink-0 mb-2">
            <div className="flex items-center gap-2">
              <Syringe className="w-6 h-6 text-teal-600" />
              <h1 className="text-2xl font-bold text-teal-800">Example: Vaccine Efficacy</h1>
            </div>
            <p className="text-gray-600 text-sm">Applying the multivariate delta method to a real-world problem</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-3">
            {/* Left: Setup and calculation */}
            <div className="flex flex-col gap-2">
              {/* Data */}
              <div className="bg-blue-50 rounded-lg p-3">
                <h3 className="font-semibold text-blue-800 mb-2">Trial Data</h3>
                <div className="grid grid-cols-2 gap-2 text-sm">
                  <div className="bg-white rounded p-2">
                    <p className="font-semibold text-blue-700">Vaccinated</p>
                    <p><Latex math="n_v = 20{,}000" />, <Latex math="x_v = 8" /></p>
                    <p><Latex math="\hat{p}_v = 0.0004" /></p>
                  </div>
                  <div className="bg-white rounded p-2">
                    <p className="font-semibold text-blue-700">Placebo</p>
                    <p><Latex math="n_p = 20{,}000" />, <Latex math="x_p = 162" /></p>
                    <p><Latex math="\hat{p}_p = 0.0081" /></p>
                  </div>
                </div>
              </div>
    
              {/* VE Definition */}
              <div className="bg-teal-50 rounded-lg p-3">
                <h3 className="font-semibold text-teal-800 mb-2">Vaccine Efficacy</h3>
                <div className="bg-white rounded p-2 text-center mb-2">
                  <Latex math="\text{VE} = 1 - \frac{p_v}{p_p} = 1 - \text{RR}" />
                </div>
                <p className="text-sm text-gray-600">Relative risk reduction: 1 minus the risk ratio</p>
              </div>
    
              {/* Gradient */}
              <div className="bg-gray-50 rounded-lg p-3">
                <h3 className="font-semibold text-gray-700 mb-2">Step 1: Compute Gradient</h3>
                <div className="bg-white rounded p-2 text-sm">
                  <Latex math="\nabla \text{VE} = \begin{pmatrix} \partial \text{VE}/\partial p_v \\ \partial \text{VE}/\partial p_p \end{pmatrix} = \begin{pmatrix} -1/p_p \\ p_v/p_p^2 \end{pmatrix}" />
                </div>
              </div>
    
              {/* Covariance */}
              <div className="bg-gray-50 rounded-lg p-3">
                <h3 className="font-semibold text-gray-700 mb-2">Step 2: Covariance Matrix</h3>
                <p className="text-xs text-gray-600 mb-1">Independent samples → diagonal covariance</p>
                <div className="bg-white rounded p-2 text-sm">
                  <Latex math="\boldsymbol{\Sigma} = \begin{pmatrix} \hat{p}_v(1-\hat{p}_v)/n_v & 0 \\ 0 & \hat{p}_p(1-\hat{p}_p)/n_p \end{pmatrix}" />
                </div>
              </div>
    
              {/* Result */}
              <div className="bg-green-50 border-2 border-green-400 rounded-lg p-3 flex-1">
                <h3 className="font-semibold text-green-800 mb-2">Step 3: Apply Delta Method</h3>
                <div className="space-y-1 text-sm">
                  <p><Latex math="\widehat{\text{VE}} = 1 - 0.0004/0.0081 = \mathbf{0.951}" /></p>
                  <p><Latex math="\text{Var}(\widehat{\text{VE}}) = (\nabla g)^\top \boldsymbol{\Sigma} (\nabla g)" /></p>
                  <p><Latex math="\text{SE}(\widehat{\text{VE}}) = \mathbf{0.0175}" /></p>
                </div>
                <div className="mt-2 p-2 bg-green-100 rounded">
                  <p className="font-semibold text-green-800">95% CI: (0.916, 0.985)</p>
                  <p className="text-xs text-gray-600">i.e., (91.6%, 98.5%)</p>
                </div>
              </div>
            </div>
    
            {/* Right: Figure and interpretation */}
            <div className="flex flex-col gap-2">
              {/* Figure */}
              <div className="flex-1 bg-white rounded-lg border overflow-hidden">
                <img 
                  src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/PartII/Chapter3/ch3_3_fig10_vaccine_efficacy.png"
                  alt="Complete vaccine efficacy analysis showing joint distribution and CI comparison"
                  className="w-full h-full object-contain"
                />
              </div>
    
              {/* Interpretation */}
              <div className="bg-amber-50 rounded-lg p-3">
                <h3 className="font-semibold text-amber-800 mb-2">Interpretation</h3>
                <div className="space-y-2 text-sm">
                  <div className="flex items-start gap-2">
                    <CheckCircle className="w-4 h-4 text-green-600 flex-shrink-0 mt-0.5" />
                    <p>Vaccine reduces infection risk by ~95%</p>
                  </div>
                  <div className="flex items-start gap-2">
                    <CheckCircle className="w-4 h-4 text-green-600 flex-shrink-0 mt-0.5" />
                    <p>95% CI excludes values below 91.6%</p>
                  </div>
                  <div className="flex items-start gap-2">
                    <CheckCircle className="w-4 h-4 text-green-600 flex-shrink-0 mt-0.5" />
                    <p>Strong evidence of high efficacy</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom */}
          <div className="flex-shrink-0 mt-2 bg-purple-50 border border-purple-200 rounded-lg p-2">
            <p className="text-center text-sm text-gray-700">
              <strong>This is "error propagation"</strong> from physics labs — the delta method applied to measurement uncertainty!
            </p>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                     SLIDE 58: DELTA METHOD FAILURE
// ═══════════════════════════════════════════════════════════════════════

function Slide58_DeltaMethodFailure() {
  return (
    <div className="h-full flex flex-col p-4">
          {/* Header */}
          <div className="flex-shrink-0 mb-2">
            <div className="flex items-center gap-2">
              <AlertTriangle className="w-6 h-6 text-red-600" />
              <h1 className="text-2xl font-bold text-red-800">When the Delta Method Breaks Down</h1>
            </div>
            <p className="text-gray-600 text-sm">Four failure modes to watch for</p>
          </div>
    
          {/* Main content - Figure + explanations */}
          <div className="flex-1 grid grid-cols-2 gap-3">
            {/* Left: Figure */}
            <div className="bg-white rounded-lg border overflow-hidden">
              <img 
                src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/PartII/Chapter3/ch3_3_fig08_delta_method_breakdown.png"
                alt="Four cases where delta method fails: small samples, high curvature, boundary, zero derivative"
                className="w-full h-full object-contain"
              />
            </div>
    
            {/* Right: Four failure modes */}
            <div className="flex flex-col gap-2">
              {/* Small samples */}
              <div className="bg-red-50 rounded-lg p-3 flex-1">
                <div className="flex items-start gap-2">
                  <div className="w-6 h-6 bg-red-600 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0">1</div>
                  <div>
                    <h3 className="font-semibold text-red-800">Small Samples</h3>
                    <p className="text-sm text-gray-700 mt-1">
                      Asymptotic normality of <Latex math="\hat{\theta}" /> doesn't hold. Example: exponential MLE with n=5 is highly skewed.
                    </p>
                    <p className="text-xs text-red-600 mt-1">Rule: n should be "large enough" for CLT</p>
                  </div>
                </div>
              </div>
    
              {/* High curvature */}
              <div className="bg-amber-50 rounded-lg p-3 flex-1">
                <div className="flex items-start gap-2">
                  <div className="w-6 h-6 bg-amber-600 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0">2</div>
                  <div>
                    <h3 className="font-semibold text-amber-800">High Curvature</h3>
                    <p className="text-sm text-gray-700 mt-1">
                      Large <Latex math="|g''(\theta)|" /> makes linear approximation poor. Example: <Latex math="g(\theta) = \theta^3" /> curves sharply.
                    </p>
                    <p className="text-xs text-amber-600 mt-1">Check: Is <Latex math="|g''| \cdot \text{Var}(\hat{\theta})" /> small?</p>
                  </div>
                </div>
              </div>
    
              {/* Boundary */}
              <div className="bg-purple-50 rounded-lg p-3 flex-1">
                <div className="flex items-start gap-2">
                  <div className="w-6 h-6 bg-purple-600 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0">3</div>
                  <div>
                    <h3 className="font-semibold text-purple-800">Boundary Parameters</h3>
                    <p className="text-sm text-gray-700 mt-1">
                      When <Latex math="\hat{\theta}" /> is near boundary, distribution is truncated. Example: <Latex math="\log(\hat{p})" /> when <Latex math="\hat{p} \approx 0" />.
                    </p>
                    <p className="text-xs text-purple-600 mt-1">13% of samples give <Latex math="\hat{p} = 0" /> when p = 0.02, n = 20</p>
                  </div>
                </div>
              </div>
    
              {/* Zero derivative */}
              <div className="bg-blue-50 rounded-lg p-3 flex-1">
                <div className="flex items-start gap-2">
                  <div className="w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0">4</div>
                  <div>
                    <h3 className="font-semibold text-blue-800">Zero Derivative</h3>
                    <p className="text-sm text-gray-700 mt-1">
                      When <Latex math="g'(\theta_0) = 0" />, delta method predicts Var = 0. Example: <Latex math="g(\theta) = \theta^2" /> at <Latex math="\theta_0 = 0" />.
                    </p>
                    <p className="text-xs text-blue-600 mt-1">Actual distribution is <Latex math="\sigma^2 \chi^2_1" />, not normal!</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom - Alternatives */}
          <div className="flex-shrink-0 mt-2 bg-green-50 border-2 border-green-400 rounded-lg p-3">
            <h3 className="font-semibold text-green-800 mb-2">What to Use Instead</h3>
            <div className="grid grid-cols-4 gap-3 text-sm">
              <div className="bg-white rounded p-2 text-center">
                <p className="font-semibold text-green-700">Bootstrap</p>
                <p className="text-xs text-gray-600">Chapter 4</p>
              </div>
              <div className="bg-white rounded p-2 text-center">
                <p className="font-semibold text-green-700">Profile Likelihood</p>
                <p className="text-xs text-gray-600">Section 3.2</p>
              </div>
              <div className="bg-white rounded p-2 text-center">
                <p className="font-semibold text-green-700">Simulation</p>
                <p className="text-xs text-gray-600">Monte Carlo</p>
              </div>
              <div className="bg-white rounded p-2 text-center">
                <p className="font-semibold text-green-700">Fieller's Method</p>
                <p className="text-xs text-gray-600">For ratios</p>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                      SLIDE 59: FISHER INFORMATION
// ═══════════════════════════════════════════════════════════════════════

function Slide59_FisherInformation() {
  return (
    <div className="h-full flex flex-col p-4">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-2xl font-bold text-teal-800">Variance Estimation: Fisher Information</h1>
            <p className="text-gray-600 text-sm">Expected (theoretical) curvature of the log-likelihood</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Left: Definition and formula */}
            <div className="flex flex-col gap-3">
              {/* Definition */}
              <div className="bg-teal-50 border-l-4 border-teal-500 p-4 rounded-r-lg">
                <h3 className="font-bold text-teal-800 mb-2">Fisher Information (Review)</h3>
                <div className="bg-white rounded-lg p-3 mb-2">
                  <div className="text-center">
                    <Latex math="I(\theta) = -\mathbb{E}\left[\frac{\partial^2 \ell}{\partial \theta^2}\right] = \text{Var}\left[\frac{\partial \ell}{\partial \theta}\right]" />
                  </div>
                </div>
                <p className="text-sm text-gray-700">
                  Expected negative curvature = Variance of the score
                </p>
              </div>
    
              {/* Variance formula */}
              <div className="bg-blue-50 rounded-lg p-4 flex-1">
                <h3 className="font-semibold text-blue-800 mb-2">Variance Estimate</h3>
                <div className="bg-white rounded-lg p-3 mb-3">
                  <p className="text-sm text-gray-600 mb-2">For MLE <Latex math="\hat{\theta}" /> from n observations:</p>
                  <div className="text-center text-lg">
                    <Latex math="\widehat{\text{Var}}(\hat{\theta}) = \frac{1}{n \, I_1(\hat{\theta})}" />
                  </div>
                </div>
                <p className="text-sm text-gray-700 mb-2">
                  where <Latex math="I_1(\theta)" /> is per-observation Fisher information.
                </p>
                <div className="bg-blue-100 rounded p-2 text-sm">
                  <strong>Plug-in:</strong> Evaluate <Latex math="I_1" /> at <Latex math="\hat{\theta}" /> (unknown true θ).
                </div>
              </div>
    
              {/* Interpretation */}
              <div className="bg-gray-50 rounded-lg p-3">
                <h4 className="font-semibold text-gray-700 mb-2">Interpretation</h4>
                <div className="space-y-1 text-sm text-gray-700">
                  <p>• More curvature → more information → smaller variance</p>
                  <p>• Variance decreases as 1/n (precision improves with √n)</p>
                  <p>• Based on expected behavior under the model</p>
                </div>
              </div>
            </div>
    
            {/* Right: Examples and pros/cons */}
            <div className="flex flex-col gap-3">
              {/* Example: Normal */}
              <div className="bg-white border rounded-lg p-4">
                <h3 className="font-semibold text-gray-800 mb-2">Example: Normal Mean</h3>
                <div className="text-sm space-y-1">
                  <p><Latex math="X_i \sim N(\mu, \sigma^2)" /> with <Latex math="\sigma^2" /> known</p>
                  <p className="mt-2"><Latex math="\ell(\mu) = -\frac{1}{2\sigma^2}\sum(x_i - \mu)^2 + \text{const}" /></p>
                  <p><Latex math="\frac{\partial^2 \ell}{\partial \mu^2} = -\frac{n}{\sigma^2}" /></p>
                  <p><Latex math="I_n(\mu) = \frac{n}{\sigma^2}" /></p>
                  <p className="bg-green-100 rounded p-2 mt-2"><Latex math="\text{Var}(\hat{\mu}) = \frac{\sigma^2}{n}" /> ✓</p>
                </div>
              </div>
    
              {/* Pros and cons */}
              <div className="grid grid-cols-2 gap-2 flex-1">
                <div className="bg-green-50 rounded-lg p-3">
                  <h4 className="font-semibold text-green-800 mb-2 flex items-center gap-1">
                    <CheckCircle className="w-4 h-4" />
                    Advantages
                  </h4>
                  <ul className="text-sm text-gray-700 space-y-1">
                    <li>• Theoretically motivated</li>
                    <li>• Often closed-form</li>
                    <li>• Works well for exp families</li>
                    <li>• Less variable than observed</li>
                  </ul>
                </div>
    
                <div className="bg-red-50 rounded-lg p-3">
                  <h4 className="font-semibold text-red-800 mb-2 flex items-center gap-1">
                    <XCircle className="w-4 h-4" />
                    Disadvantages
                  </h4>
                  <ul className="text-sm text-gray-700 space-y-1">
                    <li>• Assumes correct model</li>
                    <li>• May need expectation calc</li>
                    <li>• Can miss sample-specific info</li>
                    <li>• Wrong if model misspecified</li>
                  </ul>
                </div>
              </div>
    
              {/* When to use */}
              <div className="bg-amber-50 border border-amber-200 rounded-lg p-3">
                <h4 className="font-semibold text-amber-800 mb-1">When to Use</h4>
                <p className="text-sm text-gray-700">
                  Best for <strong>exponential families</strong> where Fisher information has a clean closed form and you trust the model specification.
                </p>
              </div>
            </div>
          </div>
    
          {/* Bottom */}
          <div className="flex-shrink-0 mt-3 bg-teal-100 rounded-lg p-3">
            <p className="text-center text-teal-800">
              <strong>Key assumption:</strong> The model <Latex math="f(x|\theta)" /> is correctly specified. If not, Fisher information can be misleading.
            </p>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                     SLIDE 60: OBSERVED INFORMATION
// ═══════════════════════════════════════════════════════════════════════

function Slide60_ObservedInformation() {
  return (
    <div className="h-full flex flex-col p-4">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <div className="flex items-center gap-2">
              <Eye className="w-6 h-6 text-teal-600" />
              <h1 className="text-2xl font-bold text-teal-800">Variance Estimation: Observed Information</h1>
            </div>
            <p className="text-gray-600 text-sm">Data-adaptive curvature from the actual sample</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Left: Definition and comparison */}
            <div className="flex flex-col gap-3">
              {/* Definition */}
              <div className="bg-teal-50 border-l-4 border-teal-500 p-4 rounded-r-lg">
                <h3 className="font-bold text-teal-800 mb-2">Observed Information</h3>
                <div className="bg-white rounded-lg p-3 mb-2">
                  <div className="text-center">
                    <Latex math="J_n(\hat{\theta}) = -\frac{\partial^2 \ell_n(\theta)}{\partial \theta^2}\bigg|_{\theta = \hat{\theta}}" />
                  </div>
                </div>
                <p className="text-sm text-gray-700">
                  The <strong>actual</strong> negative Hessian at the MLE, not the expected value.
                </p>
              </div>
    
              {/* Variance formula */}
              <div className="bg-blue-50 rounded-lg p-4">
                <h3 className="font-semibold text-blue-800 mb-2">Variance Estimate</h3>
                <div className="bg-white rounded-lg p-3 mb-2">
                  <div className="text-center text-lg">
                    <Latex math="\widehat{\text{Var}}(\hat{\theta}) = J_n(\hat{\theta})^{-1}" />
                  </div>
                </div>
                <p className="text-sm text-gray-700">
                  Inverse of observed information gives variance estimate directly.
                </p>
              </div>
    
              {/* Comparison */}
              <div className="bg-gray-50 rounded-lg p-4 flex-1">
                <h3 className="font-semibold text-gray-700 mb-2">Expected vs Observed</h3>
                <div className="grid grid-cols-2 gap-2 text-sm">
                  <div className="bg-white rounded p-2">
                    <p className="font-semibold text-blue-700">Expected (Fisher)</p>
                    <p className="text-gray-600"><Latex math="-\mathbb{E}[\partial^2 \ell / \partial \theta^2]" /></p>
                    <p className="text-xs text-gray-500 mt-1">Averages over samples</p>
                  </div>
                  <div className="bg-white rounded p-2">
                    <p className="font-semibold text-green-700">Observed</p>
                    <p className="text-gray-600"><Latex math="-\partial^2 \ell_n / \partial \theta^2 \big|_{\hat{\theta}}" /></p>
                    <p className="text-xs text-gray-500 mt-1">From THIS sample</p>
                  </div>
                </div>
                <p className="text-sm text-gray-700 mt-3">
                  <strong>Asymptotically equivalent</strong> under correct specification, but can differ for finite n.
                </p>
              </div>
            </div>
    
            {/* Right: Pros/cons and when to use */}
            <div className="flex flex-col gap-3">
              {/* Efron-Hinkley argument */}
              <div className="bg-purple-50 border border-purple-200 rounded-lg p-4">
                <h3 className="font-semibold text-purple-800 mb-2">The Efron-Hinkley Argument (1978)</h3>
                <p className="text-sm text-gray-700 mb-2">
                  Observed information <strong>conditions on ancillary statistics</strong> — aspects of the data that carry no information about <Latex math="\theta" /> but affect how informative the sample is.
                </p>
                <p className="text-sm text-purple-700">
                  This gives inference that's more relevant to <em>this particular sample</em>.
                </p>
              </div>
    
              {/* Pros and cons */}
              <div className="grid grid-cols-2 gap-2 flex-1">
                <div className="bg-green-50 rounded-lg p-3">
                  <h4 className="font-semibold text-green-800 mb-2 flex items-center gap-1">
                    <CheckCircle className="w-4 h-4" />
                    Advantages
                  </h4>
                  <ul className="text-sm text-gray-700 space-y-1">
                    <li>• Data-adaptive</li>
                    <li>• Conditions on ancillaries</li>
                    <li>• More sample-specific</li>
                    <li>• Often preferred theoretically</li>
                  </ul>
                </div>
    
                <div className="bg-red-50 rounded-lg p-3">
                  <h4 className="font-semibold text-red-800 mb-2 flex items-center gap-1">
                    <XCircle className="w-4 h-4" />
                    Disadvantages
                  </h4>
                  <ul className="text-sm text-gray-700 space-y-1">
                    <li>• More variable</li>
                    <li>• Can be unstable (small n)</li>
                    <li>• Still assumes correct model</li>
                    <li>• May need numerical Hessian</li>
                  </ul>
                </div>
              </div>
    
              {/* Numerical computation */}
              <div className="bg-amber-50 rounded-lg p-3">
                <h4 className="font-semibold text-amber-800 mb-2">Numerical Computation</h4>
                <p className="text-sm text-gray-700 mb-2">
                  When analytical Hessian unavailable, use finite differences:
                </p>
                <div className="bg-white rounded p-2 text-xs font-mono">
                  <p># scipy.optimize returns inverse Hessian</p>
                  <p>result = minimize(neg_log_lik, x0, method='BFGS')</p>
                  <p>var_theta = result.hess_inv</p>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom */}
          <div className="flex-shrink-0 mt-3 bg-amber-100 rounded-lg p-3">
            <p className="text-center text-gray-700">
              <strong>Bottom line:</strong> Both Fisher and observed assume the model is correct. 
              <span className="ml-2">When it might be wrong → <span className="text-teal-700 font-semibold">sandwich estimator</span></span>
            </p>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                      SLIDE 61: SANDWICH ESTIMATOR
// ═══════════════════════════════════════════════════════════════════════

function Slide61_SandwichEstimator() {
  return (
    <div className="h-full flex flex-col p-4">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <div className="flex items-center gap-2">
              <Shield className="w-6 h-6 text-teal-600" />
              <h1 className="text-2xl font-bold text-teal-800">The Sandwich Variance Estimator</h1>
            </div>
            <p className="text-gray-600 text-sm">Robust standard errors that work even when the model is wrong</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Left: Formula and intuition */}
            <div className="flex flex-col gap-3">
              {/* Main formula */}
              <div className="bg-teal-50 border-2 border-teal-400 rounded-lg p-4">
                <h3 className="font-bold text-teal-800 mb-2">The Sandwich Formula</h3>
                <div className="bg-white rounded-lg p-3 mb-3">
                  <div className="text-center text-xl">
                    <Latex math="\widehat{\text{Var}}_{\text{sandwich}}(\hat{\theta}) = A^{-1} B A^{-1}" />
                  </div>
                </div>
                <div className="grid grid-cols-2 gap-2 text-sm">
                  <div className="bg-teal-100 rounded p-2">
                    <p className="font-semibold text-teal-800">A = "Bread"</p>
                    <p className="text-xs"><Latex math="-\frac{1}{n}\sum_i \nabla^2 \ell_i(\hat{\theta})" /></p>
                    <p className="text-xs text-gray-600">Average Hessian</p>
                  </div>
                  <div className="bg-amber-100 rounded p-2">
                    <p className="font-semibold text-amber-800">B = "Meat"</p>
                    <p className="text-xs"><Latex math="\frac{1}{n}\sum_i \nabla \ell_i \nabla \ell_i^\top" /></p>
                    <p className="text-xs text-gray-600">Empirical score variance</p>
                  </div>
                </div>
              </div>
    
              {/* Key insight */}
              <div className="bg-purple-50 rounded-lg p-4">
                <h3 className="font-semibold text-purple-800 mb-2">The Key Insight</h3>
                <div className="space-y-2 text-sm">
                  <div className="flex items-start gap-2 p-2 bg-white rounded">
                    <CheckCircle className="w-4 h-4 text-green-500 flex-shrink-0 mt-0.5" />
                    <div>
                      <strong>Model correct:</strong> <Latex math="A = B" />
                      <p className="text-gray-600 text-xs">Sandwich = Fisher information⁻¹</p>
                    </div>
                  </div>
                  <div className="flex items-start gap-2 p-2 bg-white rounded">
                    <Shield className="w-4 h-4 text-purple-500 flex-shrink-0 mt-0.5" />
                    <div>
                      <strong>Model wrong:</strong> <Latex math="A \neq B" />
                      <p className="text-gray-600 text-xs">Sandwich captures true variability anyway!</p>
                    </div>
                  </div>
                </div>
              </div>
    
              {/* When to use */}
              <div className="bg-green-50 rounded-lg p-3 flex-1">
                <h4 className="font-semibold text-green-800 mb-2">When to Use</h4>
                <ul className="text-sm text-gray-700 space-y-1">
                  <li>• Model may be misspecified</li>
                  <li>• Heteroskedasticity present/suspected</li>
                  <li>• Quasi-likelihood estimation (e.g., GEE)</li>
                  <li>• You want "insurance" against model failure</li>
                </ul>
              </div>
            </div>
    
            {/* Right: Variants and practical */}
            <div className="flex flex-col gap-3">
              {/* HC variants */}
              <div className="bg-white border rounded-lg p-4">
                <h3 className="font-semibold text-gray-800 mb-2">Heteroskedasticity-Consistent Variants</h3>
                <div className="space-y-2 text-sm">
                  <div className="grid grid-cols-4 gap-1">
                    <div className="bg-blue-50 rounded p-2 text-center">
                      <p className="font-semibold text-blue-700">HC0</p>
                      <p className="text-xs text-gray-600">Basic</p>
                    </div>
                    <div className="bg-blue-50 rounded p-2 text-center">
                      <p className="font-semibold text-blue-700">HC1</p>
                      <p className="text-xs text-gray-600">n/(n-p) adjust</p>
                    </div>
                    <div className="bg-blue-50 rounded p-2 text-center">
                      <p className="font-semibold text-blue-700">HC2</p>
                      <p className="text-xs text-gray-600">Leverage adjust</p>
                    </div>
                    <div className="bg-green-50 rounded p-2 text-center border-2 border-green-400">
                      <p className="font-semibold text-green-700">HC3</p>
                      <p className="text-xs text-gray-600">Most conservative</p>
                    </div>
                  </div>
                  <p className="text-xs text-gray-600 mt-2">
                    <strong>Recommendation:</strong> Use HC3 for finite samples; it's most resistant to influential observations.
                  </p>
                </div>
              </div>
    
              {/* Code example */}
              <div className="bg-gray-50 rounded-lg p-3">
                <h4 className="font-semibold text-gray-700 mb-2">Python Example</h4>
                <div className="bg-white rounded p-2 text-xs font-mono overflow-x-auto">
                  <pre>{`import statsmodels.api as sm
    
    # Fit OLS regression
    model = sm.OLS(y, X).fit()
    
    # Get robust standard errors
    robust = model.get_robustcov_results(
        cov_type='HC3'  # or 'HC0', 'HC1', 'HC2'
    )
    print(robust.summary())`}</pre>
                </div>
              </div>
    
              {/* Cluster-robust */}
              <div className="bg-amber-50 rounded-lg p-3 flex-1">
                <h4 className="font-semibold text-amber-800 mb-2">Extension: Cluster-Robust</h4>
                <p className="text-sm text-gray-700 mb-2">
                  When observations are correlated within groups (e.g., students in schools, repeated measures):
                </p>
                <div className="bg-white rounded p-2 text-xs font-mono">
                  robust = model.get_robustcov_results(cov_type='cluster', groups=cluster_id)
                </div>
                <p className="text-xs text-gray-600 mt-2">
                  Accounts for within-cluster correlation. Essential for panel data and hierarchical designs.
                </p>
              </div>
            </div>
          </div>
    
          {/* Bottom */}
          <div className="flex-shrink-0 mt-3 bg-teal-800 text-white rounded-lg p-3">
            <p className="text-center">
              <strong>The sandwich is your insurance policy:</strong> Valid inference even when your model assumptions are wrong.
            </p>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                       SLIDE 62: SECTION33 SUMMARY
// ═══════════════════════════════════════════════════════════════════════

function Slide62_Section33Summary() {
  return (
    <div className="h-full flex flex-col p-4">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-2xl font-bold text-teal-800">Section 3.3 Summary: Sampling Variability</h1>
            <p className="text-gray-600 text-sm">From point estimates to uncertainty quantification</p>
          </div>
    
          {/* Main content - 2x2 grid */}
          <div className="flex-1 grid grid-cols-2 gap-3 mb-3">
            {/* Key Formulas */}
            <div className="bg-teal-50 rounded-lg p-4 flex flex-col">
              <h3 className="font-bold text-teal-800 text-lg mb-3">Key Formulas</h3>
              <div className="flex-1 space-y-3">
                <div className="bg-white rounded p-3">
                  <p className="text-sm font-semibold text-gray-700 mb-1">Univariate Delta Method</p>
                  <div className="text-center">
                    <Latex math="\text{Var}(g(\hat{\theta})) \approx [g'(\theta)]^2 \, \text{Var}(\hat{\theta})" />
                  </div>
                </div>
                <div className="bg-white rounded p-3">
                  <p className="text-sm font-semibold text-gray-700 mb-1">Multivariate Delta Method</p>
                  <div className="text-center">
                    <Latex math="\text{Var}(g(\hat{\boldsymbol{\theta}})) = (\nabla g)^\top \boldsymbol{\Sigma} (\nabla g)" />
                  </div>
                </div>
                <div className="bg-white rounded p-3">
                  <p className="text-sm font-semibold text-gray-700 mb-1">Sandwich Estimator</p>
                  <div className="text-center">
                    <Latex math="\widehat{\text{Var}} = A^{-1} B A^{-1}" />
                  </div>
                </div>
              </div>
            </div>
    
            {/* Variance Estimation Hierarchy */}
            <div className="bg-blue-50 rounded-lg p-4 flex flex-col">
              <h3 className="font-bold text-blue-800 text-lg mb-3">Variance Estimation Hierarchy</h3>
              <div className="flex-1 space-y-2">
                <div className="flex items-center gap-3 bg-white rounded p-2">
                  <div className="w-8 h-8 bg-blue-200 rounded-full flex items-center justify-center font-bold text-blue-800">1</div>
                  <div className="flex-1">
                    <p className="font-semibold text-blue-700">Fisher Information</p>
                    <p className="text-xs text-gray-600">Theoretical; requires correct model</p>
                  </div>
                </div>
                <div className="flex items-center gap-3 bg-white rounded p-2">
                  <div className="w-8 h-8 bg-green-200 rounded-full flex items-center justify-center font-bold text-green-800">2</div>
                  <div className="flex-1">
                    <p className="font-semibold text-green-700">Observed Information</p>
                    <p className="text-xs text-gray-600">Data-adaptive; requires correct model</p>
                  </div>
                </div>
                <div className="flex items-center gap-3 bg-white rounded p-2">
                  <div className="w-8 h-8 bg-purple-200 rounded-full flex items-center justify-center font-bold text-purple-800">3</div>
                  <div className="flex-1">
                    <p className="font-semibold text-purple-700">Sandwich Estimator</p>
                    <p className="text-xs text-gray-600">Robust to misspecification</p>
                  </div>
                </div>
                <div className="flex items-center gap-3 bg-white rounded p-2">
                  <div className="w-8 h-8 bg-amber-200 rounded-full flex items-center justify-center font-bold text-amber-800">4</div>
                  <div className="flex-1">
                    <p className="font-semibold text-amber-700">Bootstrap (Chapter 4)</p>
                    <p className="text-xs text-gray-600">When analytical methods fail</p>
                  </div>
                </div>
              </div>
            </div>
    
            {/* Key Takeaways */}
            <div className="bg-green-50 rounded-lg p-4">
              <h3 className="font-bold text-green-800 text-lg mb-3">Key Takeaways</h3>
              <div className="space-y-2 text-sm">
                <div className="flex items-start gap-2">
                  <CheckCircle className="w-5 h-5 text-green-600 flex-shrink-0" />
                  <p><strong>Variance scales as derivative²</strong> — the core delta method insight</p>
                </div>
                <div className="flex items-start gap-2">
                  <CheckCircle className="w-5 h-5 text-green-600 flex-shrink-0" />
                  <p><strong>Covariance matters</strong> — affects variance of transformations</p>
                </div>
                <div className="flex items-start gap-2">
                  <CheckCircle className="w-5 h-5 text-green-600 flex-shrink-0" />
                  <p><strong>Know the limitations</strong> — small n, boundaries, zero derivatives</p>
                </div>
                <div className="flex items-start gap-2">
                  <CheckCircle className="w-5 h-5 text-green-600 flex-shrink-0" />
                  <p><strong>Sandwich = insurance</strong> — valid even when model is wrong</p>
                </div>
              </div>
            </div>
    
            {/* Learning Outcomes */}
            <div className="bg-amber-50 rounded-lg p-4">
              <h3 className="font-bold text-amber-800 text-lg mb-3">Learning Outcomes</h3>
              <div className="space-y-2 text-sm">
                <div className="bg-white rounded p-2">
                  <p className="font-semibold text-amber-700">LO 1: Simulation & Transformations</p>
                  <p className="text-xs text-gray-600">Delta method propagates uncertainty through <Latex math="g(\theta)" /></p>
                </div>
                <div className="bg-white rounded p-2">
                  <p className="font-semibold text-amber-700">LO 2: Frequentist Inference</p>
                  <p className="text-xs text-gray-600">Standard errors, confidence intervals, hypothesis tests</p>
                </div>
                <div className="bg-white rounded p-2">
                  <p className="font-semibold text-amber-700">LO 3: Resampling Methods</p>
                  <p className="text-xs text-gray-600">Chapter 4 provides alternatives when analytical fails</p>
                </div>
              </div>
            </div>
          </div>
    
          {/* Footer */}
          <div className="flex-shrink-0 flex items-center justify-between bg-white border rounded-lg p-3">
            <div className="flex items-center gap-2">
              <BookOpen className="w-5 h-5 text-gray-400" />
              <span className="text-gray-600 text-sm">See textbook Section 3.3 for proofs and exercises</span>
            </div>
            <div className="flex items-center gap-2 text-teal-600">
              <span className="font-semibold">Next: Linear Models (Section 3.4)</span>
              <ArrowRight className="w-5 h-5" />
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                          SLIDE 63: CH3_4 HERO
// ═══════════════════════════════════════════════════════════════════════

function Slide63_Ch3_4Hero() {
  return (
    <div className="h-full flex flex-col bg-gradient-to-br from-emerald-900 via-teal-800 to-cyan-900 text-white p-6">
          {/* Section identifier */}
          <div className="flex-shrink-0 mb-4 text-center">
            <div className="inline-block bg-emerald-400/20 border border-emerald-400/40 rounded-full px-4 py-1">
              <span className="text-emerald-200 font-mono text-sm">Section 3.4</span>
            </div>
          </div>
    
          {/* Main title */}
          <div className="flex-1 flex flex-col justify-center items-center text-center">
            <h1 className="text-5xl font-bold mb-4">Linear Models</h1>
            <p className="text-2xl text-emerald-200 mb-8">The Foundation of Regression Analysis</p>
            
            {/* Historical context */}
            <div className="bg-white/10 backdrop-blur rounded-xl p-5 mb-6 max-w-3xl mx-auto text-left">
              <div className="flex items-start gap-4">
                <div className="text-4xl">🔭</div>
                <div>
                  <p className="text-lg text-emerald-100 mb-2">
                    <strong>1801:</strong> Gauss predicts the orbit of Ceres using least squares
                  </p>
                  <p className="text-emerald-300 text-sm">
                    From astronomy to economics to machine learning — this method remains the workhorse of quantitative science
                  </p>
                </div>
              </div>
            </div>
    
            {/* Roadmap */}
            <div className="grid grid-cols-5 gap-3 max-w-4xl mx-auto">
              {[
                { num: '1', title: 'Matrix Calculus', desc: 'Differentiate vectors' },
                { num: '2', title: 'OLS Derivation', desc: 'Two perspectives' },
                { num: '3', title: 'Gauss-Markov', desc: 'Why OLS is "best"' },
                { num: '4', title: 'Inference', desc: 't-tests, F-tests, CIs' },
                { num: '5', title: 'Diagnostics', desc: 'When assumptions fail' },
              ].map((item, i) => (
                <div key={i} className="bg-white/10 rounded-lg p-3 text-center">
                  <div className="w-8 h-8 bg-emerald-400 text-emerald-900 rounded-full flex items-center justify-center font-bold mx-auto mb-2">
                    {item.num}
                  </div>
                  <p className="font-semibold text-sm">{item.title}</p>
                  <p className="text-xs text-emerald-300">{item.desc}</p>
                </div>
              ))}
            </div>
          </div>
    
          {/* Key equation preview */}
          <div className="flex-shrink-0 mt-4 text-center">
            <div className="inline-block bg-white/10 backdrop-blur rounded-lg px-6 py-3">
              <Latex math="\hat{\boldsymbol{\beta}} = (\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{X}^\top\mathbf{y}" />
              <p className="text-emerald-300 text-sm mt-1">The OLS estimator — we'll derive this from scratch</p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                      SLIDE 64: WHY MATRIX CALCULUS
// ═══════════════════════════════════════════════════════════════════════

function Slide64_WhyMatrixCalculus() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-teal-800">Why Matrix Calculus?</h1>
            <p className="text-gray-600">From scalar to vector optimization</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-6">
            {/* Left: Scalar case */}
            <div className="space-y-4">
              <div className="bg-blue-50 border border-blue-200 rounded-lg p-4">
                <h3 className="font-semibold text-blue-800 mb-3 flex items-center gap-2">
                  <span className="text-xl">📐</span> Scalar Case (STAT 355)
                </h3>
                <div className="space-y-3">
                  <div className="bg-white rounded p-3">
                    <p className="text-sm text-gray-600 mb-1">Minimize:</p>
                    <div className="text-center">
                      <Latex math="f(x) = (y - x)^2" />
                    </div>
                  </div>
                  <div className="bg-white rounded p-3">
                    <p className="text-sm text-gray-600 mb-1">Take derivative:</p>
                    <div className="text-center">
                      <Latex math="\frac{df}{dx} = -2(y - x)" />
                    </div>
                  </div>
                  <div className="bg-white rounded p-3">
                    <p className="text-sm text-gray-600 mb-1">Set to zero, solve:</p>
                    <div className="text-center">
                      <Latex math="\hat{x} = y" />
                    </div>
                  </div>
                </div>
                <p className="text-sm text-blue-600 mt-3 text-center">One parameter, one derivative</p>
              </div>
            </div>
    
            {/* Right: Vector case */}
            <div className="space-y-4">
              <div className="bg-emerald-50 border border-emerald-200 rounded-lg p-4">
                <h3 className="font-semibold text-emerald-800 mb-3 flex items-center gap-2">
                  <span className="text-xl">🧮</span> Vector Case (Now)
                </h3>
                <div className="space-y-3">
                  <div className="bg-white rounded p-3">
                    <p className="text-sm text-gray-600 mb-1">Minimize:</p>
                    <div className="text-center text-sm">
                      <Latex math="f(\boldsymbol{\beta}) = \sum_{i=1}^n (y_i - \mathbf{x}_i^\top \boldsymbol{\beta})^2" />
                    </div>
                  </div>
                  <div className="bg-white rounded p-3">
                    <p className="text-sm text-gray-600 mb-1">In matrix form:</p>
                    <div className="text-center">
                      <Latex math="f(\boldsymbol{\beta}) = (\mathbf{y} - \mathbf{X}\boldsymbol{\beta})^\top(\mathbf{y} - \mathbf{X}\boldsymbol{\beta})" />
                    </div>
                  </div>
                  <div className="bg-white rounded p-3">
                    <p className="text-sm text-gray-600 mb-1">Take derivative w.r.t. vector:</p>
                    <div className="text-center">
                      <Latex math="\frac{\partial f}{\partial \boldsymbol{\beta}} = \; ?" />
                    </div>
                  </div>
                </div>
                <p className="text-sm text-emerald-600 mt-3 text-center">p parameters, need gradient</p>
              </div>
            </div>
          </div>
    
          {/* Bottom: The question */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-amber-50 border border-amber-200 rounded-lg p-4">
              <div className="flex items-center justify-between">
                <div>
                  <p className="font-semibold text-amber-800">The Question</p>
                  <p className="text-gray-700">How do we differentiate a scalar function with respect to a <em>vector</em>?</p>
                </div>
                <div className="text-right bg-white rounded-lg px-4 py-2">
                  <p className="text-sm text-gray-500">Answer:</p>
                  <p className="text-amber-800 font-medium">Matrix calculus rules</p>
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                        SLIDE 65: MATRIX NOTATION
// ═══════════════════════════════════════════════════════════════════════

function Slide65_MatrixNotation() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-teal-800">Matrix Calculus: Notation</h1>
            <p className="text-gray-600">Establishing conventions for vectors, matrices, and gradients</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-6">
            {/* Left: Notation conventions */}
            <div className="space-y-4">
              <div className="bg-gray-50 rounded-lg p-4">
                <h3 className="font-semibold text-gray-800 mb-3">Notation Conventions</h3>
                <table className="w-full text-sm">
                  <tbody className="divide-y">
                    <tr>
                      <td className="py-2 pr-3 font-medium text-gray-600">Vectors</td>
                      <td className="py-2">
                        Bold lowercase: <Latex math="\mathbf{x}, \mathbf{y}, \boldsymbol{\beta}" />
                      </td>
                    </tr>
                    <tr>
                      <td className="py-2 pr-3 font-medium text-gray-600">Matrices</td>
                      <td className="py-2">
                        Bold uppercase: <Latex math="\mathbf{X}, \mathbf{A}, \boldsymbol{\Sigma}" />
                      </td>
                    </tr>
                    <tr>
                      <td className="py-2 pr-3 font-medium text-gray-600">Scalars</td>
                      <td className="py-2">
                        Italic: <Latex math="a, b, \sigma^2" />
                      </td>
                    </tr>
                    <tr>
                      <td className="py-2 pr-3 font-medium text-gray-600">Transpose</td>
                      <td className="py-2">
                        <Latex math="\mathbf{x}^\top" /> (row vector), <Latex math="\mathbf{A}^\top" />
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
    
              <div className="bg-blue-50 rounded-lg p-4">
                <h3 className="font-semibold text-blue-800 mb-3">Dimensions</h3>
                <div className="space-y-2 text-sm">
                  <div className="flex justify-between items-center bg-white rounded px-3 py-2">
                    <span>Response:</span>
                    <Latex math="\mathbf{y} \in \mathbb{R}^n" />
                  </div>
                  <div className="flex justify-between items-center bg-white rounded px-3 py-2">
                    <span>Design matrix:</span>
                    <Latex math="\mathbf{X} \in \mathbb{R}^{n \times p}" />
                  </div>
                  <div className="flex justify-between items-center bg-white rounded px-3 py-2">
                    <span>Parameters:</span>
                    <Latex math="\boldsymbol{\beta} \in \mathbb{R}^p" />
                  </div>
                  <div className="flex justify-between items-center bg-white rounded px-3 py-2">
                    <span>Errors:</span>
                    <Latex math="\boldsymbol{\varepsilon} \in \mathbb{R}^n" />
                  </div>
                </div>
              </div>
            </div>
    
            {/* Right: Gradient definition */}
            <div className="space-y-4">
              <div className="bg-emerald-50 border-2 border-emerald-300 rounded-lg p-4">
                <h3 className="font-semibold text-emerald-800 mb-3">The Gradient</h3>
                <p className="text-sm text-gray-600 mb-3">
                  For a scalar function <Latex math="f: \mathbb{R}^p \to \mathbb{R}" />, the gradient is:
                </p>
                <div className="bg-white rounded-lg p-4 text-center">
                  <Latex math="\nabla_{\boldsymbol{\beta}} f = \frac{\partial f}{\partial \boldsymbol{\beta}} = \begin{pmatrix} \frac{\partial f}{\partial \beta_1} \\ \frac{\partial f}{\partial \beta_2} \\ \vdots \\ \frac{\partial f}{\partial \beta_p} \end{pmatrix} \in \mathbb{R}^p" />
                </div>
                <p className="text-sm text-emerald-700 mt-3 text-center">
                  A column vector of all partial derivatives
                </p>
              </div>
    
              <div className="bg-amber-50 border border-amber-200 rounded-lg p-4">
                <h3 className="font-semibold text-amber-800 mb-2">Key Insight</h3>
                <p className="text-sm text-gray-700">
                  The gradient has the <strong>same shape</strong> as <Latex math="\boldsymbol{\beta}" />. 
                  This makes sense: each component of <Latex math="\boldsymbol{\beta}" /> contributes one partial derivative.
                </p>
              </div>
            </div>
          </div>
    
          {/* Bottom: Convention note */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-gray-100 rounded-lg p-3 text-center">
              <p className="text-sm text-gray-600">
                <strong>Convention:</strong> Vectors are column vectors by default. 
                Row vectors are written as transposes: <Latex math="\mathbf{x}^\top" />
              </p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                     SLIDE 66: DIFFERENTIATION RULES
// ═══════════════════════════════════════════════════════════════════════

function Slide66_DifferentiationRules() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-teal-800">Key Differentiation Rules</h1>
            <p className="text-gray-600">Building up the calculus we need for OLS</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Rule 1: Linear Form */}
            <div className="bg-blue-50 border border-blue-200 rounded-lg p-4">
              <div className="flex items-center gap-2 mb-3">
                <span className="bg-blue-600 text-white w-7 h-7 rounded-full flex items-center justify-center font-bold text-sm">1</span>
                <h3 className="font-semibold text-blue-800">Linear Form</h3>
              </div>
              
              <div className="bg-white rounded p-3 mb-3 text-center">
                <Latex math="f(\boldsymbol{\beta}) = \mathbf{a}^\top \boldsymbol{\beta} = \sum_{j=1}^p a_j \beta_j" />
              </div>
              
              <div className="text-sm text-gray-600 mb-2">
                Partial w.r.t. <Latex math="\beta_k" />:
              </div>
              <div className="bg-white rounded p-2 mb-3 text-center text-sm">
                <Latex math="\frac{\partial f}{\partial \beta_k} = a_k" />
              </div>
              
              <div className="bg-blue-100 rounded-lg p-3 text-center">
                <p className="text-xs text-blue-600 mb-1">Result:</p>
                <Latex math="\boxed{\frac{\partial}{\partial \boldsymbol{\beta}}(\mathbf{a}^\top \boldsymbol{\beta}) = \mathbf{a}}" />
              </div>
            </div>
    
            {/* Rule 2: Quadratic Form */}
            <div className="bg-emerald-50 border border-emerald-200 rounded-lg p-4">
              <div className="flex items-center gap-2 mb-3">
                <span className="bg-emerald-600 text-white w-7 h-7 rounded-full flex items-center justify-center font-bold text-sm">2</span>
                <h3 className="font-semibold text-emerald-800">Quadratic Form</h3>
              </div>
              
              <div className="bg-white rounded p-3 mb-3 text-center">
                <Latex math="f(\boldsymbol{\beta}) = \boldsymbol{\beta}^\top \mathbf{A} \boldsymbol{\beta} = \sum_i \sum_j \beta_i A_{ij} \beta_j" />
              </div>
              
              <div className="text-sm text-gray-600 mb-2">
                Terms with <Latex math="\beta_k" />: row <em>k</em> and column <em>k</em>
              </div>
              
              <div className="bg-white rounded p-2 mb-3 text-center text-sm">
                <Latex math="\frac{\partial f}{\partial \beta_k} = [\mathbf{A}\boldsymbol{\beta}]_k + [\mathbf{A}^\top\boldsymbol{\beta}]_k" />
              </div>
              
              <div className="bg-emerald-100 rounded-lg p-3 text-center">
                <p className="text-xs text-emerald-600 mb-1">General result:</p>
                <Latex math="\boxed{\frac{\partial}{\partial \boldsymbol{\beta}}(\boldsymbol{\beta}^\top \mathbf{A} \boldsymbol{\beta}) = (\mathbf{A} + \mathbf{A}^\top)\boldsymbol{\beta}}" />
              </div>
            </div>
          </div>
    
          {/* Bottom: Symmetric special case */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-amber-50 border-2 border-amber-300 rounded-lg p-4">
              <div className="flex items-center justify-between">
                <div>
                  <h3 className="font-semibold text-amber-800 mb-1">Special Case: Symmetric A</h3>
                  <p className="text-sm text-gray-600">
                    When <Latex math="\mathbf{A} = \mathbf{A}^\top" /> (like <Latex math="\mathbf{X}^\top\mathbf{X}" />):
                  </p>
                </div>
                <div className="bg-white rounded-lg px-6 py-3">
                  <Latex math="\frac{\partial}{\partial \boldsymbol{\beta}}(\boldsymbol{\beta}^\top \mathbf{A} \boldsymbol{\beta}) = 2\mathbf{A}\boldsymbol{\beta}" />
                </div>
              </div>
              <p className="text-xs text-amber-700 mt-2">
                This is the form we'll use for OLS since <Latex math="\mathbf{X}^\top\mathbf{X}" /> is always symmetric.
              </p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                    SLIDE 67: MATRIX CALCULUS SUMMARY
// ═══════════════════════════════════════════════════════════════════════

function Slide67_MatrixCalculusSummary() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-teal-800">Matrix Calculus Summary</h1>
            <p className="text-gray-600">The rules we need for deriving OLS</p>
          </div>
    
          {/* Main table */}
          <div className="flex-1 flex flex-col justify-center">
            <div className="bg-white border-2 border-gray-200 rounded-xl overflow-hidden shadow-lg">
              <table className="w-full">
                <thead className="bg-gray-100">
                  <tr>
                    <th className="px-4 py-3 text-left font-semibold text-gray-700 border-b-2 border-gray-200">Expression <Latex math="f(\boldsymbol{\beta})" /></th>
                    <th className="px-4 py-3 text-left font-semibold text-gray-700 border-b-2 border-gray-200">Derivative <Latex math="\frac{\partial f}{\partial \boldsymbol{\beta}}" /></th>
                    <th className="px-4 py-3 text-left font-semibold text-gray-700 border-b-2 border-gray-200">Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr className="bg-blue-50/50 hover:bg-blue-50">
                    <td className="px-4 py-3 border-b">
                      <Latex math="\mathbf{a}^\top \boldsymbol{\beta}" /> or <Latex math="\boldsymbol{\beta}^\top \mathbf{a}" />
                    </td>
                    <td className="px-4 py-3 border-b">
                      <Latex math="\mathbf{a}" />
                    </td>
                    <td className="px-4 py-3 border-b text-sm text-gray-600">
                      <Latex math="\mathbf{a}" /> constant
                    </td>
                  </tr>
                  <tr className="hover:bg-gray-50">
                    <td className="px-4 py-3 border-b">
                      <Latex math="\boldsymbol{\beta}^\top \mathbf{A} \boldsymbol{\beta}" />
                    </td>
                    <td className="px-4 py-3 border-b">
                      <Latex math="(\mathbf{A} + \mathbf{A}^\top)\boldsymbol{\beta}" />
                    </td>
                    <td className="px-4 py-3 border-b text-sm text-gray-600">
                      <Latex math="\mathbf{A}" /> constant
                    </td>
                  </tr>
                  <tr className="bg-emerald-50/50 hover:bg-emerald-50">
                    <td className="px-4 py-3 border-b">
                      <Latex math="\boldsymbol{\beta}^\top \mathbf{A} \boldsymbol{\beta}" />
                    </td>
                    <td className="px-4 py-3 border-b">
                      <Latex math="2\mathbf{A}\boldsymbol{\beta}" />
                    </td>
                    <td className="px-4 py-3 border-b text-sm text-gray-600">
                      <Latex math="\mathbf{A}" /> symmetric
                    </td>
                  </tr>
                  <tr className="bg-amber-50 hover:bg-amber-100">
                    <td className="px-4 py-3">
                      <Latex math="\|\mathbf{y} - \mathbf{X}\boldsymbol{\beta}\|^2" />
                    </td>
                    <td className="px-4 py-3">
                      <Latex math="-2\mathbf{X}^\top(\mathbf{y} - \mathbf{X}\boldsymbol{\beta})" />
                    </td>
                    <td className="px-4 py-3 text-sm text-gray-600">
                      The OLS objective!
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
    
            {/* Derivation hint */}
            <div className="mt-6 grid grid-cols-2 gap-4">
              <div className="bg-gray-50 rounded-lg p-4">
                <h4 className="font-semibold text-gray-700 mb-2">Last Row Derivation</h4>
                <div className="text-sm space-y-1">
                  <p className="text-gray-600">Expand: <Latex math="\mathbf{y}^\top\mathbf{y} - 2\boldsymbol{\beta}^\top\mathbf{X}^\top\mathbf{y} + \boldsymbol{\beta}^\top\mathbf{X}^\top\mathbf{X}\boldsymbol{\beta}" /></p>
                  <p className="text-gray-600">Apply rules 1 and 3, combine.</p>
                </div>
              </div>
              
              <div className="bg-teal-50 border border-teal-200 rounded-lg p-4">
                <h4 className="font-semibold text-teal-700 mb-2">Scalar Analogy</h4>
                <div className="text-sm grid grid-cols-2 gap-2">
                  <div className="text-gray-600"><Latex math="\frac{d}{dx}(ax) = a" /></div>
                  <div className="text-teal-700">Rule 1</div>
                  <div className="text-gray-600"><Latex math="\frac{d}{dx}(ax^2) = 2ax" /></div>
                  <div className="text-teal-700">Rule 3</div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom note */}
          <div className="flex-shrink-0 mt-4 text-center">
            <p className="text-sm text-gray-500">These four rules are all we need for deriving OLS and understanding its properties.</p>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                         SLIDE 68: LINEAR MODEL
// ═══════════════════════════════════════════════════════════════════════

function Slide68_LinearModel() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-teal-800">The Linear Model</h1>
            <p className="text-gray-600">From scalar equations to matrix form</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-6">
            {/* Left: Scalar form */}
            <div className="space-y-4">
              <div className="bg-gray-50 rounded-lg p-4">
                <h3 className="font-semibold text-gray-700 mb-3">Scalar Form</h3>
                <div className="bg-white rounded p-3 text-center">
                  <Latex math="y_i = \beta_0 + \beta_1 x_{i1} + \beta_2 x_{i2} + \cdots + \beta_{p-1} x_{i,p-1} + \varepsilon_i" />
                </div>
                <p className="text-sm text-gray-500 mt-2 text-center">for <Latex math="i = 1, \ldots, n" /></p>
              </div>
    
              <div className="bg-blue-50 rounded-lg p-4">
                <h3 className="font-semibold text-blue-800 mb-3">Design Matrix</h3>
                <div className="bg-white rounded p-3 text-sm">
                  <Latex math="\mathbf{X} = \begin{pmatrix} 1 & x_{11} & x_{12} & \cdots & x_{1,p-1} \\ 1 & x_{21} & x_{22} & \cdots & x_{2,p-1} \\ \vdots & \vdots & \vdots & \ddots & \vdots \\ 1 & x_{n1} & x_{n2} & \cdots & x_{n,p-1} \end{pmatrix}" />
                </div>
                <div className="flex justify-between mt-2 text-xs text-blue-600">
                  <span>n rows (observations)</span>
                  <span>p columns (1 + predictors)</span>
                </div>
              </div>
            </div>
    
            {/* Right: Matrix form */}
            <div className="space-y-4">
              <div className="bg-emerald-50 border-2 border-emerald-300 rounded-lg p-4">
                <h3 className="font-semibold text-emerald-800 mb-3">Matrix Form</h3>
                <div className="bg-white rounded-lg p-4 text-center">
                  <Latex math="\boxed{\mathbf{y} = \mathbf{X}\boldsymbol{\beta} + \boldsymbol{\varepsilon}}" />
                </div>
                <div className="grid grid-cols-2 gap-2 mt-4 text-sm">
                  <div className="bg-white rounded p-2 text-center">
                    <Latex math="\mathbf{y} \in \mathbb{R}^n" />
                    <p className="text-xs text-gray-500">response</p>
                  </div>
                  <div className="bg-white rounded p-2 text-center">
                    <Latex math="\boldsymbol{\beta} \in \mathbb{R}^p" />
                    <p className="text-xs text-gray-500">parameters</p>
                  </div>
                  <div className="bg-white rounded p-2 text-center">
                    <Latex math="\mathbf{X} \in \mathbb{R}^{n \times p}" />
                    <p className="text-xs text-gray-500">design matrix</p>
                  </div>
                  <div className="bg-white rounded p-2 text-center">
                    <Latex math="\boldsymbol{\varepsilon} \in \mathbb{R}^n" />
                    <p className="text-xs text-gray-500">errors</p>
                  </div>
                </div>
              </div>
    
              <div className="bg-amber-50 border border-amber-200 rounded-lg p-4">
                <h3 className="font-semibold text-amber-800 mb-2">Dimension Check</h3>
                <div className="flex items-center justify-center gap-2 text-sm">
                  <span className="bg-white px-2 py-1 rounded"><Latex math="n \times 1" /></span>
                  <span>=</span>
                  <span className="bg-white px-2 py-1 rounded"><Latex math="n \times p" /></span>
                  <span className="text-lg">×</span>
                  <span className="bg-white px-2 py-1 rounded"><Latex math="p \times 1" /></span>
                  <span>+</span>
                  <span className="bg-white px-2 py-1 rounded"><Latex math="n \times 1" /></span>
                </div>
                <p className="text-center text-xs text-amber-700 mt-2">Dimensions match!</p>
              </div>
            </div>
          </div>
    
          {/* Bottom: Intercept note */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-gray-100 rounded-lg p-3">
              <div className="flex items-center gap-4">
                <span className="text-2xl">💡</span>
                <div>
                  <p className="text-sm text-gray-700">
                    <strong>The column of 1s</strong> in <Latex math="\mathbf{X}" /> corresponds to the intercept <Latex math="\beta_0" />. 
                    This lets us write the entire model compactly without treating the intercept as a special case.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                        SLIDE 69: LINEAR MEANING
// ═══════════════════════════════════════════════════════════════════════

function Slide69_LinearMeaning() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-teal-800">What "Linear" Means</h1>
            <p className="text-gray-600">Linear in parameters, not predictors</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-6">
            {/* Left: Linear vs not */}
            <div className="space-y-3">
              <div className="bg-emerald-50 border border-emerald-200 rounded-lg p-4">
                <h3 className="font-semibold text-emerald-800 mb-3 flex items-center gap-2">
                  <span className="text-lg">{"\u2713"}</span> Linear Models
                </h3>
                <div className="space-y-2 text-sm">
                  <div className="bg-white rounded p-2">
                    <Latex math="y = \beta_0 + \beta_1 x + \varepsilon" />
                    <span className="text-gray-500 ml-2 text-xs">simple regression</span>
                  </div>
                  <div className="bg-white rounded p-2">
                    <Latex math="y = \beta_0 + \beta_1 x + \beta_2 x^2 + \varepsilon" />
                    <span className="text-gray-500 ml-2 text-xs">polynomial</span>
                  </div>
                  <div className="bg-white rounded p-2">
                    <Latex math="y = \beta_0 + \beta_1 \log(x) + \varepsilon" />
                    <span className="text-gray-500 ml-2 text-xs">log transform</span>
                  </div>
                  <div className="bg-white rounded p-2">
                    <Latex math="y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_1 x_2 + \varepsilon" />
                    <span className="text-gray-500 ml-2 text-xs">interaction</span>
                  </div>
                </div>
                <p className="text-xs text-emerald-600 mt-2">y is a linear combination of the betas</p>
              </div>
    
              <div className="bg-red-50 border border-red-200 rounded-lg p-4">
                <h3 className="font-semibold text-red-800 mb-3 flex items-center gap-2">
                  <span className="text-lg">{"\u2717"}</span> Not Linear
                </h3>
                <div className="bg-white rounded p-2 text-sm">
                  <Latex math="y = \beta_0 e^{\beta_1 x} + \varepsilon" />
                </div>
                <p className="text-xs text-red-600 mt-2">y is nonlinear in the parameter <Latex math="\beta_1" /></p>
              </div>
            </div>
    
            {/* Right: Interpretation */}
            <div className="space-y-3">
              <div className="bg-blue-50 border border-blue-200 rounded-lg p-4">
                <h3 className="font-semibold text-blue-800 mb-3">Interpreting Coefficients</h3>
                <div className="bg-white rounded p-3 mb-3">
                  <p className="text-sm text-gray-700">
                    <Latex math="\beta_j" /> = expected change in <Latex math="y" /> for a one-unit 
                    increase in <Latex math="x_j" />, <strong>holding all other predictors fixed</strong>.
                  </p>
                </div>
                <p className="text-xs text-blue-600">
                  This "ceteris paribus" interpretation is fundamental to multiple regression.
                </p>
              </div>
    
              <div className="bg-amber-50 border-2 border-amber-300 rounded-lg p-4">
                <h3 className="font-semibold text-amber-800 mb-2 flex items-center gap-2">
                  <span className="text-xl">{"\u26A0\uFE0F"}</span> Correlation vs. Causation
                </h3>
                <p className="text-sm text-gray-700 mb-2">
                  OLS measures <strong>association</strong>, not causation. For causal interpretation:
                </p>
                <ul className="text-xs text-gray-600 space-y-1">
                  <li>• No omitted confounders</li>
                  <li>• No reverse causation</li>
                  <li>• No measurement error in predictors</li>
                </ul>
                <p className="text-xs text-amber-700 mt-2">
                  Rarely satisfied in observational data!
                </p>
              </div>
            </div>
          </div>
    
          {/* Bottom: Key insight */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-gray-100 rounded-lg p-3 text-center">
              <p className="text-sm text-gray-700">
                <strong>Key insight:</strong> "Linear model" means <Latex math="y = \sum_j \beta_j f_j(\mathbf{x})" /> 
                for any functions <Latex math="f_j" />. The linearity is in how parameters combine, not in the predictor transformations.
              </p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                   SLIDE 70: GAUSS MARKOV ASSUMPTIONS
// ═══════════════════════════════════════════════════════════════════════

function Slide70_GaussMarkovAssumptions() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-teal-800">Gauss-Markov Assumptions</h1>
            <p className="text-gray-600">The classical conditions for OLS optimality</p>
          </div>
    
          {/* Main content - assumptions */}
          <div className="flex-1 grid grid-cols-2 gap-3">
            {/* GM1: Linearity */}
            <div className="bg-blue-50 border-l-4 border-blue-500 rounded-lg p-3">
              <div className="flex items-center gap-2 mb-2">
                <span className="bg-blue-600 text-white text-xs font-bold px-2 py-0.5 rounded">GM1</span>
                <h3 className="font-semibold text-blue-800">Linearity</h3>
              </div>
              <div className="bg-white rounded p-2 text-center text-sm">
                <Latex math="\mathbf{y} = \mathbf{X}\boldsymbol{\beta} + \boldsymbol{\varepsilon}" />
              </div>
              <p className="text-xs text-gray-600 mt-2">True relationship is linear in parameters</p>
            </div>
    
            {/* GM2: Full Rank */}
            <div className="bg-emerald-50 border-l-4 border-emerald-500 rounded-lg p-3">
              <div className="flex items-center gap-2 mb-2">
                <span className="bg-emerald-600 text-white text-xs font-bold px-2 py-0.5 rounded">GM2</span>
                <h3 className="font-semibold text-emerald-800">Full Rank</h3>
              </div>
              <div className="bg-white rounded p-2 text-center text-sm">
                <Latex math="\text{rank}(\mathbf{X}) = p" />
              </div>
              <p className="text-xs text-gray-600 mt-2">No perfect multicollinearity; <Latex math="\mathbf{X}^\top\mathbf{X}" /> invertible</p>
            </div>
    
            {/* GM3: Exogeneity */}
            <div className="bg-purple-50 border-l-4 border-purple-500 rounded-lg p-3">
              <div className="flex items-center gap-2 mb-2">
                <span className="bg-purple-600 text-white text-xs font-bold px-2 py-0.5 rounded">GM3</span>
                <h3 className="font-semibold text-purple-800">Strict Exogeneity</h3>
              </div>
              <div className="bg-white rounded p-2 text-center text-sm">
                <Latex math="\mathbb{E}[\boldsymbol{\varepsilon} | \mathbf{X}] = \mathbf{0}" />
              </div>
              <p className="text-xs text-gray-600 mt-2">Errors have zero mean given predictors; no omitted confounders</p>
            </div>
    
            {/* GM4: Spherical Errors */}
            <div className="bg-amber-50 border-l-4 border-amber-500 rounded-lg p-3">
              <div className="flex items-center gap-2 mb-2">
                <span className="bg-amber-600 text-white text-xs font-bold px-2 py-0.5 rounded">GM4</span>
                <h3 className="font-semibold text-amber-800">Spherical Errors</h3>
              </div>
              <div className="bg-white rounded p-2 text-center text-sm">
                <Latex math="\text{Var}(\boldsymbol{\varepsilon} | \mathbf{X}) = \sigma^2 \mathbf{I}_n" />
              </div>
              <p className="text-xs text-gray-600 mt-2">Homoskedasticity + no autocorrelation</p>
            </div>
          </div>
    
          {/* GM5: Normality (for inference) */}
          <div className="mt-3">
            <div className="bg-rose-50 border-2 border-rose-300 rounded-lg p-3">
              <div className="flex items-center gap-2 mb-2">
                <span className="bg-rose-600 text-white text-xs font-bold px-2 py-0.5 rounded">GM5</span>
                <h3 className="font-semibold text-rose-800">Normality (for exact inference)</h3>
              </div>
              <div className="flex items-center justify-between">
                <div className="bg-white rounded p-2 text-sm">
                  <Latex math="\boldsymbol{\varepsilon} | \mathbf{X} \sim \mathcal{N}(\mathbf{0}, \sigma^2 \mathbf{I}_n)" />
                </div>
                <p className="text-xs text-gray-600 max-w-xs">Enables exact t-tests and F-tests in finite samples</p>
              </div>
            </div>
          </div>
    
          {/* Bottom: Hierarchy */}
          <div className="flex-shrink-0 mt-3">
            <div className="bg-gray-100 rounded-lg p-3">
              <h4 className="font-semibold text-gray-700 mb-2 text-sm">Assumption Hierarchy</h4>
              <div className="flex items-center justify-between text-xs">
                <div className="flex items-center gap-1">
                  <span className="bg-blue-100 px-2 py-1 rounded">GM1-2</span>
                  <span className="text-gray-500">{"\u2192"}</span>
                  <span className="text-gray-600">OLS well-defined</span>
                </div>
                <div className="flex items-center gap-1">
                  <span className="bg-emerald-100 px-2 py-1 rounded">GM1-4</span>
                  <span className="text-gray-500">{"\u2192"}</span>
                  <span className="text-gray-600">OLS is BLUE</span>
                </div>
                <div className="flex items-center gap-1">
                  <span className="bg-rose-100 px-2 py-1 rounded">GM1-5</span>
                  <span className="text-gray-500">{"\u2192"}</span>
                  <span className="text-gray-600">Exact inference</span>
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                         SLIDE 71: OLS CALCULUS
// ═══════════════════════════════════════════════════════════════════════

function Slide71_OLSCalculus() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-teal-800">OLS: The Calculus Approach</h1>
            <p className="text-gray-600">Minimizing the residual sum of squares</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 space-y-3">
            {/* Step 1: Objective */}
            <div className="bg-blue-50 rounded-lg p-3">
              <div className="flex items-center gap-2 mb-2">
                <span className="bg-blue-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold">1</span>
                <h3 className="font-semibold text-blue-800">Define the Objective</h3>
              </div>
              <div className="bg-white rounded p-3 text-center">
                <Latex math="\text{RSS}(\boldsymbol{\beta}) = \|\mathbf{y} - \mathbf{X}\boldsymbol{\beta}\|^2 = (\mathbf{y} - \mathbf{X}\boldsymbol{\beta})^\top(\mathbf{y} - \mathbf{X}\boldsymbol{\beta})" />
              </div>
            </div>
    
            {/* Step 2: Expand */}
            <div className="bg-emerald-50 rounded-lg p-3">
              <div className="flex items-center gap-2 mb-2">
                <span className="bg-emerald-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold">2</span>
                <h3 className="font-semibold text-emerald-800">Expand the Quadratic</h3>
              </div>
              <div className="bg-white rounded p-3 text-center text-sm">
                <Latex math="\text{RSS} = \mathbf{y}^\top\mathbf{y} - 2\boldsymbol{\beta}^\top\mathbf{X}^\top\mathbf{y} + \boldsymbol{\beta}^\top\mathbf{X}^\top\mathbf{X}\boldsymbol{\beta}" />
              </div>
              <p className="text-xs text-emerald-600 mt-2 text-center">
                Note: <Latex math="\mathbf{y}^\top\mathbf{X}\boldsymbol{\beta} = \boldsymbol{\beta}^\top\mathbf{X}^\top\mathbf{y}" /> (scalar = its transpose)
              </p>
            </div>
    
            {/* Step 3: Differentiate */}
            <div className="bg-amber-50 rounded-lg p-3">
              <div className="flex items-center gap-2 mb-2">
                <span className="bg-amber-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold">3</span>
                <h3 className="font-semibold text-amber-800">Apply Matrix Calculus Rules</h3>
              </div>
              <div className="grid grid-cols-3 gap-2 text-sm">
                <div className="bg-white rounded p-2 text-center">
                  <Latex math="\frac{\partial}{\partial \boldsymbol{\beta}}(\mathbf{y}^\top\mathbf{y}) = \mathbf{0}" />
                  <p className="text-xs text-gray-500 mt-1">constant</p>
                </div>
                <div className="bg-white rounded p-2 text-center">
                  <Latex math="\frac{\partial}{\partial \boldsymbol{\beta}}(2\boldsymbol{\beta}^\top\mathbf{X}^\top\mathbf{y}) = 2\mathbf{X}^\top\mathbf{y}" />
                  <p className="text-xs text-gray-500 mt-1">Rule 1</p>
                </div>
                <div className="bg-white rounded p-2 text-center">
                  <Latex math="\frac{\partial}{\partial \boldsymbol{\beta}}(\boldsymbol{\beta}^\top\mathbf{X}^\top\mathbf{X}\boldsymbol{\beta}) = 2\mathbf{X}^\top\mathbf{X}\boldsymbol{\beta}" />
                  <p className="text-xs text-gray-500 mt-1">Rule 2 (symmetric)</p>
                </div>
              </div>
            </div>
    
            {/* Step 4: Gradient */}
            <div className="bg-purple-50 border-2 border-purple-300 rounded-lg p-3">
              <div className="flex items-center gap-2 mb-2">
                <span className="bg-purple-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold">4</span>
                <h3 className="font-semibold text-purple-800">The Gradient of RSS</h3>
              </div>
              <div className="bg-white rounded p-3 text-center">
                <Latex math="\frac{\partial \text{RSS}}{\partial \boldsymbol{\beta}} = -2\mathbf{X}^\top\mathbf{y} + 2\mathbf{X}^\top\mathbf{X}\boldsymbol{\beta} = 2\mathbf{X}^\top(\mathbf{X}\boldsymbol{\beta} - \mathbf{y})" />
              </div>
            </div>
          </div>
    
          {/* Bottom: Set to zero */}
          <div className="flex-shrink-0 mt-3">
            <div className="bg-gray-100 rounded-lg p-3 flex items-center justify-between">
              <div>
                <p className="text-sm text-gray-700">
                  <strong>Next step:</strong> Set gradient to zero and solve for <Latex math="\hat{\boldsymbol{\beta}}" />
                </p>
              </div>
              <div className="text-2xl">{"\u2192"}</div>
              <div className="bg-white rounded-lg px-4 py-2">
                <Latex math="\mathbf{X}^\top\mathbf{X}\boldsymbol{\beta} = \mathbf{X}^\top\mathbf{y}" />
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                         SLIDE 72: OLS ESTIMATOR
// ═══════════════════════════════════════════════════════════════════════

function Slide72_OLSEstimator() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-teal-800">The OLS Estimator</h1>
            <p className="text-gray-600">Solving the normal equations</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 flex flex-col justify-center space-y-4">
            {/* Normal equations */}
            <div className="bg-blue-50 rounded-lg p-4">
              <h3 className="font-semibold text-blue-800 mb-2">The Normal Equations</h3>
              <p className="text-sm text-gray-600 mb-2">Setting the gradient to zero:</p>
              <div className="bg-white rounded-lg p-4 text-center">
                <Latex math="\mathbf{X}^\top\mathbf{X}\hat{\boldsymbol{\beta}} = \mathbf{X}^\top\mathbf{y}" />
              </div>
            </div>
    
            {/* OLS solution - the big reveal */}
            <div className="bg-emerald-50 border-4 border-emerald-400 rounded-xl p-6">
              <h3 className="font-semibold text-emerald-800 mb-3 text-center">The OLS Estimator</h3>
              <p className="text-sm text-gray-600 mb-3 text-center">
                Under GM2 (<Latex math="\text{rank}(\mathbf{X}) = p" />), multiply both sides by <Latex math="(\mathbf{X}^\top\mathbf{X})^{-1}" />:
              </p>
              <div className="bg-white rounded-lg p-6 text-center">
                <Latex math="\boxed{\hat{\boldsymbol{\beta}} = (\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{X}^\top\mathbf{y}}" />
              </div>
              <p className="text-center text-emerald-700 mt-3 font-medium">
                The central formula of regression analysis
              </p>
            </div>
    
            {/* Verification */}
            <div className="grid grid-cols-2 gap-4">
              <div className="bg-amber-50 rounded-lg p-4">
                <h3 className="font-semibold text-amber-800 mb-2">Verifying the Minimum</h3>
                <p className="text-sm text-gray-600 mb-2">The Hessian is:</p>
                <div className="bg-white rounded p-2 text-center text-sm">
                  <Latex math="\frac{\partial^2 \text{RSS}}{\partial \boldsymbol{\beta} \partial \boldsymbol{\beta}^\top} = 2\mathbf{X}^\top\mathbf{X}" />
                </div>
                <p className="text-xs text-amber-700 mt-2">
                  <Latex math="\mathbf{X}^\top\mathbf{X}" /> is positive semi-definite; positive definite when full rank {"\u2192"} <strong>global minimum</strong>
                </p>
              </div>
    
              <div className="bg-gray-50 rounded-lg p-4">
                <h3 className="font-semibold text-gray-700 mb-2">Dimension Check</h3>
                <div className="space-y-1 text-sm">
                  <div className="flex justify-between">
                    <span><Latex math="(\mathbf{X}^\top\mathbf{X})^{-1}" /></span>
                    <span className="text-gray-500"><Latex math="p \times p" /></span>
                  </div>
                  <div className="flex justify-between">
                    <span><Latex math="\mathbf{X}^\top" /></span>
                    <span className="text-gray-500"><Latex math="p \times n" /></span>
                  </div>
                  <div className="flex justify-between">
                    <span><Latex math="\mathbf{y}" /></span>
                    <span className="text-gray-500"><Latex math="n \times 1" /></span>
                  </div>
                  <div className="flex justify-between border-t pt-1 font-medium">
                    <span><Latex math="\hat{\boldsymbol{\beta}}" /></span>
                    <span className="text-emerald-600"><Latex math="p \times 1" /> {"\u2713"}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom note */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-red-50 border border-red-200 rounded-lg p-3">
              <p className="text-sm text-red-700">
                <strong>Numerical warning:</strong> Never compute <Latex math="(\mathbf{X}^\top\mathbf{X})^{-1}" /> directly in code — 
                use <code className="bg-red-100 px-1 rounded">np.linalg.lstsq()</code> or QR decomposition. We'll see why later.
              </p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                         SLIDE 73: OLS GEOMETRY
// ═══════════════════════════════════════════════════════════════════════

function Slide73_OLSGeometry() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-teal-800">OLS: The Geometric Approach</h1>
            <p className="text-gray-600">Projection onto the column space</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Left: Geometric setup */}
            <div className="space-y-3">
              <div className="bg-blue-50 rounded-lg p-4">
                <h3 className="font-semibold text-blue-800 mb-3">Column Space</h3>
                <div className="bg-white rounded p-3 text-center text-sm mb-2">
                  <Latex math="\mathcal{C}(\mathbf{X}) = \{\mathbf{X}\boldsymbol{\beta} : \boldsymbol{\beta} \in \mathbb{R}^p\}" />
                </div>
                <p className="text-sm text-gray-600">
                  All linear combinations of columns of <Latex math="\mathbf{X}" /> — a <em>p</em>-dimensional subspace of <Latex math="\mathbb{R}^n" />
                </p>
              </div>
    
              <div className="bg-emerald-50 rounded-lg p-4">
                <h3 className="font-semibold text-emerald-800 mb-3">The Model Says</h3>
                <div className="space-y-2 text-sm">
                  <div className="flex items-center gap-2">
                    <span className="text-emerald-600">•</span>
                    <span><Latex math="\mathbb{E}[\mathbf{y}] = \mathbf{X}\boldsymbol{\beta}" /> lies in <Latex math="\mathcal{C}(\mathbf{X})" /></span>
                  </div>
                  <div className="flex items-center gap-2">
                    <span className="text-emerald-600">•</span>
                    <span>Observed <Latex math="\mathbf{y}" /> typically does NOT lie in <Latex math="\mathcal{C}(\mathbf{X})" /></span>
                  </div>
                  <div className="flex items-center gap-2">
                    <span className="text-emerald-600">•</span>
                    <span>OLS finds the <strong>closest point</strong> in <Latex math="\mathcal{C}(\mathbf{X})" /> to <Latex math="\mathbf{y}" /></span>
                  </div>
                </div>
              </div>
    
              <div className="bg-purple-50 border-2 border-purple-300 rounded-lg p-4">
                <h3 className="font-semibold text-purple-800 mb-2">Key Insight</h3>
                <p className="text-sm text-gray-700">
                  The closest point is the <strong>orthogonal projection</strong>. 
                  The residual <Latex math="\mathbf{e} = \mathbf{y} - \hat{\mathbf{y}}" /> must be <strong>perpendicular</strong> to the entire column space.
                </p>
              </div>
            </div>
    
            {/* Right: Textbook Figure */}
            <div className="flex flex-col">
              <div className="flex-1 bg-white rounded-lg p-2 flex flex-col items-center justify-center border border-gray-200">
                <img 
                  src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/PartII/Chapter3/ch3_4_fig01_ols_geometry.png"
                  alt="OLS as orthogonal projection onto the column space C(X)"
                  className="max-w-full max-h-148 object-contain"
                />
                <p className="text-xs text-gray-500 mt-2 text-center italic">
                  Figure 3.4.1: OLS as orthogonal projection
                </p>
              </div>
    
              <div className="mt-3 bg-amber-50 rounded-lg p-3">
                <p className="text-sm text-amber-800 text-center">
                  <Latex math="\mathbf{e} \perp \mathcal{C}(\mathbf{X})" />
                  <br />
                  <span className="text-xs text-gray-600">Residual perpendicular to column space</span>
                </p>
              </div>
            </div>
          </div>
    
          {/* Bottom: Connection */}
          <div className="flex-shrink-0 mt-3">
            <div className="bg-gray-100 rounded-lg p-3 text-center">
              <p className="text-sm text-gray-700">
                <strong>Two derivations, same result:</strong> Calculus (minimize RSS) and geometry (project onto <Latex math="\mathcal{C}(\mathbf{X})" />) both give <Latex math="\hat{\boldsymbol{\beta}} = (\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{X}^\top\mathbf{y}" />
              </p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                         SLIDE 74: ORTHOGONALITY
// ═══════════════════════════════════════════════════════════════════════

function Slide74_Orthogonality() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-teal-800">Orthogonality and Normal Equations</h1>
            <p className="text-gray-600">Why "normal" means perpendicular</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 space-y-4">
            {/* The orthogonality principle */}
            <div className="bg-blue-50 rounded-lg p-4">
              <h3 className="font-semibold text-blue-800 mb-3">The Orthogonality Principle</h3>
              <div className="grid grid-cols-2 gap-4">
                <div>
                  <p className="text-sm text-gray-600 mb-2">The residual must be perpendicular to the column space:</p>
                  <div className="bg-white rounded p-3 text-center">
                    <Latex math="\mathbf{e} = \mathbf{y} - \hat{\mathbf{y}} \perp \mathcal{C}(\mathbf{X})" />
                  </div>
                </div>
                <div>
                  <p className="text-sm text-gray-600 mb-2">This means perpendicular to every vector in <Latex math="\mathcal{C}(\mathbf{X})" />:</p>
                  <div className="bg-white rounded p-3 text-center">
                    <Latex math="(\mathbf{X}\mathbf{a})^\top (\mathbf{y} - \mathbf{X}\hat{\boldsymbol{\beta}}) = 0 \; \text{ for all } \mathbf{a}" />
                  </div>
                </div>
              </div>
            </div>
    
            {/* Derivation */}
            <div className="bg-emerald-50 rounded-lg p-4">
              <h3 className="font-semibold text-emerald-800 mb-3">Deriving the Normal Equations</h3>
              <div className="space-y-2">
                <div className="flex items-center gap-4">
                  <span className="bg-emerald-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-sm">1</span>
                  <div className="bg-white rounded p-2 flex-1 text-center text-sm">
                    <Latex math="\mathbf{a}^\top \mathbf{X}^\top (\mathbf{y} - \mathbf{X}\hat{\boldsymbol{\beta}}) = 0 \quad \text{for all } \mathbf{a} \in \mathbb{R}^p" />
                  </div>
                </div>
                <div className="flex items-center gap-4">
                  <span className="bg-emerald-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-sm">2</span>
                  <div className="flex-1 text-sm text-gray-600">
                    The only way this holds for ALL <Latex math="\mathbf{a}" /> is if:
                  </div>
                </div>
                <div className="flex items-center gap-4">
                  <span className="bg-emerald-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-sm">3</span>
                  <div className="bg-white rounded p-2 flex-1 text-center">
                    <Latex math="\mathbf{X}^\top (\mathbf{y} - \mathbf{X}\hat{\boldsymbol{\beta}}) = \mathbf{0}" />
                  </div>
                </div>
              </div>
            </div>
    
            {/* The result */}
            <div className="grid grid-cols-2 gap-4">
              <div className="bg-purple-50 border-2 border-purple-300 rounded-lg p-4">
                <h3 className="font-semibold text-purple-800 mb-2">Rearranging</h3>
                <div className="bg-white rounded p-3 text-center">
                  <Latex math="\mathbf{X}^\top\mathbf{X}\hat{\boldsymbol{\beta}} = \mathbf{X}^\top\mathbf{y}" />
                </div>
                <p className="text-sm text-purple-700 mt-2 text-center">
                  The normal equations — recovered geometrically!
                </p>
              </div>
    
              <div className="bg-amber-50 border-2 border-amber-300 rounded-lg p-4">
                <h3 className="font-semibold text-amber-800 mb-2">Why "Normal"?</h3>
                <p className="text-sm text-gray-700">
                  The equations express that residuals are <strong>normal</strong> (perpendicular) to the column space.
                </p>
                <div className="bg-white rounded p-2 mt-2 text-center text-sm">
                  <Latex math="\mathbf{X}^\top \mathbf{e} = \mathbf{0}" />
                </div>
                <p className="text-xs text-amber-700 mt-1 text-center">
                  Residuals orthogonal to all columns of X
                </p>
              </div>
            </div>
          </div>
    
          {/* Bottom: Practical implication */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-gray-100 rounded-lg p-3">
              <div className="flex items-center gap-3">
                <span className="text-2xl">💡</span>
                <div>
                  <p className="text-sm text-gray-700">
                    <strong>Practical implication:</strong> <Latex math="\mathbf{X}^\top\mathbf{e} = \mathbf{0}" /> means 
                    OLS residuals are uncorrelated with all predictors (including the intercept column). 
                    This is automatic — no assumption needed.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                          SLIDE 75: HAT MATRIX
// ═══════════════════════════════════════════════════════════════════════

function Slide75_HatMatrix() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-teal-800">The Hat Matrix</h1>
            <p className="text-gray-600">The projection operator that "puts a hat on y"</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Left: Definition */}
            <div className="space-y-3">
              <div className="bg-emerald-50 border-2 border-emerald-300 rounded-lg p-4">
                <h3 className="font-semibold text-emerald-800 mb-2">Definition</h3>
                <div className="bg-white rounded-lg p-4 text-center">
                  <Latex math="\mathbf{H} = \mathbf{X}(\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{X}^\top" />
                </div>
                <p className="text-sm text-emerald-700 mt-2 text-center">
                  Projects <Latex math="\mathbf{y}" /> onto <Latex math="\mathcal{C}(\mathbf{X})" />
                </p>
              </div>
    
              <div className="bg-blue-50 rounded-lg p-4">
                <h3 className="font-semibold text-blue-800 mb-2">Why "Hat" Matrix?</h3>
                <div className="bg-white rounded p-3 text-center">
                  <Latex math="\hat{\mathbf{y}} = \mathbf{H}\mathbf{y}" />
                </div>
                <p className="text-sm text-blue-600 mt-2 text-center">
                  It puts a "hat" on <Latex math="\mathbf{y}" /> to get <Latex math="\hat{\mathbf{y}}" />!
                </p>
              </div>
    
              <div className="bg-purple-50 rounded-lg p-4">
                <h3 className="font-semibold text-purple-800 mb-2">Residual Maker</h3>
                <div className="bg-white rounded p-3 text-center text-sm">
                  <Latex math="\mathbf{M} = \mathbf{I} - \mathbf{H}" />
                </div>
                <div className="bg-white rounded p-2 mt-2 text-center text-sm">
                  <Latex math="\mathbf{e} = \mathbf{M}\mathbf{y} = (\mathbf{I} - \mathbf{H})\mathbf{y}" />
                </div>
                <p className="text-xs text-purple-600 mt-2 text-center">
                  Projects onto orthogonal complement of <Latex math="\mathcal{C}(\mathbf{X})" />
                </p>
              </div>
            </div>
    
            {/* Right: Properties */}
            <div className="space-y-3">
              <div className="bg-amber-50 rounded-lg p-4">
                <h3 className="font-semibold text-amber-800 mb-3">Properties of H</h3>
                <div className="space-y-3">
                  <div className="bg-white rounded p-3">
                    <div className="flex justify-between items-center">
                      <span className="font-medium text-gray-700">Symmetric</span>
                      <Latex math="\mathbf{H}^\top = \mathbf{H}" />
                    </div>
                    <p className="text-xs text-gray-500 mt-1">Proof: transpose the definition</p>
                  </div>
                  
                  <div className="bg-white rounded p-3">
                    <div className="flex justify-between items-center">
                      <span className="font-medium text-gray-700">Idempotent</span>
                      <Latex math="\mathbf{H}^2 = \mathbf{H}" />
                    </div>
                    <p className="text-xs text-gray-500 mt-1">Projecting twice = projecting once</p>
                  </div>
                  
                  <div className="bg-white rounded p-3">
                    <div className="flex justify-between items-center">
                      <span className="font-medium text-gray-700">Trace</span>
                      <Latex math="\text{tr}(\mathbf{H}) = p" />
                    </div>
                    <p className="text-xs text-gray-500 mt-1">Using tr(AB) = tr(BA)</p>
                  </div>
                  
                  <div className="bg-white rounded p-3">
                    <div className="flex justify-between items-center">
                      <span className="font-medium text-gray-700">Diagonal elements</span>
                      <Latex math="h_{ii} \in [1/n, 1]" />
                    </div>
                    <p className="text-xs text-gray-500 mt-1">Leverage values</p>
                  </div>
                </div>
              </div>
    
              <div className="bg-gray-50 rounded-lg p-4">
                <h3 className="font-semibold text-gray-700 mb-2">M has the same properties</h3>
                <div className="grid grid-cols-2 gap-2 text-sm">
                  <div className="bg-white rounded p-2 text-center">
                    <Latex math="\mathbf{M}^\top = \mathbf{M}" />
                  </div>
                  <div className="bg-white rounded p-2 text-center">
                    <Latex math="\mathbf{M}^2 = \mathbf{M}" />
                  </div>
                  <div className="bg-white rounded p-2 text-center col-span-2">
                    <Latex math="\text{tr}(\mathbf{M}) = n - p" />
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom: Key relationship */}
          <div className="flex-shrink-0 mt-3">
            <div className="bg-gray-100 rounded-lg p-3">
              <div className="flex justify-center items-center gap-4 text-sm">
                <div className="bg-white px-3 py-1 rounded">
                  <Latex math="\mathbf{H} + \mathbf{M} = \mathbf{I}" />
                </div>
                <span className="text-gray-500">and</span>
                <div className="bg-white px-3 py-1 rounded">
                  <Latex math="\mathbf{H}\mathbf{M} = \mathbf{0}" />
                </div>
                <span className="text-gray-500">{"\u2192"}</span>
                <span className="text-gray-700">Orthogonal projections</span>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                           SLIDE 76: LEVERAGE
// ═══════════════════════════════════════════════════════════════════════

function Slide76_Leverage() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-teal-800">Leverage</h1>
            <p className="text-gray-600">How much each observation influences its own fitted value</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Left: Definition, formula, why it matters, rules of thumb */}
            <div className="space-y-3">
              <div className="bg-blue-50 rounded-lg p-3">
                <h3 className="font-semibold text-blue-800 mb-2">Definition</h3>
                <div className="bg-white rounded p-2 text-center">
                  <Latex math="h_{ii} = [\mathbf{H}]_{ii}" />
                </div>
                <p className="text-sm text-gray-600 mt-2">
                  The <em>i</em>-th diagonal element of the hat matrix
                </p>
              </div>
    
              <div className="bg-emerald-50 rounded-lg p-3">
                <h3 className="font-semibold text-emerald-800 mb-2">Simple Regression Formula</h3>
                <div className="bg-white rounded p-2 text-center text-sm">
                  <Latex math="h_{ii} = \frac{1}{n} + \frac{(x_i - \bar{x})^2}{\sum_{j=1}^n (x_j - \bar{x})^2}" />
                </div>
                <p className="text-xs text-emerald-700 mt-2">
                  Increases with distance from <Latex math="\bar{x}" /> — U-shaped in <Latex math="x" />
                </p>
              </div>
    
              <div className="bg-purple-50 rounded-lg p-3">
                <h3 className="font-semibold text-purple-800 mb-2">Why It Matters</h3>
                <p className="text-sm text-gray-700">
                  <Latex math="h_{ii}" /> measures how much <Latex math="y_i" /> influences its own fitted value:
                </p>
                <div className="bg-white rounded p-2 mt-2 text-center text-sm">
                  <Latex math="\frac{\partial \hat{y}_i}{\partial y_i} = h_{ii}" />
                </div>
                <p className="text-xs text-purple-700 mt-2">
                  High leverage points can "pull" the regression line toward themselves
                </p>
              </div>
    
              <div className="bg-red-50 border border-red-200 rounded-lg p-3">
                <h3 className="font-semibold text-red-800 mb-1 text-sm">Rules of Thumb</h3>
                <div className="text-sm space-y-1">
                  <p className="text-gray-700">Flag high leverage if:</p>
                  <div className="flex gap-3">
                    <span className="bg-white px-2 py-0.5 rounded text-xs"><Latex math="h_{ii} > 2p/n" /></span>
                    <span className="text-gray-500">or</span>
                    <span className="bg-white px-2 py-0.5 rounded text-xs"><Latex math="h_{ii} > 3p/n" /></span>
                  </div>
                </div>
              </div>
            </div>
    
            {/* Right: Figure and properties */}
            <div className="flex flex-col gap-3">
              <div className="bg-gray-50 rounded-lg p-4 flex-1 flex flex-col">
                <h3 className="font-semibold text-gray-700 mb-2">Intuition</h3>
                <div className="flex-1 flex items-center justify-center">
                  <img 
                    src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/PartII/Chapter3/ch3_4_fig05_leverage.png"
                    alt="Leverage visualization showing points far from x-bar have higher leverage values"
                    className="max-w-full max-h-56 object-contain rounded-lg"
                  />
                </div>
                <p className="text-sm text-gray-600 text-center mt-2">
                  Points far from <Latex math="\bar{x}" /> have higher leverage
                </p>
              </div>
    
              <div className="bg-amber-50 rounded-lg p-3 flex-shrink-0">
                <h3 className="font-semibold text-amber-800 mb-2">Properties</h3>
                <div className="space-y-2 text-sm">
                  <div className="flex justify-between bg-white rounded p-2">
                    <span>Range:</span>
                    <Latex math="h_{ii} \in [1/n, 1]" />
                  </div>
                  <div className="flex justify-between bg-white rounded p-2">
                    <span>Sum:</span>
                    <Latex math="\sum_{i=1}^n h_{ii} = p" />
                  </div>
                  <div className="flex justify-between bg-white rounded p-2">
                    <span>Average:</span>
                    <Latex math="\bar{h} = p/n" />
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom: Important note */}
          <div className="flex-shrink-0 mt-3">
            <div className="bg-gray-100 rounded-lg p-3">
              <p className="text-sm text-gray-700 text-center">
                <strong>Key distinction:</strong> High leverage alone isn't bad — the observation may fit the line well. 
                It's high leverage <em>combined with</em> a large residual that indicates an influential outlier ({"\u2192"} Cook's distance).
              </p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                         SLIDE 77: UNBIASEDNESS
// ═══════════════════════════════════════════════════════════════════════

function Slide77_Unbiasedness() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-teal-800">Unbiasedness of OLS</h1>
            <p className="text-gray-600">OLS hits the target on average</p>
          </div>
    
          {/* Theorem statement */}
          <div className="bg-emerald-50 border-2 border-emerald-300 rounded-lg p-4 mb-4">
            <h3 className="font-semibold text-emerald-800 mb-2">Theorem</h3>
            <div className="flex items-center gap-4">
              <div className="text-sm text-gray-600">Under GM1-GM3:</div>
              <div className="bg-white rounded-lg px-4 py-2">
                <Latex math="\mathbb{E}[\hat{\boldsymbol{\beta}} | \mathbf{X}] = \boldsymbol{\beta}" />
              </div>
            </div>
          </div>
    
          {/* Proof */}
          <div className="flex-1 bg-blue-50 rounded-lg p-4">
            <h3 className="font-semibold text-blue-800 mb-3">Proof</h3>
            <div className="space-y-3">
              {/* Step 1 */}
              <div className="flex items-start gap-3">
                <span className="bg-blue-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-sm flex-shrink-0">1</span>
                <div className="bg-white rounded p-3 flex-1">
                  <p className="text-sm text-gray-600 mb-1">Start with OLS and substitute <Latex math="\mathbf{y} = \mathbf{X}\boldsymbol{\beta} + \boldsymbol{\varepsilon}" />:</p>
                  <div className="text-center">
                    <Latex math="\hat{\boldsymbol{\beta}} = (\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{X}^\top\mathbf{y} = (\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{X}^\top(\mathbf{X}\boldsymbol{\beta} + \boldsymbol{\varepsilon})" />
                  </div>
                </div>
              </div>
    
              {/* Step 2 */}
              <div className="flex items-start gap-3">
                <span className="bg-blue-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-sm flex-shrink-0">2</span>
                <div className="bg-white rounded p-3 flex-1">
                  <p className="text-sm text-gray-600 mb-1">Distribute:</p>
                  <div className="text-center">
                    <Latex math="\hat{\boldsymbol{\beta}} = \underbrace{(\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{X}^\top\mathbf{X}}_{= \mathbf{I}_p}\boldsymbol{\beta} + (\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{X}^\top\boldsymbol{\varepsilon}" />
                  </div>
                </div>
              </div>
    
              {/* Step 3 */}
              <div className="flex items-start gap-3">
                <span className="bg-blue-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-sm flex-shrink-0">3</span>
                <div className="bg-white rounded p-3 flex-1">
                  <p className="text-sm text-gray-600 mb-1">Simplify:</p>
                  <div className="text-center">
                    <Latex math="\hat{\boldsymbol{\beta}} = \boldsymbol{\beta} + (\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{X}^\top\boldsymbol{\varepsilon}" />
                  </div>
                </div>
              </div>
    
              {/* Step 4 */}
              <div className="flex items-start gap-3">
                <span className="bg-blue-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-sm flex-shrink-0">4</span>
                <div className="bg-white rounded p-3 flex-1">
                  <p className="text-sm text-gray-600 mb-1">Take expectation conditional on <Latex math="\mathbf{X}" />, using GM3 (<Latex math="\mathbb{E}[\boldsymbol{\varepsilon}|\mathbf{X}] = \mathbf{0}" />):</p>
                  <div className="text-center">
                    <Latex math="\mathbb{E}[\hat{\boldsymbol{\beta}}|\mathbf{X}] = \boldsymbol{\beta} + (\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{X}^\top \cdot \mathbf{0} = \boldsymbol{\beta}" />
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom: Key insight */}
          <div className="flex-shrink-0 mt-4">
            <div className="grid grid-cols-2 gap-4">
              <div className="bg-gray-100 rounded-lg p-3">
                <h4 className="font-semibold text-gray-700 mb-1 text-sm">Assumptions Used</h4>
                <p className="text-xs text-gray-600">
                  Only GM1-GM3 (linearity, full rank, exogeneity). 
                  <strong>Not</strong> homoskedasticity or normality!
                </p>
              </div>
              <div className="bg-amber-50 rounded-lg p-3">
                <h4 className="font-semibold text-amber-800 mb-1 text-sm">Key Formula</h4>
                <div className="text-center text-sm">
                  <Latex math="\hat{\boldsymbol{\beta}} = \boldsymbol{\beta} + (\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{X}^\top\boldsymbol{\varepsilon}" />
                </div>
                <p className="text-xs text-amber-700 mt-1 text-center">Estimator = truth + noise term</p>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                         SLIDE 78: VARIANCE OLS
// ═══════════════════════════════════════════════════════════════════════

function Slide78_VarianceOLS() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-teal-800">Variance of OLS Estimator</h1>
            <p className="text-gray-600">Quantifying the uncertainty in our estimates</p>
          </div>
    
          {/* Theorem */}
          <div className="bg-emerald-50 border-2 border-emerald-300 rounded-lg p-4 mb-4">
            <h3 className="font-semibold text-emerald-800 mb-2">Theorem</h3>
            <div className="flex items-center gap-4">
              <div className="text-sm text-gray-600">Under GM1-GM4:</div>
              <div className="bg-white rounded-lg px-4 py-2">
                <Latex math="\text{Var}(\hat{\boldsymbol{\beta}} | \mathbf{X}) = \sigma^2 (\mathbf{X}^\top\mathbf{X})^{-1}" />
              </div>
            </div>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Left: Proof */}
            <div className="bg-blue-50 rounded-lg p-4">
              <h3 className="font-semibold text-blue-800 mb-3">Proof</h3>
              <div className="space-y-2 text-sm">
                <div className="bg-white rounded p-2">
                  <p className="text-gray-600 mb-1">From the unbiasedness proof:</p>
                  <Latex math="\hat{\boldsymbol{\beta}} - \boldsymbol{\beta} = (\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{X}^\top\boldsymbol{\varepsilon}" />
                </div>
                
                <div className="bg-white rounded p-2">
                  <p className="text-gray-600 mb-1">Let <Latex math="\mathbf{A} = (\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{X}^\top" />. Then:</p>
                  <Latex math="\text{Var}(\hat{\boldsymbol{\beta}}|\mathbf{X}) = \mathbf{A}\,\text{Var}(\boldsymbol{\varepsilon}|\mathbf{X})\,\mathbf{A}^\top" />
                </div>
                
                <div className="bg-white rounded p-2">
                  <p className="text-gray-600 mb-1">Using GM4 (<Latex math="\text{Var}(\boldsymbol{\varepsilon}|\mathbf{X}) = \sigma^2\mathbf{I}" />):</p>
                  <Latex math="= \sigma^2 \mathbf{A}\mathbf{A}^\top" />
                </div>
                
                <div className="bg-white rounded p-2">
                  <p className="text-gray-600 mb-1">Compute <Latex math="\mathbf{A}\mathbf{A}^\top" />:</p>
                  <Latex math="= (\mathbf{X}^\top\mathbf{X})^{-1}" />
                </div>
              </div>
            </div>
    
            {/* Right: Interpretation */}
            <div className="space-y-3">
              <div className="bg-amber-50 rounded-lg p-4">
                <h3 className="font-semibold text-amber-800 mb-2">Variance of Individual Coefficients</h3>
                <div className="bg-white rounded p-3 text-center">
                  <Latex math="\text{Var}(\hat{\beta}_j | \mathbf{X}) = \sigma^2 [(\mathbf{X}^\top\mathbf{X})^{-1}]_{jj}" />
                </div>
                <p className="text-sm text-gray-600 mt-2">
                  The <em>j</em>-th diagonal element of the covariance matrix
                </p>
              </div>
    
              <div className="bg-purple-50 rounded-lg p-4">
                <h3 className="font-semibold text-purple-800 mb-2">Standard Error</h3>
                <div className="bg-white rounded p-3 text-center">
                  <Latex math="\text{SE}(\hat{\beta}_j) = \sigma \sqrt{[(\mathbf{X}^\top\mathbf{X})^{-1}]_{jj}}" />
                </div>
                <p className="text-sm text-gray-600 mt-2">
                  In practice, replace <Latex math="\sigma" /> with <Latex math="s" /> (estimated)
                </p>
              </div>
    
              <div className="bg-gray-50 rounded-lg p-4">
                <h3 className="font-semibold text-gray-700 mb-2">What Determines Precision?</h3>
                <ul className="text-sm text-gray-600 space-y-1">
                  <li>• <strong>Larger <Latex math="\sigma^2" /></strong>: More noise {"\u2192"} larger variance</li>
                  <li>• <strong>Larger <Latex math="\mathbf{X}^\top\mathbf{X}" /></strong>: More spread in predictors {"\u2192"} smaller variance</li>
                  <li>• <strong>Correlated predictors</strong>: Inflates <Latex math="(\mathbf{X}^\top\mathbf{X})^{-1}" /> {"\u2192"} larger variance</li>
                </ul>
              </div>
            </div>
          </div>
    
          {/* Bottom */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-gray-100 rounded-lg p-3">
              <div className="flex items-center justify-between">
                <div>
                  <p className="text-sm text-gray-700">
                    <strong>New assumption used:</strong> GM4 (spherical errors). Without it, we'd need robust standard errors.
                  </p>
                </div>
                <div className="bg-white rounded-lg px-4 py-2 text-sm">
                  <Latex math="\widehat{\text{Var}}(\hat{\boldsymbol{\beta}}) = s^2 (\mathbf{X}^\top\mathbf{X})^{-1}" />
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                     SLIDE 79: GAUSS MARKOV THEOREM
// ═══════════════════════════════════════════════════════════════════════

function Slide79_GaussMarkovTheorem() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-teal-800">The Gauss-Markov Theorem</h1>
            <p className="text-gray-600">OLS is the Best Linear Unbiased Estimator (BLUE)</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Left: BLUE explained */}
            <div className="space-y-3">
              <div className="bg-blue-50 rounded-lg p-4">
                <h3 className="font-semibold text-blue-800 mb-3">What BLUE Means</h3>
                <div className="space-y-2">
                  <div className="flex items-start gap-2">
                    <span className="bg-blue-600 text-white text-xs font-bold px-2 py-0.5 rounded">B</span>
                    <div>
                      <p className="font-medium text-gray-700">Best</p>
                      <p className="text-xs text-gray-500">Minimum variance</p>
                    </div>
                  </div>
                  <div className="flex items-start gap-2">
                    <span className="bg-blue-600 text-white text-xs font-bold px-2 py-0.5 rounded">L</span>
                    <div>
                      <p className="font-medium text-gray-700">Linear</p>
                      <p className="text-xs text-gray-500"><Latex math="\tilde{\boldsymbol{\beta}} = \mathbf{C}\mathbf{y}" /> for some matrix <Latex math="\mathbf{C}" /></p>
                    </div>
                  </div>
                  <div className="flex items-start gap-2">
                    <span className="bg-blue-600 text-white text-xs font-bold px-2 py-0.5 rounded">U</span>
                    <div>
                      <p className="font-medium text-gray-700">Unbiased</p>
                      <p className="text-xs text-gray-500"><Latex math="\mathbb{E}[\tilde{\boldsymbol{\beta}}] = \boldsymbol{\beta}" /></p>
                    </div>
                  </div>
                  <div className="flex items-start gap-2">
                    <span className="bg-blue-600 text-white text-xs font-bold px-2 py-0.5 rounded">E</span>
                    <div>
                      <p className="font-medium text-gray-700">Estimator</p>
                      <p className="text-xs text-gray-500">Function of the data</p>
                    </div>
                  </div>
                </div>
              </div>
    
              <div className="bg-gray-50 rounded-lg p-4">
                <h3 className="font-semibold text-gray-700 mb-2">Why Linear Estimators?</h3>
                <ul className="text-sm text-gray-600 space-y-1">
                  <li>• <strong>Tractable</strong>: Easy variance formulas</li>
                  <li>• <strong>Robust</strong>: Don't require exact distributions</li>
                  <li>• <strong>Sufficient</strong>: For normal errors, best overall IS linear</li>
                </ul>
              </div>
            </div>
    
            {/* Right: Theorem statement */}
            <div className="space-y-3">
              <div className="bg-emerald-50 border-2 border-emerald-400 rounded-lg p-4">
                <h3 className="font-semibold text-emerald-800 mb-3">Theorem Statement</h3>
                <div className="bg-white rounded p-3 text-sm mb-3">
                  <p className="text-gray-700 mb-2">
                    Under GM1-GM4, for any linear unbiased estimator <Latex math="\tilde{\boldsymbol{\beta}} = \mathbf{C}\mathbf{y}" />:
                  </p>
                  <div className="text-center">
                    <Latex math="\text{Var}(\tilde{\boldsymbol{\beta}}) - \text{Var}(\hat{\boldsymbol{\beta}}) \succeq \mathbf{0}" />
                  </div>
                </div>
                <p className="text-sm text-emerald-700">
                  The difference is positive semi-definite: OLS has the smallest variance.
                </p>
              </div>
    
              <div className="bg-amber-50 rounded-lg p-4">
                <h3 className="font-semibold text-amber-800 mb-2">What This Means</h3>
                <div className="space-y-2 text-sm">
                  <div className="bg-white rounded p-2">
                    <p className="text-gray-700">For each coefficient:</p>
                    <div className="text-center mt-1">
                      <Latex math="\text{Var}(\tilde{\beta}_j) \geq \text{Var}(\hat{\beta}_j)" />
                    </div>
                  </div>
                  <div className="bg-white rounded p-2">
                    <p className="text-gray-700">For any linear combination <Latex math="\mathbf{c}^\top\boldsymbol{\beta}" />:</p>
                    <div className="text-center mt-1">
                      <Latex math="\text{Var}(\mathbf{c}^\top\tilde{\boldsymbol{\beta}}) \geq \text{Var}(\mathbf{c}^\top\hat{\boldsymbol{\beta}})" />
                    </div>
                  </div>
                </div>
              </div>
    
              <div className="bg-purple-50 rounded-lg p-3">
                <p className="text-sm text-purple-800">
                  <strong>Equality holds</strong> if and only if <Latex math="\tilde{\boldsymbol{\beta}} = \hat{\boldsymbol{\beta}}" />
                </p>
              </div>
            </div>
          </div>
    
          {/* Bottom: Historical note */}
          <div className="flex-shrink-0 mt-3">
            <div className="bg-gray-100 rounded-lg p-3">
              <p className="text-sm text-gray-700">
                <strong>Historical note:</strong> Gauss proved this in 1821 without assuming normality. 
                Markov rediscovered it in 1900. The theorem shows OLS optimality comes from 
                <em>spherical errors</em> (GM4), not normality.
              </p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                      SLIDE 80: GAUSS MARKOV PROOF
// ═══════════════════════════════════════════════════════════════════════

function Slide80_GaussMarkovProof() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-teal-800">Gauss-Markov: The Proof</h1>
            <p className="text-gray-600">Why OLS achieves minimum variance</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 space-y-3">
            {/* Step 1 */}
            <div className="bg-blue-50 rounded-lg p-3">
              <div className="flex items-start gap-3">
                <span className="bg-blue-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-sm flex-shrink-0">1</span>
                <div className="flex-1">
                  <h4 className="font-semibold text-blue-800 mb-1">Characterize linear unbiased estimators</h4>
                  <div className="grid grid-cols-2 gap-2 text-sm">
                    <div className="bg-white rounded p-2">
                      <p className="text-gray-600">Any linear estimator:</p>
                      <Latex math="\tilde{\boldsymbol{\beta}} = \mathbf{C}\mathbf{y}" />
                    </div>
                    <div className="bg-white rounded p-2">
                      <p className="text-gray-600">Unbiasedness requires:</p>
                      <Latex math="\mathbf{C}\mathbf{X} = \mathbf{I}_p" />
                    </div>
                  </div>
                </div>
              </div>
            </div>
    
            {/* Step 2 */}
            <div className="bg-emerald-50 rounded-lg p-3">
              <div className="flex items-start gap-3">
                <span className="bg-emerald-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-sm flex-shrink-0">2</span>
                <div className="flex-1">
                  <h4 className="font-semibold text-emerald-800 mb-1">Decompose: any alternative = OLS + difference</h4>
                  <div className="bg-white rounded p-2 text-sm">
                    <p className="text-gray-600 mb-1">Let <Latex math="\mathbf{A} = (\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{X}^\top" /> (OLS matrix), and <Latex math="\mathbf{D} = \mathbf{C} - \mathbf{A}" /></p>
                    <p className="text-gray-600">Since both satisfy <Latex math="\mathbf{C}\mathbf{X} = \mathbf{A}\mathbf{X} = \mathbf{I}" />:</p>
                    <div className="text-center mt-1">
                      <Latex math="\mathbf{D}\mathbf{X} = \mathbf{0}" />
                    </div>
                  </div>
                </div>
              </div>
            </div>
    
            {/* Step 3 */}
            <div className="bg-amber-50 rounded-lg p-3">
              <div className="flex items-start gap-3">
                <span className="bg-amber-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-sm flex-shrink-0">3</span>
                <div className="flex-1">
                  <h4 className="font-semibold text-amber-800 mb-1">Compute variance and show cross-terms vanish</h4>
                  <div className="bg-white rounded p-2 text-sm">
                    <Latex math="\text{Var}(\tilde{\boldsymbol{\beta}}) = \sigma^2(\mathbf{A} + \mathbf{D})(\mathbf{A} + \mathbf{D})^\top = \sigma^2(\mathbf{A}\mathbf{A}^\top + \mathbf{A}\mathbf{D}^\top + \mathbf{D}\mathbf{A}^\top + \mathbf{D}\mathbf{D}^\top)" />
                    <p className="text-gray-600 mt-2">
                      But <Latex math="\mathbf{D}\mathbf{X} = \mathbf{0}" /> implies <Latex math="\mathbf{X}^\top\mathbf{D}^\top = \mathbf{0}" />, so:
                    </p>
                    <div className="text-center mt-1">
                      <Latex math="\mathbf{A}\mathbf{D}^\top = (\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{X}^\top\mathbf{D}^\top = \mathbf{0}" />
                    </div>
                  </div>
                </div>
              </div>
            </div>
    
            {/* Step 4 - Conclusion */}
            <div className="bg-purple-50 border-2 border-purple-300 rounded-lg p-3">
              <div className="flex items-start gap-3">
                <span className="bg-purple-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-sm flex-shrink-0">4</span>
                <div className="flex-1">
                  <h4 className="font-semibold text-purple-800 mb-1">Conclude</h4>
                  <div className="bg-white rounded p-3 text-center">
                    <Latex math="\text{Var}(\tilde{\boldsymbol{\beta}}) = \underbrace{\sigma^2\mathbf{A}\mathbf{A}^\top}_{= \text{Var}(\hat{\boldsymbol{\beta}})} + \underbrace{\sigma^2\mathbf{D}\mathbf{D}^\top}_{\succeq \mathbf{0}}" />
                  </div>
                  <p className="text-sm text-purple-700 mt-2">
                    Since <Latex math="\mathbf{D}\mathbf{D}^\top" /> is positive semi-definite: <Latex math="\text{Var}(\tilde{\boldsymbol{\beta}}) \succeq \text{Var}(\hat{\boldsymbol{\beta}})" />
                  </p>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom: Key insight */}
          <div className="flex-shrink-0 mt-3">
            <div className="bg-gray-100 rounded-lg p-3">
              <p className="text-sm text-gray-700 text-center">
                <strong>Key insight:</strong> Any deviation <Latex math="\mathbf{D}" /> from OLS that preserves unbiasedness 
                (<Latex math="\mathbf{D}\mathbf{X} = \mathbf{0}" />) can only <em>add</em> variance (<Latex math="\mathbf{D}\mathbf{D}^\top \succeq \mathbf{0}" />).
              </p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                      SLIDE 81: ASSUMPTION FAILURES
// ═══════════════════════════════════════════════════════════════════════

function Slide81_AssumptionFailures() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-teal-800">When Assumptions Fail</h1>
            <p className="text-gray-600">Consequences and remedies for each violation</p>
          </div>
    
          {/* Main table */}
          <div className="flex-1 overflow-auto">
            <table className="w-full text-sm">
              <thead className="bg-gray-100">
                <tr>
                  <th className="px-2 py-2 text-left font-semibold text-gray-700 border-b">Assumption</th>
                  <th className="px-2 py-2 text-left font-semibold text-gray-700 border-b">Violation</th>
                  <th className="px-2 py-2 text-left font-semibold text-gray-700 border-b">Consequence</th>
                  <th className="px-2 py-2 text-left font-semibold text-gray-700 border-b">Remedy</th>
                </tr>
              </thead>
              <tbody>
                <tr className="bg-blue-50/50">
                  <td className="px-2 py-2 border-b font-medium">
                    <span className="bg-blue-600 text-white text-xs px-1.5 py-0.5 rounded mr-1">GM1</span>
                    Linearity
                  </td>
                  <td className="px-2 py-2 border-b text-xs">
                    True model nonlinear in <Latex math="\boldsymbol{\beta}" />
                  </td>
                  <td className="px-2 py-2 border-b text-xs text-red-700">
                    <strong>Biased</strong> + inconsistent
                  </td>
                  <td className="px-2 py-2 border-b text-xs">
                    Transform predictors, nonlinear models
                  </td>
                </tr>
                <tr>
                  <td className="px-2 py-2 border-b font-medium">
                    <span className="bg-emerald-600 text-white text-xs px-1.5 py-0.5 rounded mr-1">GM2</span>
                    Full Rank
                  </td>
                  <td className="px-2 py-2 border-b text-xs">
                    Perfect multicollinearity
                  </td>
                  <td className="px-2 py-2 border-b text-xs text-red-700">
                    <Latex math="(\mathbf{X}^\top\mathbf{X})^{-1}" /> doesn't exist
                  </td>
                  <td className="px-2 py-2 border-b text-xs">
                    Drop redundant predictors, ridge regression
                  </td>
                </tr>
                <tr className="bg-red-50">
                  <td className="px-2 py-2 border-b font-medium">
                    <span className="bg-purple-600 text-white text-xs px-1.5 py-0.5 rounded mr-1">GM3</span>
                    Exogeneity
                  </td>
                  <td className="px-2 py-2 border-b text-xs">
                    Omitted confounders, reverse causation
                  </td>
                  <td className="px-2 py-2 border-b text-xs text-red-700">
                    <strong>Biased</strong> + inconsistent
                  </td>
                  <td className="px-2 py-2 border-b text-xs">
                    IV, fixed effects, natural experiments
                  </td>
                </tr>
                <tr className="bg-amber-50/50">
                  <td className="px-2 py-2 border-b font-medium">
                    <span className="bg-amber-600 text-white text-xs px-1.5 py-0.5 rounded mr-1">GM4a</span>
                    Homoskedasticity
                  </td>
                  <td className="px-2 py-2 border-b text-xs">
                    <Latex math="\text{Var}(\varepsilon_i)" /> varies with <Latex math="x" />
                  </td>
                  <td className="px-2 py-2 border-b text-xs text-amber-700">
                    Unbiased but <strong>SEs wrong</strong>
                  </td>
                  <td className="px-2 py-2 border-b text-xs">
                    WLS, robust (sandwich) SEs
                  </td>
                </tr>
                <tr className="bg-amber-50/50">
                  <td className="px-2 py-2 font-medium">
                    <span className="bg-amber-600 text-white text-xs px-1.5 py-0.5 rounded mr-1">GM4b</span>
                    No autocorrelation
                  </td>
                  <td className="px-2 py-2 text-xs">
                    <Latex math="\varepsilon_t" /> correlated over time
                  </td>
                  <td className="px-2 py-2 text-xs text-amber-700">
                    Unbiased but <strong>SEs wrong</strong>
                  </td>
                  <td className="px-2 py-2 text-xs">
                    GLS, Newey-West SEs, time series models
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
    
          {/* Bottom: Critical warning */}
          <div className="flex-shrink-0 mt-3">
            <div className="bg-red-50 border-2 border-red-300 rounded-lg p-3">
              <div className="flex items-start gap-3">
                <span className="text-2xl">⚠️</span>
                <div>
                  <h4 className="font-semibold text-red-800 mb-1">Critical: Robust SEs Don't Fix Bias</h4>
                  <p className="text-sm text-red-700">
                    When GM3 fails (endogeneity), OLS <Latex math="\hat{\boldsymbol{\beta}}" /> is <strong>biased</strong>. 
                    Robust standard errors correct for heteroskedasticity, not bias. 
                    Having precise standard errors for a wrong estimate doesn't help!
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                       SLIDE 82: ESTIMATING SIGMA
// ═══════════════════════════════════════════════════════════════════════

function Slide82_EstimatingSigma() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-teal-800">Estimating the Error Variance</h1>
            <p className="text-gray-600">From RSS to unbiased variance estimate</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Left: The problem */}
            <div className="space-y-3">
              <div className="bg-blue-50 rounded-lg p-4">
                <h3 className="font-semibold text-blue-800 mb-2">Residual Sum of Squares</h3>
                <div className="bg-white rounded p-3 text-center">
                  <Latex math="\text{RSS} = \mathbf{e}^\top\mathbf{e} = \sum_{i=1}^n (y_i - \hat{y}_i)^2" />
                </div>
              </div>
    
              <div className="bg-red-50 border border-red-200 rounded-lg p-4">
                <h3 className="font-semibold text-red-800 mb-2">Why RSS/n is Biased</h3>
                <p className="text-sm text-gray-700 mb-2">
                  Residuals <Latex math="e_i" /> underestimate true errors <Latex math="\varepsilon_i" /> because
                  OLS is chosen to make residuals small.
                </p>
                <div className="bg-white rounded p-2 text-center text-sm">
                  <Latex math="\mathbb{E}[\text{RSS}/n] < \sigma^2" />
                </div>
                <p className="text-xs text-red-600 mt-2">Systematically underestimates</p>
              </div>
    
              <div className="bg-gray-50 rounded-lg p-4">
                <h3 className="font-semibold text-gray-700 mb-2">Degrees of Freedom Intuition</h3>
                <div className="flex items-center justify-between text-sm">
                  <div className="text-center">
                    <div className="text-2xl font-bold text-gray-800">n</div>
                    <div className="text-xs text-gray-500">observations</div>
                  </div>
                  <div className="text-2xl text-gray-400">-</div>
                  <div className="text-center">
                    <div className="text-2xl font-bold text-blue-600">p</div>
                    <div className="text-xs text-gray-500">parameters</div>
                  </div>
                  <div className="text-2xl text-gray-400">=</div>
                  <div className="text-center">
                    <div className="text-2xl font-bold text-emerald-600">n-p</div>
                    <div className="text-xs text-gray-500">df for error</div>
                  </div>
                </div>
              </div>
            </div>
    
            {/* Right: The solution */}
            <div className="space-y-3">
              <div className="bg-emerald-50 border-2 border-emerald-300 rounded-lg p-4">
                <h3 className="font-semibold text-emerald-800 mb-2">Unbiased Estimator</h3>
                <div className="bg-white rounded-lg p-4 text-center">
                  <Latex math="s^2 = \frac{\text{RSS}}{n - p} = \frac{\mathbf{e}^\top\mathbf{e}}{n - p}" />
                </div>
                <div className="bg-white rounded p-2 mt-3 text-center text-sm">
                  <Latex math="\mathbb{E}[s^2] = \sigma^2" />
                </div>
              </div>
    
              <div className="bg-amber-50 rounded-lg p-4">
                <h3 className="font-semibold text-amber-800 mb-2">Proof Sketch</h3>
                <div className="space-y-2 text-sm">
                  <p className="text-gray-600">Write residuals using the residual maker:</p>
                  <div className="bg-white rounded p-2 text-center">
                    <Latex math="\mathbf{e} = \mathbf{M}\boldsymbol{\varepsilon}" />
                  </div>
                  <p className="text-gray-600">Use trace formula for quadratic forms:</p>
                  <div className="bg-white rounded p-2 text-center">
                    <Latex math="\mathbb{E}[\text{RSS}] = \sigma^2 \text{tr}(\mathbf{M}) = \sigma^2(n-p)" />
                  </div>
                </div>
              </div>
    
              <div className="bg-purple-50 rounded-lg p-4">
                <h3 className="font-semibold text-purple-800 mb-2">Residual Standard Error</h3>
                <div className="bg-white rounded p-3 text-center">
                  <Latex math="s = \sqrt{s^2} = \sqrt{\frac{\text{RSS}}{n-p}}" />
                </div>
                <p className="text-xs text-purple-600 mt-2 text-center">
                  This is what software reports as "Residual standard error"
                </p>
              </div>
            </div>
          </div>
    
          {/* Bottom */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-gray-100 rounded-lg p-3">
              <p className="text-sm text-gray-700 text-center">
                <strong>Now we can estimate standard errors:</strong> <Latex math="\widehat{\text{Var}}(\hat{\boldsymbol{\beta}}) = s^2 (\mathbf{X}^\top\mathbf{X})^{-1}" />
              </p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                        SLIDE 83: STANDARD ERRORS
// ═══════════════════════════════════════════════════════════════════════

function Slide83_StandardErrors() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-teal-800">Standard Errors of Coefficients</h1>
            <p className="text-gray-600">Quantifying uncertainty in each estimate</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-6">
            {/* Left: Formulas */}
            <div className="space-y-4">
              <div className="bg-blue-50 rounded-lg p-4">
                <h3 className="font-semibold text-blue-800 mb-3">Estimated Covariance Matrix</h3>
                <div className="bg-white rounded-lg p-4 text-center">
                  <Latex math="\widehat{\text{Var}}(\hat{\boldsymbol{\beta}}) = s^2 (\mathbf{X}^\top\mathbf{X})^{-1}" />
                </div>
              </div>
    
              <div className="bg-emerald-50 border-2 border-emerald-300 rounded-lg p-4">
                <h3 className="font-semibold text-emerald-800 mb-3">Standard Error Formula</h3>
                <div className="bg-white rounded-lg p-4 text-center">
                  <Latex math="\text{SE}(\hat{\beta}_j) = s \sqrt{[(\mathbf{X}^\top\mathbf{X})^{-1}]_{jj}}" />
                </div>
                <p className="text-sm text-emerald-700 mt-2 text-center">
                  Square root of <em>j</em>-th diagonal element
                </p>
              </div>
    
              <div className="bg-gray-50 rounded-lg p-4">
                <h3 className="font-semibold text-gray-700 mb-2">Interpretation</h3>
                <p className="text-sm text-gray-600">
                  SE measures the typical magnitude of estimation error. 
                  Under normality, <Latex math="\hat{\beta}_j \pm 2 \cdot \text{SE}" /> covers the true <Latex math="\beta_j" /> about 95% of the time.
                </p>
              </div>
            </div>
    
            {/* Right: Factors affecting SE and VIF */}
            <div className="space-y-3">
              <div className="bg-amber-50 rounded-lg p-4">
                <h3 className="font-semibold text-amber-800 mb-3">What Affects Standard Errors?</h3>
                <div className="space-y-2">
                  <div className="bg-white rounded p-3 flex items-center justify-between">
                    <span className="text-sm text-gray-700">More noise (<Latex math="\sigma^2 \uparrow" />)</span>
                    <span className="text-red-600 font-semibold">SE {"\u2191"}</span>
                  </div>
                  <div className="bg-white rounded p-3 flex items-center justify-between">
                    <span className="text-sm text-gray-700">More data (<Latex math="n \uparrow" />)</span>
                    <span className="text-emerald-600 font-semibold">SE {"\u2193"}</span>
                  </div>
                  <div className="bg-white rounded p-3 flex items-center justify-between">
                    <span className="text-sm text-gray-700">More spread in <Latex math="x_j" /></span>
                    <span className="text-emerald-600 font-semibold">SE {"\u2193"}</span>
                  </div>
                  <div className="bg-white rounded p-3 flex items-center justify-between">
                    <span className="text-sm text-gray-700">Correlated predictors</span>
                    <span className="text-red-600 font-semibold">SE {"\u2191"}</span>
                  </div>
                </div>
              </div>
    
              <div className="bg-purple-50 border-2 border-purple-300 rounded-lg p-4">
                <h3 className="font-semibold text-purple-800 mb-2">Variance Inflation Factor (VIF)</h3>
                <div className="bg-white rounded-lg p-3 text-center mb-2">
                  <Latex math="\text{VIF}_j = \frac{1}{1 - R_j^2}" />
                </div>
                <p className="text-xs text-purple-700 mb-2">
                  where <Latex math="R_j^2" /> = R-squared from regressing <Latex math="x_j" /> on all other predictors
                </p>
                <div className="bg-purple-100 rounded p-2 text-sm">
                  <Latex math="\text{SE}(\hat{\beta}_j) = \frac{s}{\sqrt{\sum(x_{ij} - \bar{x}_j)^2}} \cdot \sqrt{\text{VIF}_j}" />
                </div>
                <div className="mt-2 text-xs text-gray-600 space-y-1">
                  <p><strong>VIF = 1:</strong> No collinearity</p>
                  <p><strong>VIF {"\u003E"} 5:</strong> Moderate concern</p>
                  <p><strong>VIF {"\u003E"} 10:</strong> Severe multicollinearity</p>
                </div>
              </div>
    
              <div className="bg-gray-50 rounded-lg p-3">
                <h3 className="font-semibold text-gray-700 mb-2 text-sm">Quick Check in Python</h3>
                <code className="text-xs text-gray-600 block">
                  model.bse  # Standard errors<br/>
                  variance_inflation_factor(X, j)  # VIF
                </code>
              </div>
            </div>
          </div>
    
          {/* Bottom: Connection to inference */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-blue-50 rounded-lg p-3">
              <div className="flex items-center justify-center gap-8 text-sm">
                <div className="text-center">
                  <p className="text-gray-600 mb-1">95% Confidence Interval</p>
                  <div className="bg-white rounded px-3 py-1">
                    <Latex math="\hat{\beta}_j \pm t_{n-p,\, 0.975} \cdot \text{SE}(\hat{\beta}_j)" />
                  </div>
                </div>
                <div className="text-2xl text-gray-400">{"\u2192"}</div>
                <div className="text-center">
                  <p className="text-gray-600 mb-1">t-statistic</p>
                  <div className="bg-white rounded px-3 py-1">
                    <Latex math="t = \frac{\hat{\beta}_j - \beta_{j,0}}{\text{SE}(\hat{\beta}_j)}" />
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                    SLIDE 84: DISTRIBUTIONAL RESULTS
// ═══════════════════════════════════════════════════════════════════════

function Slide84_DistributionalResults() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-teal-800">Distributional Results Under Normality</h1>
            <p className="text-gray-600">GM1-GM5: Exact finite-sample distributions</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 space-y-4">
            {/* Result 1: Normality of beta-hat */}
            <div className="bg-blue-50 rounded-lg p-4">
              <div className="flex items-start gap-3">
                <span className="bg-blue-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold flex-shrink-0">1</span>
                <div className="flex-1">
                  <h3 className="font-semibold text-blue-800 mb-2">OLS Estimator is Normal</h3>
                  <div className="bg-white rounded-lg p-3 text-center">
                    <Latex math="\hat{\boldsymbol{\beta}} | \mathbf{X} \sim \mathcal{N}\left(\boldsymbol{\beta}, \sigma^2(\mathbf{X}^\top\mathbf{X})^{-1}\right)" />
                  </div>
                  <p className="text-sm text-blue-600 mt-2">
                    Linear transformation of normal errors {"\u2192"} normal estimator
                  </p>
                </div>
              </div>
            </div>
    
            {/* Result 2: Chi-squared for RSS */}
            <div className="bg-emerald-50 rounded-lg p-4">
              <div className="flex items-start gap-3">
                <span className="bg-emerald-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold flex-shrink-0">2</span>
                <div className="flex-1">
                  <h3 className="font-semibold text-emerald-800 mb-2">RSS has Chi-Squared Distribution</h3>
                  <div className="bg-white rounded-lg p-3 text-center">
                    <Latex math="\frac{(n-p)s^2}{\sigma^2} = \frac{\text{RSS}}{\sigma^2} \sim \chi^2_{n-p}" />
                  </div>
                  <p className="text-sm text-emerald-600 mt-2">
                    Quadratic form in normal errors with rank <Latex math="n-p" /> matrix
                  </p>
                </div>
              </div>
            </div>
    
            {/* Result 3: Independence */}
            <div className="bg-purple-50 rounded-lg p-4">
              <div className="flex items-start gap-3">
                <span className="bg-purple-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold flex-shrink-0">3</span>
                <div className="flex-1">
                  <h3 className="font-semibold text-purple-800 mb-2">Independence of Estimators</h3>
                  <div className="bg-white rounded-lg p-3 text-center">
                    <Latex math="\hat{\boldsymbol{\beta}} \perp\!\!\!\perp s^2" />
                  </div>
                  <p className="text-sm text-purple-600 mt-2">
                    <Latex math="\hat{\boldsymbol{\beta}}" /> and <Latex math="s^2" /> use orthogonal projections of <Latex math="\boldsymbol{\varepsilon}" /> (Cochran's theorem)
                  </p>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom: What this enables */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-amber-50 border-2 border-amber-300 rounded-lg p-4">
              <h3 className="font-semibold text-amber-800 mb-2">What This Enables</h3>
              <div className="grid grid-cols-3 gap-4 text-sm">
                <div className="bg-white rounded p-3 text-center">
                  <p className="font-medium text-gray-700">Normal / Chi-squared</p>
                  <p className="text-2xl my-1">{"\u2192"}</p>
                  <p className="text-amber-700 font-semibold">t-distribution</p>
                </div>
                <div className="bg-white rounded p-3 text-center">
                  <p className="font-medium text-gray-700">Two Chi-squareds</p>
                  <p className="text-2xl my-1">{"\u2192"}</p>
                  <p className="text-amber-700 font-semibold">F-distribution</p>
                </div>
                <div className="bg-white rounded p-3 text-center">
                  <p className="font-medium text-gray-700">Independence</p>
                  <p className="text-2xl my-1">{"\u2192"}</p>
                  <p className="text-amber-700 font-semibold">Exact tests</p>
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                            SLIDE 85: T TESTS
// ═══════════════════════════════════════════════════════════════════════

function Slide85_tTests() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-teal-800">t-Tests for Individual Coefficients</h1>
            <p className="text-gray-600">Testing hypotheses about single parameters</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Left: Test statistic */}
            <div className="space-y-3">
              <div className="bg-blue-50 border-2 border-blue-300 rounded-lg p-4">
                <h3 className="font-semibold text-blue-800 mb-3">The t-Statistic</h3>
                <div className="bg-white rounded-lg p-4 text-center">
                  <Latex math="t = \frac{\hat{\beta}_j - \beta_{j,0}}{\text{SE}(\hat{\beta}_j)} \sim t_{n-p}" />
                </div>
                <p className="text-sm text-blue-600 mt-2 text-center">
                  Under <Latex math="H_0: \beta_j = \beta_{j,0}" />
                </p>
              </div>
    
              <div className="bg-gray-50 rounded-lg p-4">
                <h3 className="font-semibold text-gray-700 mb-2">Testing Procedure</h3>
                <div className="space-y-2 text-sm">
                  <div className="flex items-start gap-2">
                    <span className="bg-gray-300 w-5 h-5 rounded-full flex items-center justify-center text-xs">1</span>
                    <span>State <Latex math="H_0: \beta_j = 0" /> vs <Latex math="H_1: \beta_j \neq 0" /></span>
                  </div>
                  <div className="flex items-start gap-2">
                    <span className="bg-gray-300 w-5 h-5 rounded-full flex items-center justify-center text-xs">2</span>
                    <span>Compute <Latex math="t = \hat{\beta}_j / \text{SE}(\hat{\beta}_j)" /></span>
                  </div>
                  <div className="flex items-start gap-2">
                    <span className="bg-gray-300 w-5 h-5 rounded-full flex items-center justify-center text-xs">3</span>
                    <span>Reject if <Latex math="|t| > t_{n-p, 1-\alpha/2}" /></span>
                  </div>
                </div>
              </div>
    
              <div className="bg-amber-50 rounded-lg p-4">
                <h3 className="font-semibold text-amber-800 mb-2">p-value</h3>
                <div className="bg-white rounded p-2 text-center text-sm">
                  <Latex math="p = 2 \cdot P(T_{n-p} > |t|)" />
                </div>
                <p className="text-xs text-amber-700 mt-2">
                  Probability of seeing a t-stat this extreme if <Latex math="H_0" /> were true
                </p>
              </div>
            </div>
    
            {/* Right: Confidence intervals */}
            <div className="space-y-3">
              <div className="bg-emerald-50 border-2 border-emerald-300 rounded-lg p-4">
                <h3 className="font-semibold text-emerald-800 mb-3">Confidence Interval</h3>
                <div className="bg-white rounded-lg p-4 text-center">
                  <Latex math="\hat{\beta}_j \pm t_{n-p, 1-\alpha/2} \cdot \text{SE}(\hat{\beta}_j)" />
                </div>
                <p className="text-sm text-emerald-700 mt-2 text-center">
                  Inverts the test: values of <Latex math="\beta_j" /> not rejected at level <Latex math="\alpha" />
                </p>
              </div>
    
              <div className="bg-purple-50 rounded-lg p-4">
                <h3 className="font-semibold text-purple-800 mb-2">Example: 95% CI</h3>
                <div className="text-sm space-y-2">
                  <p className="text-gray-600">With <Latex math="n = 32, p = 3" />:</p>
                  <div className="bg-white rounded p-2">
                    <Latex math="t_{29, 0.975} \approx 2.045" />
                  </div>
                  <p className="text-gray-600">If <Latex math="\hat{\beta}_1 = -0.031" />, <Latex math="\text{SE} = 0.005" />:</p>
                  <div className="bg-white rounded p-2">
                    <Latex math="\text{CI: } -0.031 \pm 2.045 \times 0.005" />
                  </div>
                  <div className="bg-white rounded p-2">
                    <Latex math="= (-0.041, -0.021)" />
                  </div>
                </div>
              </div>
    
              <div className="bg-red-50 border border-red-200 rounded-lg p-3">
                <p className="text-sm text-red-700">
                  <strong>Common error:</strong> Using <Latex math="z" /> instead of <Latex math="t" />. 
                  For <Latex math="n-p < 30" />, this matters!
                </p>
              </div>
            </div>
          </div>
    
          {/* Bottom */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-gray-100 rounded-lg p-3 text-center">
              <p className="text-sm text-gray-700">
                <strong>Interpretation:</strong> If 0 is not in the CI, we reject <Latex math="H_0: \beta_j = 0" /> at level <Latex math="\alpha" />. 
                The coefficient is "statistically significant."
              </p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                            SLIDE 86: F TESTS
// ═══════════════════════════════════════════════════════════════════════

function Slide86_FTests() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-teal-800">F-Tests for Nested Models</h1>
            <p className="text-gray-600">Testing multiple coefficients jointly</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Left: Setup and formula */}
            <div className="space-y-3">
              <div className="bg-blue-50 rounded-lg p-4">
                <h3 className="font-semibold text-blue-800 mb-2">Setup</h3>
                <div className="space-y-2 text-sm">
                  <div className="bg-white rounded p-2">
                    <p className="text-gray-600 mb-1"><strong>Full model:</strong> p parameters, <Latex math="\text{RSS}_F" /></p>
                  </div>
                  <div className="bg-white rounded p-2">
                    <p className="text-gray-600 mb-1"><strong>Restricted model:</strong> q fewer parameters, <Latex math="\text{RSS}_R" /></p>
                  </div>
                  <div className="bg-white rounded p-2">
                    <p className="text-gray-600"><strong>Test:</strong> Are the q restrictions valid?</p>
                  </div>
                </div>
              </div>
    
              <div className="bg-emerald-50 border-2 border-emerald-300 rounded-lg p-4">
                <h3 className="font-semibold text-emerald-800 mb-2">F-Statistic</h3>
                <div className="bg-white rounded-lg p-3 text-center">
                  <Latex math="F = \frac{(\text{RSS}_R - \text{RSS}_F) / q}{\text{RSS}_F / (n - p)} \sim F_{q, n-p}" />
                </div>
                <p className="text-xs text-emerald-700 mt-2 text-center">
                  Under <Latex math="H_0" />: the q restrictions are true
                </p>
              </div>
    
              <div className="bg-gray-50 rounded-lg p-4">
                <h3 className="font-semibold text-gray-700 mb-2">Intuition</h3>
                <p className="text-sm text-gray-600">
                  <strong>Numerator:</strong> How much RSS increases when we impose the restrictions (per df)
                </p>
                <p className="text-sm text-gray-600 mt-1">
                  <strong>Denominator:</strong> Baseline variance estimate (MSE)
                </p>
                <p className="text-sm text-gray-700 mt-2">
                  Large F {"\u2192"} restrictions hurt the fit {"\u2192"} reject <Latex math="H_0" />
                </p>
              </div>
            </div>
    
            {/* Right: Examples */}
            <div className="space-y-3">
              <div className="bg-amber-50 rounded-lg p-4">
                <h3 className="font-semibold text-amber-800 mb-2">Example: Joint Significance</h3>
                <p className="text-sm text-gray-600 mb-2">
                  Test <Latex math="H_0: \beta_2 = \beta_3 = 0" /> (q = 2 restrictions)
                </p>
                <div className="bg-white rounded p-2 text-sm">
                  <p className="text-gray-600">Full: <Latex math="y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_3" /></p>
                  <p className="text-gray-600">Restricted: <Latex math="y = \beta_0 + \beta_1 x_1" /></p>
                </div>
              </div>
    
              <div className="bg-purple-50 rounded-lg p-4">
                <h3 className="font-semibold text-purple-800 mb-2">Overall F-Test</h3>
                <p className="text-sm text-gray-600 mb-2">
                  Test <Latex math="H_0: \beta_1 = \beta_2 = \cdots = \beta_{p-1} = 0" />
                </p>
                <div className="bg-white rounded p-2 text-sm">
                  <p className="text-gray-600">Full: all predictors</p>
                  <p className="text-gray-600">Restricted: intercept only (<Latex math="\text{RSS}_R = \text{TSS}" />)</p>
                </div>
                <p className="text-xs text-purple-700 mt-2">
                  This is the "F-statistic" in regression output
                </p>
              </div>
    
              <div className="bg-red-50 border border-red-200 rounded-lg p-3">
                <h3 className="font-semibold text-red-800 mb-1 text-sm">Why Not Multiple t-Tests?</h3>
                <p className="text-xs text-gray-700">
                  Testing <Latex math="\beta_2 = 0" /> and <Latex math="\beta_3 = 0" /> separately ignores correlation 
                  between <Latex math="\hat{\beta}_2" /> and <Latex math="\hat{\beta}_3" />. The F-test accounts for this 
                  and controls overall Type I error.
                </p>
              </div>
            </div>
          </div>
    
          {/* Bottom */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-gray-100 rounded-lg p-3">
              <div className="flex items-center justify-between text-sm">
                <span className="text-gray-700"><strong>Decision rule:</strong> Reject <Latex math="H_0" /> if <Latex math="F > F_{q, n-p, 1-\alpha}" /></span>
                <span className="text-gray-500">|</span>
                <span className="text-gray-700"><strong>Relationship:</strong> When q = 1, <Latex math="F = t^2" /></span>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                       SLIDE 87: C IVS PREDICTION
// ═══════════════════════════════════════════════════════════════════════

function Slide87_CIvsPrediction() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-teal-800">Confidence vs Prediction Intervals</h1>
            <p className="text-gray-600">Two different questions about new observations</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-6">
            {/* Left: Confidence interval for mean */}
            <div className="space-y-3">
              <div className="bg-blue-50 border-2 border-blue-300 rounded-lg p-4">
                <h3 className="font-semibold text-blue-800 mb-2">Confidence Interval for Mean</h3>
                <p className="text-sm text-gray-600 mb-2">
                  Where is <Latex math="\mathbb{E}[Y | \mathbf{x}_0] = \mathbf{x}_0^\top\boldsymbol{\beta}" />?
                </p>
                <div className="bg-white rounded-lg p-3 text-center text-sm">
                  <Latex math="\hat{y}_0 \pm t_{n-p, 1-\alpha/2} \cdot s \sqrt{\mathbf{x}_0^\top(\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{x}_0}" />
                </div>
                <div className="mt-3 p-2 bg-blue-100 rounded">
                  <p className="text-xs text-blue-800">
                    <strong>Use case:</strong> Estimating average response for all units with predictors <Latex math="\mathbf{x}_0" />
                  </p>
                </div>
              </div>
    
              <div className="bg-gray-50 rounded-lg p-3">
                <h4 className="font-semibold text-gray-700 mb-1 text-sm">Sources of Uncertainty</h4>
                <ul className="text-xs text-gray-600 space-y-1">
                  <li>• Estimation error in <Latex math="\hat{\boldsymbol{\beta}}" /></li>
                </ul>
              </div>
            </div>
    
            {/* Right: Prediction interval */}
            <div className="space-y-3">
              <div className="bg-emerald-50 border-2 border-emerald-300 rounded-lg p-4">
                <h3 className="font-semibold text-emerald-800 mb-2">Prediction Interval for New Y</h3>
                <p className="text-sm text-gray-600 mb-2">
                  Where will a new <Latex math="Y_0 = \mathbf{x}_0^\top\boldsymbol{\beta} + \varepsilon_0" /> fall?
                </p>
                <div className="bg-white rounded-lg p-3 text-center text-sm">
                  <Latex math="\hat{y}_0 \pm t_{n-p, 1-\alpha/2} \cdot s \sqrt{\boxed{1} + \mathbf{x}_0^\top(\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{x}_0}" />
                </div>
                <div className="mt-3 p-2 bg-emerald-100 rounded">
                  <p className="text-xs text-emerald-800">
                    <strong>Use case:</strong> Predicting a specific individual's response
                  </p>
                </div>
              </div>
    
              <div className="bg-gray-50 rounded-lg p-3">
                <h4 className="font-semibold text-gray-700 mb-1 text-sm">Sources of Uncertainty</h4>
                <ul className="text-xs text-gray-600 space-y-1">
                  <li>• Estimation error in <Latex math="\hat{\boldsymbol{\beta}}" /></li>
                  <li>• <strong>Plus:</strong> Irreducible error <Latex math="\varepsilon_0" /> (the "+1")</li>
                </ul>
              </div>
            </div>
          </div>
    
          {/* Visual comparison - Figure from textbook */}
          <div className="my-4 flex justify-center">
            <img 
              src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/PartII/Chapter3/ch3_4_fig11_confidence_vs_prediction.png"
              alt="Confidence intervals vs prediction intervals: CI bands are narrower and converge to 0, while PI bands remain wide due to irreducible error"
              className="max-h-80 object-contain rounded-lg shadow-sm"
            />
          </div>
    
          {/* Bottom: Key insight */}
          <div className="flex-shrink-0">
            <div className="bg-amber-50 border border-amber-200 rounded-lg p-3">
              <div className="flex items-center gap-3">
                <span className="text-xl">{"\u26A0\uFE0F"}</span>
                <p className="text-sm text-gray-700">
                  <strong>The "+1" matters!</strong> PI is always wider than CI. 
                  As <Latex math="n \to \infty" />, CI {"\u2192"} 0 but PI {"\u2192"} <Latex math="\pm 1.96\sigma" /> (irreducible).
                </p>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                     SLIDE 88: RESIDUAL DIAGNOSTICS
// ═══════════════════════════════════════════════════════════════════════

function Slide88_ResidualDiagnostics() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-teal-800">Residual Diagnostics</h1>
            <p className="text-gray-600">Visual checks for model assumptions</p>
          </div>
    
          {/* Main content: Diagnostic plots figure from textbook */}
          <div className="flex-1 flex justify-center items-center">
            <img 
              src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/PartII/Chapter3/ch3_4_fig07_assumption_violations.png"
              alt="Residual diagnostic plots showing assumption violations: nonlinearity, heteroskedasticity, and non-normality patterns"
              className="max-h-124 object-contain rounded-lg shadow-sm"
            />
          </div>
    
          {/* Residual types */}
          <div className="flex-shrink-0 mt-3">
            <div className="bg-blue-50 rounded-lg p-3">
              <h3 className="font-semibold text-blue-800 mb-2 text-sm">Residual Types</h3>
              <div className="grid grid-cols-3 gap-3 text-sm">
                <div className="bg-white rounded p-2">
                  <p className="font-medium text-gray-700">Raw</p>
                  <Latex math="e_i = y_i - \hat{y}_i" />
                </div>
                <div className="bg-white rounded p-2">
                  <p className="font-medium text-gray-700">Standardized</p>
                  <Latex math="r_i = \frac{e_i}{s\sqrt{1-h_{ii}}}" />
                </div>
                <div className="bg-white rounded p-2">
                  <p className="font-medium text-gray-700">Studentized</p>
                  <Latex math="t_i = \frac{e_i}{s_{(i)}\sqrt{1-h_{ii}}}" />
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                      SLIDE 89: INFLUENCE MEASURES
// ═══════════════════════════════════════════════════════════════════════

function Slide89_InfluenceMeasures() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-teal-800">Influence Measures</h1>
            <p className="text-gray-600">Identifying observations that drive the results</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Left: Cook's Distance */}
            <div className="space-y-3">
              <div className="bg-emerald-50 border-2 border-emerald-300 rounded-lg p-4">
                <h3 className="font-semibold text-emerald-800 mb-2">Cook's Distance</h3>
                <p className="text-sm text-gray-600 mb-2">
                  Measures how much ALL fitted values change when observation <em>i</em> is removed:
                </p>
                <div className="bg-white rounded-lg p-3 text-center">
                  <Latex math="D_i = \frac{\sum_{j=1}^n (\hat{y}_j - \hat{y}_{j(i)})^2}{p \cdot s^2}" />
                </div>
              </div>
    
              <div className="bg-blue-50 rounded-lg p-4">
                <h3 className="font-semibold text-blue-800 mb-2">Computational Formula</h3>
                <div className="bg-white rounded p-3 text-center">
                  <Latex math="D_i = \frac{r_i^2}{p} \cdot \frac{h_{ii}}{1 - h_{ii}}" />
                </div>
                <div className="grid grid-cols-2 gap-2 mt-3 text-xs">
                  <div className="bg-white rounded p-2 text-center">
                    <Latex math="r_i^2" />
                    <p className="text-gray-500">Residual size</p>
                  </div>
                  <div className="bg-white rounded p-2 text-center">
                    <Latex math="\frac{h_{ii}}{1-h_{ii}}" />
                    <p className="text-gray-500">Leverage multiplier</p>
                  </div>
                </div>
              </div>
    
              <div className="bg-amber-50 rounded-lg p-3">
                <h3 className="font-semibold text-amber-800 mb-1 text-sm">Rules of Thumb</h3>
                <div className="grid grid-cols-2 gap-2 text-sm">
                  <div className="bg-white rounded p-2">
                    <span className="text-amber-700"><Latex math="D_i > 0.5" /></span>
                    <span className="text-xs text-gray-500 block">investigate</span>
                  </div>
                  <div className="bg-white rounded p-2">
                    <span className="text-red-700"><Latex math="D_i > 1" /></span>
                    <span className="text-xs text-gray-500 block">highly influential</span>
                  </div>
                </div>
              </div>
            </div>
    
            {/* Right: Interpretation */}
            <div className="space-y-3">
              <div className="bg-gray-50 rounded-lg p-4">
                <h3 className="font-semibold text-gray-700 mb-3">Understanding Influence</h3>
                <div className="space-y-2">
                  <div className="flex items-center gap-3 p-2 bg-white rounded">
                    <div className="w-20 text-center">
                      <span className="text-lg">📊</span>
                      <p className="text-xs text-gray-500">High leverage</p>
                    </div>
                    <span className="text-xl">+</span>
                    <div className="w-20 text-center">
                      <span className="text-lg">📍</span>
                      <p className="text-xs text-gray-500">Small residual</p>
                    </div>
                    <span className="text-xl">=</span>
                    <div className="flex-1">
                      <span className="text-emerald-600 font-medium">Low influence</span>
                      <p className="text-xs text-gray-500">Fits the pattern</p>
                    </div>
                  </div>
                  <div className="flex items-center gap-3 p-2 bg-white rounded">
                    <div className="w-20 text-center">
                      <span className="text-lg">📊</span>
                      <p className="text-xs text-gray-500">High leverage</p>
                    </div>
                    <span className="text-xl">+</span>
                    <div className="w-20 text-center">
                      <span className="text-lg">⚠️</span>
                      <p className="text-xs text-gray-500">Large residual</p>
                    </div>
                    <span className="text-xl">=</span>
                    <div className="flex-1">
                      <span className="text-red-600 font-medium">High influence!</span>
                      <p className="text-xs text-gray-500">Drives results</p>
                    </div>
                  </div>
                </div>
              </div>
    
              <div className="bg-purple-50 rounded-lg p-4">
                <h3 className="font-semibold text-purple-800 mb-2">Other Measures</h3>
                <div className="space-y-2 text-sm">
                  <div className="bg-white rounded p-2 flex justify-between">
                    <span className="font-medium">DFBETAS</span>
                    <span className="text-xs text-gray-500">Change in each <Latex math="\hat{\beta}_j" /></span>
                  </div>
                  <div className="bg-white rounded p-2 flex justify-between">
                    <span className="font-medium">DFFITS</span>
                    <span className="text-xs text-gray-500">Change in <Latex math="\hat{y}_i" /></span>
                  </div>
                  <div className="bg-white rounded p-2 flex justify-between">
                    <span className="font-medium">COVRATIO</span>
                    <span className="text-xs text-gray-500">Change in <Latex math="\det(\widehat{\text{Var}})" /></span>
                  </div>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom: Warning */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-red-50 border border-red-200 rounded-lg p-3">
              <div className="flex items-center gap-3">
                <span className="text-xl">⚠️</span>
                <p className="text-sm text-gray-700">
                  <strong>Don't automatically delete influential points!</strong> 
                  Investigate why they're influential. They may reveal important features of the data 
                  or indicate model misspecification.
                </p>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                           SLIDE 90: ROBUST SE
// ═══════════════════════════════════════════════════════════════════════

function Slide90_RobustSE() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-teal-800">Robust Standard Errors</h1>
            <p className="text-gray-600">Valid inference under heteroskedasticity</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Left: The problem and solution */}
            <div className="space-y-3">
              <div className="bg-blue-50 rounded-lg p-4">
                <h3 className="font-semibold text-blue-800 mb-2">The Problem</h3>
                <p className="text-sm text-gray-600 mb-2">
                  Under heteroskedasticity (<Latex math="\text{Var}(\varepsilon_i) = \sigma_i^2" /> varies):
                </p>
                <div className="bg-white rounded p-2 text-center text-sm">
                  <Latex math="s^2(\mathbf{X}^\top\mathbf{X})^{-1} \neq \text{Var}(\hat{\boldsymbol{\beta}})" />
                </div>
                <p className="text-xs text-gray-500 mt-2">
                  Usual SEs may be too small OR too large
                </p>
              </div>
    
              <div className="bg-emerald-50 border-2 border-emerald-300 rounded-lg p-4">
                <h3 className="font-semibold text-emerald-800 mb-2">Sandwich Estimator</h3>
                <p className="text-sm text-gray-600 mb-2">
                  The true variance (White, 1980):
                </p>
                <div className="bg-white rounded p-2 text-center text-sm">
                  <Latex math="(\mathbf{X}^\top\mathbf{X})^{-1} \left(\sum_i e_i^2 \mathbf{x}_i\mathbf{x}_i^\top\right) (\mathbf{X}^\top\mathbf{X})^{-1}" />
                </div>
                <p className="text-xs text-emerald-700 mt-2 text-center">
                  "Bread" × "Meat" × "Bread"
                </p>
              </div>
            </div>
    
            {/* Right: HC variants */}
            <div className="space-y-3">
              <div className="bg-gray-50 rounded-lg p-4">
                <h3 className="font-semibold text-gray-700 mb-2">HC Variants</h3>
                <table className="w-full text-sm">
                  <tbody>
                    <tr className="border-b">
                      <td className="py-2 font-medium">HC0</td>
                      <td className="py-2"><Latex math="e_i^2" /></td>
                      <td className="py-2 text-xs text-gray-500">Basic</td>
                    </tr>
                    <tr className="border-b">
                      <td className="py-2 font-medium">HC1</td>
                      <td className="py-2"><Latex math="\frac{n}{n-p} e_i^2" /></td>
                      <td className="py-2 text-xs text-gray-500">df correction</td>
                    </tr>
                    <tr className="border-b">
                      <td className="py-2 font-medium">HC2</td>
                      <td className="py-2"><Latex math="\frac{e_i^2}{1-h_{ii}}" /></td>
                      <td className="py-2 text-xs text-gray-500">Leverage adjusted</td>
                    </tr>
                    <tr>
                      <td className="py-2 font-medium">HC3</td>
                      <td className="py-2"><Latex math="\frac{e_i^2}{(1-h_{ii})^2}" /></td>
                      <td className="py-2 text-xs text-gray-500 text-emerald-600">Recommended</td>
                    </tr>
                  </tbody>
                </table>
              </div>
    
              <div className="bg-amber-50 rounded-lg p-4">
                <h3 className="font-semibold text-amber-800 mb-2">Python Code</h3>
                <pre className="bg-white rounded p-2 text-xs font-mono overflow-x-auto">
    {`import statsmodels.api as sm
    
    # Fit OLS
    model = sm.OLS(y, X).fit()
    
    # Get HC3 robust SEs
    robust = model.get_robustcov_results(
        cov_type='HC3'
    )
    print(robust.summary())`}
                </pre>
              </div>
            </div>
          </div>
    
          {/* Bottom: Critical warning */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-red-50 border-2 border-red-300 rounded-lg p-3">
              <div className="flex items-start gap-3">
                <span className="text-2xl">🛑</span>
                <div>
                  <h4 className="font-semibold text-red-800 mb-1">Critical Reminder</h4>
                  <p className="text-sm text-red-700">
                    Robust SEs fix inference <strong>under heteroskedasticity</strong> (GM4 violation). 
                    They do <strong>NOT</strong> fix bias from endogeneity (GM3 violation). 
                    Having precise SEs for a biased estimate doesn't help!
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                      SLIDE 91: NUMERICAL STABILITY
// ═══════════════════════════════════════════════════════════════════════

function Slide91_NumericalStability() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-teal-800">Numerical Stability</h1>
            <p className="text-gray-600">Why you should never compute <Latex math="(\mathbf{X}^\top\mathbf{X})^{-1}" /> directly</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Left: The problem */}
            <div className="space-y-3">
              <div className="bg-red-50 border border-red-200 rounded-lg p-4">
                <h3 className="font-semibold text-red-800 mb-2">The Problem: Condition Number</h3>
                <p className="text-sm text-gray-600 mb-2">
                  Condition number measures sensitivity to numerical error:
                </p>
                <div className="bg-white rounded p-3 text-center">
                  <Latex math="\kappa(\mathbf{X}^\top\mathbf{X}) = \kappa(\mathbf{X})^2" />
                </div>
                <p className="text-xs text-red-700 mt-2">
                  Forming <Latex math="\mathbf{X}^\top\mathbf{X}" /> <strong>squares</strong> the condition number!
                </p>
              </div>
    
              <div className="bg-gray-50 rounded-lg p-4">
                <h3 className="font-semibold text-gray-700 mb-2">Example</h3>
                <div className="space-y-1 text-sm">
                  <div className="flex justify-between bg-white rounded p-2">
                    <span><Latex math="\kappa(\mathbf{X})" /></span>
                    <span><Latex math="10^4" /></span>
                  </div>
                  <div className="flex justify-between bg-white rounded p-2">
                    <span><Latex math="\kappa(\mathbf{X}^\top\mathbf{X})" /></span>
                    <span><Latex math="10^8" /></span>
                  </div>
                  <div className="flex justify-between bg-white rounded p-2">
                    <span>Double precision</span>
                    <span><Latex math="\sim 10^{16}" /></span>
                  </div>
                </div>
                <p className="text-xs text-gray-600 mt-2">
                  With <Latex math="\kappa = 10^8" />, you may lose 8 of your 16 digits!
                </p>
              </div>
            </div>
    
            {/* Right: The solution */}
            <div className="space-y-3">
              <div className="bg-emerald-50 border-2 border-emerald-300 rounded-lg p-4">
                <h3 className="font-semibold text-emerald-800 mb-2">Solution: QR Decomposition</h3>
                <p className="text-sm text-gray-600 mb-2">
                  Factor <Latex math="\mathbf{X} = \mathbf{Q}\mathbf{R}" /> where:
                </p>
                <div className="grid grid-cols-2 gap-2 text-sm">
                  <div className="bg-white rounded p-2 text-center">
                    <Latex math="\mathbf{Q}^\top\mathbf{Q} = \mathbf{I}" />
                    <p className="text-xs text-gray-500">orthogonal</p>
                  </div>
                  <div className="bg-white rounded p-2 text-center">
                    <Latex math="\mathbf{R}" /> upper triangular
                    <p className="text-xs text-gray-500">easy to solve</p>
                  </div>
                </div>
              </div>
    
              <div className="bg-blue-50 rounded-lg p-4">
                <h3 className="font-semibold text-blue-800 mb-2">QR-Based OLS</h3>
                <div className="space-y-2 text-sm">
                  <p className="text-gray-600">Normal equations become:</p>
                  <div className="bg-white rounded p-2 text-center">
                    <Latex math="\mathbf{R}\hat{\boldsymbol{\beta}} = \mathbf{Q}^\top\mathbf{y}" />
                  </div>
                  <p className="text-gray-600">Solve by back-substitution (no matrix inversion!)</p>
                </div>
              </div>
    
              <div className="bg-amber-50 rounded-lg p-4">
                <h3 className="font-semibold text-amber-800 mb-2">In Practice</h3>
                <pre className="bg-white rounded p-2 text-xs font-mono">
    {`# Good: uses QR internally
    beta, residuals, rank, s = \\
        np.linalg.lstsq(X, y, rcond=None)
    
    # Bad: forms X'X explicitly  
    beta_bad = np.linalg.inv(X.T @ X) @ X.T @ y`}
                </pre>
              </div>
            </div>
          </div>
    
          {/* Bottom: Rule */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-purple-50 border-2 border-purple-300 rounded-lg p-3">
              <div className="flex items-center justify-between">
                <div>
                  <h4 className="font-semibold text-purple-800">Golden Rule</h4>
                  <p className="text-sm text-purple-700">
                    The formula <Latex math="\hat{\boldsymbol{\beta}} = (\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{X}^\top\mathbf{y}" /> is 
                    for <strong>understanding</strong>. Use <code className="bg-purple-100 px-1 rounded">lstsq</code> for <strong>computing</strong>.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                        SLIDE 92: STATSMODELS OLS
// ═══════════════════════════════════════════════════════════════════════

function Slide92_StatsmodelsOLS() {
  return (
    <div className="h-full flex flex-col p-4 overflow-hidden">
          {/* Header */}
          <div className="flex-shrink-0 mb-2">
            <h1 className="text-2xl font-bold text-teal-800">OLS in Practice: statsmodels</h1>
          </div>
    
          {/* Main content - 3 columns */}
          <div className="flex-1 grid grid-cols-3 gap-3 text-sm overflow-hidden">
            {/* Column 1: Model Specification */}
            <div className="space-y-2 overflow-hidden">
              <div className="bg-blue-50 rounded-lg p-2">
                <h3 className="font-semibold text-blue-800 mb-2">Model Specification</h3>
                
                <div className="bg-gray-900 rounded p-2 mb-2">
                  <pre className="text-green-400 font-mono text-sm leading-snug">
    {`import statsmodels.api as sm
    
    X = sm.add_constant(X)
    model = sm.OLS(y, X)
    results = model.fit()`}
                  </pre>
                </div>
    
                <div className="bg-gray-900 rounded p-2">
                  <pre className="text-green-400 font-mono text-sm leading-snug">
    {`import statsmodels.formula.api as smf
    
    results = smf.ols(
        'y ~ x1 + x2 + C(cat)',
        data=df
    ).fit()`}
                  </pre>
                </div>
              </div>
    
              <div className="bg-red-50 border-2 border-red-300 rounded-lg p-2">
                <p className="font-bold text-red-800">Warning: No automatic intercept!</p>
                <p className="text-red-700">Use <code className="bg-white px-1 rounded">add_constant(X)</code></p>
              </div>
            </div>
    
            {/* Column 2: Results Attributes */}
            <div className="space-y-2 overflow-hidden">
              <div className="bg-emerald-50 rounded-lg p-2">
                <h3 className="font-semibold text-emerald-800 mb-2">Results Attributes</h3>
                
                <div className="grid grid-cols-2 gap-1">
                  <div className="bg-white rounded p-1.5">
                    <code className="text-emerald-700 font-semibold">.params</code>
                    <span className="text-gray-500 ml-1"><Latex math="\hat{\beta}" /></span>
                  </div>
                  <div className="bg-white rounded p-1.5">
                    <code className="text-emerald-700 font-semibold">.bse</code>
                    <span className="text-gray-500 ml-1">SE</span>
                  </div>
                  <div className="bg-white rounded p-1.5">
                    <code className="text-emerald-700 font-semibold">.tvalues</code>
                    <span className="text-gray-500 ml-1">t-stats</span>
                  </div>
                  <div className="bg-white rounded p-1.5">
                    <code className="text-emerald-700 font-semibold">.pvalues</code>
                    <span className="text-gray-500 ml-1">p-vals</span>
                  </div>
                  <div className="bg-white rounded p-1.5">
                    <code className="text-emerald-700 font-semibold">.rsquared</code>
                    <span className="text-gray-500 ml-1"><Latex math="R^2" /></span>
                  </div>
                  <div className="bg-white rounded p-1.5">
                    <code className="text-emerald-700 font-semibold">.fvalue</code>
                    <span className="text-gray-500 ml-1">F-stat</span>
                  </div>
                </div>
              </div>
    
              <div className="bg-amber-50 rounded-lg p-2">
                <h3 className="font-semibold text-amber-800 mb-2">Residuals & Fitted</h3>
                <div className="grid grid-cols-2 gap-1">
                  <div className="bg-white rounded p-1.5">
                    <code className="text-amber-700 font-semibold">.resid</code>
                  </div>
                  <div className="bg-white rounded p-1.5">
                    <code className="text-amber-700 font-semibold">.fittedvalues</code>
                  </div>
                </div>
              </div>
    
              <div className="bg-purple-50 rounded-lg p-2">
                <h3 className="font-semibold text-purple-800 mb-1">Covariance & CIs</h3>
                <code className="text-purple-700">.cov_params()</code><br/>
                <code className="text-purple-700">.conf_int(alpha=0.05)</code>
              </div>
            </div>
    
            {/* Column 3: Methods & Diagnostics */}
            <div className="space-y-2 overflow-hidden">
              <div className="bg-indigo-50 rounded-lg p-2">
                <h3 className="font-semibold text-indigo-800 mb-2">Hypothesis Testing</h3>
                <div className="bg-gray-900 rounded p-2">
                  <pre className="text-green-400 font-mono text-sm leading-snug">
    {`results.t_test('x1 = 0')
    results.f_test('x1 = x2 = 0')
    results.wald_test(R, q)`}
                  </pre>
                </div>
              </div>
    
              <div className="bg-cyan-50 rounded-lg p-2">
                <h3 className="font-semibold text-cyan-800 mb-2">Prediction</h3>
                <div className="bg-gray-900 rounded p-2">
                  <pre className="text-green-400 font-mono text-sm leading-snug">
    {`results.predict(X_new)
    results.get_prediction(X_new)
      .summary_frame()`}
                  </pre>
                </div>
              </div>
    
              <div className="bg-pink-50 rounded-lg p-2">
                <h3 className="font-semibold text-pink-800 mb-2">Diagnostics</h3>
                <div className="bg-gray-900 rounded p-2">
                  <pre className="text-green-400 font-mono text-sm leading-snug">
    {`infl = results.get_influence()
    infl.hat_matrix_diag
    infl.cooks_distance[0]`}
                  </pre>
                </div>
              </div>
    
              <div className="bg-orange-50 border-2 border-orange-300 rounded-lg p-2">
                <h3 className="font-semibold text-orange-800 mb-1">Robust SEs</h3>
                <code className="text-orange-700">model.fit(cov_type='HC3')</code>
              </div>
            </div>
          </div>
    
          {/* Bottom: Quick reference */}
          <div className="flex-shrink-0 mt-2">
            <div className="bg-gray-100 rounded-lg p-2 flex items-center justify-between">
              <code className="bg-white px-2 py-1 rounded text-sm">results.summary()</code>
              <span className="text-gray-600">Complete regression table</span>
              <a href="https://www.statsmodels.org/stable/regression.html" 
                 className="text-blue-600 hover:underline text-sm" 
                 target="_blank" 
                 rel="noopener noreferrer">
                statsmodels.org/regression
              </a>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                    SLIDE 93: STATSMODELS VS SKLEARN
// ═══════════════════════════════════════════════════════════════════════

function Slide93_StatsmodelsVsSklearn() {
  return (
    <div className="h-full flex flex-col p-6 overflow-hidden">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-teal-800">statsmodels vs scikit-learn</h1>
            <p className="text-gray-600 text-lg">Different tools for different questions</p>
          </div>
    
          {/* Main comparison - 2 columns */}
          <div className="flex-1 grid grid-cols-2 gap-6 overflow-hidden">
            {/* statsmodels column */}
            <div className="flex flex-col">
              <div className="bg-blue-600 text-white rounded-t-lg p-3 text-center">
                <h3 className="font-bold text-xl">statsmodels</h3>
                <p className="text-blue-200">Inference & Understanding</p>
              </div>
              
              <div className="bg-blue-50 rounded-b-lg p-4 flex-1 flex flex-col">
                <p className="text-blue-800 font-semibold text-lg mb-3">Use all data to understand relationships</p>
                
                <div className="bg-gray-900 rounded p-3 mb-4">
                  <pre className="text-green-400 font-mono text-base leading-relaxed">
    {`model = sm.OLS(y, X).fit()
    print(model.summary())`}
                  </pre>
                </div>
    
                <div className="space-y-2 text-base flex-1">
                  <div className="flex items-center gap-2">
                    <span className="text-green-500 text-lg">✓</span>
                    <span>p-values and hypothesis tests</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <span className="text-green-500 text-lg">✓</span>
                    <span>Confidence intervals</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <span className="text-green-500 text-lg">✓</span>
                    <span>Diagnostics and influence</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <span className="text-green-500 text-lg">✓</span>
                    <span>Robust standard errors</span>
                  </div>
                </div>
    
                <div className="bg-blue-100 rounded p-3 mt-3">
                  <p className="text-blue-800 font-medium">"Is <Latex math="\beta_j" /> significantly different from zero?"</p>
                </div>
              </div>
            </div>
    
            {/* sklearn column */}
            <div className="flex flex-col">
              <div className="bg-orange-500 text-white rounded-t-lg p-3 text-center">
                <h3 className="font-bold text-xl">scikit-learn</h3>
                <p className="text-orange-200">Prediction & Evaluation</p>
              </div>
              
              <div className="bg-orange-50 rounded-b-lg p-4 flex-1 flex flex-col">
                <p className="text-orange-800 font-semibold text-lg mb-3">Hold out data to evaluate honestly</p>
                
                <div className="bg-gray-900 rounded p-3 mb-4">
                  <pre className="text-green-400 font-mono text-base leading-relaxed">
    {`X_train, X_test, y_train, y_test = \\
        train_test_split(X, y, test_size=0.2)
    model.fit(X_train, y_train)
    model.score(X_test, y_test)`}
                  </pre>
                </div>
    
                <div className="space-y-2 text-base flex-1">
                  <div className="flex items-center gap-2">
                    <span className="text-green-500 text-lg">✓</span>
                    <span>Train/test splits</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <span className="text-green-500 text-lg">✓</span>
                    <span>Cross-validation</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <span className="text-green-500 text-lg">✓</span>
                    <span>Pipelines and preprocessing</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <span className="text-green-500 text-lg">✓</span>
                    <span>Model comparison</span>
                  </div>
                </div>
    
                <div className="bg-orange-100 rounded p-3 mt-3">
                  <p className="text-orange-800 font-medium">"How well will this predict new data?"</p>
                </div>
              </div>
            </div>
          </div>
    
          {/* Forward look to Chapter 4 */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-gradient-to-r from-purple-100 to-indigo-100 border-2 border-purple-300 rounded-lg p-4">
              <div className="flex items-center gap-4">
                <div className="text-3xl font-bold text-purple-600">Ch 4</div>
                <div className="flex-1">
                  <p className="font-semibold text-purple-800 text-lg">Coming Up: Why Holdout Data Matters</p>
                  <p className="text-purple-700">
                    In-sample <Latex math="R^2" /> is optimistically biased. Cross-validation gives honest estimates of predictive performance.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                       SLIDE 94: SECTION34 SUMMARY
// ═══════════════════════════════════════════════════════════════════════

function Slide94_Section34Summary() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-teal-800">Section 3.4 Summary</h1>
            <p className="text-gray-600">Linear Models: Key Results and Formulas</p>
          </div>
    
          {/* Main content */}
          <div className="flex-1 grid grid-cols-2 gap-4">
            {/* Left: Core formulas */}
            <div className="space-y-3">
              <div className="bg-emerald-50 border-2 border-emerald-300 rounded-lg p-4">
                <h3 className="font-semibold text-emerald-800 mb-3">Core Formulas</h3>
                <div className="space-y-2">
                  <div className="bg-white rounded p-2 text-sm">
                    <span className="text-gray-600">OLS estimator:</span>
                    <div className="text-center mt-1">
                      <Latex math="\hat{\boldsymbol{\beta}} = (\mathbf{X}^\top\mathbf{X})^{-1}\mathbf{X}^\top\mathbf{y}" />
                    </div>
                  </div>
                  <div className="bg-white rounded p-2 text-sm">
                    <span className="text-gray-600">Variance:</span>
                    <div className="text-center mt-1">
                      <Latex math="\text{Var}(\hat{\boldsymbol{\beta}}) = \sigma^2(\mathbf{X}^\top\mathbf{X})^{-1}" />
                    </div>
                  </div>
                  <div className="bg-white rounded p-2 text-sm">
                    <span className="text-gray-600">Error variance:</span>
                    <div className="text-center mt-1">
                      <Latex math="s^2 = \frac{\text{RSS}}{n-p} = \frac{\mathbf{e}^\top\mathbf{e}}{n-p}" />
                    </div>
                  </div>
                  <div className="bg-white rounded p-2 text-sm">
                    <span className="text-gray-600">t-statistic:</span>
                    <div className="text-center mt-1">
                      <Latex math="t_j = \frac{\hat{\beta}_j}{\text{SE}(\hat{\beta}_j)} \sim t_{n-p}" />
                    </div>
                  </div>
                </div>
              </div>
    
              <div className="bg-blue-50 rounded-lg p-4">
                <h3 className="font-semibold text-blue-800 mb-2">Two Perspectives</h3>
                <div className="grid grid-cols-2 gap-2 text-sm">
                  <div className="bg-white rounded p-2 text-center">
                    <p className="font-medium text-gray-700">Calculus</p>
                    <p className="text-xs text-gray-500">Minimize RSS</p>
                  </div>
                  <div className="bg-white rounded p-2 text-center">
                    <p className="font-medium text-gray-700">Geometry</p>
                    <p className="text-xs text-gray-500">Project onto C(X)</p>
                  </div>
                </div>
                <p className="text-xs text-blue-700 mt-2 text-center">Both give the same answer!</p>
              </div>
            </div>
    
            {/* Right: Key results and checklist */}
            <div className="space-y-3">
              <div className="bg-amber-50 rounded-lg p-4">
                <h3 className="font-semibold text-amber-800 mb-2">Gauss-Markov Hierarchy</h3>
                <div className="space-y-1 text-sm">
                  <div className="flex items-center gap-2">
                    <span className="bg-blue-100 px-2 py-0.5 rounded text-xs">GM1-2</span>
                    <span className="text-gray-600">OLS is computable</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <span className="bg-emerald-100 px-2 py-0.5 rounded text-xs">GM1-3</span>
                    <span className="text-gray-600">OLS is unbiased</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <span className="bg-purple-100 px-2 py-0.5 rounded text-xs">GM1-4</span>
                    <span className="text-gray-600">OLS is BLUE</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <span className="bg-rose-100 px-2 py-0.5 rounded text-xs">GM1-5</span>
                    <span className="text-gray-600">Exact t and F tests</span>
                  </div>
                </div>
              </div>
    
              <div className="bg-gray-50 rounded-lg p-4">
                <h3 className="font-semibold text-gray-700 mb-2">Diagnostics Checklist</h3>
                <ul className="text-sm text-gray-600 space-y-1">
                  <li>- Residuals vs fitted: check linearity, heteroskedasticity</li>
                  <li>- Q-Q plot: check normality</li>
                  <li>- Leverage <Latex math="h_{ii}" />: identify high-influence predictors</li>
                  <li>- Cook's D: find influential observations</li>
                  <li>- If GM4 fails: use robust SEs</li>
                  <li>- If GM3 fails: robust SEs don't help!</li>
                </ul>
              </div>
    
              <div className="bg-red-50 border border-red-200 rounded-lg p-3">
                <h3 className="font-semibold text-red-800 mb-1 text-sm">Numerical Rule</h3>
                <p className="text-xs text-gray-700">
                  Never compute <Latex math="(\mathbf{X}^\top\mathbf{X})^{-1}" /> directly. 
                  Use <code className="bg-red-100 px-1 rounded">np.linalg.lstsq()</code> or QR decomposition.
                </p>
              </div>
            </div>
          </div>
    
          {/* Bottom: Forward pointer */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-teal-50 border border-teal-200 rounded-lg p-3">
              <div className="flex items-center justify-between">
                <div>
                  <p className="font-semibold text-teal-800">Next: Generalized Linear Models</p>
                  <p className="text-sm text-gray-600">Extending linear models to binary, count, and other non-normal responses</p>
                </div>
                <div className="text-3xl">{"\u2192"}</div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                          SLIDE 95: CH3_5 HERO
// ═══════════════════════════════════════════════════════════════════════

function Slide95_Ch3_5Hero() {
  return (
    <div className="h-full flex flex-col bg-gradient-to-br from-violet-900 via-purple-800 to-indigo-900 text-white p-6">
          {/* Section identifier */}
          <div className="flex-shrink-0 mb-4 text-center">
            <div className="inline-block bg-violet-400/20 border border-violet-400/40 rounded-full px-4 py-1">
              <span className="text-violet-200 font-mono text-sm">Section 3.5</span>
            </div>
          </div>
    
          {/* Main title */}
          <div className="flex-1 flex flex-col justify-center items-center text-center">
            <h1 className="text-5xl font-bold mb-4">Generalized Linear Models</h1>
            <p className="text-2xl text-violet-200 mb-8">Beyond Normal Responses</p>
            
            {/* Historical context */}
            <div className="bg-white/10 backdrop-blur rounded-xl p-5 mb-6 max-w-3xl mx-auto text-left">
              <div className="flex items-start gap-4">
                <div className="text-4xl">{"🔗"}</div>
                <div>
                  <p className="text-lg text-violet-100 mb-2">
                    <strong>1972:</strong> Nelder & Wedderburn unify regression methods
                  </p>
                  <p className="text-violet-300 text-sm">
                    Logistic, Poisson, Gamma regression - all special cases of one framework built on exponential families
                  </p>
                </div>
              </div>
            </div>
    
            {/* Three response types */}
            <div className="grid grid-cols-3 gap-4 max-w-4xl mx-auto mb-6">
              <div className="bg-white/10 rounded-lg p-4 text-center">
                <div className="text-3xl mb-2">{"0/1"}</div>
                <p className="font-semibold">Binary</p>
                <p className="text-xs text-violet-300">Pass/Fail, Yes/No</p>
              </div>
              <div className="bg-white/10 rounded-lg p-4 text-center">
                <div className="text-3xl mb-2">{"0,1,2..."}</div>
                <p className="font-semibold">Counts</p>
                <p className="text-xs text-violet-300">Events, claims, defects</p>
              </div>
              <div className="bg-white/10 rounded-lg p-4 text-center">
                <div className="text-3xl mb-2">{"> 0"}</div>
                <p className="font-semibold">Positive</p>
                <p className="text-xs text-violet-300">Costs, durations, amounts</p>
              </div>
            </div>
    
            {/* Roadmap */}
            <div className="grid grid-cols-4 gap-3 max-w-3xl mx-auto">
              {[
                { num: '1', title: 'Framework', desc: 'Three components' },
                { num: '2', title: 'IRLS', desc: 'Estimation algorithm' },
                { num: '3', title: 'Applications', desc: 'Logistic, Poisson, Gamma' },
                { num: '4', title: 'Diagnostics', desc: 'Deviance, residuals' },
              ].map((item, i) => (
                <div key={i} className="bg-white/10 rounded-lg p-3 text-center">
                  <div className="w-8 h-8 bg-violet-400 text-violet-900 rounded-full flex items-center justify-center font-bold mx-auto mb-2">
                    {item.num}
                  </div>
                  <p className="font-semibold text-sm">{item.title}</p>
                  <p className="text-xs text-violet-300">{item.desc}</p>
                </div>
              ))}
            </div>
          </div>
    
          {/* Key equation preview */}
          <div className="flex-shrink-0 mt-4 text-center">
            <div className="inline-block bg-white/10 backdrop-blur rounded-lg px-6 py-3">
              <Latex math="g(\mu_i) = \mathbf{x}_i^\top \boldsymbol{\beta}" />
              <p className="text-violet-300 text-sm mt-1">Link function connects mean to linear predictor</p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                       SLIDE 96: PROBLEM WITH OLS
// ═══════════════════════════════════════════════════════════════════════

function Slide96_ProblemWithOLS() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-red-800">The Problem with OLS</h1>
            <p className="text-gray-600">Why linear regression fails for non-normal responses</p>
          </div>
    
          {/* Three failure modes */}
          <div className="flex-1 grid grid-cols-3 gap-4">
            {/* Binary */}
            <div className="bg-gradient-to-b from-red-50 to-white border-2 border-red-200 rounded-xl p-4 flex flex-col">
              <div className="text-center mb-3">
                <span className="bg-red-600 text-white px-3 py-1 rounded-full text-sm font-bold">Binary</span>
              </div>
              
              <div className="text-center mb-3">
                <Latex math="Y_i \in \{0, 1\}" display={true} />
              </div>
    
              <div className="bg-white rounded-lg p-3 border border-red-100 mb-3 flex-1">
                <p className="text-sm font-semibold text-red-800 mb-2">Problems:</p>
                <ul className="text-xs text-gray-700 space-y-1">
                  <li>{"• "}<Latex math="\hat{y}" /> can be {"< 0 or > 1"}</li>
                  <li>{"• "}<Latex math="\text{Var}(Y) = p(1-p)" /> depends on mean</li>
                  <li>{"•"} Not normal - only two values!</li>
                </ul>
              </div>
    
              <div className="bg-red-100 rounded p-2 text-center">
                <p className="text-xs text-red-800">
                  Predicted: <Latex math="\hat{y} = 1.3" />
                  <br />
                  <span className="font-semibold">Not a valid probability!</span>
                </p>
              </div>
            </div>
    
            {/* Counts */}
            <div className="bg-gradient-to-b from-amber-50 to-white border-2 border-amber-200 rounded-xl p-4 flex flex-col">
              <div className="text-center mb-3">
                <span className="bg-amber-600 text-white px-3 py-1 rounded-full text-sm font-bold">Counts</span>
              </div>
              
              <div className="text-center mb-3">
                <Latex math="Y_i \in \{0, 1, 2, \ldots\}" display={true} />
              </div>
    
              <div className="bg-white rounded-lg p-3 border border-amber-100 mb-3 flex-1">
                <p className="text-sm font-semibold text-amber-800 mb-2">Problems:</p>
                <ul className="text-xs text-gray-700 space-y-1">
                  <li>{"• "}<Latex math="\hat{y}" /> can be negative</li>
                  <li>{"• "}<Latex math="\text{Var}(Y) = \mu" /> for Poisson</li>
                  <li>{"•"} Discrete, not continuous!</li>
                </ul>
              </div>
    
              <div className="bg-amber-100 rounded p-2 text-center">
                <p className="text-xs text-amber-800">
                  Predicted: <Latex math="\hat{y} = -2.4" />
                  <br />
                  <span className="font-semibold">Negative event count?</span>
                </p>
              </div>
            </div>
    
            {/* Positive Continuous */}
            <div className="bg-gradient-to-b from-green-50 to-white border-2 border-green-200 rounded-xl p-4 flex flex-col">
              <div className="text-center mb-3">
                <span className="bg-green-600 text-white px-3 py-1 rounded-full text-sm font-bold">Positive</span>
              </div>
              
              <div className="text-center mb-3">
                <Latex math="Y_i > 0" display={true} />
              </div>
    
              <div className="bg-white rounded-lg p-3 border border-green-100 mb-3 flex-1">
                <p className="text-sm font-semibold text-green-800 mb-2">Problems:</p>
                <ul className="text-xs text-gray-700 space-y-1">
                  <li>{"• "}<Latex math="\hat{y}" /> can be negative</li>
                  <li>{"• "}<Latex math="\text{Var}(Y) = \phi\mu^2" /> for Gamma</li>
                  <li>{"•"} Right-skewed, not symmetric!</li>
                </ul>
              </div>
    
              <div className="bg-green-100 rounded p-2 text-center">
                <p className="text-xs text-green-800">
                  Predicted: <Latex math="\hat{y} = -\$500" />
                  <br />
                  <span className="font-semibold">Negative cost?</span>
                </p>
              </div>
            </div>
          </div>
    
          {/* Bottom insight */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-indigo-100 border-2 border-indigo-300 rounded-xl p-4">
              <div className="flex items-center gap-4">
                <div className="text-4xl">{"💡"}</div>
                <div>
                  <p className="font-bold text-indigo-900">The Core Issue</p>
                  <p className="text-sm text-indigo-700">
                    OLS assumes <Latex math="Y \sim \mathcal{N}(\mu, \sigma^2)" /> with constant variance.
                    The data violates both assumptions. <strong>Solution:</strong> Model the data's actual distribution.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                       SLIDE 97: NELDER WEDDERBURN
// ═══════════════════════════════════════════════════════════════════════

function Slide97_NelderWedderburn() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-4">
            <h1 className="text-3xl font-bold text-purple-800">Nelder & Wedderburn (1972)</h1>
            <p className="text-gray-600">The unification that changed statistics</p>
          </div>
    
          {/* Main content - two columns */}
          <div className="flex-1 grid grid-cols-2 gap-6">
            {/* Left: The old way */}
            <div className="flex flex-col">
              <div className="bg-gray-100 border border-gray-300 rounded-xl p-4 flex-1">
                <h3 className="font-bold text-gray-700 mb-3 text-center">Before 1972: Separate Methods</h3>
                
                <div className="space-y-2">
                  <div className="bg-white rounded-lg p-2 border-l-4 border-red-400">
                    <p className="text-sm"><strong>Binary data:</strong> Logistic regression (bioassay, 1940s)</p>
                  </div>
                  <div className="bg-white rounded-lg p-2 border-l-4 border-amber-400">
                    <p className="text-sm"><strong>Count data:</strong> Poisson regression (actuarial)</p>
                  </div>
                  <div className="bg-white rounded-lg p-2 border-l-4 border-green-400">
                    <p className="text-sm"><strong>Positive data:</strong> Gamma regression (survival)</p>
                  </div>
                  <div className="bg-white rounded-lg p-2 border-l-4 border-blue-400">
                    <p className="text-sm"><strong>Tables:</strong> Log-linear models (categorical)</p>
                  </div>
                </div>
    
                <div className="mt-4 text-center text-gray-500 text-sm">
                  Different theory, different software, different courses
                </div>
              </div>
            </div>
    
            {/* Right: The insight */}
            <div className="flex flex-col">
              <div className="bg-gradient-to-b from-purple-100 to-violet-50 border-2 border-purple-300 rounded-xl p-4 flex-1">
                <h3 className="font-bold text-purple-800 mb-3 text-center">The Unifying Insight</h3>
                
                <div className="bg-white rounded-lg p-4 border border-purple-200 mb-4">
                  <p className="text-center text-purple-900 font-semibold mb-2">
                    "Transform the <em>model</em>, not the data"
                  </p>
                  <p className="text-sm text-gray-700 text-center">
                    All these distributions belong to the <strong>exponential family</strong>
                  </p>
                </div>
    
                <div className="bg-purple-50 rounded-lg p-3 mb-3">
                  <p className="text-sm text-purple-800 mb-2 font-semibold">The GLM Recipe:</p>
                  <ol className="text-sm text-purple-700 space-y-1">
                    <li>1. Choose distribution matching data type</li>
                    <li>2. Keep linear predictor: <Latex math="\eta = \mathbf{X}\boldsymbol{\beta}" /></li>
                    <li>3. Connect via link function: <Latex math="g(\mu) = \eta" /></li>
                  </ol>
                </div>
    
                <div className="text-center">
                  <span className="bg-purple-600 text-white px-4 py-2 rounded-full text-sm font-bold">
                    One Framework, Many Applications
                  </span>
                </div>
              </div>
            </div>
          </div>
    
          {/* Bottom: The legacy */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-gradient-to-r from-violet-100 via-purple-100 to-indigo-100 rounded-xl p-4 border border-purple-200">
              <div className="grid grid-cols-3 gap-4 text-center">
                <div>
                  <p className="font-bold text-purple-800">1972</p>
                  <p className="text-sm text-gray-600">JRSS-A paper published</p>
                </div>
                <div>
                  <p className="font-bold text-purple-800">1974</p>
                  <p className="text-sm text-gray-600">GLIM software released</p>
                </div>
                <div>
                  <p className="font-bold text-purple-800">Today</p>
                  <p className="text-sm text-gray-600">glm() in every package</p>
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                       SLIDE 98: THREE COMPONENTS
// ═══════════════════════════════════════════════════════════════════════

function Slide98_ThreeComponents() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-violet-800">The GLM Framework</h1>
            <p className="text-gray-600">Three components working together</p>
          </div>
    
          {/* Main content: Figure + Key equation */}
          <div className="flex-1 flex flex-col">
            {/* Textbook figure */}
            <div className="flex-1 flex items-center justify-center mb-4">
              <img 
                src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/PartII/Chapter3/ch3_5_fig01_glm_components_diagram.png"
                alt="GLM three-component framework showing random component, systematic component, and link function"
                className="max-h-114 object-contain rounded-lg shadow-lg"
              />
            </div>
    
            {/* Three components summary */}
            <div className="grid grid-cols-3 gap-4">
              {/* Random */}
              <div className="bg-gradient-to-b from-blue-100 to-blue-50 rounded-xl p-4 border-2 border-blue-300">
                <div className="text-center mb-2">
                  <span className="bg-blue-600 text-white px-3 py-1 rounded-full text-sm font-bold">1. Random</span>
                </div>
                <div className="bg-white rounded-lg p-2 text-center mb-2">
                  <Latex math="Y_i \sim \text{ExpFamily}" />
                </div>
                <p className="text-xs text-blue-800 text-center">
                  Distribution of response
                  <br />
                  (Bernoulli, Poisson, Gamma, Normal)
                </p>
              </div>
    
              {/* Systematic */}
              <div className="bg-gradient-to-b from-emerald-100 to-emerald-50 rounded-xl p-4 border-2 border-emerald-300">
                <div className="text-center mb-2">
                  <span className="bg-emerald-600 text-white px-3 py-1 rounded-full text-sm font-bold">2. Systematic</span>
                </div>
                <div className="bg-white rounded-lg p-2 text-center mb-2">
                  <Latex math="\eta_i = \mathbf{x}_i^\top \boldsymbol{\beta}" />
                </div>
                <p className="text-xs text-emerald-800 text-center">
                  Linear predictor
                  <br />
                  (Same as linear regression!)
                </p>
              </div>
    
              {/* Link */}
              <div className="bg-gradient-to-b from-purple-100 to-purple-50 rounded-xl p-4 border-2 border-purple-300">
                <div className="text-center mb-2">
                  <span className="bg-purple-600 text-white px-3 py-1 rounded-full text-sm font-bold">3. Link</span>
                </div>
                <div className="bg-white rounded-lg p-2 text-center mb-2">
                  <Latex math="g(\mu_i) = \eta_i" />
                </div>
                <p className="text-xs text-purple-800 text-center">
                  Connects mean to <Latex math="\eta" />
                  <br />
                  (logit, log, identity, inverse)
                </p>
              </div>
            </div>
          </div>
    
          {/* Bottom: Key insight */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-violet-100 border border-violet-300 rounded-lg p-3 text-center">
              <p className="text-violet-900">
                <strong>The connection:</strong>{" "}
                <Latex math="\mu_i = g^{-1}(\eta_i) = g^{-1}(\mathbf{x}_i^\top \boldsymbol{\beta})" />
                {" "}- mean is a nonlinear function of predictors
              </p>
            </div>
          </div>
        </div>
  );
}

// ═══════════════════════════════════════════════════════════════════════
//                       SLIDE 99: RANDOM COMPONENT
// ═══════════════════════════════════════════════════════════════════════

function Slide99_RandomComponent() {
  return (
    <div className="h-full flex flex-col p-6">
          {/* Header */}
          <div className="flex-shrink-0 mb-3">
            <h1 className="text-3xl font-bold text-blue-800">Random Component</h1>
            <p className="text-gray-600">Exponential dispersion family from Section 3.1</p>
          </div>
    
          {/* Density formula */}
          <div className="bg-blue-50 border border-blue-200 rounded-xl p-4 mb-4">
            <div className="text-center">
              <Latex 
                math="f(y_i | \theta_i, \phi) = \exp\left\{ \frac{y_i \theta_i - b(\theta_i)}{\phi} + c(y_i, \phi) \right\}" 
                display={true} 
              />
            </div>
            <div className="grid grid-cols-4 gap-2 mt-3 text-xs text-center">
              <div className="bg-white rounded p-2">
                <Latex math="\theta_i" /> = canonical param
              </div>
              <div className="bg-white rounded p-2">
                <Latex math="b(\theta)" /> = cumulant function
              </div>
              <div className="bg-white rounded p-2">
                <Latex math="\phi" /> = dispersion
              </div>
              <div className="bg-white rounded p-2">
                <Latex math="c(y,\phi)" /> = normalizer
              </div>
            </div>
          </div>
    
          {/* Distribution table */}
          <div className="flex-1">
            <table className="w-full text-sm border-collapse">
              <thead>
                <tr className="bg-blue-600 text-white">
                  <th className="p-2 text-left rounded-tl-lg">Distribution</th>
                  <th className="p-2 text-center"><Latex math="\theta" /></th>
                  <th className="p-2 text-center"><Latex math="b(\theta)" /></th>
                  <th className="p-2 text-center"><Latex math="\phi" /></th>
                  <th className="p-2 text-left rounded-tr-lg">Use Case</th>
                </tr>
              </thead>
              <tbody>
                <tr className="bg-gray-50 border-b border-gray-200">
                  <td className="p-2 font-semibold text-gray-800">Normal</td>
                  <td className="p-2 text-center"><Latex math="\mu" /></td>
                  <td className="p-2 text-center"><Latex math="\theta^2/2" /></td>
                  <td className="p-2 text-center"><Latex math="\sigma^2" /> (est.)</td>
                  <td className="p-2 text-gray-600">Continuous unbounded</td>
                </tr>
                <tr className="bg-white border-b border-gray-200">
                  <td className="p-2 font-semibold text-gray-800">Bernoulli</td>
                  <td className="p-2 text-center"><Latex math="\log\frac{\mu}{1-\mu}" /></td>
                  <td className="p-2 text-center"><Latex math="\log(1+e^\theta)" /></td>
                  <td className="p-2 text-center">1 (fixed)</td>
                  <td className="p-2 text-gray-600">Binary 0/1</td>
                </tr>
                <tr className="bg-gray-50 border-b border-gray-200">
                  <td className="p-2 font-semibold text-gray-800">Poisson</td>
                  <td className="p-2 text-center"><Latex math="\log \mu" /></td>
                  <td className="p-2 text-center"><Latex math="e^\theta" /></td>
                  <td className="p-2 text-center">1 (fixed)</td>
                  <td className="p-2 text-gray-600">Counts</td>
                </tr>
                <tr className="bg-white">
                  <td className="p-2 font-semibold text-gray-800 rounded-bl-lg">Gamma</td>
                  <td className="p-2 text-center"><Latex math="-1/\mu" /></td>
                  <td className="p-2 text-center"><Latex math="-\log(-\theta)" /></td>
                  <td className="p-2 text-center"><Latex math="1/\alpha" /> (est.)</td>
                  <td className="p-2 text-gray-600 rounded-br-lg">Positive continuous</td>
                </tr>
              </tbody>
            </table>
          </div>
    
          {/* Bottom: Key properties */}
          <div className="flex-shrink-0 mt-4">
            <div className="bg-gradient-to-r from-blue-100 to-indigo-100 rounded-xl p-3 border border-blue-200">
              <div className="grid grid-cols-2 gap-4 text-center">
                <div>
                  <p className="font-semibold text-blue-800">Mean</p>
                  <Latex math="\mu_i = \mathbb{E}[Y_i] = b'(\theta_i)" />
                </div>
                <div>
                  <p className="font-semibold text-blue-800">Variance</p>
                  <Latex math="\text{Var}(Y_i) = \phi \cdot b''(\theta_i) = \phi \cdot V(\mu_i)" />
                </div>
              </div>
            </div>
          </div>
        </div>
  );
}

    // ═══════════════════════════════════════════════════════════════════
    // HELPER FUNCTIONS
    // ═══════════════════════════════════════════════════════════════════
    const getSectionForSlide = (slideIndex) => {
      const slideId = slideIndex + 1;
      const sortedSections = [...sections].sort((a, b) => b.startSlide - a.startSlide);
      return sortedSections.find(s => slideId >= s.startSlide);
    };

    // ═══════════════════════════════════════════════════════════════════
    // ACCESSIBLE HELP MODAL
    // ═══════════════════════════════════════════════════════════════════
    function HelpModal({ onClose }) {
      const modalRef = useRef(null);
      useFocusTrap(true, modalRef);
      
      useEffect(() => {
        const handleEscape = (e) => {
          if (e.key === 'Escape') onClose();
        };
        window.addEventListener('keydown', handleEscape);
        return () => window.removeEventListener('keydown', handleEscape);
      }, [onClose]);
      
      return (
        <div 
          className="help-overlay" 
          onClick={onClose}
          role="dialog"
          aria-modal="true"
          aria-labelledby="help-title"
        >
          <div 
            ref={modalRef}
            className="help-content" 
            onClick={e => e.stopPropagation()}
            role="document"
          >
            <h2 id="help-title" className="text-2xl font-bold">Keyboard Shortcuts</h2>
            <div className="help-grid" role="list">
              <div role="listitem" className="contents">
                <kbd className="help-key">→ / Space / N</kbd>
                <span>Next slide</span>
              </div>
              <div role="listitem" className="contents">
                <kbd className="help-key">← / Backspace / P</kbd>
                <span>Previous slide</span>
              </div>
              <div role="listitem" className="contents">
                <kbd className="help-key">Home</kbd>
                <span>First slide</span>
              </div>
              <div role="listitem" className="contents">
                <kbd className="help-key">End</kbd>
                <span>Last slide</span>
              </div>
              <div role="listitem" className="contents">
                <kbd className="help-key">O</kbd>
                <span>Overview mode</span>
              </div>
              <div role="listitem" className="contents">
                <kbd className="help-key">F</kbd>
                <span>Fullscreen</span>
              </div>
              <div role="listitem" className="contents">
                <kbd className="help-key">?</kbd>
                <span>Show help</span>
              </div>
              <div role="listitem" className="contents">
                <kbd className="help-key">Esc</kbd>
                <span>Close overlay</span>
              </div>
            </div>
            <button 
              onClick={onClose} 
              className="help-close-btn"
              autoFocus
            >
              Close (Escape)
            </button>
          </div>
        </div>
      );
    }

    // ═══════════════════════════════════════════════════════════════════
    // ACCESSIBLE OVERVIEW MODE
    // ═══════════════════════════════════════════════════════════════════
    function OverviewMode({ slides, currentSlide, onSelectSlide, onClose }) {
      const containerRef = useRef(null);
      const currentCardRef = useRef(null);
      
      useEffect(() => {
        currentCardRef.current?.focus();
      }, []);
      
      const handleKeyDown = useCallback((e, index) => {
        const cols = Math.floor(containerRef.current?.clientWidth / 316) || 3;
        let newIndex = index;
        
        switch (e.key) {
          case 'ArrowRight': newIndex = Math.min(index + 1, slides.length - 1); break;
          case 'ArrowLeft': newIndex = Math.max(index - 1, 0); break;
          case 'ArrowDown': newIndex = Math.min(index + cols, slides.length - 1); break;
          case 'ArrowUp': newIndex = Math.max(index - cols, 0); break;
          case 'Enter':
          case ' ':
            e.preventDefault();
            onSelectSlide(index);
            return;
          case 'Escape':
            onClose();
            return;
          default: return;
        }
        
        if (newIndex !== index) {
          e.preventDefault();
          const cards = containerRef.current?.querySelectorAll('[role="gridcell"] button');
          cards?.[newIndex]?.focus();
        }
      }, [slides.length, onSelectSlide, onClose]);
      
      return (
        <div 
          ref={containerRef}
          className="overview-grid"
          role="grid"
          aria-label="Slide overview"
        >
          <div className="overview-header" role="row">
            <h2 id="overview-title" className="text-2xl font-bold">Slide Overview</h2>
            <button 
              onClick={onClose} 
              className="overview-close-btn"
              aria-label="Close overview (Escape)"
            >
              Close (Esc)
            </button>
          </div>
          <div role="row" style={{display: 'contents'}}>
            {slides.map((slide, index) => {
              const SlideComponent = slide.component;
              const isCurrent = index === currentSlide;
              
              return (
                <div key={slide.id} role="gridcell">
                  <button
                    ref={isCurrent ? currentCardRef : null}
                    onClick={() => onSelectSlide(index)}
                    onKeyDown={(e) => handleKeyDown(e, index)}
                    className={`overview-card ${isCurrent ? 'current' : ''}`}
                    aria-label={`Slide ${index + 1}: ${slide.title}${isCurrent ? ' (current)' : ''}`}
                    aria-current={isCurrent ? 'true' : undefined}
                  >
                    <div className="overview-card-content" aria-hidden="true">
                      <SlideComponent />
                    </div>
                    <div className="overview-label">
                      <span className="num" aria-hidden="true">{index + 1}</span>
                      <span>{slide.title}</span>
                    </div>
                  </button>
                </div>
              );
            })}
          </div>
        </div>
      );
    }

    // ═══════════════════════════════════════════════════════════════════
    // ACCESSIBLE PROGRESS BAR
    // ═══════════════════════════════════════════════════════════════════
    function ProgressBar({ currentSlide, slides, sections, currentSection, goToSlide, goToSection }) {
      return (
        <nav className="progress-container" aria-label="Slide progress">
          <div className="section-labels" role="tablist" aria-label="Presentation sections">
            {sections.map((section) => {
              const sectionIndex = sections.indexOf(section);
              const nextSection = sections[sectionIndex + 1];
              const sectionEnd = nextSection ? nextSection.startSlide - 1 : slides.length;
              const width = ((sectionEnd - section.startSlide + 1) / slides.length) * 100;
              const isActive = currentSection?.id === section.id;
              const isCompleted = (currentSlide + 1) > sectionEnd;
              
              return (
                <button 
                  key={section.id}
                  role="tab"
                  aria-selected={isActive}
                  className={`section-label ${isActive ? 'active' : isCompleted ? 'completed' : 'future'}`}
                  style={{width: `${width}%`}}
                  onClick={() => goToSection(section.id)}
                  title={`Go to ${section.name}`}
                  aria-label={`${section.name} section${isActive ? ' (current)' : isCompleted ? ' (completed)' : ''}`}
                >
                  <span aria-hidden="true">{section.icon}</span> {section.shortName}
                </button>
              );
            })}
          </div>
          
          <div 
            className="progress-sections" 
            role="progressbar" 
            aria-valuenow={currentSlide + 1}
            aria-valuemin={1}
            aria-valuemax={slides.length}
            aria-label={`Slide ${currentSlide + 1} of ${slides.length}`}
          >
            {sections.map((section) => {
              const sectionIndex = sections.indexOf(section);
              const nextSection = sections[sectionIndex + 1];
              const sectionStart = section.startSlide;
              const sectionEnd = nextSection ? nextSection.startSlide - 1 : slides.length;
              const slidesInSection = sectionEnd - sectionStart + 1;
              const isActiveSection = currentSection?.id === section.id;
              const isPastSection = (currentSlide + 1) > sectionEnd;
              
              const currentSlideId = currentSlide + 1;
              const slidesCompletedInSection = isActiveSection 
                ? Math.max(0, currentSlideId - sectionStart + 1)
                : isPastSection ? slidesInSection : 0;
              const sectionProgress = Math.round((slidesCompletedInSection / slidesInSection) * 100);
              
              return (
                <div 
                  key={section.id}
                  className={`section-group ${isActiveSection ? 'active' : ''}`}
                  style={{flex: slidesInSection}}
                  role="group"
                  aria-label={`${section.name}: ${slidesCompletedInSection} of ${slidesInSection} slides`}
                >
                  {isActiveSection && (
                    <div className="section-progress-text" aria-hidden="true">
                      {slidesCompletedInSection}/{slidesInSection} ({sectionProgress}%)
                    </div>
                  )}
                  
                  {Array.from({length: slidesInSection}, (_, i) => {
                    const slideNum = sectionStart + i;
                    const slideIdx = slideNum - 1;
                    const isCurrentSlide = slideNum === currentSlideId;
                    const isPastSlide = slideNum < currentSlideId;
                    
                    let barClass = 'slide-bar';
                    let status = '';
                    if (isCurrentSlide) {
                      barClass += ' current';
                      status = 'current';
                    } else if (isActiveSection) {
                      barClass += isPastSlide ? ' active-past' : ' active-future';
                      status = isPastSlide ? 'viewed' : 'upcoming in section';
                    } else if (isPastSection) {
                      barClass += ' completed';
                      status = 'completed';
                    } else {
                      barClass += ' future';
                      status = 'upcoming';
                    }
                    
                    const slideTitle = slides[slideIdx]?.title || `Slide ${slideNum}`;
                    
                    return (
                      <button
                        key={slideNum}
                        className={barClass}
                        data-tooltip={`${slideNum}: ${slideTitle}`}
                        onClick={() => goToSlide(slideIdx)}
                        aria-label={`Go to slide ${slideNum}: ${slideTitle} (${status})`}
                        aria-current={isCurrentSlide ? 'step' : undefined}
                        tabIndex={isCurrentSlide ? 0 : -1}
                      >
                        {isCurrentSlide && <div className="current-indicator" aria-hidden="true"></div>}
                      </button>
                    );
                  })}
                </div>
              );
            })}
          </div>
          
          <div className="progress-info">
            <div className="progress-counter" aria-hidden="true">
              Slide {currentSlide + 1} / {slides.length}
            </div>
            <div className="progress-legend" aria-hidden="true">
              <div className="legend-item"><div className="legend-bar completed"></div><span>Done</span></div>
              <div className="legend-item"><div className="legend-bar active"></div><span>Section</span></div>
              <div className="legend-item"><div className="legend-bar current"></div><span>Current</span></div>
              <div className="legend-item"><div className="legend-bar future"></div><span>Upcoming</span></div>
            </div>
          </div>
        </nav>
      );
    }


    // ═══════════════════════════════════════════════════════════════════
    // MAIN APP
    // ═══════════════════════════════════════════════════════════════════
    function App() {
      const [currentSlide, setCurrentSlide] = useState(0);
      const [overviewMode, setOverviewMode] = useState(false);
      const [showHelp, setShowHelp] = useState(false);
      const [announcement, setAnnouncement] = useState('');
      const mainContentRef = useRef(null);

      const CurrentSlideComponent = slides[currentSlide]?.component;
      const currentSection = getSectionForSlide(currentSlide);

      const announceSlide = useCallback((slideIndex) => {
        const slide = slides[slideIndex];
        const section = getSectionForSlide(slideIndex);
        setAnnouncement(`Slide ${slideIndex + 1} of ${slides.length}: ${slide.title}. Section: ${section?.name || 'Unknown'}`);
      }, []);

      const nextSlide = useCallback(() => {
        if (currentSlide < slides.length - 1) {
          const newSlide = currentSlide + 1;
          setCurrentSlide(newSlide);
          announceSlide(newSlide);
        }
      }, [currentSlide, announceSlide]);

      const prevSlide = useCallback(() => {
        if (currentSlide > 0) {
          const newSlide = currentSlide - 1;
          setCurrentSlide(newSlide);
          announceSlide(newSlide);
        }
      }, [currentSlide, announceSlide]);

      const goToSlide = useCallback((index) => {
        if (index >= 0 && index < slides.length) {
          setCurrentSlide(index);
          setOverviewMode(false);
          announceSlide(index);
          setTimeout(() => mainContentRef.current?.focus(), 100);
        }
      }, [announceSlide]);

      const goToSection = useCallback((sectionId) => {
        const section = sections.find(s => s.id === sectionId);
        if (section) {
          const newSlide = section.startSlide - 1;
          setCurrentSlide(newSlide);
          announceSlide(newSlide);
        }
      }, [announceSlide]);

      useEffect(() => {
        const handleKeyDown = (e) => {
          if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
          
          switch (e.key) {
            case 'ArrowRight': case ' ': case 'n': case 'N':
              if (!overviewMode && !showHelp) { e.preventDefault(); nextSlide(); }
              break;
            case 'ArrowLeft': case 'Backspace': case 'p': case 'P':
              if (!overviewMode && !showHelp) { e.preventDefault(); prevSlide(); }
              break;
            case 'Home': 
              if (!overviewMode && !showHelp) { e.preventDefault(); goToSlide(0); }
              break;
            case 'End': 
              if (!overviewMode && !showHelp) { e.preventDefault(); goToSlide(slides.length - 1); }
              break;
            case 'o': case 'O': 
              if (!showHelp) { e.preventDefault(); setOverviewMode(prev => !prev); }
              break;
            case 'f': case 'F':
              e.preventDefault();
              document.fullscreenElement ? document.exitFullscreen() : document.documentElement.requestFullscreen();
              break;
            case '?': e.preventDefault(); setShowHelp(prev => !prev); break;
            case 'Escape': e.preventDefault(); setOverviewMode(false); setShowHelp(false); break;
          }
        };
        window.addEventListener('keydown', handleKeyDown);
        return () => window.removeEventListener('keydown', handleKeyDown);
      }, [nextSlide, prevSlide, goToSlide, overviewMode, showHelp]);

      if (showHelp) {
        return (
          <>
            <LiveAnnouncer message="Help dialog opened" priority="assertive" />
            <HelpModal onClose={() => setShowHelp(false)} />
          </>
        );
      }

      if (overviewMode) {
        return (
          <>
            <LiveAnnouncer message="Overview mode. Use arrow keys to navigate, Enter to select." priority="assertive" />
            <OverviewMode 
              slides={slides}
              currentSlide={currentSlide}
              onSelectSlide={goToSlide}
              onClose={() => setOverviewMode(false)}
            />
          </>
        );
      }

      return (
        <>
          <a href="#slide-content" className="skip-link">
            Skip to slide content
          </a>
          
          <LiveAnnouncer message={announcement} />
          
          <div className="slide-container">
            <header className="slide-header" role="banner">
              <div className="header-top">
                <div className="header-title">
                  <span className="purdue">PURDUE</span>
                  <span className="course">STAT 418 - Computational Methods</span>
                </div>
                <div className="header-slide-info">
                  {currentSection && (
                    <div className="current-section" aria-label={`Current section: ${currentSection.name}`}>
                      <span className="icon" aria-hidden="true">{currentSection.icon}</span>
                      <span className="name">{currentSection.name}</span>
                    </div>
                  )}
                  <div className="slide-counter" aria-hidden="true">
                    {currentSlide + 1} / {slides.length}
                  </div>
                </div>
              </div>
              
              <ProgressBar 
                currentSlide={currentSlide}
                slides={slides}
                sections={sections}
                currentSection={currentSection}
                goToSlide={goToSlide}
                goToSection={goToSection}
              />
            </header>

            <main 
              id="slide-content"
              ref={mainContentRef}
              className="slide-content"
              role="main"
              aria-label={`Slide ${currentSlide + 1}: ${slides[currentSlide]?.title}`}
              tabIndex={-1}
            >
              <article className="slide-wrapper">
                {CurrentSlideComponent && <CurrentSlideComponent />}
              </article>
            </main>

            <nav className="slide-nav" aria-label="Slide navigation">
              <button 
                onClick={prevSlide} 
                disabled={currentSlide === 0} 
                aria-label="Previous slide (Left Arrow)"
                title="Previous slide"
              >
                <span aria-hidden="true">◀</span>
              </button>
              <button 
                onClick={nextSlide} 
                disabled={currentSlide === slides.length - 1} 
                aria-label="Next slide (Right Arrow)"
                title="Next slide"
              >
                <span aria-hidden="true">▶</span>
              </button>
              <div className="nav-divider" role="separator"></div>
              <button 
                onClick={() => setOverviewMode(true)} 
                aria-label="Open slide overview (O)"
                title="Slide overview"
              >
                <span aria-hidden="true">⊞</span>
              </button>
              <button 
                onClick={() => setShowHelp(true)} 
                aria-label="Show keyboard shortcuts (?)"
                title="Keyboard shortcuts"
              >
                <span aria-hidden="true">?</span>
              </button>
            </nav>
          </div>
        </>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
