

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1.1.3. Python Random Generation &mdash; STAT 418</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=5af2d4ad" />

  
    <link rel="canonical" href="https://treese41528.github.io/STAT418/Website/part1_foundations/chapter1/ch1.3-python_random_generation.html" />
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script>window.MathJax = {"options": {"enableMenu": true, "menuOptions": {"settings": {"enrich": true, "speech": true, "braille": true, "collapsible": true, "assistiveMml": false}}}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
      <script src="../../_static/custom.js?v=d2113767"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Part II: Simulation-Based Methods" href="../../part2_simulation/index.html" />
    <link rel="prev" title="1.1.2. Probability Distributions: Theory and Computation" href="ch1.2-probability_distributions_review.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            STAT 350: Introduction to Statistics
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Course Content</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">1. Part I: Foundations of Probability and Computation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">1.1. Chapter 1: Statistical Paradigms and Core Concepts</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ch1.1-probability-and-inference-paradigms.html">1.1.1. Paradigms of Probability and Statistical Inference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ch1.1-probability-and-inference-paradigms.html#the-mathematical-foundation-kolmogorov-s-axioms">The Mathematical Foundation: Kolmogorov‚Äôs Axioms</a></li>
<li class="toctree-l4"><a class="reference internal" href="ch1.1-probability-and-inference-paradigms.html#interpretations-of-probability">Interpretations of Probability</a></li>
<li class="toctree-l4"><a class="reference internal" href="ch1.1-probability-and-inference-paradigms.html#statistical-inference-paradigms">Statistical Inference Paradigms</a></li>
<li class="toctree-l4"><a class="reference internal" href="ch1.1-probability-and-inference-paradigms.html#historical-and-philosophical-debates">Historical and Philosophical Debates</a></li>
<li class="toctree-l4"><a class="reference internal" href="ch1.1-probability-and-inference-paradigms.html#bringing-it-all-together">Bringing It All Together</a></li>
<li class="toctree-l4"><a class="reference internal" href="ch1.1-probability-and-inference-paradigms.html#looking-ahead-our-course-focus">Looking Ahead: Our Course Focus</a></li>
<li class="toctree-l4"><a class="reference internal" href="ch1.1-probability-and-inference-paradigms.html#references-and-further-reading">References and Further Reading</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ch1.2-probability_distributions_review.html">1.1.2. Probability Distributions: Theory and Computation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ch1.2-probability_distributions_review.html#from-abstract-foundations-to-concrete-tools">From Abstract Foundations to Concrete Tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="ch1.2-probability_distributions_review.html#the-python-ecosystem-for-probability">The Python Ecosystem for Probability</a></li>
<li class="toctree-l4"><a class="reference internal" href="ch1.2-probability_distributions_review.html#introduction-why-probability-distributions-matter">Introduction: Why Probability Distributions Matter</a></li>
<li class="toctree-l4"><a class="reference internal" href="ch1.2-probability_distributions_review.html#id1">The Python Ecosystem for Probability</a></li>
<li class="toctree-l4"><a class="reference internal" href="ch1.2-probability_distributions_review.html#discrete-distributions">Discrete Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="ch1.2-probability_distributions_review.html#continuous-distributions">Continuous Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="ch1.2-probability_distributions_review.html#additional-important-distributions">Additional Important Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="ch1.2-probability_distributions_review.html#summary-and-practical-guidelines">Summary and Practical Guidelines</a></li>
<li class="toctree-l4"><a class="reference internal" href="ch1.2-probability_distributions_review.html#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">1.1.3. Python Random Generation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#from-mathematical-distributions-to-computational-samples">From Mathematical Distributions to Computational Samples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-python-ecosystem-at-a-glance">The Python Ecosystem at a Glance</a></li>
<li class="toctree-l4"><a class="reference internal" href="#understanding-pseudo-random-number-generation">Understanding Pseudo-Random Number Generation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-standard-library-random-module">The Standard Library: <code class="docutils literal notranslate"><span class="pre">random</span></code> Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#numpy-fast-vectorized-random-sampling">NumPy: Fast Vectorized Random Sampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#scipy-stats-the-complete-statistical-toolkit">SciPy Stats: The Complete Statistical Toolkit</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bringing-it-all-together-library-selection-guide">Bringing It All Together: Library Selection Guide</a></li>
<li class="toctree-l4"><a class="reference internal" href="#looking-ahead-from-random-numbers-to-monte-carlo-methods">Looking Ahead: From Random Numbers to Monte Carlo Methods</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../part2_simulation/index.html">Part II: Simulation-Based Methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../part2_simulation/chapter2/index.html">1. Chapter 2: Monte Carlo Simulation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.1-monte-carlo-fundamentals.html">1.1. Monte Carlo Fundamentals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.1-monte-carlo-fundamentals.html#the-historical-development-of-monte-carlo-methods">1.1.1. The Historical Development of Monte Carlo Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.1-monte-carlo-fundamentals.html#the-core-principle-expectation-as-integration">1.1.2. The Core Principle: Expectation as Integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.1-monte-carlo-fundamentals.html#theoretical-foundations">1.1.3. Theoretical Foundations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.1-monte-carlo-fundamentals.html#variance-estimation-and-confidence-intervals">1.1.4. Variance Estimation and Confidence Intervals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.1-monte-carlo-fundamentals.html#worked-examples">1.1.5. Worked Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.1-monte-carlo-fundamentals.html#comparison-with-deterministic-methods">1.1.6. Comparison with Deterministic Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.1-monte-carlo-fundamentals.html#sample-size-determination">1.1.7. Sample Size Determination</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.1-monte-carlo-fundamentals.html#convergence-diagnostics-and-monitoring">1.1.8. Convergence Diagnostics and Monitoring</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.1-monte-carlo-fundamentals.html#practical-considerations">1.1.9. Practical Considerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.1-monte-carlo-fundamentals.html#bringing-it-all-together">1.1.10. Bringing It All Together</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.1-monte-carlo-fundamentals.html#transition-to-what-follows">1.1.11. Transition to What Follows</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.2-uniform-random-variates.html">1.2. Uniform Random Variates</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.2-uniform-random-variates.html#the-probability-integral-transform">1.2.1. The Probability Integral Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.2-uniform-random-variates.html#the-paradox-of-computational-randomness">1.2.2. The Paradox of Computational Randomness</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.2-uniform-random-variates.html#chaotic-dynamical-systems-an-instructive-failure">1.2.3. Chaotic Dynamical Systems: An Instructive Failure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.2-uniform-random-variates.html#linear-congruential-generators">1.2.4. Linear Congruential Generators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.2-uniform-random-variates.html#shift-register-generators">1.2.5. Shift-Register Generators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.2-uniform-random-variates.html#the-kiss-generator-combining-strategies">1.2.6. The KISS Generator: Combining Strategies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.2-uniform-random-variates.html#modern-generators-mersenne-twister-and-pcg">1.2.7. Modern Generators: Mersenne Twister and PCG</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.2-uniform-random-variates.html#statistical-testing-of-random-number-generators">1.2.8. Statistical Testing of Random Number Generators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.2-uniform-random-variates.html#practical-considerations">1.2.9. Practical Considerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.2-uniform-random-variates.html#bringing-it-all-together">1.2.10. Bringing It All Together</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.2-uniform-random-variates.html#transition-to-what-follows">1.2.11. Transition to What Follows</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.3-inverse-cdf-method.html">1.3. Inverse CDF Method</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.3-inverse-cdf-method.html#mathematical-foundations">1.3.1. Mathematical Foundations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.3-inverse-cdf-method.html#continuous-distributions-with-closed-form-inverses">1.3.2. Continuous Distributions with Closed-Form Inverses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.3-inverse-cdf-method.html#numerical-inversion">1.3.3. Numerical Inversion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.3-inverse-cdf-method.html#discrete-distributions">1.3.4. Discrete Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.3-inverse-cdf-method.html#mixed-distributions">1.3.5. Mixed Distributions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.3-inverse-cdf-method.html#practical-considerations">1.3.6. Practical Considerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.3-inverse-cdf-method.html#bringing-it-all-together">1.3.7. Bringing It All Together</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter2/ch2.3-inverse-cdf-method.html#transition-to-what-follows">1.3.8. Transition to What Follows</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../part2_simulation/chapter3/index.html">2. Chapter 3: Frequentist Statistical Inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../part2_simulation/chapter3/sampling_variability.html">2.1. Sampling Variability</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/sampling_variability.html#introduction">2.1.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/sampling_variability.html#key-concepts">2.1.2. Key Concepts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/sampling_variability.html#mathematical-framework">2.1.3. Mathematical Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/sampling_variability.html#python-implementation">2.1.4. Python Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/sampling_variability.html#examples">2.1.5. Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/sampling_variability.html#summary">2.1.6. Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../part2_simulation/chapter3/statistical_estimators.html">2.2. Statistical Estimators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/statistical_estimators.html#introduction">2.2.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/statistical_estimators.html#key-concepts">2.2.2. Key Concepts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/statistical_estimators.html#mathematical-framework">2.2.3. Mathematical Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/statistical_estimators.html#python-implementation">2.2.4. Python Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/statistical_estimators.html#examples">2.2.5. Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/statistical_estimators.html#summary">2.2.6. Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../part2_simulation/chapter3/plugin_methods.html">2.3. Plugin Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/plugin_methods.html#introduction">2.3.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/plugin_methods.html#key-concepts">2.3.2. Key Concepts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/plugin_methods.html#mathematical-framework">2.3.3. Mathematical Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/plugin_methods.html#python-implementation">2.3.4. Python Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/plugin_methods.html#examples">2.3.5. Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/plugin_methods.html#summary">2.3.6. Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../part2_simulation/chapter3/parametric_inference.html">2.4. Parametric Inference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/parametric_inference.html#introduction">2.4.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/parametric_inference.html#key-concepts">2.4.2. Key Concepts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/parametric_inference.html#mathematical-framework">2.4.3. Mathematical Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/parametric_inference.html#python-implementation">2.4.4. Python Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/parametric_inference.html#examples">2.4.5. Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/parametric_inference.html#summary">2.4.6. Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../part2_simulation/chapter3/exponential_families.html">2.5. Exponential Families</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/exponential_families.html#introduction">2.5.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/exponential_families.html#key-concepts">2.5.2. Key Concepts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/exponential_families.html#mathematical-framework">2.5.3. Mathematical Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/exponential_families.html#python-implementation">2.5.4. Python Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/exponential_families.html#examples">2.5.5. Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/exponential_families.html#summary">2.5.6. Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../part2_simulation/chapter3/maximum_likelihood.html">2.6. Maximum Likelihood</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/maximum_likelihood.html#introduction">2.6.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/maximum_likelihood.html#key-concepts">2.6.2. Key Concepts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/maximum_likelihood.html#mathematical-framework">2.6.3. Mathematical Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/maximum_likelihood.html#python-implementation">2.6.4. Python Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/maximum_likelihood.html#examples">2.6.5. Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/maximum_likelihood.html#summary">2.6.6. Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../part2_simulation/chapter3/linear_models.html">2.7. Linear Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/linear_models.html#introduction">2.7.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/linear_models.html#key-concepts">2.7.2. Key Concepts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/linear_models.html#mathematical-framework">2.7.3. Mathematical Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/linear_models.html#python-implementation">2.7.4. Python Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/linear_models.html#examples">2.7.5. Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/linear_models.html#summary">2.7.6. Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../part2_simulation/chapter3/generalized_linear_models.html">2.8. Generalized Linear Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/generalized_linear_models.html#introduction">2.8.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/generalized_linear_models.html#key-concepts">2.8.2. Key Concepts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/generalized_linear_models.html#mathematical-framework">2.8.3. Mathematical Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/generalized_linear_models.html#python-implementation">2.8.4. Python Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/generalized_linear_models.html#examples">2.8.5. Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter3/generalized_linear_models.html#summary">2.8.6. Summary</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../part2_simulation/chapter4/index.html">3. Chapter 4: Resampling Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../part2_simulation/chapter4/jackknife_introduction.html">3.1. Jackknife Introduction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/jackknife_introduction.html#introduction">3.1.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/jackknife_introduction.html#key-concepts">3.1.2. Key Concepts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/jackknife_introduction.html#mathematical-framework">3.1.3. Mathematical Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/jackknife_introduction.html#python-implementation">3.1.4. Python Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/jackknife_introduction.html#examples">3.1.5. Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/jackknife_introduction.html#summary">3.1.6. Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../part2_simulation/chapter4/bootstrap_fundamentals.html">3.2. Bootstrap Fundamentals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/bootstrap_fundamentals.html#introduction">3.2.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/bootstrap_fundamentals.html#key-concepts">3.2.2. Key Concepts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/bootstrap_fundamentals.html#mathematical-framework">3.2.3. Mathematical Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/bootstrap_fundamentals.html#python-implementation">3.2.4. Python Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/bootstrap_fundamentals.html#examples">3.2.5. Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/bootstrap_fundamentals.html#summary">3.2.6. Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../part2_simulation/chapter4/nonparametric_bootstrap.html">3.3. Nonparametric Bootstrap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/nonparametric_bootstrap.html#introduction">3.3.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/nonparametric_bootstrap.html#key-concepts">3.3.2. Key Concepts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/nonparametric_bootstrap.html#mathematical-framework">3.3.3. Mathematical Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/nonparametric_bootstrap.html#python-implementation">3.3.4. Python Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/nonparametric_bootstrap.html#examples">3.3.5. Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/nonparametric_bootstrap.html#summary">3.3.6. Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../part2_simulation/chapter4/parametric_bootstrap.html">3.4. Parametric Bootstrap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/parametric_bootstrap.html#introduction">3.4.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/parametric_bootstrap.html#key-concepts">3.4.2. Key Concepts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/parametric_bootstrap.html#mathematical-framework">3.4.3. Mathematical Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/parametric_bootstrap.html#python-implementation">3.4.4. Python Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/parametric_bootstrap.html#examples">3.4.5. Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/parametric_bootstrap.html#summary">3.4.6. Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../part2_simulation/chapter4/confidence_intervals.html">3.5. Confidence Intervals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/confidence_intervals.html#introduction">3.5.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/confidence_intervals.html#key-concepts">3.5.2. Key Concepts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/confidence_intervals.html#mathematical-framework">3.5.3. Mathematical Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/confidence_intervals.html#python-implementation">3.5.4. Python Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/confidence_intervals.html#examples">3.5.5. Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/confidence_intervals.html#summary">3.5.6. Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../part2_simulation/chapter4/bias_correction.html">3.6. Bias Correction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/bias_correction.html#introduction">3.6.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/bias_correction.html#key-concepts">3.6.2. Key Concepts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/bias_correction.html#mathematical-framework">3.6.3. Mathematical Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/bias_correction.html#python-implementation">3.6.4. Python Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/bias_correction.html#examples">3.6.5. Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/bias_correction.html#summary">3.6.6. Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../part2_simulation/chapter4/cross_validation_loo.html">3.7. Cross Validation Loo</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/cross_validation_loo.html#introduction">3.7.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/cross_validation_loo.html#key-concepts">3.7.2. Key Concepts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/cross_validation_loo.html#mathematical-framework">3.7.3. Mathematical Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/cross_validation_loo.html#python-implementation">3.7.4. Python Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/cross_validation_loo.html#examples">3.7.5. Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/cross_validation_loo.html#summary">3.7.6. Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../part2_simulation/chapter4/cross_validation_k_fold.html">3.8. Cross Validation K Fold</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/cross_validation_k_fold.html#introduction">3.8.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/cross_validation_k_fold.html#key-concepts">3.8.2. Key Concepts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/cross_validation_k_fold.html#mathematical-framework">3.8.3. Mathematical Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/cross_validation_k_fold.html#python-implementation">3.8.4. Python Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/cross_validation_k_fold.html#examples">3.8.5. Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/cross_validation_k_fold.html#summary">3.8.6. Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../part2_simulation/chapter4/model_selection.html">3.9. Model Selection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/model_selection.html#introduction">3.9.1. Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/model_selection.html#key-concepts">3.9.2. Key Concepts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/model_selection.html#mathematical-framework">3.9.3. Mathematical Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/model_selection.html#python-implementation">3.9.4. Python Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/model_selection.html#examples">3.9.5. Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part2_simulation/chapter4/model_selection.html#summary">3.9.6. Summary</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../part3_bayesian/index.html">2. Part III: Bayesian Methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../part3_bayesian/index.html#overview">2.1. Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../part3_bayesian/chapter5/bayesian_philosophy.html">2.1.1. Bayesian Philosophy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../part3_bayesian/chapter5/bayesian_philosophy.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part3_bayesian/chapter5/bayesian_philosophy.html#key-concepts">Key Concepts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part3_bayesian/chapter5/bayesian_philosophy.html#mathematical-framework">Mathematical Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part3_bayesian/chapter5/bayesian_philosophy.html#python-implementation">Python Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part3_bayesian/chapter5/bayesian_philosophy.html#examples">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../part3_bayesian/chapter5/bayesian_philosophy.html#summary">Summary</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">STAT 350: Introduction to Statistics</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html"><span class="section-number">1. </span>Part I: Foundations of Probability and Computation</a></li>
          <li class="breadcrumb-item"><a href="index.html"><span class="section-number">1.1. </span>Chapter 1: Statistical Paradigms and Core Concepts</a></li>
      <li class="breadcrumb-item active"><span class="section-number">1.1.3. </span>Python Random Generation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/part1_foundations/chapter1/ch1.3-python_random_generation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="python-random-generation">
<span id="ch1-3-python-random-generation"></span><h1><span class="section-number">1.1.3. </span>Python Random Generation<a class="headerlink" href="#python-random-generation" title="Link to this heading">ÔÉÅ</a></h1>
<section id="from-mathematical-distributions-to-computational-samples">
<h2>From Mathematical Distributions to Computational Samples<a class="headerlink" href="#from-mathematical-distributions-to-computational-samples" title="Link to this heading">ÔÉÅ</a></h2>
<p>In Chapter 1.1, we established what probability <em>means</em>‚Äîwhether as long-run frequencies or degrees of belief. In Chapter 1.2, we catalogued the probability distributions that model real phenomena‚ÄîNormal, Exponential, Gamma, Poisson, and dozens more‚Äîunderstanding their mathematical properties, relationships, and when they arise naturally.</p>
<p>But theoretical understanding alone doesn‚Äôt generate data. When we need 10,000 bootstrap samples, a million Monte Carlo iterations, or posterior draws from an MCMC chain, we must bridge the gap from mathematical abstraction to computational reality. This chapter provides that bridge: a comprehensive guide to Python‚Äôs ecosystem for random number generation and probability computation.</p>
<p>Sampling from probability distributions underpins <strong>simulation, Bayesian inference, uncertainty quantification, and generative modeling</strong>. Python offers a rich ecosystem‚Äîfrom the zero-dependency standard library to high-performance scientific computing frameworks. Understanding when and how to use each tool is essential for effective computational statistics.</p>
<div class="important admonition">
<p class="admonition-title">Road Map üß≠</p>
<ul class="simple">
<li><p><strong>Understand</strong>: How pseudo-random number generators create reproducible ‚Äúrandomness‚Äù and why explicit seeding matters for scientific work</p></li>
<li><p><strong>Develop</strong>: Fluency with Python‚Äôs <code class="docutils literal notranslate"><span class="pre">random</span></code> module, NumPy‚Äôs <code class="docutils literal notranslate"><span class="pre">Generator</span></code> API, and SciPy‚Äôs <code class="docutils literal notranslate"><span class="pre">stats</span></code> distribution objects</p></li>
<li><p><strong>Implement</strong>: Sampling from all distributions covered in Chapter 1.2; weighted and stratified sampling; sequence operations</p></li>
<li><p><strong>Evaluate</strong>: Performance trade-offs, parameterization conventions, and management of parallel random streams</p></li>
</ul>
</div>
</section>
<section id="the-python-ecosystem-at-a-glance">
<h2>The Python Ecosystem at a Glance<a class="headerlink" href="#the-python-ecosystem-at-a-glance" title="Link to this heading">ÔÉÅ</a></h2>
<p>Before diving into details, here‚Äôs a map of the tools we‚Äôll explore:</p>
<table class="docutils align-default" id="id1">
<caption><span class="caption-number">Table 1.3 </span><span class="caption-text">Python Libraries for Random Generation</span><a class="headerlink" href="#id1" title="Link to this table">ÔÉÅ</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 30.0%" />
<col style="width: 30.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Category</p></th>
<th class="head"><p>Library</p></th>
<th class="head"><p>Why You Might Pick It</p></th>
<th class="head"><p>Best For</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Standard Library</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">random</span></code></p></td>
<td><p>Always available; quick scalar draws; simple shuffles; 11 classic distributions</p></td>
<td><p>Teaching, prototyping, dependency-free scripts</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Scientific Computing</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">numpy.random</span></code></p></td>
<td><p>Vectorized C/Fortran backends; 10‚Äì100√ó faster; array output; 50+ distributions</p></td>
<td><p>Monte Carlo, bootstrap, large-scale simulation</p></td>
</tr>
<tr class="row-even"><td><p><strong>Statistical Modeling</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code></p></td>
<td><p>100+ distributions; PDF/CDF/PPF/fitting; statistical tests</p></td>
<td><p>Distribution fitting, hypothesis testing, complete statistical toolkit</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Deep Learning</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">torch</span></code>, <code class="docutils literal notranslate"><span class="pre">tensorflow</span></code></p></td>
<td><p>GPU acceleration; differentiable distributions</p></td>
<td><p>Neural network initialization, VAEs, reinforcement learning</p></td>
</tr>
<tr class="row-even"><td><p><strong>Probabilistic Programming</strong></p></td>
<td><p>PyMC, Pyro, Stan</p></td>
<td><p>High-level model syntax; MCMC &amp; VI engines</p></td>
<td><p>Complex Bayesian models (covered in Chapter 5)</p></td>
</tr>
</tbody>
</table>
<p>The choice of library depends on your task. As a rule of thumb:</p>
<ul class="simple">
<li><p><strong>Need just a few random numbers?</strong> ‚Üí <code class="docutils literal notranslate"><span class="pre">random</span></code> module</p></li>
<li><p><strong>Need arrays of random numbers fast?</strong> ‚Üí NumPy <code class="docutils literal notranslate"><span class="pre">Generator</span></code></p></li>
<li><p><strong>Need probability calculations (PDF, CDF, quantiles)?</strong> ‚Üí <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code></p></li>
<li><p><strong>Building a Bayesian model?</strong> ‚Üí PyMC, Pyro, or Stan (Chapter 5)</p></li>
</ul>
</section>
<section id="understanding-pseudo-random-number-generation">
<h2>Understanding Pseudo-Random Number Generation<a class="headerlink" href="#understanding-pseudo-random-number-generation" title="Link to this heading">ÔÉÅ</a></h2>
<p>Before using any library, we should understand what‚Äôs happening under the hood. Computers are deterministic machines‚Äîgiven the same input, they produce the same output. So how do they generate ‚Äúrandom‚Äù numbers?</p>
<section id="the-nature-of-pseudo-randomness">
<h3>The Nature of Pseudo-Randomness<a class="headerlink" href="#the-nature-of-pseudo-randomness" title="Link to this heading">ÔÉÅ</a></h3>
<p><strong>Pseudo-random number generators (PRNGs)</strong> are deterministic algorithms that produce sequences of numbers which, while entirely predictable given the algorithm and starting point, pass stringent statistical tests for randomness. When you call <code class="docutils literal notranslate"><span class="pre">random.random()</span></code>, you‚Äôre executing a mathematical formula that computes the next number in a deterministic sequence.</p>
<p>This determinism is actually a feature, not a bug:</p>
<ol class="arabic simple">
<li><p><strong>Reproducibility</strong>: Given the same starting point (the <strong>seed</strong>), a PRNG produces exactly the same sequence. This enables scientific reproducibility‚Äîif you report bootstrap results, others can verify your exact computation.</p></li>
<li><p><strong>Debugging</strong>: When a simulation produces unexpected results, fixing the seed lets you reproduce the problematic run while investigating.</p></li>
<li><p><strong>Testing</strong>: Unit tests for stochastic code can have deterministic pass/fail criteria.</p></li>
</ol>
</section>
<section id="what-makes-a-good-prng">
<h3>What Makes a Good PRNG?<a class="headerlink" href="#what-makes-a-good-prng" title="Link to this heading">ÔÉÅ</a></h3>
<p>A sequence <span class="math notranslate nohighlight">\(u_1, u_2, u_3, \ldots\)</span> behaves like independent draws from <span class="math notranslate nohighlight">\(\text{Uniform}(0, 1)\)</span> if it satisfies:</p>
<p><strong>Uniformity</strong>: Values should be evenly distributed across <span class="math notranslate nohighlight">\([0, 1)\)</span>. Dividing into <span class="math notranslate nohighlight">\(k\)</span> equal bins, each should contain approximately <span class="math notranslate nohighlight">\(n/k\)</span> of <span class="math notranslate nohighlight">\(n\)</span> total values.</p>
<p><strong>Independence</strong>: Knowing <span class="math notranslate nohighlight">\(u_t\)</span> should provide no information about <span class="math notranslate nohighlight">\(u_{t+1}\)</span>. No correlation between values at any lag.</p>
<p><strong>Long period</strong>: The <strong>period</strong>‚Äîthe length before the sequence repeats‚Äîshould vastly exceed any practical simulation length.</p>
<p><strong>High-dimensional equidistribution</strong>: When consecutive outputs are used as coordinates in high-dimensional space, points should fill the space uniformly.</p>
<p>Modern PRNGs are tested against extensive statistical test suites (like TestU01‚Äôs BigCrush). The generators in Python and NumPy pass these tests.</p>
</section>
<section id="the-mersenne-twister">
<h3>The Mersenne Twister<a class="headerlink" href="#the-mersenne-twister" title="Link to this heading">ÔÉÅ</a></h3>
<p>Python‚Äôs standard library uses the <strong>Mersenne Twister</strong> (MT19937), developed by Matsumoto and Nishimura in 1997:</p>
<ul class="simple">
<li><p><strong>Period</strong>: <span class="math notranslate nohighlight">\(2^{19937} - 1\)</span> (approximately <span class="math notranslate nohighlight">\(10^{6001}\)</span>)‚Äîfar exceeding any simulation need</p></li>
<li><p><strong>623-dimensional equidistribution</strong>: Suitable for high-dimensional Monte Carlo</p></li>
<li><p><strong>State size</strong>: 624 √ó 32-bit integers (19,968 bits)</p></li>
<li><p><strong>Speed</strong>: Uses simple bit operations; very fast</p></li>
</ul>
<p><strong>Limitations</strong>: Not cryptographically secure (given 624 outputs, the state can be reconstructed). For security applications, use Python‚Äôs <code class="docutils literal notranslate"><span class="pre">secrets</span></code> module.</p>
</section>
<section id="numpy-s-pcg64">
<h3>NumPy‚Äôs PCG64<a class="headerlink" href="#numpy-s-pcg64" title="Link to this heading">ÔÉÅ</a></h3>
<p>NumPy‚Äôs modern <code class="docutils literal notranslate"><span class="pre">Generator</span></code> API defaults to <strong>PCG64</strong> (Permuted Congruential Generator):</p>
<ul class="simple">
<li><p><strong>Period</strong>: <span class="math notranslate nohighlight">\(2^{128}\)</span> with smaller state (128 bits)</p></li>
<li><p><strong>Better statistical properties</strong>: Passes even more stringent tests</p></li>
<li><p><strong>Faster</strong>: Simpler operations on modern 64-bit CPUs</p></li>
<li><p><strong>Jumpable</strong>: Can efficiently skip ahead, enabling parallel streams</p></li>
</ul>
<p>For new projects, NumPy‚Äôs PCG64 is generally preferred over Mersenne Twister.</p>
</section>
</section>
<section id="the-standard-library-random-module">
<h2>The Standard Library: <code class="docutils literal notranslate"><span class="pre">random</span></code> Module<a class="headerlink" href="#the-standard-library-random-module" title="Link to this heading">ÔÉÅ</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">random</span></code> module ships with every Python installation‚Äîno <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span></code> required. It‚Äôs ideal for teaching, prototyping, and situations where external dependencies are problematic.</p>
<section id="generating-random-numbers">
<h3>Generating Random Numbers<a class="headerlink" href="#generating-random-numbers" title="Link to this heading">ÔÉÅ</a></h3>
<p>The foundation of all random generation is the uniform distribution on <span class="math notranslate nohighlight">\([0, 1)\)</span>:</p>
<table class="docutils align-default" id="id2">
<caption><span class="caption-number">Table 1.4 </span><span class="caption-text">Basic Random Number Functions</span><a class="headerlink" href="#id2" title="Link to this table">ÔÉÅ</a></caption>
<colgroup>
<col style="width: 25.0%" />
<col style="width: 15.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Output</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">random.random()</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td><p>Uniform on <span class="math notranslate nohighlight">\([0, 1)\)</span>; the fundamental building block</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">random.uniform(a,</span> <span class="pre">b)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td><p>Uniform on <span class="math notranslate nohighlight">\([a, b]\)</span>; implemented as <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+</span> <span class="pre">(b-a)</span> <span class="pre">*</span> <span class="pre">random()</span></code>; if <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&gt;</span> <span class="pre">b</span></code> silently swaps</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">random.randint(a,</span> <span class="pre">b)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p></td>
<td><p>Discrete uniform on <span class="math notranslate nohighlight">\(\{a, a+1, \ldots, b\}\)</span>; <strong>inclusive on both ends</strong></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">random.randrange(start,</span> <span class="pre">stop,</span> <span class="pre">step)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p></td>
<td><p>Like <code class="docutils literal notranslate"><span class="pre">range()</span></code> but random element; <strong>half-open</strong> (excludes <code class="docutils literal notranslate"><span class="pre">stop</span></code>)</p></td>
</tr>
</tbody>
</table>
<p><strong>Rule of thumb</strong>: Use <code class="docutils literal notranslate"><span class="pre">random()</span></code> for unit-interval floats; <code class="docutils literal notranslate"><span class="pre">uniform(a,</span> <span class="pre">b)</span></code> for self-documenting intervals; <code class="docutils literal notranslate"><span class="pre">randint(a,</span> <span class="pre">b)</span></code> for dice rolls and indices.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statistics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean</span><span class="p">,</span> <span class="n">pvariance</span>

<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># For reproducibility</span>

<span class="c1"># Generate U(0,1) samples</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>

<span class="c1"># Verify distributional properties</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;U(0,1)  n=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  mean     : </span><span class="si">{</span><span class="n">mean</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">  (theory 0.5000)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  variance : </span><span class="si">{</span><span class="n">pvariance</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">  (theory 0.0833)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  min‚Ä¶max  : </span><span class="si">{</span><span class="nb">min</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2"> ‚Ä¶ </span><span class="si">{</span><span class="nb">max</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="random-operations-on-sequences">
<h3>Random Operations on Sequences<a class="headerlink" href="#random-operations-on-sequences" title="Link to this heading">ÔÉÅ</a></h3>
<p>Beyond generating numbers, we often need to sample from existing sequences‚Äîselecting survey respondents, shuffling experimental treatments, or drawing cards.</p>
<table class="docutils align-default" id="id3">
<caption><span class="caption-number">Table 1.5 </span><span class="caption-text">Sequence Sampling Functions</span><a class="headerlink" href="#id3" title="Link to this table">ÔÉÅ</a></caption>
<colgroup>
<col style="width: 28.0%" />
<col style="width: 12.0%" />
<col style="width: 12.0%" />
<col style="width: 10.0%" />
<col style="width: 10.0%" />
<col style="width: 28.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Returns</p></th>
<th class="head"><p>Replacement?</p></th>
<th class="head"><p>Size</p></th>
<th class="head"><p>Weights?</p></th>
<th class="head"><p>When to Use</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">random.choice(seq)</span></code></p></td>
<td><p>One element</p></td>
<td><p>‚Äî</p></td>
<td><p>‚Äî</p></td>
<td><p>No</p></td>
<td><p>Pick a single winner, coin-flip between labels</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">random.choices(seq,</span> <span class="pre">k=,</span> <span class="pre">weights=)</span></code></p></td>
<td><p>List of <code class="docutils literal notranslate"><span class="pre">k</span></code></p></td>
<td><p><strong>With</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">k=</span></code></p></td>
<td><p>Yes</p></td>
<td><p>Bootstrap resampling, Monte Carlo from categorical</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">random.sample(seq,</span> <span class="pre">k)</span></code></p></td>
<td><p>List of <code class="docutils literal notranslate"><span class="pre">k</span></code> <strong>unique</strong></p></td>
<td><p><strong>Without</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">k</span></code> positional</p></td>
<td><p>No</p></td>
<td><p>Deal cards, random subset for cross-validation</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">random.shuffle(seq)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p>‚Äî</p></td>
<td><p>whole seq</p></td>
<td><p>‚Äî</p></td>
<td><p>In-place permutation (e.g., shuffle deck)</p></td>
</tr>
</tbody>
</table>
<p><strong>Key distinction</strong>: <code class="docutils literal notranslate"><span class="pre">choices</span></code> (with replacement) allows duplicates; <code class="docutils literal notranslate"><span class="pre">sample</span></code> (without replacement) guarantees uniqueness. Bootstrap resampling uses <code class="docutils literal notranslate"><span class="pre">choices</span></code>; survey sampling uses <code class="docutils literal notranslate"><span class="pre">sample</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span>

<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># choice: single random element</span>
<span class="n">volunteers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;Carol&quot;</span><span class="p">,</span> <span class="s2">&quot;Deepak&quot;</span><span class="p">,</span> <span class="s2">&quot;Eve&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Today&#39;s volunteer: </span><span class="si">{</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">volunteers</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># choices: weighted sampling WITH replacement (loaded die)</span>
<span class="n">faces</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">]</span>  <span class="c1"># Biased toward high values</span>
<span class="n">rolls</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">faces</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Loaded die frequencies:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">face</span><span class="p">,</span> <span class="n">target_p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">faces</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span>
    <span class="n">empirical_p</span> <span class="o">=</span> <span class="n">rolls</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">face</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">rolls</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">face</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">empirical_p</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">  (target </span><span class="si">{</span><span class="n">target_p</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="c1"># sample: WITHOUT replacement (poker hand)</span>
<span class="n">deck</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r</span><span class="si">}{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="s2">&quot;‚ô†‚ô•‚ô¶‚ô£&quot;</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="s2">&quot;A23456789TJQK&quot;</span><span class="p">]</span>
<span class="n">hand</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">deck</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Poker hand: </span><span class="si">{</span><span class="n">hand</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># shuffle: in-place randomization</span>
<span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shuffled: </span><span class="si">{</span><span class="n">items</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="warning admonition">
<p class="admonition-title">Common Pitfall ‚ö†Ô∏è</p>
<p><code class="docutils literal notranslate"><span class="pre">shuffle()</span></code> works only on <strong>mutable</strong> sequences (lists). For strings or tuples, convert to a list first:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;HELLO&quot;</span>
<span class="n">letters</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">letters</span><span class="p">)</span>
<span class="n">shuffled</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">letters</span><span class="p">)</span>  <span class="c1"># e.g., &quot;OELHL&quot;</span>
</pre></div>
</div>
</div>
</section>
<section id="distribution-generators">
<h3>Distribution Generators<a class="headerlink" href="#distribution-generators" title="Link to this heading">ÔÉÅ</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">random</span></code> module provides generators for common continuous distributions. Each uses the <strong>rate</strong> or <strong>scale</strong> parameterization noted below‚Äîpay attention to avoid errors.</p>
<table class="docutils align-default" id="id4">
<caption><span class="caption-number">Table 1.6 </span><span class="caption-text">Continuous Distribution Functions in <code class="docutils literal notranslate"><span class="pre">random</span></code></span><a class="headerlink" href="#id4" title="Link to this table">ÔÉÅ</a></caption>
<colgroup>
<col style="width: 30.0%" />
<col style="width: 35.0%" />
<col style="width: 35.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Distribution</p></th>
<th class="head"><p>Parameters &amp; Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">gauss(mu,</span> <span class="pre">sigma)</span></code></p></td>
<td><p>Normal <span class="math notranslate nohighlight">\(N(\mu, \sigma^2)\)</span></p></td>
<td><p>Slightly faster than <code class="docutils literal notranslate"><span class="pre">normalvariate</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">normalvariate(mu,</span> <span class="pre">sigma)</span></code></p></td>
<td><p>Normal <span class="math notranslate nohighlight">\(N(\mu, \sigma^2)\)</span></p></td>
<td><p>Thread-safe version</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">expovariate(lambd)</span></code></p></td>
<td><p>Exponential with <strong>rate</strong> <span class="math notranslate nohighlight">\(\lambda\)</span></p></td>
<td><p>Mean = <span class="math notranslate nohighlight">\(1/\lambda\)</span>. <strong>Not scale!</strong></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">gammavariate(alpha,</span> <span class="pre">beta)</span></code></p></td>
<td><p>Gamma with shape <span class="math notranslate nohighlight">\(\alpha\)</span>, <strong>scale</strong> <span class="math notranslate nohighlight">\(\beta\)</span></p></td>
<td><p>Mean = <span class="math notranslate nohighlight">\(\alpha \beta\)</span></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">betavariate(alpha,</span> <span class="pre">beta)</span></code></p></td>
<td><p>Beta(<span class="math notranslate nohighlight">\(\alpha, \beta\)</span>)</p></td>
<td><p>Support <span class="math notranslate nohighlight">\([0, 1]\)</span>; mean = <span class="math notranslate nohighlight">\(\alpha/(\alpha+\beta)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">lognormvariate(mu,</span> <span class="pre">sigma)</span></code></p></td>
<td><p>Log-Normal</p></td>
<td><p><span class="math notranslate nohighlight">\(\exp(N(\mu, \sigma^2))\)</span></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">weibullvariate(alpha,</span> <span class="pre">beta)</span></code></p></td>
<td><p>Weibull with scale <span class="math notranslate nohighlight">\(\alpha\)</span>, shape <span class="math notranslate nohighlight">\(\beta\)</span></p></td>
<td><p>Note: scale first, shape second</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">paretovariate(alpha)</span></code></p></td>
<td><p>Pareto Type I with shape <span class="math notranslate nohighlight">\(\alpha\)</span></p></td>
<td><p>Support <span class="math notranslate nohighlight">\([1, \infty)\)</span></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">vonmisesvariate(mu,</span> <span class="pre">kappa)</span></code></p></td>
<td><p>Von Mises (circular normal)</p></td>
<td><p><span class="math notranslate nohighlight">\(\mu\)</span> = mean angle, <span class="math notranslate nohighlight">\(\kappa\)</span> = concentration</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">triangular(low,</span> <span class="pre">high,</span> <span class="pre">mode)</span></code></p></td>
<td><p>Triangular</p></td>
<td><p>Peak at <code class="docutils literal notranslate"><span class="pre">mode</span></code></p></td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Normal distribution</span>
<span class="n">normal_samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;N(0,1): </span><span class="si">{</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">normal_samples</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Exponential - RATE parameter (mean = 1/rate)</span>
<span class="c1"># For mean = 2, use rate = 0.5</span>
<span class="n">exp_samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">expovariate</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exp(rate=0.5, mean=2): </span><span class="si">{</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">exp_samples</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Gamma distribution</span>
<span class="n">gamma_samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">gammavariate</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gamma(Œ±=2, Œ≤=3): </span><span class="si">{</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">gamma_samples</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Beta distribution</span>
<span class="n">beta_samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">betavariate</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Beta(2,5): </span><span class="si">{</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">beta_samples</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="note admonition">
<p class="admonition-title">Example üí°: Verifying Distribution Properties</p>
<p><strong>Problem:</strong> Verify that samples from standard distributions match their theoretical moments.</p>
<p><strong>Implementation:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statistics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean</span><span class="p">,</span> <span class="n">pvariance</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">gamma</span> <span class="k">as</span> <span class="n">math_gamma</span>

<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="n">distributions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;Normal(0,1)&quot;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Exponential(Œª=1)&quot;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">expovariate</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Gamma(Œ±=2, Œ∏=3)&quot;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">gammavariate</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Beta(2,5)&quot;</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">betavariate</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">2</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">49</span><span class="o">*</span><span class="mi">8</span><span class="p">)),</span>
<span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Distribution&#39;</span><span class="si">:</span><span class="s2">&lt;22</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Sample Œº&#39;</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Theory Œº&#39;</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Sample œÉ¬≤&#39;</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Theory œÉ¬≤&#39;</span><span class="si">:</span><span class="s2">&gt;10</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">66</span><span class="p">)</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">sampler</span><span class="p">,</span> <span class="n">mu_th</span><span class="p">,</span> <span class="n">var_th</span> <span class="ow">in</span> <span class="n">distributions</span><span class="p">:</span>
    <span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">sampler</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
    <span class="n">mu_emp</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
    <span class="n">var_emp</span> <span class="o">=</span> <span class="n">pvariance</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">:</span><span class="s2">&lt;22</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">mu_emp</span><span class="si">:</span><span class="s2">&gt;10.4f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">mu_th</span><span class="si">:</span><span class="s2">&gt;10.4f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">var_emp</span><span class="si">:</span><span class="s2">&gt;10.4f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">var_th</span><span class="si">:</span><span class="s2">&gt;10.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Result:</strong> Sample moments closely match theoretical values, confirming correct implementation.</p>
</div>
</section>
<section id="controlling-randomness-seeds-and-state">
<h3>Controlling Randomness: Seeds and State<a class="headerlink" href="#controlling-randomness-seeds-and-state" title="Link to this heading">ÔÉÅ</a></h3>
<p>Reproducibility is essential for scientific computing. The <code class="docutils literal notranslate"><span class="pre">random</span></code> module provides three mechanisms:</p>
<table class="docutils align-default" id="id5">
<caption><span class="caption-number">Table 1.7 </span><span class="caption-text">State Control Functions</span><a class="headerlink" href="#id5" title="Link to this table">ÔÉÅ</a></caption>
<colgroup>
<col style="width: 30.0%" />
<col style="width: 35.0%" />
<col style="width: 35.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Purpose</p></th>
<th class="head"><p>Key Details</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">seed(a=None)</span></code></p></td>
<td><p>Initialize the PRNG</p></td>
<td><p>Same seed ‚Üí identical sequence; <code class="docutils literal notranslate"><span class="pre">None</span></code> uses system entropy</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">getstate()</span></code></p></td>
<td><p>Capture full internal state</p></td>
<td><p>Returns ~6300-integer tuple (Mersenne Twister state)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">setstate(state)</span></code></p></td>
<td><p>Restore captured state</p></td>
<td><p>Resumes stream exactly where it left off</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Random(seed)</span></code></p></td>
<td><p>Independent RNG object</p></td>
<td><p>Keeps multiple deterministic streams without touching global</p></td>
</tr>
</tbody>
</table>
<p><strong>Typical patterns:</strong></p>
<table class="docutils align-default" id="id6">
<caption><span class="caption-number">Table 1.8 </span><span class="caption-text">When to Use Each Control Method</span><a class="headerlink" href="#id6" title="Link to this table">ÔÉÅ</a></caption>
<colgroup>
<col style="width: 35.0%" />
<col style="width: 65.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Scenario</p></th>
<th class="head"><p>Recommended Approach</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Intro demo / unit test</p></td>
<td><p>Call <code class="docutils literal notranslate"><span class="pre">random.seed(42)</span></code> at the top</p></td>
</tr>
<tr class="row-odd"><td><p>Pause &amp; resume long simulation</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">state</span> <span class="pre">=</span> <span class="pre">random.getstate()</span></code> ‚Üí save to disk ‚Üí later <code class="docutils literal notranslate"><span class="pre">random.setstate(state)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Parallel simulations</p></td>
<td><p>Create <code class="docutils literal notranslate"><span class="pre">random.Random(seed+i)</span></code> per worker to avoid overlap</p></td>
</tr>
<tr class="row-odd"><td><p>Temporary determinism</p></td>
<td><p>Store state, run code, restore: <code class="docutils literal notranslate"><span class="pre">state</span> <span class="pre">=</span> <span class="pre">getstate();</span> <span class="pre">...;</span> <span class="pre">setstate(state)</span></code></p></td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>

<span class="c1"># Reproducibility demonstration</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">run1</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>

<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># Reset to same seed</span>
<span class="n">run2</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Run 1: </span><span class="si">{</span><span class="n">run1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Run 2: </span><span class="si">{</span><span class="n">run2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Identical: </span><span class="si">{</span><span class="n">run1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">run2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># True</span>

<span class="c1"># State save/restore</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>  <span class="c1"># Advance state</span>
<span class="n">saved</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">getstate</span><span class="p">()</span>

<span class="n">batch1</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
<span class="n">random</span><span class="o">.</span><span class="n">setstate</span><span class="p">(</span><span class="n">saved</span><span class="p">)</span>  <span class="c1"># Restore</span>
<span class="n">batch2</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Batches match: </span><span class="si">{</span><span class="n">batch1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">batch2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># True</span>
</pre></div>
</div>
</section>
</section>
<section id="numpy-fast-vectorized-random-sampling">
<h2>NumPy: Fast Vectorized Random Sampling<a class="headerlink" href="#numpy-fast-vectorized-random-sampling" title="Link to this heading">ÔÉÅ</a></h2>
<p>For serious scientific computing‚ÄîMonte Carlo simulations, bootstrap resampling, machine learning‚ÄîNumPy‚Äôs random module is essential. It‚Äôs typically <strong>50‚Äì100√ó faster</strong> than Python loops and provides far more distributions.</p>
<section id="why-numpy-is-the-default-for-scientific-work">
<h3>Why NumPy Is the Default for Scientific Work<a class="headerlink" href="#why-numpy-is-the-default-for-scientific-work" title="Link to this heading">ÔÉÅ</a></h3>
<table class="docutils align-default" id="id7">
<caption><span class="caption-number">Table 1.9 </span><span class="caption-text">NumPy Advantages</span><a class="headerlink" href="#id7" title="Link to this table">ÔÉÅ</a></caption>
<colgroup>
<col style="width: 25.0%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>What It Buys You</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>ndarray-native</strong></p></td>
<td><p>Draws arrive in the same structure you use for linear algebra, broadcasting, pandas I/O</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Vectorized C/Fortran core</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">rng.normal(size=1_000_000)</span></code> finishes in milliseconds‚Äîno Python loop overhead</p></td>
</tr>
<tr class="row-even"><td><p><strong>Modern Generator API</strong></p></td>
<td><p>Independent streams (<code class="docutils literal notranslate"><span class="pre">rng1</span></code>, <code class="docutils literal notranslate"><span class="pre">rng2</span></code>) ‚Üí no accidental global-state collisions</p></td>
</tr>
<tr class="row-odd"><td><p><strong>PCG64 PRNG</strong></p></td>
<td><p>Tiny state, period <span class="math notranslate nohighlight">\(2^{128}\)</span>, passes BigCrush; spawns parallel streams safely</p></td>
</tr>
<tr class="row-even"><td><p><strong>Dozens of distributions</strong></p></td>
<td><p>Uniform to Dirichlet, plus multinomial, hypergeometric, log-series, ‚Ä¶</p></td>
</tr>
</tbody>
</table>
</section>
<section id="the-modern-generator-api">
<h3>The Modern Generator API<a class="headerlink" href="#the-modern-generator-api" title="Link to this heading">ÔÉÅ</a></h3>
<p>NumPy provides two APIs: the <strong>legacy API</strong> (<code class="docutils literal notranslate"><span class="pre">np.random.rand()</span></code>, etc.) using global state, and the <strong>modern Generator API</strong> using explicit objects. Always use the modern API:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Create a Generator with specific seed</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Generate arrays of random numbers</span>
<span class="n">uniforms</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>           <span class="c1"># 10 U(0,1) values</span>
<span class="n">normals</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>   <span class="c1"># 10 N(0,1) values</span>
<span class="n">integers</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">integers</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>   <span class="c1"># 10 dice rolls {1,2,3,4,5,6}</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Uniforms: </span><span class="si">{</span><span class="n">uniforms</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Normals: </span><span class="si">{</span><span class="n">normals</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Integers: </span><span class="si">{</span><span class="n">integers</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Why explicit generators are better:</strong></p>
<ol class="arabic simple">
<li><p><strong>No hidden global state</strong>: Different code sections don‚Äôt interfere</p></li>
<li><p><strong>Clear reproducibility</strong>: Pass generators to functions explicitly</p></li>
<li><p><strong>Parallel safety</strong>: Create independent streams for workers</p></li>
<li><p><strong>Better algorithms</strong>: Default PCG64 beats Mersenne Twister</p></li>
</ol>
</section>
<section id="performance-comparison">
<h3>Performance Comparison<a class="headerlink" href="#performance-comparison" title="Link to this heading">ÔÉÅ</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">1_000_000</span>

<span class="c1"># Python standard library</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="n">python_samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
<span class="n">python_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="c1"># NumPy Generator</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="n">numpy_samples</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">numpy_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Python: </span><span class="si">{</span><span class="n">python_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> sec&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NumPy:  </span><span class="si">{</span><span class="n">numpy_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> sec&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Speedup: </span><span class="si">{</span><span class="n">python_time</span><span class="o">/</span><span class="n">numpy_time</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">√ó&quot;</span><span class="p">)</span>
<span class="c1"># Typical: 50-100√ó speedup</span>
</pre></div>
</div>
<figure class="align-center" id="id8">
<a class="reference internal image-reference" href="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/Part1/numpy_performance.png"><img alt="Performance comparison showing NumPy 50-100√ó faster than Python loops" src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/Part1/numpy_performance.png" style="width: 95%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 1.20 </span><span class="caption-text"><strong>NumPy Performance Advantage.</strong> Speedups of 50‚Äì100√ó come from eliminating Python‚Äôs per-element overhead, not from faster random number algorithms.</span><a class="headerlink" href="#id8" title="Link to this image">ÔÉÅ</a></p>
</figcaption>
</figure>
</section>
<section id="univariate-distributions">
<h3>Univariate Distributions<a class="headerlink" href="#univariate-distributions" title="Link to this heading">ÔÉÅ</a></h3>
<p>NumPy provides generators for all distributions from Chapter 1.2:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="c1"># Continuous distributions</span>
<span class="n">uniform_01</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>                        <span class="c1"># U(0,1)</span>
<span class="n">uniform_ab</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>                <span class="c1"># U(-3, 2)</span>
<span class="n">normal</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>   <span class="c1"># N(100, 225)</span>
<span class="n">exponential</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>   <span class="c1"># Exp(scale=2), mean=2</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>      <span class="c1"># Gamma(k=2, Œ∏=3)</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>                <span class="c1"># Beta(2, 5)</span>

<span class="c1"># Discrete distributions</span>
<span class="n">binomial</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>     <span class="c1"># Binom(20, 0.3)</span>
<span class="n">poisson</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">lam</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>             <span class="c1"># Poisson(Œª=5)</span>
<span class="n">geometric</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">geometric</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>         <span class="c1"># Geom(p=0.2)</span>

<span class="c1"># Verify moments</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;N(100,15¬≤):  mean=</span><span class="si">{</span><span class="n">normal</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, std=</span><span class="si">{</span><span class="n">normal</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exp(Œ∏=2):    mean=</span><span class="si">{</span><span class="n">exponential</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gamma(2,3):  mean=</span><span class="si">{</span><span class="n">gamma</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (theory: 6)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Poisson(5):  mean=</span><span class="si">{</span><span class="n">poisson</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, var=</span><span class="si">{</span><span class="n">poisson</span><span class="o">.</span><span class="n">var</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center" id="id9">
<a class="reference internal image-reference" href="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/Part1/distribution_gallery.png"><img alt="Six distributions with histograms and theoretical curves" src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/Part1/distribution_gallery.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 1.21 </span><span class="caption-text"><strong>Sampling from Common Distributions.</strong> Histograms of 10,000 samples with theoretical curves overlaid confirm correct implementation.</span><a class="headerlink" href="#id9" title="Link to this image">ÔÉÅ</a></p>
</figcaption>
</figure>
</section>
<section id="multivariate-distributions">
<h3>Multivariate Distributions<a class="headerlink" href="#multivariate-distributions" title="Link to this heading">ÔÉÅ</a></h3>
<p>NumPy excels at multivariate distributions essential for modeling correlated data:</p>
<p><strong>Multivariate Normal:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Bivariate normal with correlation œÅ = 0.8</span>
<span class="n">mean</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">cov</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]]</span>

<span class="n">samples</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">cov</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sample correlation: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">samples</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sample covariance:</span><span class="se">\n</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">samples</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center" id="id10">
<a class="reference internal image-reference" href="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/Part1/multivariate_normal.png"><img alt="Three scatter plots showing correlations œÅ = -0.8, 0, 0.8" src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/Part1/multivariate_normal.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 1.22 </span><span class="caption-text"><strong>Bivariate Normal with Different Correlations.</strong> Negative correlation creates downward-sloping clouds; positive correlation creates upward-sloping clouds.</span><a class="headerlink" href="#id10" title="Link to this image">ÔÉÅ</a></p>
</figcaption>
</figure>
<p><strong>Dirichlet Distribution:</strong></p>
<p>The Dirichlet generates probability vectors (samples sum to 1)‚Äîessential as a prior for categorical data in Bayesian statistics:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Dirichlet with concentration Œ± = [2, 5, 3]</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">dirichlet</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dirichlet samples (each row sums to 1):&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">samples</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: [</span><span class="si">{</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">], sum=</span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Theoretical mean = Œ± / sum(Œ±)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Theory mean: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="numpy-sampling-utilities">
<h3>NumPy Sampling Utilities<a class="headerlink" href="#numpy-sampling-utilities" title="Link to this heading">ÔÉÅ</a></h3>
<p>NumPy provides powerful functions for sampling from existing arrays:</p>
<table class="docutils align-default" id="id11">
<caption><span class="caption-number">Table 1.10 </span><span class="caption-text">NumPy Sampling Functions</span><a class="headerlink" href="#id11" title="Link to this table">ÔÉÅ</a></caption>
<colgroup>
<col style="width: 35.0%" />
<col style="width: 65.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rng.choice(a,</span> <span class="pre">size,</span> <span class="pre">replace,</span> <span class="pre">p,</span> <span class="pre">axis)</span></code></p></td>
<td><p>Weighted sampling with/without replacement; <strong>axis-aware</strong> (NumPy ‚â•1.23)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">rng.permutation(x,</span> <span class="pre">axis)</span></code></p></td>
<td><p>Return permuted <strong>copy</strong> along axis</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rng.shuffle(x,</span> <span class="pre">axis)</span></code></p></td>
<td><p>Shuffle <strong>in-place</strong> along axis</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">rng.bytes(n)</span></code></p></td>
<td><p>Generate <code class="docutils literal notranslate"><span class="pre">n</span></code> random bytes</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rng.integers(low,</span> <span class="pre">high,</span> <span class="pre">size)</span></code></p></td>
<td><p>Random integers in <code class="docutils literal notranslate"><span class="pre">[low,</span> <span class="pre">high)</span></code></p></td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>

<span class="c1"># Sample WITH replacement (bootstrap)</span>
<span class="n">bootstrap</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bootstrap sample: </span><span class="si">{</span><span class="n">bootstrap</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Sample WITHOUT replacement</span>
<span class="n">subset</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unique subset: </span><span class="si">{</span><span class="n">subset</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Weighted sampling</span>
<span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span>
<span class="n">weighted</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Weighted (favors 40,50): </span><span class="si">{</span><span class="n">weighted</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Axis-aware bootstrap of rows</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">boot_rows</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Original:</span><span class="se">\n</span><span class="si">{</span><span class="n">X</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bootstrap rows:</span><span class="se">\n</span><span class="si">{</span><span class="n">boot_rows</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-center" id="id12">
<a class="reference internal image-reference" href="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/Part1/sampling_replacement.png"><img alt="Sampling with vs without replacement illustration" src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/Part1/sampling_replacement.png" style="width: 95%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 1.23 </span><span class="caption-text"><strong>Sampling With vs Without Replacement.</strong> Bootstrap resampling (with replacement) allows duplicates; simple random sampling (without) guarantees uniqueness.</span><a class="headerlink" href="#id12" title="Link to this image">ÔÉÅ</a></p>
</figcaption>
</figure>
</section>
<section id="parallel-random-number-generation">
<h3>Parallel Random Number Generation<a class="headerlink" href="#parallel-random-number-generation" title="Link to this heading">ÔÉÅ</a></h3>
<p>For parallel computing, each worker needs an <strong>independent</strong> random stream. Naively using seeds 0, 1, 2, ‚Ä¶ doesn‚Äôt guarantee independence. NumPy‚Äôs <code class="docutils literal notranslate"><span class="pre">SeedSequence</span></code> provides the solution:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numpy.random</span><span class="w"> </span><span class="kn">import</span> <span class="n">SeedSequence</span><span class="p">,</span> <span class="n">default_rng</span>

<span class="k">def</span><span class="w"> </span><span class="nf">mc_pi</span><span class="p">(</span><span class="n">child_seed</span><span class="p">,</span> <span class="n">n_points</span><span class="o">=</span><span class="mi">1_000_000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Estimate œÄ using one worker&#39;s independent stream.&quot;&quot;&quot;</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">default_rng</span><span class="p">(</span><span class="n">child_seed</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">n_points</span><span class="p">),</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">n_points</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_points</span>

<span class="c1"># Create master seed and spawn children</span>
<span class="n">master</span> <span class="o">=</span> <span class="n">SeedSequence</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">child_seeds</span> <span class="o">=</span> <span class="n">master</span><span class="o">.</span><span class="n">spawn</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># Each worker gets independent stream</span>
<span class="n">estimates</span> <span class="o">=</span> <span class="p">[</span><span class="n">mc_pi</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span> <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="n">child_seeds</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;œÄ estimates from 4 workers: </span><span class="si">{</span><span class="n">estimates</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">estimates</span><span class="p">)</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="warning admonition">
<p class="admonition-title">Common Pitfall ‚ö†Ô∏è</p>
<p><strong>Never share a Generator across threads or processes!</strong> Each parallel worker must have its own <code class="docutils literal notranslate"><span class="pre">Generator</span></code> from <code class="docutils literal notranslate"><span class="pre">SeedSequence.spawn()</span></code>. Sharing leads to:</p>
<ul class="simple">
<li><p>Race conditions (undefined behavior)</p></li>
<li><p>Correlated streams (invalid statistics)</p></li>
<li><p>Non-reproducibility (results depend on timing)</p></li>
</ul>
</div>
</section>
</section>
<section id="scipy-stats-the-complete-statistical-toolkit">
<h2>SciPy Stats: The Complete Statistical Toolkit<a class="headerlink" href="#scipy-stats-the-complete-statistical-toolkit" title="Link to this heading">ÔÉÅ</a></h2>
<p>While NumPy generates samples fast, <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> provides the complete mathematical infrastructure: probability density functions, cumulative distributions, quantile functions, parameter fitting, and statistical tests.</p>
<section id="why-scipy-is-the-next-stop-after-numpy">
<h3>Why SciPy Is the ‚ÄúNext Stop‚Äù After NumPy<a class="headerlink" href="#why-scipy-is-the-next-stop-after-numpy" title="Link to this heading">ÔÉÅ</a></h3>
<table class="docutils align-default" id="id13">
<caption><span class="caption-number">Table 1.11 </span><span class="caption-text">SciPy Advantages Over NumPy Alone</span><a class="headerlink" href="#id13" title="Link to this table">ÔÉÅ</a></caption>
<colgroup>
<col style="width: 30.0%" />
<col style="width: 70.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>What It Buys You</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>100+ distributions</strong></p></td>
<td><p>Gaussian to Zipf, each with PDF, CDF, PPF, RVS, fit</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Analytic functions</strong></p></td>
<td><p>Evaluate density, quantile, or survival at any point‚Äîno Monte Carlo noise</p></td>
</tr>
<tr class="row-even"><td><p><strong>Parameter fitting</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">stats.&lt;dist&gt;.fit(data)</span></code> returns MLEs in one line</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Hypothesis tests</strong></p></td>
<td><p>t-, Z-, KS-, Shapiro-Wilk, œá¬≤, Levene, Kruskal-Wallis, ‚Ä¶</p></td>
</tr>
<tr class="row-even"><td><p><strong>Bootstrap helpers</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">stats.bootstrap</span></code>, <code class="docutils literal notranslate"><span class="pre">stats.permutation_test</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Decision cheat-sheet:</strong></p>
<table class="docutils align-default" id="id14">
<caption><span class="caption-number">Table 1.12 </span><span class="caption-text">When to Use NumPy vs SciPy</span><a class="headerlink" href="#id14" title="Link to this table">ÔÉÅ</a></caption>
<colgroup>
<col style="width: 35.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 25.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Task</p></th>
<th class="head"><p>NumPy</p></th>
<th class="head"><p>SciPy</p></th>
<th class="head"><p>Go Beyond</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Vectorized random draws</p></td>
<td><p>‚úÖ</p></td>
<td><p>‚Äî</p></td>
<td><p>‚Äî</p></td>
</tr>
<tr class="row-odd"><td><p>Analytic PDF/CDF/quantile</p></td>
<td><p>‚Äî</p></td>
<td><p>‚úÖ</p></td>
<td><p>‚Äî</p></td>
</tr>
<tr class="row-even"><td><p>Fit distribution parameters</p></td>
<td><p>‚Äî</p></td>
<td><p>‚úÖ</p></td>
<td><p>‚Äî</p></td>
</tr>
<tr class="row-odd"><td><p>Classical tests (t, KS, œá¬≤, ANOVA)</p></td>
<td><p>‚Äî</p></td>
<td><p>‚úÖ</p></td>
<td><p>‚Äî</p></td>
</tr>
<tr class="row-even"><td><p>Linear/GLM/mixed models</p></td>
<td><p>‚Äî</p></td>
<td><p>‚Äî</p></td>
<td><p>statsmodels</p></td>
</tr>
<tr class="row-odd"><td><p>Full Bayesian inference</p></td>
<td><p>‚Äî</p></td>
<td><p>‚Äî</p></td>
<td><p>PyMC, Stan</p></td>
</tr>
</tbody>
</table>
</section>
<section id="the-frozen-distribution-pattern">
<h3>The Frozen Distribution Pattern<a class="headerlink" href="#the-frozen-distribution-pattern" title="Link to this heading">ÔÉÅ</a></h3>
<p>SciPy‚Äôs key design: create a distribution object with fixed parameters, then call methods on it:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>

<span class="c1"># Create &quot;frozen&quot; distribution</span>
<span class="n">iq_dist</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="c1"># Access properties</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean: </span><span class="si">{</span><span class="n">iq_dist</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Variance: </span><span class="si">{</span><span class="n">iq_dist</span><span class="o">.</span><span class="n">var</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Median: </span><span class="si">{</span><span class="n">iq_dist</span><span class="o">.</span><span class="n">median</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Probability calculations</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P(IQ ‚â§ 130) = </span><span class="si">{</span><span class="n">iq_dist</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">130</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P(IQ &gt; 130) = </span><span class="si">{</span><span class="n">iq_dist</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="mi">130</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Quantiles</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;90th percentile: </span><span class="si">{</span><span class="n">iq_dist</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.90</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Random samples</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">iq_dist</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;5 samples: </span><span class="si">{</span><span class="n">samples</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="the-unified-interface">
<h3>The Unified Interface<a class="headerlink" href="#the-unified-interface" title="Link to this heading">ÔÉÅ</a></h3>
<p>Every distribution provides the same methods:</p>
<table class="docutils align-default" id="id15">
<caption><span class="caption-number">Table 1.13 </span><span class="caption-text">SciPy Distribution Methods</span><a class="headerlink" href="#id15" title="Link to this table">ÔÉÅ</a></caption>
<colgroup>
<col style="width: 15.0%" />
<col style="width: 25.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Mathematical</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pdf(x)</span></code>/<code class="docutils literal notranslate"><span class="pre">pmf(x)</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(f(x)\)</span> or <span class="math notranslate nohighlight">\(P(X=x)\)</span></p></td>
<td><p>Density (continuous) or mass (discrete)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cdf(x)</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(F(x) = P(X \leq x)\)</span></p></td>
<td><p>Cumulative distribution function</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sf(x)</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(1 - F(x)\)</span></p></td>
<td><p>Survival function</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ppf(q)</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(F^{-1}(q)\)</span></p></td>
<td><p>Quantile function (inverse CDF)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rvs(size)</span></code></p></td>
<td><p>‚Äî</p></td>
<td><p>Random samples</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">mean()</span></code>, <code class="docutils literal notranslate"><span class="pre">var()</span></code>, <code class="docutils literal notranslate"><span class="pre">std()</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(E[X]\)</span>, <span class="math notranslate nohighlight">\(\text{Var}(X)\)</span></p></td>
<td><p>Moments</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">interval(Œ±)</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\([a,b]\)</span>: <span class="math notranslate nohighlight">\(P(a \leq X \leq b) = \alpha\)</span></p></td>
<td><p>Central probability interval</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">fit(data)</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\hat{\theta}_{\text{MLE}}\)</span></p></td>
<td><p>Maximum likelihood estimation</p></td>
</tr>
</tbody>
</table>
<figure class="align-center" id="id16">
<a class="reference internal image-reference" href="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/Part1/scipy_methods.png"><img alt="Four panels showing PDF, CDF, PPF, and samples for a Gamma distribution" src="https://pqyjaywwccbnqpwgeiuv.supabase.co/storage/v1/object/public/STAT%20418%20Images/assets/Part1/scipy_methods.png" style="width: 90%;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 1.24 </span><span class="caption-text"><strong>SciPy Distribution Methods.</strong> (A) PDF gives density at any point. (B) CDF gives cumulative probability. (C) PPF (quantile function) inverts the CDF. (D) RVS generates samples matching the distribution.</span><a class="headerlink" href="#id16" title="Link to this image">ÔÉÅ</a></p>
</figcaption>
</figure>
</section>
<section id="parameterization-the-most-common-error-source">
<h3>Parameterization: The Most Common Error Source<a class="headerlink" href="#parameterization-the-most-common-error-source" title="Link to this heading">ÔÉÅ</a></h3>
<p>Different sources use different parameterizations. SciPy has its own conventions:</p>
<table class="docutils align-default" id="id17">
<caption><span class="caption-number">Table 1.14 </span><span class="caption-text">SciPy Parameterization Reference</span><a class="headerlink" href="#id17" title="Link to this table">ÔÉÅ</a></caption>
<colgroup>
<col style="width: 18.0%" />
<col style="width: 32.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Distribution</p></th>
<th class="head"><p>SciPy Call</p></th>
<th class="head"><p>Notes &amp; Gotchas</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Normal</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">stats.norm(loc=Œº,</span> <span class="pre">scale=œÉ)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">scale</span></code> is std dev œÉ, <strong>NOT</strong> variance œÉ¬≤</p></td>
</tr>
<tr class="row-odd"><td><p>Exponential</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">stats.expon(scale=Œ≤)</span></code></p></td>
<td><p>Mean = scale = 1/rate. For rate Œª=2, use <code class="docutils literal notranslate"><span class="pre">scale=0.5</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Gamma</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">stats.gamma(a=k,</span> <span class="pre">scale=Œ∏)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span></code> is shape k. Mean = k¬∑Œ∏</p></td>
</tr>
<tr class="row-odd"><td><p>Beta</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">stats.beta(a,</span> <span class="pre">b)</span></code></p></td>
<td><p>Shape parameters Œ±, Œ≤</p></td>
</tr>
<tr class="row-even"><td><p>Chi-square</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">stats.chi2(df)</span></code></p></td>
<td><p>Degrees of freedom only</p></td>
</tr>
<tr class="row-odd"><td><p>Student‚Äôs t</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">stats.t(df)</span></code></p></td>
<td><p>Add <code class="docutils literal notranslate"><span class="pre">loc</span></code>, <code class="docutils literal notranslate"><span class="pre">scale</span></code> for non-standard</p></td>
</tr>
<tr class="row-even"><td><p>F</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">stats.f(dfn,</span> <span class="pre">dfd)</span></code></p></td>
<td><p>Numerator df first</p></td>
</tr>
<tr class="row-odd"><td><p>Poisson</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">stats.poisson(mu=Œª)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">mu</span></code> is the rate Œª</p></td>
</tr>
<tr class="row-even"><td><p>Binomial</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">stats.binom(n,</span> <span class="pre">p)</span></code></p></td>
<td><p>n trials, probability p</p></td>
</tr>
<tr class="row-odd"><td><p>Negative Binomial</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">stats.nbinom(n,</span> <span class="pre">p)</span></code></p></td>
<td><p>Counts <strong>failures</strong> before n successes</p></td>
</tr>
</tbody>
</table>
<div class="warning admonition">
<p class="admonition-title">Common Pitfall ‚ö†Ô∏è: Exponential Parameterization</p>
<p>The exponential distribution causes endless confusion:</p>
<ul class="simple">
<li><p><strong>Rate parameterization</strong> (textbooks): <span class="math notranslate nohighlight">\(f(x) = \lambda e^{-\lambda x}\)</span>, mean = <span class="math notranslate nohighlight">\(1/\lambda\)</span></p></li>
<li><p><strong>Scale parameterization</strong> (SciPy/NumPy): <span class="math notranslate nohighlight">\(f(x) = \frac{1}{\beta}e^{-x/\beta}\)</span>, mean = <span class="math notranslate nohighlight">\(\beta\)</span></p></li>
</ul>
<p>For mean = 2:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">random.expovariate(0.5)</span></code> ‚Äî rate = 0.5</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rng.exponential(2)</span></code> ‚Äî scale = 2</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stats.expon(scale=2)</span></code> ‚Äî scale = 2</p></li>
</ul>
<p><strong>Always verify by checking the sample mean!</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Want mean = 2</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">expon</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Correct</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean: </span><span class="si">{</span><span class="n">samples</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># ‚âà 2.0</span>

<span class="c1"># Common mistake</span>
<span class="n">wrong</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">expon</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># This has mean = 0.5!</span>
</pre></div>
</div>
</div>
</section>
<section id="complete-analysis-example">
<h3>Complete Analysis Example<a class="headerlink" href="#complete-analysis-example" title="Link to this heading">ÔÉÅ</a></h3>
<div class="note admonition">
<p class="admonition-title">Example üí°: Distribution Fitting and Diagnostics</p>
<p><strong>Problem:</strong> Fit a Gamma distribution to data and assess the fit.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Generate &quot;observed&quot; data</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">true_dist</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">true_dist</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>

<span class="c1"># Fit Gamma distribution (fix location at 0)</span>
<span class="n">a_hat</span><span class="p">,</span> <span class="n">loc_hat</span><span class="p">,</span> <span class="n">scale_hat</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">gamma</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">floc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fitted: shape=</span><span class="si">{</span><span class="n">a_hat</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, scale=</span><span class="si">{</span><span class="n">scale_hat</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;True:   shape=2.000, scale=2.000&quot;</span><span class="p">)</span>

<span class="c1"># Create fitted distribution</span>
<span class="n">fitted</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a_hat</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc_hat</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale_hat</span><span class="p">)</span>

<span class="c1"># Goodness-of-fit test</span>
<span class="n">D</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">kstest</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">fitted</span><span class="o">.</span><span class="n">cdf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">KS test: D=</span><span class="si">{</span><span class="n">D</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, p-value=</span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Theoretical vs empirical quantiles</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">95th percentile: fitted=</span><span class="si">{</span><span class="n">fitted</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, empirical=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="mi">95</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="bringing-it-all-together-library-selection-guide">
<h2>Bringing It All Together: Library Selection Guide<a class="headerlink" href="#bringing-it-all-together-library-selection-guide" title="Link to this heading">ÔÉÅ</a></h2>
<p><strong>Use ``random`` (standard library) when:</strong></p>
<ul class="simple">
<li><p>Zero dependencies required</p></li>
<li><p>Teaching probability concepts</p></li>
<li><p>Simple prototypes or scripts</p></li>
<li><p>Sample sizes under ~10,000</p></li>
<li><p>You need <code class="docutils literal notranslate"><span class="pre">choice</span></code>, <code class="docutils literal notranslate"><span class="pre">shuffle</span></code>, <code class="docutils literal notranslate"><span class="pre">sample</span></code> on lists</p></li>
</ul>
<p><strong>Use NumPy ``Generator`` when:</strong></p>
<ul class="simple">
<li><p>Working with arrays and matrices</p></li>
<li><p>Sample sizes exceed 10,000</p></li>
<li><p>Performance is critical</p></li>
<li><p>You need multivariate distributions</p></li>
<li><p>Parallel computing with independent streams</p></li>
</ul>
<p><strong>Use ``scipy.stats`` when:</strong></p>
<ul class="simple">
<li><p>You need PDF, CDF, or quantile functions</p></li>
<li><p>Fitting distributions to data</p></li>
<li><p>Performing statistical tests</p></li>
<li><p>Computing theoretical properties exactly</p></li>
<li><p>You need exotic distributions (100+ available)</p></li>
</ul>
<p><strong>Combine them:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># SciPy for distribution definition and analysis</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">theoretical_mean</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">critical_value</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)</span>

<span class="c1"># NumPy for efficient sampling</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>

<span class="c1"># Verify</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Theory mean: </span><span class="si">{</span><span class="n">theoretical_mean</span><span class="si">}</span><span class="s2">, Sample mean: </span><span class="si">{</span><span class="n">samples</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="important admonition">
<p class="admonition-title">Key Takeaways üìù</p>
<ol class="arabic simple">
<li><p><strong>Pseudo-randomness is deterministic</strong>: PRNGs produce sequences determined by their seed. Reproducibility requires explicit seeding.</p></li>
<li><p><strong>Three libraries, three purposes</strong>: Standard library for simplicity; NumPy for performance with arrays; SciPy for complete distribution analysis.</p></li>
<li><p><strong>Know your parameterizations</strong>: Rate vs scale causes endless bugs. <strong>Always verify sample means match expectations.</strong></p></li>
<li><p><strong>Vectorize for speed</strong>: NumPy provides 50‚Äì100√ó speedup by eliminating Python loop overhead.</p></li>
<li><p><strong>Independent streams for parallel work</strong>: Use <code class="docutils literal notranslate"><span class="pre">SeedSequence.spawn()</span></code>. Never share generators across threads/processes.</p></li>
<li><p><strong>Outcome alignment</strong>: This chapter directly supports Learning Outcome 1 (simulation techniques) and provides the computational foundation for all subsequent chapters.</p></li>
</ol>
</div>
</section>
<section id="looking-ahead-from-random-numbers-to-monte-carlo-methods">
<h2>Looking Ahead: From Random Numbers to Monte Carlo Methods<a class="headerlink" href="#looking-ahead-from-random-numbers-to-monte-carlo-methods" title="Link to this heading">ÔÉÅ</a></h2>
<p>With Python‚Äôs random generation ecosystem mastered, we are ready to put these tools to work. The ability to draw samples from probability distributions is not merely a computational convenience‚Äîit is the engine that powers modern statistical inference.</p>
<p>In <strong>Chapter 2</strong>, we turn to <strong>Monte Carlo methods</strong>: using random sampling to solve problems that would be analytically intractable. The techniques you‚Äôve learned here‚Äîgenerating uniforms, transforming to other distributions, managing random streams‚Äîbecome the building blocks for:</p>
<ul class="simple">
<li><p><strong>Monte Carlo integration</strong>: Estimating integrals via random sampling, essential when closed-form solutions don‚Äôt exist</p></li>
<li><p><strong>The inverse CDF method</strong>: Transforming uniform samples to arbitrary distributions using quantile functions (<code class="docutils literal notranslate"><span class="pre">ppf</span></code>)</p></li>
<li><p><strong>Rejection sampling</strong>: Generating samples from complex distributions by accepting/rejecting proposals</p></li>
<li><p><strong>Variance reduction</strong>: Techniques like antithetic variates and control variates that improve Monte Carlo efficiency</p></li>
</ul>
<p>The connection is direct: every Monte Carlo estimate begins with a call to a random number generator. The <code class="docutils literal notranslate"><span class="pre">numpy.random.Generator</span></code> you‚Äôve learned to use will generate the uniform samples; the <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> distributions will provide the CDFs and PDFs needed for transformations and density evaluation. Understanding the computational tools in this chapter is prerequisite to understanding <em>why</em> Monte Carlo methods work and <em>how</em> to implement them efficiently.</p>
<p>Consider the preview exercise on parallel Monte Carlo integration at the end of this chapter‚Äîit demonstrates exactly this bridge: spawning independent random streams, generating samples, and averaging to estimate an integral. Chapter 2 develops the theory behind why this works and when it fails.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ch1.2-probability_distributions_review.html" class="btn btn-neutral float-left" title="1.1.2. Probability Distributions: Theory and Computation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../part2_simulation/index.html" class="btn btn-neutral float-right" title="Part II: Simulation-Based Methods" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>